function sourceFn(){"use strict";(self.webpackChunkvkweb=self.webpackChunkvkweb||[]).push([[89887],{784099:(e,_,t)=>{t.d(_,{AjaxCacheClient:()=>n});var o=t(593159),a=t(969686);class n{static getInstance(e,_){const t=n.makeCacheKey(e,_);return n._instances[t]||(n._instances[t]=new n(t)),n._instances[t]}getFromCache(e,_,{cacheLevel:t=0,forceGlobalCache:a=!1,onAnswerProcessed:n=()=>{}}){if(t>0||a){let i=window.ajaxCache[this._cacheKey];if(i&&i._loading)return i._callbacks.push(e),!1;if(i&&!a)return e(0,i),3===t&&delete window.ajaxCache[this._cacheKey],!1;if(i=window.globalAjaxCache[this._cacheKey],i)return-1===i||(0,o.isFunction)(i)?window.globalAjaxCache[this._cacheKey]=_:_.apply(window,i),n&&n(),!1}return window.ajaxCache[this._cacheKey]={_loading:1,_callbacks:[]},!0}processExistingCache(e,_){const t=window.ajaxCache[this._cacheKey];t&&t._loading&&(setTimeout((function(){for(const o in t._callbacks)t._callbacks.hasOwnProperty(o)&&t._callbacks[o](e,_)}),0),delete window.ajaxCache[this._cacheKey])}cacheResponse(e){window.ajaxCache[this._cacheKey]=e}static ensureCachesInitialized(){window.ajaxCache||t._dG("ajaxCache",{}),window.globalAjaxCache||t._dG("globalAjaxCache",{})}static makeCacheKey(e,_){const t={..._};return["al","al_ad","ads_section","ads_showed","captcha_sid","captcha_key","_smt","_preload"].forEach((e=>delete t[e])),e+"#"+(0,a.toQueryString)(t)}static preload(e,_,t){n.ensureCachesInitialized(),e&&"/"!==e.substr(0,1)&&(e="/"+e),window.ajaxCache[n.makeCacheKey(e,_)]=t}static invalidate(e,_){n.ensureCachesInitialized(),void 0===e?t._dG("ajaxCache",{}):delete window.ajaxCache[n.makeCacheKey(e,_)]}static invalidateFor(e){Object.keys(window.ajaxCache).forEach((_=>{e(_)&&delete window.ajaxCache[_]}))}constructor(e){n.ensureCachesInitialized(),this._cacheKey=e}}n._instances={}},792238:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{FrameTransport:()=>FrameTransport,_debugLogger:()=>_debugLogger});var _shared_lib_convert__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(969686),_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(593159),_web_lib_ui_util__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(560377),_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(237625),_web_lib_ajax_module_callback__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(287227),_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(754866),_shared_lib_site__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(105330),_shared_user_user_env__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(540462),_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(636576),_vkontakte_internal_utils__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(558137);const _queueStartMarker={type:"start"},_queueEndMarker={type:"end"};function isAllowedOrigin(e){if(!(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_7__.partConfigEnabled)("fix_frame_transport_xss"))return!0;const _=((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_7__.getConfigValue)("vk_origin_frame_blacklist")??[]).every((_=>!e.includes(_)));return!_&&(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_7__.partConfigEnabled)("log_skipped_vk_origin_by_frame")&&(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_8__.statlogsValueEvent)("skipped_vk_origin_by_frame",window.vk?.id??0,e,window.cur?.aid??0),_}function _debugLogger(){if(!(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_7__.partConfigEnabled)("extended_ajax_logging"))return;let e;try{throw new Error}catch(_){e=_.stack}let _="+ Frame transport: "+arguments[0];console.groupCollapsed(_),[].slice.call(arguments,1).forEach((e=>console.log(JSON.stringify(e)))),console.log(e),console.groupEnd()}class FrameTransport{setHandlers(e=()=>{},_=()=>{},t=()=>{}){this._onEnd=e,this._onModuleEvaluated=_,this._debug=t}setInlineHandler(e){this.execInline=e}run(e,_=()=>{}){return this._debug("Run ",e,this.frameDataQueue),this.frameUrl=e,this.onReady=_,this.fulfilled=!1,this.queueReady=!1,this.frameDataQueue=[_queueStartMarker],clearTimeout(this.frameTimeout),this.frameTimeout=!1,this.frame&&this._cleanup(),this.frame=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.ce)("div",{innerHTML:"<iframe></iframe>"}),utilsNode.appendChild(this.frame),this.frame.firstChild.src=this.frameUrl,this}onWindowMessage(e){const _=!("isTrusted"in e)||e.isTrusted;if(!_shared_lib_site__WEBPACK_IMPORTED_MODULE_6__.VK_ORIGIN_REGEX_STRICT.test(e.origin)||!_)return;const{data:{action:t,type:o,data:a}}=e;if("frame_transport"===o&&"use_meta"===t)isAllowedOrigin(e.origin)&&this.useMeta(a)}useMeta(e){this._debug("Metainfo: ",e),this.onReady(e)}useAjaxBlock(e,_,t){this._debug("Ajax block: ",e,_,t,this.fulfilled,this.frameDataQueue),this.fulfilled||(this.frameDataQueue.push(FrameTransport._makeQueueBlock(e,_,t)),1===this.frameDataQueue.length&&this._nextQueueItem())}finalize(e,_){this._debug("Finalize: ",e),this._cleanup(),e&&this.frameDataQueue.push(FrameTransport._makeQueueBlock(!1,!1,e,_)),this.queueReady=!0,this.frameDataQueue.push(_queueEndMarker),window.cur.onFrameBlocksDone&&window.cur.onFrameBlocksDone(),this._onEnd&&this._onEnd((new Date).getTime())}_nextQueueItem(){if(this.frameTimeout&&clearTimeout(this.frameTimeout),!this.queueReady)return void(this.frameTimeout=setTimeout((()=>this._nextQueueItem()),100));if(this._debug("Next queue item: ",this.fulfilled,this.frameDataQueue),this.fulfilled||0===this.frameDataQueue.length)return void(this.frameTimeout=!1);const e=this.frameDataQueue.shift();switch(e.type){case _queueStartMarker.type:this._nextQueueItem();break;case _queueEndMarker.type:this.fulfilled=!0;break;default:this.frameTimeout=setTimeout((()=>this._onReceived(e)),0)}}_onReceived(e){const _=(e,_)=>{const t=e?.message||"Unknown error in eval";let o="<b>JavaScript error</b>"+((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_7__.partConfigEnabled)("extended_client_logging")?": "+t:"");e.stack&&__debugMode&&(o+="<br/>"+e.stack.replace(/\n/g,"<br/>")),(0,_web_lib_ui_util__WEBPACK_IMPORTED_MODULE_2__.topMsg)(o,15,"#FFB4A3"),(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_3__.logEvalError)(e,_,{message:t,breadcrumb:{data:{msg:t,module:(window.cur||{}).module,id:vk.id,host:locHost,lang:vk.lang,loc:(window.nav||{}).strLoc,realloc:location.toString()}}})},t=e.container&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.ge)(e.container);t&&e.html&&(t.firstChild?t.appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.cf)(e.html)):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_5__.val)(t,e.html)),e.js&&(_runJs(e.js,_),this._onModuleEvaluated&&this._onModuleEvaluated(cur.module)),e.params&&"leftads"in e.params&&window.__adsSet&&__adsSet(e.params.leftads,e.params.ads_section||"",e.params.ads_can_show,e.params.ads_showed),this._nextQueueItem()}_cleanup(){this._debug("Cleanup: ",this.frameDataQueue),this.frame&&(this.frame.innerHTML="",utilsNode.removeChild(this.frame),this.frame=null)}abort(){clearTimeout(this.frameTimeout),this.frameTimeout=!1,this._cleanup()}static get frame(){const e=(0,_vkontakte_internal_utils__WEBPACK_IMPORTED_MODULE_9__.makeSharedState)("frame-transport",(()=>new FrameTransport),{version:1})();return e.setHandlers(void 0,(e=>{(0,_web_lib_ajax_module_callback__WEBPACK_IMPORTED_MODULE_4__.triggerSubscribersOnModuleEvaluated)()}),_debugLogger),e}static request(e,_,t,o,a){const n=FrameTransport.frame;return n.setInlineHandler(a),n.run(FrameTransport.makeUrl(e,_,!(o&&o.noSort)),t)}static _makeQueueBlock(e,_,t,o){return{type:"block",container:e,html:_,js:t,params:o}}static makeUrl(e,_,t=!0){let o=_;return"string"==typeof _&&(o=(0,_shared_lib_convert__WEBPACK_IMPORTED_MODULE_0__.fromQueryString)(_)),o=(0,_shared_lib_convert__WEBPACK_IMPORTED_MODULE_0__.toQueryString)({...o,_rndVer:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_1__.irand)(0,99999)},!t),e+"?"+o}constructor(){this.frameDataQueue=[],this.frameTimeout=null,this.frame=null,this.queueReady=!1,this.fulfilled=!1,this.execInline=()=>{},this._debug=()=>{},window.addEventListener("message",this.onWindowMessage.bind(this))}}function _runJs(js,onError){const script="(function(){"+js+";})()";if(__debugMode)eval(script);else try{eval(script)}catch(e){onError&&onError(e,script)}}},628202:(e,_,t)=>{t.d(_,{activateMobileBox:()=>n,requestBox:()=>a,validateMobileBox:()=>i,validateOtpBox:()=>s,validatePassBox:()=>r});var o=t(270959);function a(e,_,t){return e.setOptions({onDestroy:t}),e.onDone=function(){_&&_.apply(null,arguments)},e}function n(e){return a((0,o.showBox)("activation.php",{act:"activate_mobile_box",hash:e.hash}),(function(){vk.nophone=0,e.onDone()}),e.onFail)}function i(e){return a((0,o.showBox)("activation.php",{act:"validate_box",captcha:e.acceptCaptcha?1:"",skip_push:e.skip_push?e.skip_push:"",from:e.from||"",hash:e.hash,ahash:e.ahash},{stat:["uncommon.css"]}),e.onDone,e.onFail)}function r(e){return a((0,o.showBox)("activation.php",{act:"pass_validate_box",hash:e.hash},{stat:["uncommon.css"]}),e.onDone,e.onFail)}function s(e){return a((0,o.showBox)("activation.php",{act:"otp_validate_box",hash:e.hash},{stat:["uncommon.css"]}),e.onDone,e.onFail)}},299628:(e,_,t)=>{t.d(_,{AjaxProtoJson:()=>a});var o=t(593159);class a{parseResponse(e){let _=this.parseStaticPayload(e);return{navVersion:(0,o.intval)(_.loaderVersion),newStatic:_.static,statsMeta:_.statsMeta,langId:(0,o.intval)(_.langPack),langVer:(0,o.intval)(_.langVersion),langKeys:_.langKeys,templates:_.templates,code:(0,o.intval)(_.payload[0]),payload:_.payload[1],debugLog:_.debugLog,env:_.env,extra:_.extra,execInline:_.execInline,vkEnv:_.vkEnv}}parseStaticPayload(e,_){let t=e;return e&&"string"==typeof e&&(t=JSON.parse(e)),t.payload&&t.payload[0]>0&&(t.payload[1]=t.payload[1].map((e=>"string"==typeof e?JSON.parse(e):e))),t}}},761520:(e,_,t)=>{t.d(_,{ajax:()=>R});var o=t(969686),a=t(246429),n=t(898848),i=t(540462),r=t(636576),s=t(593159),c=t(754866),l=t(560377),d=t(792238),u=t(784099),E=t(433409),p=t(368140),h=t(299628),w=t(298077),g=t(102088),b=t(624199),P=t(253003),m=t(416368),D=t(270959),O=t(553608),M=t(558137),v=t(790031);const f="global_reload_app_modal_local_storage_key",L="ajax_request";function C(e){try{return(new DOMParser).parseFromString(e,"text/html").querySelector("title")?.textContent||e}catch{return e}}class k{static post(e,_,t){k._protoAdapter=new h.AjaxProtoJson,e&&"/"!==e.substr(0,1)&&"http"!==e.substr(0,4)&&(e="/"+e);const o={...t||{},_captcha:!1,_box:!1,no_ads_params:!1},n={..._,al:o.frame?-1:1},i=(0,s.vkNow)(),r=vk.spentLastSendTS?Math.round((i-vk.spentLastSendTS)/1e3):0;if(vk.sampleUser>=0&&window.cur&&cur.module&&r>=1&&(window.curNotifier&&curNotifier.idle_manager&&!curNotifier.idle_manager.is_idle&&(n._smt=window.cur.module+":"+r),vk.spentLastSendTS=i),o.progress&&(o.showProgress||(o.showProgress=function(){const e=(0,c.ge)(o.progress);(0,c.hasClass)(e,"pr")&&(0,c.setStyle)(e,"opacity",1),(0,c.show)(e)}),o.hideProgress||(o.hideProgress=function(){const e=(0,c.ge)(o.progress);(0,c.hasClass)(e,"pr")&&(0,c.setStyle)(e,"opacity",0),(0,c.hide)(e)})),o.loader){const e=(0,c.isVisible)(window.boxLayerWrap);o.showProgress=function(){(0,a.boxRefreshCoords)(window.boxLoader),(0,c.show)(window.boxLoader),e||(0,c.show)(window.boxLayerWrap)},o.hideProgress=function(){(0,c.hide)(window.boxLoader),e||(0,c.hide)(window.boxLayerWrap)}}return new k(e,n,o)._post()}_post(){if(!this._query.captcha_sid&&this._options.showProgress&&this._options.showProgress(),window.__adsGetAjaxParams&&!this._options.no_ads_params&&(this._query={...this._query,...window.__adsGetAjaxParams(this._query,this._options)}),this._options.stat&&(this._additionalStaticLoader=null,window.stManager.add(this._options.stat,(()=>{this._additionalStaticLoader&&this._additionalStaticLoader(),this._options.stat=!1}))),this._cacheClient&&!this._cacheClient.getFromCache(this.processResponse,this._options.onDone,{cacheLevel:this._options.cache,forceGlobalCache:this._options.forceGlobalCache,onAnswerProcessed:this._options.hideProgress}))return;this._options.resend=(e,_)=>new k(this._url,e,_)._post(),window.debuglogSent?(this._reqid=window.debuglogSent(this._url+(this._query?": "+(0,o.toQueryString)(this._query,this._options.noSort).replace(/&/g,"&amp;"):"")),this._options.frame&&t._dG("_lfrid",this._reqid)):this._reqid=0;const e={};return this._options.timeout&&(e.timeout=this._options.timeout),this._options.onTimeout&&(e.ontimeout=this._options.onTimeout),this._options.frame?d.FrameTransport.request(this._url,this._query,this.onDone,this._options,this._runInlineScript.bind(this)):(0,E.plainpost)(this._url,this._query,this.onDone,this.onFail,!1,e,this._options,!1,(0,i.partConfigEnabled)("extended_ajax_logging")?e=>console.log("+ XHR Transport: "+e):null)}processResponse(e,_,t){if(this._options.cache&&this._cacheClient&&this._cacheClient.processExistingCache(e,_),this._options.stat)return this._options.stat=!1,void(this._additionalStaticLoader=this.processResponse.pbind(e,_));this._options.cache&&!this._options.forceGlobalCache&&!e&&this._cacheClient&&this._cacheClient.cacheResponse(_),this._options.hideProgress&&this._options.hideProgress(),2!==e&&(this._options._captcha&&(this._options._suggest&&(0,c.cleanElems)(this._options._suggest),this._options._captcha=A(this._options._captcha),this._options._suggest=this._options._captcha),this._options._box=A(this._options._box)),t&&this._runInlineScript(t),(0,p.getHandlerByCode)(e)(this._options,_,this._query,this._url)}onFail(e,_){if((0,P.processWaf)(_))return;if((0,m.processChallenge)(_))return;this._options.hideProgress&&this._options.hideProgress(),this._options._suggest&&(0,c.cleanElems)(this._options._suggest);const t=_ instanceof XMLHttpRequest?_.status:_;if(this._options._box=A(this._options._captcha,this._options._box),this._options._captcha=this._options._box,this._options._suggest=this._options._captcha,"string"==typeof e&&-1!==e.indexOf("The page is temporarily unavailable")&&__dev&&(0,s.inArray)(vk.id,[100]))return void this._post();if(!(0===t&&(0,i.partConfigEnabled)("ajax_ignore_network_errors"))&&!0!==this._options.onFail?.(e)){const _=(e?JSON.stringify((a=e,"string"==typeof a?C(a):{...a,data:C(a.data)})):"No error details").substr(0,300),n=this._query.act,r=this._query&&(0,o.toQueryString)(this._query,this._options.noSort),s=this._url,c={message:"Uncaught ajax error",status:t,data:{url:s,query:r}},l=[`url: ${s}`,n&&`act: ${n}`,_&&`text: ${_}`].filter((e=>e)).join(", ");0===c.status&&(0,i.partConfigEnabled)("js_errors_no_write_uncaught_errors")||(0,w.logError)(l,{environment:"uncaughtAjaxRequestError",breadcrumb:c}),__debugMode?console.error("Uncaught Ajax request error:",_,c):console.log("Uncaught Ajax request error:",_,c)}var a}doReload(e){nav.reload({force:!0,from:e,url:this._url,query:this._query&&(0,o.toQueryString)(this._query)})}onDone(e,_){if((0,P.processWaf)(_||e))return Promise.reject();if((0,m.processChallenge)(_||e))return Promise.reject();this._options.frame&&(0,d._debugLogger)("OnDone Req:",e);const t=_ instanceof XMLHttpRequest?_.status:_;let o;try{o=k._protoAdapter.parseResponse(e)}catch(_){return this.onFail((0,i.partConfigEnabled)("fix_frame_transport_xss")&&e?`<pre>${(0,n.clean)(e)}</pre>`:e,t),Promise.reject()}const{navVersion:a,langId:r,payload:s}=o;return a?vk.version&&String(vk.version)!==String(a)?(a&&s.length>4?this.doReload(2):nav.strLoc?window.location.replace((0,n.locBase)()):(0,l.topError)("Server error.",{type:100}),Promise.reject()):(vk.version=!1,vk.lang!==r&&this._options.canReload?(this.doReload(3),Promise.reject()):T.call(this,o,this._options.canReload)):(this.onFail(e?`<pre>${e}</pre>`:e,{status:-1}),Promise.reject())}_runInlineScript(e){const _="__exec_container",t=document.getElementById(_);t&&document.body.removeChild(t);const o=document.createElement("script");o.id=_,o.innerHTML=e,document.body.appendChild(o)}constructor(e,_,t){this._url=e,this._options={...t},this._query=_,this._additionalStaticLoader=null,this._cacheClient=null,t.local&&(this.onDone=(0,s.vkLocal)(this.onDone),this.onFail=(0,s.vkLocal)(this.onFail),this.processResponse=(0,s.vkLocal)(this.processResponse)),this._options.cache&&(this._cacheClient=u.AjaxCacheClient.getInstance(this._url,this._query)),this.onDone=this.onDone.bind(this),this.onFail=this.onFail.bind(this),this.processResponse=this.processResponse.bind(this)}}async function T(e,_){if(!(this instanceof k))throw new TypeError("_preProcessResponse should be called with AjaxRequest instance as this");const{navVersion:t,newStatic:a,statsMeta:c,langId:d,langVer:u,langKeys:E,templates:p,code:h,payload:P,debugLog:m,env:M,extra:C,execInline:T,vkEnv:A}=e;if((0,i.partConfigEnabled)("log_changing_vk_env")){const e=window[Symbol.for("vkEnv")];e!==A&&(0,r.statlogsValueEvent)("web_vk_env_desync",1,e,A,window.cur?.module,String(window.vk?.statsMeta?.st),String(c?.st),window.location.toString())}if((0,i.partConfigEnabled)("webinf_show_force_reload_modal")&&a&&_&&c&&c.reloadVersion&&c.reloadVersion!==window.vk.statsMeta.reloadVersion)try{await new Promise(((e,_)=>{let t;try{t=JSON.parse(O.vkLocalStorage.getItem(f))||{}}catch(e){t={}}const o=18e5,a=18e4,n=t.date?Date.now()-t.date:Number.POSITIVE_INFINITY;if(!t.state||"reload"===t.state&&n>o||"hidden"===t.state&&n>a){const t=()=>{O.vkLocalStorage.setItem(f,JSON.stringify({date:Date.now(),state:"reload"})),_()},o=()=>{O.vkLocalStorage.setItem(f,JSON.stringify({date:Date.now(),state:"hidden"})),e()},a={title:(0,g.getLang)("global_reload_app_modal_title"),selfDestruct:!1,hideOnBGClick:!1,noCloseButton:!1};new D.MessageBox(a).content((0,g.getLang)("global_reload_app_modal_content")).addButton((0,g.getLang)("global_reload_app_modal_action"),t).show().once("afterHide",o)}else e()}))}catch(e){throw this.doReload(5),e}if(c&&(c.reloadVersion=window.vk.statsMeta.reloadVersion,window.vk.statsMeta=c),E){const{local:e,global:_}=E;(0,g.addLangKeys)(e,window.cur),(0,g.addLangKeys)(_,!0),window.cur.onAfterReset=(_,t)=>{(0,g.addLangKeys)(e,t),delete t.onAfterReset}}let R;if(M&&M.pe&&(window.vk.pe=M.pe),p&&(0,s.addTemplates)(p),await function(e,_,t,o){return new Promise((async(t,a)=>{if(!window.stVersions||(0,n.isEmpty)(window.stVersions))t();else try{await(0,i.partConfigEnabled)(v.VERSION_SKEW_ENABLED_PE)?v.VersionSkewManager.maybeUpdateNav(e):(r=e,new Promise((e=>{String(r)!==String(window.stVersions.nav)?async function(e){try{const _=await fetch("/al_loader_nav.php?act=check",{credentials:"same-origin"}),t=await _.json(),o=t?.loaderVersion;return String(e)===String(o)}catch(e){return!1}}(r).then((_=>{if(!_)return void e();const t=function(e){const _=window.vk.navPostfix||"",t=window.navMapSection?`&section=${window.navMapSection}`:"";return`/al_loader_nav.php?act=nav${_}&l=${vk.lang}&v=${e}&f=json${t}`}(r);fetch(t,{credentials:"same-origin"}).then((e=>e.json())).then((_=>{for(const e in _)_.hasOwnProperty(e)&&(window[e]=_[e]);e()})).catch((()=>{const _=new Error("Can't load loader_nav");var o,a,n;o=t,a=_,n=_.stack,(0,w.logError)(a,{environment:L,breadcrumb:{message:String(n),category:"custom",data:{file:o}}}),(0,i.partConfigEnabled)("global_show_resource_fetch_error")&&(0,l.topMsg)(`Some problems with loading <b>${o}</b>...`,5),e()}))})):e()}))),await async function(e,_,t){const o=["common.css"];if(e){const _=e.split(",");for(let e=0,t=_.length;e<t;++e)o.push(_[e])}if(stVersions.lang<t){stVersions.lang=t;for(const e in StaticFiles)StaticFiles.hasOwnProperty(e)&&/^lang\d/i.test(e)&&o.push(e)}return window.stManager.add(o)}(_,0,o),t()}catch(e){a(e)}var r}))}(t,a,0,u),this._options.frame)R=P;else try{R=k._protoAdapter.parseStaticPayload(P,this._reqid),m&&(y=m,I=this._reqid,window.debuglogGot&&window.debuglogGot(I,y))}catch(e){const _={message:"JSON error",data:{answer:P,url:this._url,query:this._query&&(0,o.toQueryString)(this._query)}};(0,w.logError)(e,{environment:L,breadcrumb:_}),console.error(e)}var y,I;this.processResponse(h,R,T),(0,b._handleResponseExtraPayloads)(C),window.cur&&"function"==typeof window.cur.onAfterReset&&delete window.cur.onAfterReset}function A(){for(let e=0,_=arguments.length;e<_;++e){const _=arguments[e];_&&_.isVisible()&&(_.setOptions({onHide:!1,onDestroy:!1}),_.hide())}return!1}const R=(0,M.makeSharedState)("ajax",(()=>({enabled:function(){try{return!!new XMLHttpRequest}catch(e){return!1}}(),plainpost:E.plainpost,post:k.post,promisifiedPost:(e,_,t)=>new Promise(((o,a)=>{k.post(e,_,{...t,onDone:(...e)=>{o(e)},onFail:e=>((0,i.partConfigEnabled)("sentry_errors_fix")?"object"!=typeof e||e instanceof Error?a(e):a(new Error("[AjaxRequest] promisifiedPost request failed!",{cause:e})):a(e),!!t?.ignoreDefaultErrorLogger),onTimeout:()=>{a("timeout")}})})),framepost:d.FrameTransport.request,request:E.request,preload:u.AjaxCacheClient.preload,invalidate:u.AjaxCacheClient.invalidate,AjaxRequest:k,AjaxCancellationToken:E.AjaxCancellationToken,frame:d.FrameTransport.frame,_framenext:()=>d.FrameTransport.frame._nextQueueItem()})),{version:1})()},368140:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{getHandlerByCode:()=>getHandlerByCode});var _vkontakte_internal_plugins__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(657472),_shared_lib_convert__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(969686),_shared_lib_langs_utils__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(768602),_shared_user_user_env__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(540462),_web_captcha_showCaptchaSDK__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(265668),_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(972332),_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(593159),_web_lib_message_box__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(270959),_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(754866),_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(237625),_web_lib_ui_util__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(560377),_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(246429),_modal_box__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(628202),_utils_resetOptionsCache__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(386477),_authFailed__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(383641);const showCaptchaPopupAsync=async e=>{const{showCaptchaPopup:_}=await Promise.all([__webpack_require__.e(91498),__webpack_require__.e(89631),__webpack_require__.e(762),__webpack_require__.e(30072),__webpack_require__.e("langs/web/showCaptchaPopup")]).then(__webpack_require__.bind(__webpack_require__,345601));return _(e)};function emailNotConfirmed(e,_){(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_6__.showFastBox)({width:520,title:_[0],onDestroy:e.onFail},_[1])}const handleShowCaptchaSuggest=e=>{e._suggest=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("phone_validation_link",e._captcha.bodyNode),e._suggest&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__.addEvent)(e._suggest,"click",(function(){e._box=(0,_modal_box__WEBPACK_IMPORTED_MODULE_11__.validateMobileBox)({onDone:e._captcha.submit})}))};async function showCaptcha(e,_,t){const o={sid:_[0],dif:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_5__.intval)(_[1]),isRefreshEnabledValue:_[2],isSoundCaptchaAvailableValue:_[3],captchaImg:_[4],captchaTrack:_[5],captchaTrack:_[6],redirectUri:_[7]};if(2===o.dif)e._captcha=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_6__.showReCaptchaBox)(o.sid,o.isRefreshEnabledValue,e._captcha,{onSubmit:function(_){const o={...t,recaptcha:_,captcha_sid:null,captcha_key:null};e.resend(o,(0,_utils_resetOptionsCache__WEBPACK_IMPORTED_MODULE_13__.resetOptionsCache)(e))},onDestroy:function(){e.onFail&&e.onFail()}});else{const{redirectUri:_}=o;if(_)try{const o=await(0,_web_captcha_showCaptchaSDK__WEBPACK_IMPORTED_MODULE_3__.showCaptchaSDK)(_);return e.resend({...t,success_token:o},(0,_utils_resetOptionsCache__WEBPACK_IMPORTED_MODULE_13__.resetOptionsCache)(e)),void handleShowCaptchaSuggest(e)}catch(_){if(_===_vkontakte_internal_plugins__WEBPACK_IMPORTED_MODULE_14__.CaptchaSDKEvents.CLOSE||_===_vkontakte_internal_plugins__WEBPACK_IMPORTED_MODULE_14__.CaptchaSDKEvents.OPENED)return e.onFail&&e.onFail(),void handleShowCaptchaSuggest(e)}(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_2__.partConfigEnabled)("vkcom_audio_captcha_enabled")?showCaptchaPopupAsync({sid:o.sid,isRefreshEnabled:!!o.isRefreshEnabledValue,isSoundCaptchaAvailable:!!o.isSoundCaptchaAvailableValue,captcha_img:o.captchaImg,captcha_track:o.captchaTrack,onSubmit:(_,a)=>{e.resend({...t,captcha_sid:o.sid,captcha_key:_,is_sound_captcha:a},(0,_utils_resetOptionsCache__WEBPACK_IMPORTED_MODULE_13__.resetOptionsCache)(e))},onClose:()=>{e.onFail&&e.onFail()}}):e._captcha=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_6__.showCaptchaBox)(o.sid,o.dif,e._captcha,{onSubmit:function(_,o){const a={...t,captcha_sid:_,captcha_key:o};e.resend(a,(0,_utils_resetOptionsCache__WEBPACK_IMPORTED_MODULE_13__.resetOptionsCache)(e))},onDestroy:function(){e.onFail&&e.onFail()}},o.isRefreshEnabledValue)}handleShowCaptchaSuggest(e)}const mobileValidationRequired=e=>(_,t,o)=>{_._box=(0,_modal_box__WEBPACK_IMPORTED_MODULE_11__.validateMobileBox)({acceptCaptcha:11===e,onDone:function(e,t){vk.nophone=0,e&&(_._captcha=(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_10__.curBox)());const a=e?{...o,captcha_sid:e,captcha_key:t}:o;_.resend(a,(0,_utils_resetOptionsCache__WEBPACK_IMPORTED_MODULE_13__.resetOptionsCache)(_))},onFail:_.onFail,hash:t[0],ahash:t[1]})};function passwordValidationRequired(e,_,t){e._box=(0,_modal_box__WEBPACK_IMPORTED_MODULE_11__.validatePassBox)({onDone:()=>e.resend(t,(0,_utils_resetOptionsCache__WEBPACK_IMPORTED_MODULE_13__.resetOptionsCache)(e)),onFail:e.onFail,hash:_[0]})}function makeRedirect(e,_){(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_5__.intval)(_[1])?nav.go(_[0],!1,{nocur:"2"===_[1],noback:!0===_[1],showProgress:e.showProgress,hideProgress:e.hideProgress}):(hab.stop(),location.href=_[0])}function reload(e,_,t,o){nav.reload({force:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_5__.intval)(_[0]),from:1,url:o,query:t&&(0,_shared_lib_convert__WEBPACK_IMPORTED_MODULE_0__.toQueryString)(t)})}function mobileActivationRequired(e,_,t){e._box=(0,_modal_box__WEBPACK_IMPORTED_MODULE_11__.activateMobileBox)({onDone:e.resend(t,(0,_utils_resetOptionsCache__WEBPACK_IMPORTED_MODULE_13__.resetOptionsCache)(e)),onFail:e.onFail,hash:_[0]})}function showMessage(e,_){e.onFail&&e.onFail(),(0,_web_lib_ui_util__WEBPACK_IMPORTED_MODULE_9__.topMsg)(_[0],10)}function showError(e,_,t,o){e.onFail&&e.onFail(_[0])||(0,_web_lib_ui_util__WEBPACK_IMPORTED_MODULE_9__.topError)(_[0]+(_[2]?" #"+_[2]:""),{dt:_[1]?0:10,type:4,url:o,query:t&&(0,_shared_lib_convert__WEBPACK_IMPORTED_MODULE_0__.toQueryString)(t)})}function otpBox(e,_,t){e._box=(0,_modal_box__WEBPACK_IMPORTED_MODULE_11__.validateOtpBox)({onDone:()=>e.resend(t,(0,_utils_resetOptionsCache__WEBPACK_IMPORTED_MODULE_13__.resetOptionsCache)(e)),onFail:e.onFail,hash:_[0]})}function votesPayment(e,_,t){if(window.cur.paymentSuccess=!1,(e.fromBox||e.forceDone)&&(e.onDone&&e.onDone.apply(window,_),e.fromBox))return;if(e._box=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_6__.showFastBox)({title:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_5__.trim)(_[0])},_[1]),_[3]?.countries&&!cur.votesBoxOptions&&(cur.votesBoxOptions=_[3]),cur.votesBoxOptions){const _=()=>{window.Gifts.processBoxOptions(e._box,cur.votesBoxOptions),cur.votesBoxOptions=null};window.Gifts?_():window.stManager.add(window.jsc("web/gifts.js"),(()=>{_()}))}const o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_5__.extend)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_5__.clone)(e),{showProgress:e._box.showProgress,hideProgress:e._box.hideProgress});e.cache&&(o.cache=-1),e._box=(0,_modal_box__WEBPACK_IMPORTED_MODULE_11__.requestBox)(e._box,(function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.isVisible)(e._box.progress)||(_||(_={_votes_ok:1}),e.resend((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_5__.extend)(t,_),o))}),e.onFail),e._box.evalBox(_[2])}function zeroZone(e,_,t){e._box=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_6__.showFastBox)({title:_[0]||(0,_shared_lib_langs_utils__WEBPACK_IMPORTED_MODULE_1__.getLang)("global_charged_zone_title"),onHide:e.onFail},_[1],(0,_shared_lib_langs_utils__WEBPACK_IMPORTED_MODULE_1__.getLang)("global_charged_zone_continue"),(function(){e.resend({...t,charged_confirm:_[3]},e)}),(0,_shared_lib_langs_utils__WEBPACK_IMPORTED_MODULE_1__.getLang)("global_cancel"))}function evalCode(options,answer){const evalString=`(function(){${answer[0]};})()`;if(__debugMode)eval(evalString);else try{eval(evalString)}catch(e){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_8__.logEvalError)(e,evalString)}}const defaultHandler=e=>(_,t)=>{if(-1===e||-2===e||-3===e){const _=t.pop(),o=t.pop(),a=t.pop();let n;-3===e&&(n=t.pop()),window.__adsSet&&__adsSet(a,null,o,_,null,n)}_.onDone&&_.onDone.apply(window,t)};function getHandlerByCode(e){switch(e){case 1:return emailNotConfirmed;case 2:return showCaptcha;case 3:return _authFailed__WEBPACK_IMPORTED_MODULE_12__.authFailed;case 4:return makeRedirect;case 5:return reload;case 6:return mobileActivationRequired;case 7:return showMessage;case 8:return showError;case 9:return votesPayment;case 10:return zeroZone;case 11:case 12:return mobileValidationRequired(e);case 13:return evalCode;case 14:return otpBox;case 15:return passwordValidationRequired;default:return defaultHandler(e)}}},433409:(e,_,t)=>{t.d(_,{AjaxCancellationToken:()=>c,plainpost:()=>l,request:()=>d});var o=t(969686),a=t(366602),n=t(593159),i=t(540462),r=t(253003),s=t(416368);class c{_setCancelCb(e){this._cancel=e}cancel(){this._cancel&&this._cancel()}}function l(e,_,t,a,n,r,s,c=!1,l=null){if(_.act&&(0,i.partConfigEnabled)("force_act_in_get_params")){let t={},a=e,n="";e.includes("?")&&([a,n]=e.split("?"),t=(0,o.fromQueryString)(n)),t.act=_.act,e=`${a}?${(0,o.toQueryString)(t,!0)}`}let u=d(e,_,{xhrOptions:r,sortQueryStringParams:s&&!s.noSort,headers:s&&s.headers,noExtraHeaders:c,urlOnly:n,cancellationToken:s&&s.cancellationToken,logger:l}),E=u._getXhr();return u.then((e=>t&&t(e.data,E.status))).catch((e=>{if(!(e instanceof Error&&"StaticLoadingExecuteError"===e.name)||s.failOnStaticExecuteError)return a&&a(e,E.status)})),E}function d(e,_,{xhrOptions:t,headers:c=null,urlOnly:l=!1,sortQueryStringParams:d=!0,noExtraHeaders:u=!1,cancellationToken:E=null,logger:p=null}){let h,w=!1;p&&(h=(0,a.crc32)(e+JSON.stringify(_)),p(`Initialized request #${h} with URL ${e} and query ${JSON.stringify(_)}`));const g=new XMLHttpRequest;E&&E._setCancelCb((()=>{p&&p(`Aborting request #${h}`),g.abort()}));let b=new Promise((function(a,E){const b="string"!=typeof _?(0,o.toQueryString)(_,!d):_,P=()=>{if(p&&p(`Request readyState -> DONE with status ${g.status} #${h}`),g.status>=200&&g.status<300)try{a({data:g.responseText,code:g.status}),p&&p(`Success handler finished for request #${h}`)}catch(e){p&&p(`Success handler failed for request #${h}`),E({data:g.responseText,code:-1}),p&&p(`Failure handler finished for request #${h} [1]`)}else E({data:g.responseText,url:e,act:_.act,code:g.status}),p&&p(`Failure handler finished for request #${h} [2]`)};(0,i.partConfigEnabled)("skip_aborted_ajax_requests")?(g.addEventListener("readystatechange",(()=>{((0,r.processWaf)(g)||(0,s.processChallenge)(g))&&g.abort()})),g.addEventListener("abort",(()=>{w=!0})),g.addEventListener("loadend",(()=>{w||P()}))):g.onreadystatechange=function(){(0,r.processWaf)(g)||(0,s.processChallenge)(g)?g.abort():g.readyState===XMLHttpRequest.DONE&&P()};try{p&&p(`Starting request #${h}`),g.open("POST",e,!0)}catch(e){p&&p(`Request #${h} failed`),E({data:e,code:-1}),p&&p(`Failure handler finished for request #${h} [3]`)}c&&Object.keys(c).forEach((e=>{g.setRequestHeader(e,c[e])})),t&&(0,n.each)(t,(function(e,_){g[e]=_})),l||(g.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),u||g.setRequestHeader("X-Requested-With","XMLHttpRequest")),p&&p(`Sending data for request #${h}`),g.send(b)}));return b._getXhr=()=>g,b}},891787:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Nav:()=>Nav,default:()=>__WEBPACK_DEFAULT_EXPORT__,getPageContentWrapperNode:()=>getPageContentWrapperNode});var _shared_counters_tmr_moduleChangeHandler__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(830195),_shared_lib_js_logger__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(298077),_spa_shared_audio_player__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(744521),_web_di__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(319756),_web_lib_navigation_stats__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(192366),_shared_lib_nav_url__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(905366),_web_feed_constants_feedPageLoadingState__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(766135),_web_lib_date__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(101148),_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(246429),_utils_common__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(593159),_shared_lib_common__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(898848),_shared_ecomm_serviceBooking_getServiceBookingWikiParamFromPath__WEBPACK_IMPORTED_MODULE_48__=__webpack_require__(923030),_ads__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(956460),_debug_tools__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(237625),_shared_feed_selectors_constants__WEBPACK_IMPORTED_MODULE_56__=__webpack_require__(398402),_dom__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(754866),_dom_events__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(972332),_scroll__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(672277),_ui_util__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(560377),_shared_lib_convert__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(969686),_nav_utils__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(664441),_web_lib_z_nav__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(516742),_shared_counters_updateCounters__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(21871),_web_lib_check_page_blocks__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(420839),_web_lib_layout_body_utils__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(137771),_web_lib_revertLastInlineVideo__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(892848),_legacy_performance_stats__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(689634),_shared_lib_browser__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(575753),_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_51__=__webpack_require__(983567),_web_lib_feature_entries_isArticleLayerOpen__WEBPACK_IMPORTED_MODULE_54__=__webpack_require__(613253),_web_lib_feature_entries_showDonutSubscribePopup__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(396445),_accessibility__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__(576854),_web_lib_top_search_cancel__WEBPACK_IMPORTED_MODULE_52__=__webpack_require__(419733),_web_lib_updateSTL__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__(744968),_message_box__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__(270959),_lang__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__(102088),_shared_navigation_stats__WEBPACK_IMPORTED_MODULE_31__=__webpack_require__(79612),_web_lib_ajax_module_callback__WEBPACK_IMPORTED_MODULE_32__=__webpack_require__(287227),_shared_evbus__WEBPACK_IMPORTED_MODULE_33__=__webpack_require__(338329),_shared_user_user_env__WEBPACK_IMPORTED_MODULE_34__=__webpack_require__(540462),_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_35__=__webpack_require__(636576),_shared_im_peer__WEBPACK_IMPORTED_MODULE_50__=__webpack_require__(182622),_shared_marusia_marusia_stats__WEBPACK_IMPORTED_MODULE_36__=__webpack_require__(67118),_web_lib_cur_reset__WEBPACK_IMPORTED_MODULE_53__=__webpack_require__(99968),_web_feed_feed_common__WEBPACK_IMPORTED_MODULE_37__=__webpack_require__(153663),_web_feed_feedPageLoading_navigationHandler__WEBPACK_IMPORTED_MODULE_38__=__webpack_require__(91871),_spa_web_infrastructure_bookmakers__WEBPACK_IMPORTED_MODULE_39__=__webpack_require__(796804),_spa_web_infrastructure_routing_matchWebSpaRoute__WEBPACK_IMPORTED_MODULE_40__=__webpack_require__(235930),_vkontakte_internal_router__WEBPACK_IMPORTED_MODULE_55__=__webpack_require__(773444),_shared_utils_articleCheckURL__WEBPACK_IMPORTED_MODULE_57__=__webpack_require__(87252),_shared_feed_adblock_protection_attributes_hider__WEBPACK_IMPORTED_MODULE_41__=__webpack_require__(374339),_shared_adblock_protection_locator__WEBPACK_IMPORTED_MODULE_42__=__webpack_require__(962724),_shared_metrics_navigationStats__WEBPACK_IMPORTED_MODULE_43__=__webpack_require__(412877),_shared_video_isVideoStandalone__WEBPACK_IMPORTED_MODULE_44__=__webpack_require__(800361),_shared_feed_feed_utils__WEBPACK_IMPORTED_MODULE_45__=__webpack_require__(54998),_shared_ecomm_serviceBooking_showServiceBookingWiki__WEBPACK_IMPORTED_MODULE_49__=__webpack_require__(859357),_version_skew_manager__WEBPACK_IMPORTED_MODULE_46__=__webpack_require__(790031),_shared_lib_web_stats__WEBPACK_IMPORTED_MODULE_47__=__webpack_require__(101272);let updateCountersTimeout,locationChangeListeners=[];const navigationStartListeners=new Set,interseptingNavigationHandlers=new Set,PAGE_CONTENT_WRAPPER_NODE_ID="wrap3",PAGE_LEGACY_CONTENT_WRAPPER_NODE_ID="spa_legacy_content";function getPageContentId(){return(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_34__.partConfigEnabled)("spa_layout_web")?PAGE_LEGACY_CONTENT_WRAPPER_NODE_ID:PAGE_CONTENT_WRAPPER_NODE_ID}function getPageContentWrapperNode(){return document.getElementById(getPageContentId())??void 0}function isFrameNavigation(e){return e.frame?1:e.noframe||(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_34__.partConfigEnabled)("disable_frame_transport")?0:1}const Nav={getData:function(e,_=null){const t=e=>{(0,_shared_video_isVideoStandalone__WEBPACK_IMPORTED_MODULE_44__.isVideoStandalone)()&&(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_34__.partConfigEnabled)("vkvideo_nav_stats")&&(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_35__.statlogsValueEvent)("vkvideo_router_event",{route:e.replaceAll("\\","%")})};if(e.length){for(const o in navMap){if(!navMap.hasOwnProperty(o))continue;if("<"===o[0])continue;const a=e.match(new RegExp("^"+o,"i")),n=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_34__.partConfigEnabled)("web_spa_router_check_full_loc_enabled")&&_&&_.match(new RegExp("^"+o,"i"));if(a||n){if(navMap[o][2])return null;const e=navMap[o][3],_=e?.enabled&&(!0===e.enabled||(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_34__.partConfigEnabled)(e.enabled));return t(o),{url:navMap[o][0],files:_?[]:navMap[o][1],isSpaRoute:_,clientOnly:Boolean(_&&e?.client_only&&(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_34__.partConfigEnabled)(e.client_only))}}}return e.match(/^[a-z0-9\-_]+\.php$/i)?(t(e),{url:e}):(t("<other>"),{url:navMap["<other>"][0],files:navMap["<other>"][1]})}return t("<void>"),{url:navMap["<void>"][0],files:navMap["<void>"][1]}},getDataAsync:function(e,_=null){return new Promise((t=>{(window.onLoaderNavReady||(e=>e()))((()=>t(this.getData(e,_))))}))},routeData:function(){try{const e=this.objLoc?.[0],_=/^friends/,t=/^(games|apps)/,o=this.strLoc,a=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_34__.partConfigEnabled)("web_spa_router_friends_check_full_loc_enabled")&&o.match(_),n=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_34__.partConfigEnabled)("games_catalog_spa_web")&&o.match(t),i=o&&(a||n)?o:null;if(e)return this.getData(e,i)||{}}catch{return{}}return{}},reload:function(e){if((0,_nav_utils__WEBPACK_IMPORTED_MODULE_18__.reloadCheckFlood)(e))return;if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_34__.partConfigEnabled)(_version_skew_manager__WEBPACK_IMPORTED_MODULE_46__.VERSION_SKEW_ENABLED_PE)&&window.Calls?.isInActiveCall)return;e=e||{};const _=Nav.strLoc.replace(/^\/+/g,"");e.force?(window.hab.stop(),e.from&&e.from>0&&(0,_shared_lib_web_stats__WEBPACK_IMPORTED_MODULE_47__.saveStatlogEvents)({name:"navigation_force_reload_event",value:1,keys:[e.from]}),_.includes("#")&&window.location.href.replace(window.location.origin,"")==="/"+_&&(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_34__.partConfigEnabled)("mini_apps_save_hash_on_language_change")?window.location.reload():location.href="/"+_):(TopNotifier.invalidate(),Nav.go("/"+_,void 0,(0,_utils_common__WEBPACK_IMPORTED_MODULE_9__.extend)({nocur:!0},e)))},link:function(e,_){if((0,_dom_events__WEBPACK_IMPORTED_MODULE_14__.checkEvent)(_)||cur.noAjaxNav){const _=(0,_shared_lib_nav_url__WEBPACK_IMPORTED_MODULE_5__.toMaybeVKSiteURLRelativeName)(e);window.open(_)}else Nav.go(e)},onLocationChange:function(e){return locationChangeListeners.push(e),()=>{locationChangeListeners=locationChangeListeners.filter((_=>_!==e))}},addNavigationStartListener:function(e){navigationStartListeners.add(e)},removeNavigationStartListener:function(e){navigationStartListeners.has(e)&&navigationStartListeners.delete(e)},addInterseptingNavigationHandler:function(e){interseptingNavigationHandlers.add(e)},removeInterseptingNavigationHandler:function(e){interseptingNavigationHandlers.has(e)&&interseptingNavigationHandlers.delete(e)},go:function(loc,ev,opts={}){const debugLog=opts.debugLog||(()=>{});(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_34__.partConfigEnabled)("web_spa_redesign_disabled_page")&&window.cur.moduleDisabled&&(opts.hard=!0),(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_34__.partConfigEnabled)(_version_skew_manager__WEBPACK_IMPORTED_MODULE_46__.VERSION_SKEW_ENABLED_PE)&&_version_skew_manager__WEBPACK_IMPORTED_MODULE_46__.VersionSkewManager.isReloadRequired()&&(opts.hard=!0);const awayLink=maybeNavigateAwayLink(loc,opts)||maybeNavigateAwayAppFormLink(loc);if(awayLink)return debugLog("awayLink",awayLink),document.location.href=awayLink,!1;if((0,_dom_events__WEBPACK_IMPORTED_MODULE_14__.checkEvent)(ev)||window.cur.noAjaxNav)return void debugLog("noAjaxNav");if(window.LongView&&window.LongView.onBeforePageChange(),loc.tagName&&"a"===loc.tagName.toLowerCase()){if("_blank"===loc.target||Nav.baseBlank)return void debugLog("baseBlank");const e=loc.getAttribute("hrefparams");if(e&&(opts.params=(0,_utils_common__WEBPACK_IMPORTED_MODULE_9__.extend)(opts.params||{},(0,_shared_lib_convert__WEBPACK_IMPORTED_MODULE_17__.fromQueryString)(e))),loc=loc.href||"",ev&&(!loc||!(0,_shared_lib_nav_url__WEBPACK_IMPORTED_MODULE_5__.isVKSiteURLForNav)(loc)))return void debugLog("isVKSiteURLForNav")}let changed={},[strLoc,objLoc]=(0,_nav_utils__WEBPACK_IMPORTED_MODULE_18__.parseLoc)(loc,opts);if(opts.hard&&((0,_shared_lib_web_stats__WEBPACK_IMPORTED_MODULE_47__.saveStatlogEvents)({name:"navigation_force_reload_event",value:1,keys:[8]}),debugLog("hard",strLoc),location.href=strLoc,(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_34__.partConfigEnabled)("fix_eco_plate_navigation")))return;if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_34__.partConfigEnabled)("web_navigation_listeners")&&navigationStartListeners.forEach((e=>{try{e(strLoc,objLoc)}catch(e){(0,_shared_lib_js_logger__WEBPACK_IMPORTED_MODULE_1__.logUnknownError)(e)}})),window.cur.isCurrentVideoLayer&&!objLoc.section&&-1!==objLoc[0].indexOf("/playlist/")&&(objLoc.section="album_"+objLoc[0].split("_")[1]),maybeReloadBeforeNavigate(Nav.objLoc[0],objLoc[0],strLoc,debugLog))return!1;if((0,_legacy_performance_stats__WEBPACK_IMPORTED_MODULE_24__.statDurationsLoadImage)(),(0,_legacy_performance_stats__WEBPACK_IMPORTED_MODULE_24__.statNavigationTiming)(),0===strLoc.indexOf("market")&&window.MarketAnalyticsManager&&window.MarketAnalyticsManager.setScreen(window.cur.module),!opts.skipDonutLinkCheck&&maybeShowDonutSubscribePopupInsteadOfNavigation(strLoc,debugLog,ev,opts))return!1;const serviceBookingWikiPath=(0,_shared_ecomm_serviceBooking_getServiceBookingWikiParamFromPath__WEBPACK_IMPORTED_MODULE_48__.getServiceBookingWikiParamFromPath)(strLoc);if(serviceBookingWikiPath)return(0,_shared_ecomm_serviceBooking_showServiceBookingWiki__WEBPACK_IMPORTED_MODULE_49__.showServiceBookingWiki)(serviceBookingWikiPath);("im"===objLoc[0]&&(0,_shared_im_peer__WEBPACK_IMPORTED_MODULE_50__.isMarusiaPeer)(objLoc.sel)||"write-194070336"===strLoc)&&(_shared_marusia_marusia_stats__WEBPACK_IMPORTED_MODULE_36__.marusiaStats.logChatOpen(_shared_navigation_stats__WEBPACK_IMPORTED_MODULE_31__.navigationStat.getModule()),window.ajax.post("al_marusia.php",{act:"send_event",event:"chatopen"}));const ap=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_51__.getAudioPlayer)();if(ap&&ap.updateCurrentPlaying&&ap.updateCurrentPlaying(),!opts.nocur){changed=(0,_utils_common__WEBPACK_IMPORTED_MODULE_9__.clone)(objLoc);for(const e in Nav.objLoc)Nav.objLoc.hasOwnProperty(e)&&(Nav.objLoc[e]===changed[e]?delete changed[e]:void 0===changed[e]&&(changed[e]=!1));if(!1===(0,_web_lib_z_nav__WEBPACK_IMPORTED_MODULE_19__.zNav)((0,_utils_common__WEBPACK_IMPORTED_MODULE_9__.clone)(changed),{hist:opts.hist,replace:opts.replace,back:opts.back,asBox:opts.asBox,onDone:opts.onDone},objLoc))return debugLog("zNav",strLoc),Nav.setLoc(strLoc,opts),!1;bookmarksNav(ev,strLoc);const e=window.cur._back&&window.cur._back.hasOwnProperty("onArticleNavBack")?window.cur._back.onArticleNavBack:null,_=articleNav(strLoc,Nav.toStr(Nav.objLoc),opts.back,e,ev);if(_)return Promise.resolve(_).then((()=>{strLoc=cleanArticleUrlByObjLoc(objLoc),Nav.setLoc(strLoc,{...opts,isForce:!0}),(Nav.objLoc.z||Nav.objLoc.w)&&(0,_web_lib_z_nav__WEBPACK_IMPORTED_MODULE_19__.zNav)({z:Nav.objLoc.z,w:Nav.objLoc.w},{hist:opts.hist,replace:opts.replace,back:opts.back})})),debugLog("handled",strLoc),!1;const t=!(0,_shared_video_isVideoStandalone__WEBPACK_IMPORTED_MODULE_44__.isVideoStandalone)()&&authorPageNav(strLoc,Nav.toStr(Nav.objLoc),opts.back,opts.postId);if(t)return window.AuthorPage&&window.AuthorPage.isOpen()&&window.cur.articleEditorLayer&&window.cur.articleEditorLayer.hide(!1),window.cur._hardNav?(debugLog("hardNav",strLoc),window.location.href=strLoc,!1):(Nav.setLoc(strLoc,opts),(Nav.objLoc.z||Nav.objLoc.w)&&(0,_web_lib_z_nav__WEBPACK_IMPORTED_MODULE_19__.zNav)({z:Nav.objLoc.z,w:Nav.objLoc.w},{hist:opts.hist,replace:opts.replace,back:opts.back}),debugLog("noHardNav",strLoc,Nav.objLoc.z||Nav.objLoc.w),!1)}if(!opts.nocur&&(vk.loaded||vk.bootstrapLoaded||!changed[0])){const e=window.cur.nav||[];for(let _=e.length-1;_>=0;_--){const t=document.URL;if(!1===e[_]((0,_utils_common__WEBPACK_IMPORTED_MODULE_9__.clone)(changed),Nav.objLoc,objLoc,opts)){const e=`${locProtocol}//${location.host}/${strLoc}`,o=t===e?"":t;return updateCountersTimeout&&clearTimeout(updateCountersTimeout),updateCountersTimeout=setTimeout(_shared_counters_updateCounters__WEBPACK_IMPORTED_MODULE_20__.updateCounters.pbind(e,o),10),debugLog("curnav",_,objLoc),!1}}}if(4===vk.al||!vk.loaded&&!vk.bootstrapLoaded&&(!window.audioPlayer||!audioPlayer.player)&&changed[0])return debugLog("al4","/"+(strLoc||"").replace("%23","#")),setTimeout((function(){location.href="/"+(strLoc||"").replace("%23","#")}),0),!1;if(window.Upload&&Upload.terminateAllUploads(),(0,_web_lib_top_search_cancel__WEBPACK_IMPORTED_MODULE_52__.topHeaderClose)(),opts.back){if(window.cur._back&&window.cur._back.onBack)return debugLog("_back",strLoc),window.cur._back.onBack(strLoc);for(let e=0,_=globalHistory.length;e<_;e++)if(globalHistory[e].loc===strLoc){const _=globalHistory.splice(e,1)[0],t=getPageContentWrapperNode(),o=(0,_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("title"),a=window.cur._onback;return window.tooltips&&window.tooltips.destroyAll(),(0,_dom__WEBPACK_IMPORTED_MODULE_13__.hide)("audio_tip_wrap"),(0,_nav_utils__WEBPACK_IMPORTED_MODULE_18__.processDestroy)(window.cur),__webpack_require__._dG("radioBtns",_.radioBtns),__webpack_require__._dG("ajaxCache",_.ajaxCache),__webpack_require__._dG("PageID",_.pid),boxQueue.hideAll(!1,!0),layerQueue.clear(),layers.fullhide&&layers.fullhide(!0),(0,_nav_utils__WEBPACK_IMPORTED_MODULE_18__.showBackLink)(),__webpack_require__._dG("cur",_.cur),setTimeout((function(){if(t.innerHTML="",t.parentNode.replaceChild(_.content,t),vk.width===_.width&&vk.width_dec===_.width_dec&&vk.width_dec_footer===_.width_dec_footer||(0,_nav_utils__WEBPACK_IMPORTED_MODULE_18__.handlePageView)(_),(0,_scroll__WEBPACK_IMPORTED_MODULE_15__.scrollToY)(_.scrollTop,0),(0,_dom__WEBPACK_IMPORTED_MODULE_13__.setDocumentTitle)(_.htitle),o&&(o.innerHTML=_.title,(0,_dom__WEBPACK_IMPORTED_MODULE_13__.setStyle)(o.parentNode,"display",_.hideHeader?"none":"block")),_.bodyClass!==document.body.className&&(document.body.className=_.bodyClass||"",vk.body_class=_.bodyClass||""),window.cur._back.show)for(let e=0,_=window.cur._back.show.length;e<_;e++)window.cur._back.show[e]();if(!window.cur.noquickreg&&(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_10__.isFunction)(window.changeQuickRegButton)&&window.changeQuickRegButton(!1),a)for(let e=0,_=a.length;e<_;e++)a[e]();Nav.setLoc(strLoc,opts);const e=_.back||{};setTimeout((function(){_shared_navigation_stats__WEBPACK_IMPORTED_MODULE_31__.navigationStat.sendBack(_shared_navigation_stats__WEBPACK_IMPORTED_MODULE_31__.navigationStat.getModule()),(0,_nav_utils__WEBPACK_IMPORTED_MODULE_18__.showBackLink)(e[0],e[1],e[2]),(Nav.objLoc.z||Nav.objLoc.w)&&(0,_web_lib_z_nav__WEBPACK_IMPORTED_MODULE_19__.zNav)({z:Nav.objLoc.z,w:Nav.objLoc.w},{hist:opts.hist,replace:opts.replace,back:opts.back}),(0,_web_lib_updateSTL__WEBPACK_IMPORTED_MODULE_28__.updateSTL)(),(0,_nav_utils__WEBPACK_IMPORTED_MODULE_18__.updateLeftMenu)(),(0,_accessibility__WEBPACK_IMPORTED_MODULE_27__.updateAriaElements)(),window.TopSearch&&window.TopSearch.clear()}),10),(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_51__.getAudioPlayer)()?.updateCurrentPlaying()}),10),debugLog("globalHistory",strLoc),!1}}const dest=objLoc[0];let where;delete objLoc[0];try{const e=/^friends/,_=/^(games|apps)/,t=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_34__.partConfigEnabled)("web_spa_router_friends_check_full_loc_enabled")&&strLoc.match(e),o=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_34__.partConfigEnabled)("games_catalog_spa_web")&&strLoc.match(_),a=t||o?strLoc:null;where=Nav.getData(dest,a)}catch(e){where=null}if(null===where){if(debugLog("noWhere"),opts.throwErrorOnDisabledPath)throw new Error("AL navigation is disabled for this path");return!0}opts.params&&opts.params._ref||(opts.params=(0,_utils_common__WEBPACK_IMPORTED_MODULE_9__.extend)(opts.params||{},{_ref:Nav.objLoc[0]||""})),where.files&&window.stManager.add(where.files),where.params=(0,_utils_common__WEBPACK_IMPORTED_MODULE_9__.extend)({__query:dest,al_id:vk.id},objLoc,opts.params||{},{...(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_34__.partConfigEnabled)("video_upload_disable_redirect_to_standalone")&&opts.extraParams}),window.cur.isSpaRoute&&(opts=Object.assign({},opts,{noback:!0}));const possibleLinkElement=ev?.target,postParamsEl=Nav.getLinkElementWithPostParamsOrLocation(possibleLinkElement,loc),postParams=Nav.getPostParams(postParamsEl,!!where.params._post_click_type);where.params=Nav.mergePostParamsOptions(postParams,where.params),opts.cl_id&&(where.params.fr_click=window.cur.oid+","+opts.cl_id+","+window.cur.options.fr_click),opts.permanent&&(where.params._permanent=opts.permanent);const curNavVersion=++window.NextPageID,done=function({title,html,js,params}){if(curNavVersion!==window.NextPageID)return!0;try{params._id=params.id}catch(e){return(0,_ui_util__WEBPACK_IMPORTED_MODULE_16__.topError)(e,{dt:15,type:6,msg:`Error: ${e.message}, (params undefined?), title: ${title}, html: ${html}, js: ${js}`,url:where.url,query:(0,_shared_lib_convert__WEBPACK_IMPORTED_MODULE_17__.toQueryString)(where.params),answer:arguments.length})}const execTqTasks=e=>{params.exec_on_start&&(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_33__.processExecData)(JSON.stringify(params.exec_on_start),e)};__webpack_require__._dG("lastScrollTop",(0,_scroll__WEBPACK_IMPORTED_MODULE_15__.scrollGetY)());const isReloadRequired=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_34__.partConfigEnabled)(_version_skew_manager__WEBPACK_IMPORTED_MODULE_46__.VERSION_SKEW_ENABLED_PE)?_version_skew_manager__WEBPACK_IMPORTED_MODULE_46__.VersionSkewManager.isReloadRequired()||params.force_reload:stVersions[window.jsc("web/common_web.js")]>StaticFiles[window.jsc("web/common_web.js")].v||params.force_reload;if(isReloadRequired){if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_34__.partConfigEnabled)(_version_skew_manager__WEBPACK_IMPORTED_MODULE_46__.VERSION_SKEW_ENABLED_PE))return Nav.setLoc(params.loc||Nav.strLoc,opts),Nav.reload(Object.assign({},opts,{force:!0,from:7}));if(Nav.setLoc(params.loc||Nav.strLoc,opts),(0,_nav_utils__WEBPACK_IMPORTED_MODULE_18__.reloadCheckFlood)({force:!0,from:4}))return;if(window.Calls?.isInActiveCall)return;return debugLog("reload",isReloadRequired),void location.reload(!0)}const newPage=void 0===where.params.al_id||where.params.al_id!=params.id||params.fullPage,tNode=(0,_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("title");let wNode=getPageContentWrapperNode(),_back=window.cur._back,hist=!1;if((strLoc===(window.cur._back||{}).loc||newPage||opts.back)&&(_back=!1),(opts.noback||params.level&&(!window.cur._level||params.level<=window.cur._level)&&!1!==opts.noback)&&(_back=!1,(opts.noback||window.cur._level&&params.level<window.cur._level)&&(0,_nav_utils__WEBPACK_IMPORTED_MODULE_18__.showBackLink)()),window.tooltips&&window.tooltips.destroyAll(),(0,_utils_common__WEBPACK_IMPORTED_MODULE_9__.each)((0,_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("page_actions_wrap"),((e,_)=>(0,_dom__WEBPACK_IMPORTED_MODULE_13__.hide)(_))),(0,_dom__WEBPACK_IMPORTED_MODULE_13__.hide)("audio_tip_wrap"),_back){if((0,_web_lib_revertLastInlineVideo__WEBPACK_IMPORTED_MODULE_23__.revertLastInlineVideo)(null,!0),hist={loc:_back.loc||Nav.strLoc,cur:window.cur,radioBtns:(0,_utils_common__WEBPACK_IMPORTED_MODULE_9__.clone)(radioBtns),ajaxCache,pid:window.PageID,scrollTop:(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_34__.partConfigEnabled)("feed_manual_scroll_restoration")&&(0,_shared_feed_feed_utils__WEBPACK_IMPORTED_MODULE_45__.isOnFeedPage)()?0:(0,_scroll__WEBPACK_IMPORTED_MODULE_15__.scrollGetY)(),htitle:document.title.toString(),width:vk.width,width_dec:vk.width_dec,width_dec_footer:vk.width_dec_footer,noleftmenu:vk.noleftmenu,notopmenu:vk.notopmenu,nobottommenu:vk.nobottommenu,bodyClass:vk.body_class,back:!(!_tbLink||!_tbLink.loc)&&[_tbLink.loc,(0,_dom__WEBPACK_IMPORTED_MODULE_13__.val)(_tbLink),_tbLink.fast]},tNode&&tNode.parentNode&&!(0,_dom__WEBPACK_IMPORTED_MODULE_13__.isVisible)(tNode.parentNode)&&(hist.hideHeader=!0),(0,_nav_utils__WEBPACK_IMPORTED_MODULE_18__.globalHistoryDestroy)(hist.loc),globalHistory.length>2){const e=globalHistory.shift();(0,_nav_utils__WEBPACK_IMPORTED_MODULE_18__.processDestroy)(e.cur),e.content.innerHTML=""}if(window.cur._back.hide)for(let e=0,_=window.cur._back.hide.length;e<_;e++)window.cur._back.hide[e]();_back.text&&(0,_nav_utils__WEBPACK_IMPORTED_MODULE_18__.showBackLink)(hist.loc,_back.text,1)}else _tbLink&&(_tbLink.fast=0),(0,_nav_utils__WEBPACK_IMPORTED_MODULE_18__.processDestroy)(window.cur);if(__webpack_require__._dG("PageID",window.NextPageID),(0,_utils_common__WEBPACK_IMPORTED_MODULE_9__.each)(radioBtns,(function(e,_){_.keep||delete radioBtns[e]})),__webpack_require__._dG("ajaxCache",{}),boxQueue.hideAll(!1,!0),layerQueue.clear(),layers.fullhide&&layers.fullhide(!0,!0),(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_34__.partConfigEnabled)("video_fix_preserve_lang")?(0,_web_lib_cur_reset__WEBPACK_IMPORTED_MODULE_53__.resetWindowCur)(!0):(0,_web_lib_cur_reset__WEBPACK_IMPORTED_MODULE_53__.resetWindowCur)(),__webpack_require__._dG("_stlWas",0),newPage){for((0,_dom__WEBPACK_IMPORTED_MODULE_13__.cleanElems)("quick_login_button","quick_expire","search_form","top_links","bottom_nav");globalHistory.length;){const e=globalHistory.shift();(0,_nav_utils__WEBPACK_IMPORTED_MODULE_18__.processDestroy)(e.cur),e.content.innerHTML=""}const e=(0,_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("dev_top_nav_wrap")&&(0,_dom__WEBPACK_IMPORTED_MODULE_13__.getSize)("dev_top_nav_wrap")[0]||(0,_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("page_header_wrap")&&(0,_dom__WEBPACK_IMPORTED_MODULE_13__.getSize)("page_header_wrap")[0]||0;pageNode.innerHTML=html,execTqTasks(pageNode),e&&!vk.staticheader&&(0,_nav_utils__WEBPACK_IMPORTED_MODULE_18__.updateHeaderStyles)({width:e}),_shared_lib_browser__WEBPACK_IMPORTED_MODULE_25__.browser.mobile||(0,_web_lib_layout_body_utils__WEBPACK_IMPORTED_MODULE_22__.onBodyResize)(!0)}else{if(_back){const e=(0,_dom__WEBPACK_IMPORTED_MODULE_13__.ce)("div",{id:getPageContentId()});(0,_utils_common__WEBPACK_IMPORTED_MODULE_9__.extend)(hist,{content:wNode.parentNode.replaceChild(e,wNode),title:tNode?tNode.innerHTML:""}),globalHistory.push(hist),wNode=e}const e=(0,_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("dev_top_nav_wrap")&&(0,_dom__WEBPACK_IMPORTED_MODULE_13__.getSize)("dev_top_nav_wrap")[0]||(0,_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("page_header_wrap")&&(0,_dom__WEBPACK_IMPORTED_MODULE_13__.getSize)("page_header_wrap")[0]||0;wNode&&(wNode.innerHTML=html,execTqTasks(wNode)),e&&!vk.staticheader&&(0,_nav_utils__WEBPACK_IMPORTED_MODULE_18__.updateHeaderStyles)({width:e}),tNode&&(tNode.innerHTML=title,(title?_dom__WEBPACK_IMPORTED_MODULE_13__.show:_dom__WEBPACK_IMPORTED_MODULE_13__.hide)(tNode.parentNode)),(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_51__.getAudioPlayer)()?.updateCurrentPlaying()}(0,_web_lib_check_page_blocks__WEBPACK_IMPORTED_MODULE_21__.checkPageBlocks)(),(0,_web_lib_updateSTL__WEBPACK_IMPORTED_MODULE_28__.updateSTL)(),(0,_nav_utils__WEBPACK_IMPORTED_MODULE_18__.updateLeftMenu)(),(0,_accessibility__WEBPACK_IMPORTED_MODULE_27__.updateAriaElements)(),window.TopSearch&&window.TopSearch.clear(),(0,_nav_utils__WEBPACK_IMPORTED_MODULE_18__.handlePageParams)(params),opts.preventScroll||(opts.scrollTop>0?(0,_scroll__WEBPACK_IMPORTED_MODULE_15__.scrollToY)(opts.scrollTop,0):opts.noscroll||params.noscroll||(0,_scroll__WEBPACK_IMPORTED_MODULE_15__.scrollToTop)(0)),Nav.curLoc=params.loc,isFrameNavigation(opts)||Nav.setLoc(params.loc||"",opts);const runInlineScripts=()=>{if(js){const evalString=`(function(){${js};})()`;if(__debugMode)eval(evalString);else try{eval(evalString)}catch(e){(0,_debug_tools__WEBPACK_IMPORTED_MODULE_12__.logEvalError)(e,evalString)}}};isFrameNavigation(opts)?(runInlineScripts(),window.ajax._framenext()):setTimeout((()=>{runInlineScripts(),(0,_web_lib_ajax_module_callback__WEBPACK_IMPORTED_MODULE_32__.triggerSubscribersOnModuleEvaluated)()}),0),_shared_lib_browser__WEBPACK_IMPORTED_MODULE_25__.browser.mobile&&(0,_web_lib_layout_body_utils__WEBPACK_IMPORTED_MODULE_22__.onBodyResize)(),changed.f&&(0,_scroll__WEBPACK_IMPORTED_MODULE_15__.handleScroll)(changed.f),isFrameNavigation(opts)&&Nav.setLoc(params.loc||"",opts),opts.onDone&&opts.onDone(),changed[0]&&__webpack_require__._dG("vkLastNav",Date.now()),(0,_utils_common__WEBPACK_IMPORTED_MODULE_9__.lTimeout)((function(){(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_51__.getAudioPlayer)()?.updateCurrentPlaying(),window.TopMenu&&window.TopMenu.toggle(!1)}),_shared_lib_browser__WEBPACK_IMPORTED_MODULE_25__.browser.chrome?100:50)},clientOnlyDone=function(e,_){if(curNavVersion!==window.NextPageID)return;(0,_nav_utils__WEBPACK_IMPORTED_MODULE_18__.handlePageView)({width:window.vk.defaultLayout.width,width_dec:window.vk.defaultLayout.widthDec}),adjustStylesToSpa(),__webpack_require__._dG("PageID",window.NextPageID),__webpack_require__._dG("lastScrollTop",(0,_scroll__WEBPACK_IMPORTED_MODULE_15__.scrollGetY)());let t=getPageContentWrapperNode();window.tooltips&&window.tooltips.destroyAll(),(0,_utils_common__WEBPACK_IMPORTED_MODULE_9__.each)((0,_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("page_actions_wrap"),((e,_)=>(0,_dom__WEBPACK_IMPORTED_MODULE_13__.hide)(_))),(0,_dom__WEBPACK_IMPORTED_MODULE_13__.hide)("audio_tip_wrap");const o=Boolean(_?.persistCur)||"im"===window.cur.module&&!changed[0];o||(0,_nav_utils__WEBPACK_IMPORTED_MODULE_18__.processDestroy)(window.cur),(0,_utils_common__WEBPACK_IMPORTED_MODULE_9__.each)(window.radioBtns,(function(e,_){_.keep||delete window.radioBtns[e]})),boxQueue.hideAll(!1,!0),layerQueue.clear(),layers.fullhide&&layers.fullhide(!0,!0),o||(0,_web_lib_cur_reset__WEBPACK_IMPORTED_MODULE_53__.resetWindowCur)(!0),__webpack_require__._dG("_stlWas",0),t&&(t.innerHTML=""),(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_51__.getAudioPlayer)()?.updateCurrentPlaying(),(0,_web_lib_check_page_blocks__WEBPACK_IMPORTED_MODULE_21__.checkPageBlocks)(),(0,_web_lib_updateSTL__WEBPACK_IMPORTED_MODULE_28__.updateSTL)(),(0,_nav_utils__WEBPACK_IMPORTED_MODULE_18__.updateLeftMenu)(),(0,_accessibility__WEBPACK_IMPORTED_MODULE_27__.updateAriaElements)(),window.TopSearch&&window.TopSearch.clear(),(0,_scroll__WEBPACK_IMPORTED_MODULE_15__.scrollToTop)(0),_shared_lib_browser__WEBPACK_IMPORTED_MODULE_25__.browser.mobile&&(0,_web_lib_layout_body_utils__WEBPACK_IMPORTED_MODULE_22__.onBodyResize)(),changed.f&&(0,_scroll__WEBPACK_IMPORTED_MODULE_15__.handleScroll)(changed.f),Nav.setLoc(e,_),(Nav.objLoc.z||Nav.objLoc.w)&&(0,_web_lib_z_nav__WEBPACK_IMPORTED_MODULE_19__.zNav)({z:Nav.objLoc.z,w:Nav.objLoc.w},{hist:_.hist,replace:_.replace,back:_.back}),_.onDone&&_.onDone(),changed[0]&&__webpack_require__._dG("vkLastNav",Date.now()),(0,_utils_common__WEBPACK_IMPORTED_MODULE_9__.lTimeout)((function(){(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_51__.getAudioPlayer)()?.updateCurrentPlaying(),window.TopMenu&&window.TopMenu.toggle(!1)}),_shared_lib_browser__WEBPACK_IMPORTED_MODULE_25__.browser.chrome?100:50)};return window.Page&&(Page.postsSave(),Page.postsSend(),Page.postsClearTimeouts()),(0,_ads__WEBPACK_IMPORTED_MODULE_11__.updSeenAdsInfo)(),(0,_ads__WEBPACK_IMPORTED_MODULE_11__.__adsUpdate)("already"),"im"!==Nav.objLoc[0]&&"im"!==changed[0]||(where.params=(0,_utils_common__WEBPACK_IMPORTED_MODULE_9__.extend)({},where.params,{_full_page:!0})),Array.isArray(window.cur.beforeNavigateRequestHandlers)&&window.cur.beforeNavigateRequestHandlers.forEach((e=>{"function"==typeof e&&e()})),window.cur.beforeNavigateRequestHandlers=[],(0,_web_lib_navigation_stats__WEBPACK_IMPORTED_MODULE_4__.getModuleNavigationStatsServiceWeb)().handlePageLoadingStart(),(async()=>{let{clientOnly:e,isSpaRoute:_}=where;try{const{route:t}=await(0,_spa_web_infrastructure_routing_matchWebSpaRoute__WEBPACK_IMPORTED_MODULE_40__.matchWebSpaRoute)(strLoc);(0,_shared_video_isVideoStandalone__WEBPACK_IMPORTED_MODULE_44__.isVideoStandalone)()?e=!1:!t||t.isLegacyConfig||t.mockBookmakerRedirect||t.disabledClientNavigation&&("string"!=typeof t.disabledClientNavigation||(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_34__.partConfigEnabled)(t.disabledClientNavigation))||(_=!0,e=!0),e&&Nav.strLoc===strLoc&&(opts.persistCur=!0)}catch(e){return void(0,_shared_lib_js_logger__WEBPACK_IMPORTED_MODULE_1__.logError)(new Error("[nav.js]: failed matchWebSpaRoute",{cause:e instanceof Error?e:void 0}),{breadcrumb:{data:{prevLoc:window.location.href,cause:e instanceof Error?void 0:JSON.stringify(e),loc,strLoc,query:(0,_shared_lib_convert__WEBPACK_IMPORTED_MODULE_17__.toQueryString)(where.params)}}})}(0,_web_lib_ajax_module_callback__WEBPACK_IMPORTED_MODULE_32__.subscribeOnModuleEvaluated)((()=>{if(!e&&(_shared_navigation_stats__WEBPACK_IMPORTED_MODULE_31__.navigationStat.sendGo((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_34__.partConfigEnabled)("video_screen_in_web_navigation_logs")?(0,_shared_metrics_navigationStats__WEBPACK_IMPORTED_MODULE_43__.getModuleForNavigationStat)():_shared_navigation_stats__WEBPACK_IMPORTED_MODULE_31__.navigationStat.getModule()),(0,_shared_counters_tmr_moduleChangeHandler__WEBPACK_IMPORTED_MODULE_0__.handleModuleChanged)(window.cur?.module||""),(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_34__.partConfigEnabled)("ajax_nav_media_state"))){const e=(0,_web_di__WEBPACK_IMPORTED_MODULE_3__.ensureDIRootWebContainer)().resolve(_spa_shared_audio_player__WEBPACK_IMPORTED_MODULE_2__.AudioPlayer),_={videoplayer:window.mvcur?.minimized,musicPlayerPlaying:e?.globalChannel.playing,musicPlayerPaused:e?.globalChannel.paused,calls:window.Calls?.isInActiveCall,layer:document.body.classList.contains("layers_shown"),pip:document.pictureInPictureElement};(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_35__.statlogsValueEvent)("ajax_nav_media_state",0,window.cur?.module,Object.entries(_).flatMap((([e,_])=>_?[e]:[])).join(","))}}),!0);const t=e=>{let t;if(__debugMode)t=done.call(null,e);else try{t=done.call(null,e)}catch(_){(0,_ui_util__WEBPACK_IMPORTED_MODULE_16__.topError)(_,{dt:15,type:6,url:where.url,query:(0,_shared_lib_convert__WEBPACK_IMPORTED_MODULE_17__.toQueryString)(where.params),js:e.js,answer:Array.prototype.slice.call(arguments).join("<!>")})}return(0,_web_lib_ajax_module_callback__WEBPACK_IMPORTED_MODULE_32__.subscribeOnModuleEvaluated)((()=>{_||(0,_web_lib_navigation_stats__WEBPACK_IMPORTED_MODULE_4__.getModuleNavigationStatsServiceWeb)().handlePageLoadingFinish()}),!0),t},o=(o=!1)=>{if(e){if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_34__.partConfigEnabled)(_version_skew_manager__WEBPACK_IMPORTED_MODULE_46__.VERSION_SKEW_ENABLED_PE)&&_version_skew_manager__WEBPACK_IMPORTED_MODULE_46__.VersionSkewManager.isReloadRequired())return void Nav.go(strLoc,null,{hard:!0});clientOnlyDone.call(null,strLoc,opts),_||(0,_web_lib_navigation_stats__WEBPACK_IMPORTED_MODULE_4__.getModuleNavigationStatsServiceWeb)().handlePageLoadingFinish(),(0,_web_lib_ajax_module_callback__WEBPACK_IMPORTED_MODULE_32__.triggerSubscribersOnModuleEvaluated)()}else window.ajax.post(where.url,where.params,{onDone:async function(){if(o&&"success"===(0,_web_feed_constants_feedPageLoadingState__WEBPACK_IMPORTED_MODULE_6__.getFeedPageLoadingState)().content.requestState)return;t({title:arguments[0],html:arguments[1],js:arguments[2],params:arguments[3]})},onFail:opts.onFail||function(e){if(e)return setTimeout((0,_message_box__WEBPACK_IMPORTED_MODULE_29__.showFastBox)({title:(0,_lang__WEBPACK_IMPORTED_MODULE_30__.getLang)("global_error")},e).hide,__debugMode?3e4:3e3),!0},frame:isFrameNavigation(opts),canReload:!0,showProgress:opts.showProgress,hideProgress:opts.hideProgress,cache:opts.search?1:""});_&&(window.cur.isSpaRoute=!0)};if(!(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_34__.partConfigEnabled)("special_groups_redirects")||opts.state?.usr?.bookmakerRedirectDisabled||!await(0,_spa_web_infrastructure_bookmakers__WEBPACK_IMPORTED_MODULE_39__.processNavigation)(strLoc)){if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_34__.partConfigEnabled)("web_navigation_handlers")){let e;for(const _ of interseptingNavigationHandlers)try{const a=_({dest,opts,where,performRequest:o,clientOnlyDone,debugLog,callDoneFunc:t});if(void 0!==a&&(e=a),e)break}catch(e){(0,_shared_lib_js_logger__WEBPACK_IMPORTED_MODULE_1__.logUnknownError)(e)}if(void 0!==e)return}o(),debugLog("nothing")}})(),!1},getLinkElementWithPostParamsOrLocation(e,_){const t=e?.closest("a");return t&&t.getAttribute?t:_&&_.getAttribute?_:null},setLoc:function(e,_={}){const t="boolean"==typeof _?{isForce:_}:_;let o,a;if(o=a=e,"string"==typeof e?a=Nav.fromStr(e):o=Nav.toStr(e),!t.isForce&&(0,_web_lib_feature_entries_isArticleLayerOpen__WEBPACK_IMPORTED_MODULE_54__.isArticleLayerOpen)()&&!o.match(/article_edit(-?\d+_\d+)/))return;const n=Nav.strLoc;if(Nav.strLoc=o,Nav.objLoc=a,window.hab.setLoc(Nav.strLoc,_),(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_34__.partConfigEnabled)("disable_push_equal_history_location")&&n===o&&!_.replace)return;let i=_.replace?_vkontakte_internal_router__WEBPACK_IMPORTED_MODULE_55__.Action.Replace:_vkontakte_internal_router__WEBPACK_IMPORTED_MODULE_55__.Action.Push;_.back&&_.hist&&(i=_vkontakte_internal_router__WEBPACK_IMPORTED_MODULE_55__.Action.Pop);for(const e of locationChangeListeners)e(Nav.strLoc,i)},change:function(e,_=null,t={}){const o=(0,_utils_common__WEBPACK_IMPORTED_MODULE_9__.clone)(Nav.objLoc);return(0,_utils_common__WEBPACK_IMPORTED_MODULE_9__.each)(e,(function(e,_){!1===_?delete o[e]:o[e]=_})),Nav.go(o,_,t)},fromStr:function(e){return(0,_nav_utils__WEBPACK_IMPORTED_MODULE_18__.fromStr)(e)},toStr:function(e){return(0,_nav_utils__WEBPACK_IMPORTED_MODULE_18__.toStr)(e)},init:function(){__webpack_require__._dG("globalHistory",[]),Nav.strLoc=window.hab.getLoc(),Nav.objLoc=Nav.fromStr(Nav.strLoc)},getPostParams:function(e,_){const t=!(!e||!e.getAttribute),o={};if(!t)return o;let a=e.getAttribute("data-post-id");if(!a){const _=e?.closest?.(_shared_feed_selectors_constants__WEBPACK_IMPORTED_MODULE_56__.FEED_POST_INDICATOR_CLASSNAME_INDICATOR);a=_?.getAttribute("data-post-id")??_?.id?.replace("post","")}a&&(o.post_id=a);const n=e.getAttribute("data-parent-post-id");n&&(o.parent_post_id=n);const i=e.getAttribute("data-post-click-type");i&&(o.post_click_type=i);const r=e.getAttribute("data-item-owner-id");r&&(o.item_owner_id=r);const s=e.getAttribute("mention_id");s&&(o.post_click_mention_id=s);const c=e.getAttribute("data-post-click-cc-key");c&&(o.post_click_cc_key=c);const l=[e.getAttribute("href"),e.getAttribute("data-href")];(0,_utils_common__WEBPACK_IMPORTED_MODULE_9__.each)(l,(function(e,_){if(_&&"#"!==_)return o.post_click_url=_,!1}));if(!!i||_){const _=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_34__.partConfigEnabled)("post_adblock_protection_promo")?_shared_adblock_protection_locator__WEBPACK_IMPORTED_MODULE_42__.Locator.getInstance().lookupSelector("._ads_block_data_w"):"._ads_block_data_w",t=e?.closest?.(_),a=t&&(0,_shared_feed_adblock_protection_attributes_hider__WEBPACK_IMPORTED_MODULE_41__.getAdAttribute)(t,"ad"),n=t&&(0,_shared_feed_adblock_protection_attributes_hider__WEBPACK_IMPORTED_MODULE_41__.getAdAttribute)(t,"ad-block-uid");a&&(o.ad_data=a),n&&(o.ad_block_unique_id=n)}return o},mergePostParamsOptions:function(e,_){if(_=_||{},!e)return _;function t(e,t,o){const a=o&&_[t];return!(!e||a)&&(_[t]=e,!0)}return t(e.post_id,"_post",!0),t(e.parent_post_id,"_parent_post",!0),t(e.post_click_type,"_post_click_type",!0),_._post_click_type&&(t(e.post_click_mention_id,"_post_click_mention_id",!0),t(e.post_click_cc_key,"_post_click_cc_key",!0),t(e.post_click_url,"_post_click_url",!0),t(e.ad_data,"_post_ad_data",!0)&&t(e.ad_block_unique_id,"_post_ad_block_unique_id")),_},subscribeOnModuleEvaluated:_web_lib_ajax_module_callback__WEBPACK_IMPORTED_MODULE_32__.subscribeOnModuleEvaluated,unsubscribeOnModuleEvaluated:_web_lib_ajax_module_callback__WEBPACK_IMPORTED_MODULE_32__.unsubscribeOnModuleEvaluated};function authorPageNav(e,_,t){if(t&&cur.backFromAuthorPage)return delete cur.backFromAuthorPage,!0;const o=e.toLowerCase(),a=window.AuthorPage&&window.AuthorPage.isOpen(),n=o.match(/^(?:%40|@)-?[.a-z0-9_]+(?:\?\w+)?([\?&]z\=[a-z0-9-_]+)*$/);if(n)return!!a||(n[1]?cur._hardNav=!0:((0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_8__.boxRefreshCoords)(boxLoader),(0,_dom__WEBPACK_IMPORTED_MODULE_13__.show)(boxLoader),(0,_dom__WEBPACK_IMPORTED_MODULE_13__.show)(boxLayerWrap),window.stManager.add([window.jsc("web/author_page.js"),window.jsc("web/article_layer.js"),"author_page.css","ui_controls.js","ui_controls.css"],(function(){cur.prevAuthorPageUrl=_,window.AuthorPage.showLayer(o)})),!0));if(a){if(/^article_edit([0-9\-]+)_(\d+)/.test(o))return!1;if(t&&window.AuthorPage.isStandalone())return window.location.reload(!0),!0;const e=window.AuthorPage.close(!0);return void 0!==e?e:!!t}}function articleNav(e,_,t,o,a){const n=e.toLowerCase();if((0,_shared_utils_articleCheckURL__WEBPACK_IMPORTED_MODULE_57__.isArticleURL)(n)){(0,_web_lib_feature_entries_isArticleLayerOpen__WEBPACK_IMPORTED_MODULE_54__.isArticleLayerOpen)()||(cur.articlePrevLoc=_),window.WkView&&WkView.hide(!0),window.boxQueue&&boxQueue.hideAll(),window.Videoview&&window.Videoview.togglePlay(!1);const e=a?.target,o=e?(0,_web_feed_feed_common__WEBPACK_IMPORTED_MODULE_37__.getBaseDataFromPost)(e):void 0;return window.stManager.add([window.jsc("web/article_layer.js"),"article.css"]).then((()=>new Promise((e=>{ArticleLayer.show(n,!0,!1,{ev:a,onShowDone:()=>{cur.articleSequence=Math.max(1,(cur.articleSequence||0)+(t?-1:1)),e()},trackCode:o?.trackCode,postId:o?.postId,prepareAsync:!0})}))))}if((0,_web_lib_feature_entries_isArticleLayerOpen__WEBPACK_IMPORTED_MODULE_54__.isArticleLayerOpen)()){if(t&&ArticleLayer.isStandalone())return window.location.reload(!0),!0;const _=()=>{ArticleLayer.close(),delete cur.articleSequence},a=cur.articlePrevLoc;return delete cur.articlePrevLoc,a&&!_shared_utils_articleCheckURL__WEBPACK_IMPORTED_MODULE_57__.articleURLPattern.test(a)?e===a?(_(),o&&o(),!0):(layers.fullhide=function(){_()},!1):(_(),!0)}return!1}function cleanArticleUrlByObjLoc(e){return e&&e.ref&&delete e.ref,Nav.toStr(e)}function bookmarksNav(e){if(!e)return;const _=(0,_dom__WEBPACK_IMPORTED_MODULE_13__.domClosest)("bookmarks_rows",e.target),t=!!(0,_dom__WEBPACK_IMPORTED_MODULE_13__.domClosest)("bookmarks_pages",e.target);if((_||t)&&(t||(0,_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(_,"bookmarks_rows_user")||(0,_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(_,"bookmarks_rows_group")||(0,_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(_,"bookmarks_rows_page"))){let t;if(t=_?(0,_dom__WEBPACK_IMPORTED_MODULE_13__.domClosest)("_bookmark_page_item",e.target):(0,_dom__WEBPACK_IMPORTED_MODULE_13__.domClosest)("line_cell",e.target),!t)return;(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_35__.statlogsValueEvent)("bookmarks_product_analytics",{item_type:"page",item_id:(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_10__.intval)((0,_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(t,"id")),time:(0,_web_lib_date__WEBPACK_IMPORTED_MODULE_7__.getServerTime)()})}}function maybeNavigateAwayLink(e,_){if(e&&e.href&&e.getAttribute&&e.getAttribute("data-change-location-with-post-away")){let t=e.href;const o=Nav.getPostParams(e,!(!_.params||!_.params._post_click_type)),a=Nav.mergePostParamsOptions(o,_.params),n={};return a._post&&(n.post=a._post,a._post_ad_data&&(n.post_ad_data=a._post_ad_data),a._post_click_cc_key&&(n.cc_key=a._post_click_cc_key),t="/away.php?to="+encodeURIComponent(t)+"&"+(0,_shared_lib_convert__WEBPACK_IMPORTED_MODULE_17__.toQueryString)(n)),t}return null}function maybeNavigateAwayAppFormLink(e){if("string"!=typeof e)return null;return e.match(/app\d+_-?\d+\?form_id=\d+/i)?e:null}function maybeReloadBeforeNavigate(e,_,t,o){const a=/(^bug\d+$|^bugs$|^bugs_mng$|^bugtracker_adm$)/;if(-1!==e.search(a)&&-1===_.search(a)||-1===e.search(a)&&-1!==_.search(a))return o("bugtracker",t),location.href=t,!0}function maybeShowDonutSubscribePopupInsteadOfNavigation(e,_,t,o){const a=/^donut\/([A-Za-z0-9_\.]{2,32})/;if(e.match(a)){const n="direct_link",i=e.match(a)[1],r=()=>{_("groupDoesntExists"),nav.go(e,t,{...o,skipDonutLinkCheck:!0})};return _("donutLink",e),(0,_web_lib_feature_entries_showDonutSubscribePopup__WEBPACK_IMPORTED_MODULE_26__.showDonutSubscribePopup)(null,null,n,{type:"subscribe",fromSnippet:!0,onFailCallback:r,params:{act:"subscribe_popup"}},i),!0}}function adjustStylesToSpa(){document.body.classList.contains("video_showcase")&&document.body.classList.remove("video_showcase"),(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_34__.partConfigEnabled)("video_dashboard_body_class_after_redirect_bugfix")&&document.body.classList.contains("video_dashboard")&&document.body.classList.remove("video_dashboard"),document.body.classList.contains("static_header")&&document.body.classList.remove("static_header"),(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_34__.partConfigEnabled)("spa_redesign_web_enabled")&&!document.body.classList.contains("redesign_web")&&document.body.classList.add("redesign_web");const e="redesign_web_legacy_width";document.body.classList.contains(e)&&document.body.classList.remove(e),(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_34__.partConfigEnabled)("web_spa_helpdesk_styles_cleanup")&&(document.body.classList.contains("body_helpdesk")&&document.body.classList.remove("body_helpdesk"),document.body.classList.contains("body_narrow_sidebar")&&document.body.classList.remove("body_narrow_sidebar"))}Nav.addInterseptingNavigationHandler(_web_feed_feedPageLoading_navigationHandler__WEBPACK_IMPORTED_MODULE_38__.feedLoadingNavigationHandler);const __WEBPACK_DEFAULT_EXPORT__=Nav},406266:(e,_,t)=>{t.d(_,{addToStaticFiles:()=>v,getCompiledPath:()=>L,getSrcPrefix:()=>D,getStaticFileKeyBySrc:()=>M,initStaticManager:()=>f});var o=t(560377),a=t(298077),n=t(330478),i=t(898848),r=t(540462),s=t(502500),c=t(891040);const l={};let d=12e4;function u(){__debugMode&&(d=navigator.connection&&"4g"===navigator.connection.effectiveType?3e3:3e4)}const E=e=>"dist/"+e,p=e=>/\.js$/.test(e),h=e=>/\.css$/.test(e);function w(e){let _="/js/";return window.stTypes.fromLib[e]?_="/js/lib/":/^lang\d/i.test(e)||window.stTypes.fromRoot[e]||-1!==e.indexOf("/")?0===e.indexOf("dist")&&(_="/"):_="/js/al/",_}function g(e){return window.stTypes.fromRoot[e]||e.includes("/")||e.match(/^[\w_-]+\.[0-9a-f]{8,20}\.css$/)?"/":"/al/"}function b(e,_){const t=e.replace(/^dist\//,"");l[t]&&l[t](_)}function P(e){let _=e;if(~e.indexOf("dist/internal/")&&(!StaticFiles[_]||1===StaticFiles[_].l)){const e=new RegExp(_.replace(/\.js$/,c.DOT_HASH_DOT_JS));let t=!1;Object.keys(StaticFiles).forEach((_=>{e.test(_)&&!StaticFiles[_].l&&(t=_)})),t&&(_=t)}return _}function m(e,_,t){(0,a.logError)(_,{environment:s.staticManagerModuleName,breadcrumb:{message:String(t),category:"custom"}}),(0,r.partConfigEnabled)("global_show_resource_fetch_error")&&(0,o.topMsg)(`Some problems with loading <b>${e}</b>...`,5),b(e)}function D(e){return!p(e)&&!h(e)||function(e){if((0,r.partConfigEnabled)("no_public_files_cdn")&&!e.includes("dist/"))return!0;for(let _=0;_<vk.stExcludedMasks.length;_++)if(-1!==e.indexOf(vk.stExcludedMasks[_]))return!0;return!1}(e)?"":(0===`${w(_=e)}${_}`.indexOf("/dist/")||h(e))&&window.vk?.stDomain||"";var _}const O={_getLoadingState:function(e){const _=StaticFiles[e];return!_||!_.isLoading||_.v&&stVersions[e]&&String(_.v)!==String(stVersions[e])?null:_.isLoading},_getAssetInfo:e=>StaticFiles[e],_add:function(e){const _=O._getLoadingState(e),t=StaticFiles[e]?.error;if(_&&!t)return _;const o=stVersions[e],a=D(e);let i;if(p(e)){let _="";t&&(_=o?`t${Date.now()}`:`?t${Date.now()}`);i=function({fileName:e,fileFullName:_,domainPrefix:t}){const o=w(e),a=(new Error).stack;if(e!==E("web/common_web.js")){const i=t+o+_;return new Promise(((_,t)=>{const o={};if(void 0!==window.vk&&void 0!==window.vk.scriptType&&(o.type=window.vk.scriptType),(0,n.loadScript)(i,document.head,o).catch((_=>{StaticFiles[e]=null;const o=new c.StaticLoadingError({..._,stack:a});t(o)})),i.includes("dist/bundles/"))_(i);else{const o=setTimeout((()=>{if((0,r.partConfigEnabled)("extended_static_loading_errors")){const _=new c.StaticLoadingTimeout({source:i,stack:a});(0,r.partConfigEnabled)("send_static_loading_timeouts")&&(0,c.sendStaticLoadingIssueError)(_),(0,c.sendStaticLoadingIssueEvent)(_),b(e)}else m(e,new Error(`${n.JS_LOAD_ERROR_TEXT} ${e}`),a)}),window.devClient?.isActive?1e6:d),s=e.replace(/^dist\//,"");l[s]=e=>{if(clearTimeout(o),e){const _=new c.StaticLoadingExecuteError({source:i,error:e});t(_)}else _(i);l[s]=null}}})).catch((_=>(0,r.partConfigEnabled)("extended_static_loading_errors")?(((0,r.partConfigEnabled)("send_static_loading_errors")||(0,r.partConfigEnabled)("send_static_loading_execute_errors")&&_ instanceof c.StaticLoadingExecuteError)&&(0,c.sendStaticLoadingIssueError)(_),(0,c.sendStaticLoadingIssueEvent)(_),_ instanceof c.StaticLoadingExecuteError?Promise.reject(_):void b(e)):(m(e,_,a),Promise.resolve())))}(0,r.partConfigEnabled)("core_spa_blocking")||setTimeout((()=>O.done(E("web/common_web.js"))),0)}({fileName:e,fileFullName:`${e}${o?`?${o}${_}`:`${_}`}`,domainPrefix:a})}else h(e)&&(i=function({fileName:e,domainPrefix:_}){let t=g(e);e.startsWith("dist/")||(t="/css"+t);const o=_+t+e,a=(new Error).stack,i=(0,n.loadStyle)(o).catch((_=>{if((0,r.partConfigEnabled)("extended_static_loading_errors")){const t=new c.StaticLoadingError({..._,stack:a});(0,r.partConfigEnabled)("send_static_loading_errors")&&(0,c.sendStaticLoadingIssueError)(t),(0,c.sendStaticLoadingIssueEvent)(t),b(e)}else m(e,_,a)}));return i}({fileName:e,domainPrefix:a}));return StaticFiles[e]={v:o,isLoading:i},i},add:function(e,_){const t=[];if((0,i.isArray)(e)||(e=[e]),window.devClient?.isActive)return e.forEach((e=>{/^lang\d/i.test(e)&&(stVersions[e]=stVersions.lang)})),window.devClient.stManager.add(e).then((()=>(0,i.isFunction)(_)?_():[]));for(const _ in e){if(!e.hasOwnProperty(_))continue;let o=e[_];if(!o)continue;o.includes("?")&&(o=o.split("?")[0]);let a="";p(o)?a=w(o):h(o)&&(a=g(o)),/^lang\d/i.test(o)?stVersions[o]=stVersions.lang:stVersions[a.substring(1)+o]||(stVersions[a.substring(1)+o]=1);let n=!1;if(window.stDeps){const e=a+o,_="/css"+a+o;let i="";window.stDeps[e]?i=e:window.stDeps[_]&&(i=_),i&&(n=!0,window.stDeps[i].forEach((e=>{t.push(O._add(e))})))}n||t.push(O._add(o))}return Promise.all(t).then((e=>((0,i.isFunction)(_)&&_(e),e)))},done:function(e){const _=P(e);b(_),StaticFiles[_]&&(StaticFiles[_].l=1,delete StaticFiles[_].error)},fail:function(e,_){if(!(0,r.partConfigEnabled)("static_loading_execute_errors"))return;const t=P(e);StaticFiles[t]&&(StaticFiles[t].error=_,b(t,_))}};function M(e){const _=e.replace(/^https?:\/\/[^\/]+/i,"").slice(1).split("?")[0];if(/^dist\//.test(_))return _;const t=_.split("/").pop()||"";return h(t)?_.replace(/^css\//,""):t}function v(e,_){const t={};t.isLoading=_,window.StaticFiles[e]=t}function f(){window.addEventListener("load",u,{passive:!0}),t._dG("jsc",E),(0,r.partConfigEnabled)("webinf_strangle_st_manager")||t._dG("stQueue",l),window.stVersions||(t._dG("stVersions",{}),t._dG("stTypes",{fromLib:{},fromRoot:{}}),t._dG("navMap",{})),window.StaticFiles||t._dG("StaticFiles",{}),function(){for(const e of Object.values(window.StaticFiles))e.isLoading=(0,r.partConfigEnabled)("core_spa_blocking")?e.isLoading:Promise.resolve()}(),window.stManager||((0,r.partConfigEnabled)("webinf_strangle_st_manager")?t._dG("stManager",{add:O.add.bind(O),done:O.done.bind(O),fail:O.fail.bind(O)}):t._dG("stManager",O)),window.devClient?.isActive&&window.devClient.stManager.connect(O)}function L(e){const{stDeps:_=[]}=window,t=_[`${w(e)}${e}`],o=new RegExp(e.replace(/\.js$/,c.DOT_HASH_DOT_JS));return t.find((_=>_===e||o.test(_)))}},624199:(e,_,t)=>{t.d(_,{_handleResponseExtraPayloads:()=>s,replaceExtraHandler:()=>r});var o=t(558137),a=t(825127),n=t(298077);const i=(0,o.makeSharedState)("ajax-extra-handlers",(()=>new a.default),{version:0}),r=(e,_)=>(i().removeAllListeners(e),((e,_)=>(i().addListener(e,_),()=>{i().removeListener(e,_)}))(e,_)),s=e=>{var _;null!==(_=e)&&"object"==typeof _&&Object.keys(e).forEach((_=>{try{t=_,o=e[_],i().emit(t,o)}catch(e){const t={message:"Extra response error",data:{extraKey:_}};(0,n.logError)(e,{environment:"ajax_request",breadcrumb:t}),console.error(e)}var t,o}))}},287227:(e,_,t)=>{t.d(_,{subscribeOnModuleEvaluated:()=>i,triggerSubscribersOnModuleEvaluated:()=>c,unsubscribeOnModuleEvaluated:()=>s,waitModuleEvaluate:()=>r});const o=(0,t(558137).makeSharedState)("module-evaluation",(()=>({subscribes:[],subscribesOnce:[]})),{version:1})(),a=o.subscribes,n=o.subscribesOnce;function i(e,_=!1){"function"==typeof e&&(_?n.push(e):a.push(e))}function r(e=100){return new Promise((_=>{const t=window.setTimeout((()=>_()),e);i((()=>{clearTimeout(t),_()}),!0)}))}function s(e){const _=a.indexOf(e),t=n.indexOf(e);_>=0&&a.splice(_,1),t>=0&&n.splice(t,1)}function c(){a.forEach((e=>e())),n.forEach((e=>e())),n.splice(0,n.length)}},383641:(e,_,t)=>{t.d(_,{authFailed:()=>c});var o=t(969686),a=t(957994),n=t(754866),i=t(618123),r=t(891787),s=t(386477);const c=(()=>{let e,_=[];return(c,l,d)=>{_.push((()=>{c.resend(d,(0,s.resetOptionsCache)(c))})),e||(e=(e=>new Promise(((_,a)=>{let r;const s=(0,n.ce)("iframe",{src:`${(0,i.getLoginDomain)()}?${(0,o.toQueryString)({role:"al_frame",_origin:window.location.origin,ip_h:e[0]||window.vk.ip_h,to:e[1]||"",lrt:e[2]||""})}`}),c=(e,t,o)=>{clearTimeout(r),s.remove(),_({toUrl:e,userInfo:t,actionType:o})},l=(e,_)=>{clearTimeout(r),s.remove(),a({toRoot:e,toUrl:_})};r=window.setTimeout((()=>{window.onReLoginDone===c&&t._dG("onReLoginDone",void 0),window.onReLoginFailed===l&&t._dG("onReLoginFailed",void 0),a()}),16e3),t._dG("onReLoginDone",c),t._dG("onReLoginFailed",l),window.utilsNode.appendChild(s)})))(l).then((e=>{e.toUrl&&"need_redirect"===e.actionType?r.Nav.go(e.toUrl,null,{hard:!0}):_.forEach((e=>e()))}),(e=>{if(!e)return;const{toUrl:_,toRoot:t}=e;(0,a.removeLoginCache)(),_?r.Nav.go(_,null,{hard:!0}):-1!==t?t&&r.Nav.go("/"):window.location.href=location.href.replace(/^http:/,"https:")})).finally((()=>{_=[],e=void 0})))}})()},386477:(e,_,t)=>{t.d(_,{resetOptionsCache:()=>o});const o=e=>e.cache?{...e,cache:-1}:e},127609:(e,_,t)=>{function o(e,_,t){return window.nav.go(e,_,t)}function a(e,_=!1){return window.nav.subscribeOnModuleEvaluated(e,_),function(){window.nav.unsubscribeOnModuleEvaluated(e)}}function n(e){return window.nav.onLocationChange(e)}function i(e){window.nav.setLoc({...window.nav.objLoc,...e})}t.d(_,{navGo:()=>o,subscribeModuleEvaluated:()=>a,subscribeNavLocationChange:()=>n,updateNavLoc:()=>i})},664441:(e,_,t)=>{t.d(_,{ID_MESSAGE_GROUP_PREFIX:()=>j,ID_NOTIFICATION:()=>F,PAGE_ID_APPS:()=>R,PAGE_ID_CALLS:()=>f,PAGE_ID_CLIPS:()=>A,PAGE_ID_FRIENDS:()=>L,PAGE_ID_MARKET:()=>I,PAGE_ID_MARKET_ORDERS:()=>B,PAGE_ID_MESSENGER:()=>v,PAGE_ID_STICKERS:()=>y,PAGE_ID_SUPPORT:()=>N,fromStr:()=>te,globalHistoryDestroy:()=>X,handlePageCount:()=>Q,handlePageParams:()=>z,handlePageView:()=>ee,initNavCounters:()=>V,parseLoc:()=>_e,processDestroy:()=>Z,reloadCheckFlood:()=>J,showBackLink:()=>Y,toStr:()=>oe,updateHeaderStyles:()=>H,updateLeftMenu:()=>$});var o=t(251703),a=t(754866),n=t(102088),i=t(939646),r=t(636576),s=t(956460),c=t(560377),l=t(683234),d=t(581197),u=t(469004),E=t(593159),p=t(21871),h=t(540462),w=t(773096),g=t(707491),b=t(744968),P=t(905366),m=t(969686);const D=async e=>{const{updateItemCount:_}=await Promise.all([t.e(50560),t.e(762),t.e(19072),t.e("langs/web/left_menu_store")]).then(t.bind(t,547603));_(e)},O=17,M=9,v="msg",f="ca",L="fr",C="gr",k="ph",T="vid",A="svd",R="ap",y="stickers",I="mk",B="market_orders",W="vkp",U="fav",S="doc",K="ads",x="apm",N="spr",q="app",j="mgid",F="ntf";function V(){t._dG("vkLastNav",Date.now()),t._dG("vkTabLoaded",Date.now())}function H(e){document.querySelectorAll("#dev_top_nav_wrap, #page_header_wrap").forEach((_=>{(0,a.setStyle)(_,e)}))}function $(e){window.__leftMenu&&window.__leftMenu.handleUpdateRequest(e)}function G(e,_,t,o,r){if(D({id:e,count:_,href:o,isHighlighted:r}),!t)return;let s="",c="",l='<span class="inl_bl"></span>';const d="reqs"===e||e&&e.substr&&"spr"===e.substr(0,3)?5:3,u=(0,a.geByClass1)("left_count_wrap",t);u.classList.toggle("left_count_wrap--highlighted",r);const p=(0,a.geByClass1)("left_count",t,"span"),h=(0,a.val)(p);_&&(s=_.toString(),s.length>d&&(c=' title="'+(0,E.stripHTML)((0,n.langNumeric)(_,"%s",!0))+'"',s=".."+s.substr(s.length-d)),l=`<span class="inl_bl left_count" ${c}>${s}</span>`);const w=function(){(0,a.val)(u,l),u.classList.toggle("left_void",!_),(0,a.setStyle)(u,{opacity:""})};h?s?(0,i.animateCount)(p,s,{str:"auto",onDone:w}):(0,i.animate)(u,{opacity:0},100,w):(w(),(0,a.setStyle)(u,{opacity:0}),(0,i.animate)(u,{opacity:1},100))}function Q(e,_,t,o,n=!1){const i=(0,E.intval)(_),r=Math.max(0,i);if(e===F)return window.TopNotifier.setCount(r),void window.TopNotifier.createNewEventsBox(r);if(e===w.MARKET_EVENT_COUNTER_SECTION_ID)return void(0,w.updateMarketMenuEventCounter)(`#${e}`,r);let s="";if(o&&t){const e=i>0&&o?`?${o}`:"";s=(0,g.prepareHref)(t+e)}const c=(0,g.getLegacyLeftMenuItemEl)(e);if(G(e,i,c,s,n&&e===v&&(0,h.partConfigEnabled)("mail_unread_counter_highlight")),c){s&&(c.firstChild.href=s);const _=i>=0;(0,a.toggle)(c,_),e===B&&(c.style.display="")}}function z(e){window.vk.id=e.id,(0,o.tmrUpdateUserId)(),e.body_class!==document.body.className&&(document.body.className=e.body_class||""),(0,b.updateSTL)(),$(!0),window.cur._level=e.level,window.vk.id&&window.vk.id%1e3==1&&setTimeout((function(){(0,r.statlogsValueEvent)("page_scroll",0,window.cur.module,"0")}),300),ee(e);const _=document.querySelector("#mvk_footer_lnk");_&&e.mvklnk&&(_.firstChild.href=e.mvklnk),window.vk.nophone=(0,E.intval)(e.nophone),window.vk.staticheader=(0,E.intval)(e.staticheader),"leftads"in e&&0!==e.leftads&&window.__adsSet(e.leftads,e.ads_section||"",e.ads_can_show,e.ads_showed);let t=window.location.protocol+"//"+location.host+"/";e.loc&&(e.loc.startsWith("?")?t+=window.nav.strLoc:t+=e.loc);const a=document.URL===t?"":document.URL;setTimeout((()=>(0,p.updateCounters)(t,a)),10);const n=e.counters;if(!n.length)return;let i="",c="";(0,E.intval)(n[M])>0?(i="adsmarket",c="act=overview&status=-1"):(0,E.intval)(n[M])<-1?(n[M]=1,i="ads",c="act=a_comeback_office_redirect"):i="ads?act=office&last=1";const l=[L,k,T,v,"nts",C,W,"wsh",R,K,F,U,S,x,I],d=["friends","albums"+window.vk.id,"video","","notes","groups","vkpay","gifts.php?act=wishlist","apps",i,"","pages","docs","apps_manage","market"],u=["","act=added","section=tagged","","act=comments","","tab=invitations","","",c,"","","","",""];for(let e=0;e<l.length;e++){const _=n[e];(0,E.isObject)(_)||Q(l[e],_,d[e],u[e])}const h=n[O];(0,E.isObject)(h)&&function(e){Object.entries(e).forEach((([e,_])=>{const t=q+(0,E.intval)(e),o=(0,g.getLegacyLeftMenuItemEl)(t);G(t,(0,E.intval)(_),o)}))}(h),setTimeout(s.updSeenAdsInfo,0)}function J(e){e=e||{};const _=u.ls.get("last_reloaded")||[];_.unshift(Date.now());let t=_.length;t>5&&(_.splice(5,t-5),t=5),u.ls.set("last_reloaded",_);return!!(5===t&&_[0]-_[4]<2e4)&&((0,c.topError)('\n            <b>Reloading error</b>, please check internet connection, <b><a href="/page-777107_43991681">clear your cache</a></b> and restart your browser.\n            <br>If problem remains, please <a href="/support?act=new&from=nav_utils">report it here</a>.\n        ',{dt:15,type:6,msg:"Reload error, from "+(e.from||0)+", forced "+(e.force||0)+", url "+(e.url||"")+", query "+(e.query||"")}),!0)}function X(e){for(let _=0,t=window.globalHistory.length;_<t;_++)if(window.globalHistory[_].loc===e){const e=window.globalHistory.splice(_,1)[0];Z(e.cur),e.content.innerHTML="",--_,--t}}function Y(e,_,o){if(!window._tbLink)return;const a=e;if(e=(e||"").replace(/^\//,""),window._tbLink.loc=e,void 0===o&&(o=0,e))for(let _=0;_<window.globalHistory.length;_++)if(window.globalHistory[_].loc===e){o=1;break}a&&((0,E.extend)(window._tbLink,{href:"/"+e,fast:o}),t._dG("_stlWas",0)),(0,l.updSideTopLink)(1)}function Z(e){if(e._back&&e._back.hide&&e===window.cur)for(const _ in e._back.hide)if(e._back.hide.hasOwnProperty(_))try{e._back.hide[_]()}catch(e){try{console.log(e.stack)}catch(e){}}if(e.destroy&&e.destroy.length)for(let _=0;_<e.destroy.length;_++)try{e.destroy[_](e)}catch(e){try{console.log(e.stack)}catch(e){}}}function ee(e){const _=document.querySelector("#footer_wrap"),t=document.querySelector("#page_layout"),o=document.querySelector(".TopHomeLink"),n=void 0===e.width?window.vk.width:e.width,i=void 0===e.width_dec?window.vk.width_dec:e.width_dec,r=void 0===e.width_dec_footer?window.vk.width_dec_footer:e.width_dec_footer;if(window.vk.noleftmenu===e.noleftmenu&&window.vk.nobottommenu===e.nobottommenu&&window.vk.width===e.width&&window.vk.width_dec_footer===e.width_dec_footer||(window.vk.noleftmenu!==e.noleftmenu&&e.noleftmenu&&(0,a.hide)("side_bar"),window.vk.nobottommenu!==e.nobottommenu&&(e.nobottommenu?(0,a.hide)("bottom_nav"):(0,a.show)("bottom_nav")),e.noleftmenu&&e.nobottommenu?_&&(_.classList.add("simple"),_.style.width="auto"):_&&(_.classList.remove("simple"),_.style.width=Number(n)-Number(r)+"px")),window.vk.notopmenu!==e.notopmenu&&(e.notopmenu?(0,a.hide)("quick_search","qsearch_border","top_search","top_invite_link","top_menu_wrap"):(0,a.show)("quick_search","qsearch_border","top_search","top_invite_link","top_menu_wrap")),o&&e.top_home_link_class&&window.vk.top_home_link_class!==e.top_home_link_class&&(o.className=e.top_home_link_class),t&&(n!==window.vk.width||i!==window.vk.width_dec)){const e=Number(n);(0,d.setGlobalCustomProperty)("--layout-width",n+"px"),document.querySelector("#page_body").style.width=e-Number(i)+"px";const _=document.querySelector("#ts_wrap");_&&_.classList.contains("vk")&&(_.style.width=e-191+"px"),setTimeout((()=>(0,l.updSideTopLink)(!0)),0),setTimeout(b.updateSTL,0)}window.vk.noleftmenu===e.noleftmenu||e.noleftmenu||(0,a.show)("side_bar"),e.to&&document.querySelector("#quick_login_to")&&(0,a.val)("quick_login_to",e.to),window.vk.noleftmenu=e.noleftmenu,window.vk.nobottommenu=e.nobottommenu,window.vk.top_home_link_class=e.top_home_link_class,window.vk.notopmenu=e.notopmenu,window.vk.width=n,window.vk.width_dec=i,window.vk.width_dec_footer=r,window.vk.body_class=e.body_class,window.vk.staticheader=(0,E.intval)(e.staticheader),window.vk.no_ads=e.no_ads,window.vk.ad_preview=e.ad_preview}function _e(e,_){let t="",o={};return"string"==typeof e?(_.withoutRelativeURL||(e=(0,P.toMaybeVKSiteURLRelativeName)(e)),t=e,o=te(e)):(e[0]||(e[0]=""),t=oe(e),o=(0,m.fromQueryString)((0,m.toQueryString)(e))),[t,o]}function te(e){const[_,t]=e.split("#"),[o,a]=_.split("?"),n={0:o||""};t&&(n["#"]=t);return Object.assign({},(0,m.fromQueryString)(a||""),n)}function oe(e){const _=(0,E.clone)(e,void 0),t=String(_["#"]||""),o=String(_[0]||"");delete _[0],delete _["#"];const a=(0,m.toQueryString)(_);return(a?o+"?"+a:o)+(t?"#"+t:"")}},934919:(e,_,t)=>{t.d(_,{updateLazyLocation:()=>n,updateLocation:()=>a});var o=t(593159);function a(e,_){const t=(0,o.extend)({},window.nav.objLoc,e);Object.keys(t).filter((e=>""===t[e])).forEach((e=>{delete t[e]}));const a=window.nav.toStr(t);window.nav.setLoc(a,_)}function n(){let e={};return{scheduleNav(_){e=(0,o.extend)(e,_)},commitNav(){a(e),e={}},scheduleNavWithTimeOut(_,t=100){e=(0,o.extend)(e,_),setTimeout((()=>{a(e),e={}}),t)}}}},192366:(e,_,t)=>{t.d(_,{getModuleNavigationStatsServiceWeb:()=>n});var o=t(482513),a=t(319756);const n=()=>(0,o.getModuleNavigationStatsService)((0,a.ensureDIRootWebContainer)())},891040:(e,_,t)=>{t.d(_,{DOT_HASH_DOT_JS:()=>E,StaticLoadingError:()=>s,StaticLoadingExecuteError:()=>l,StaticLoadingTimeout:()=>c,sendStaticLoadingIssueError:()=>d,sendStaticLoadingIssueEvent:()=>u});var o=t(298077),a=t(101272),n=t(502500),i=t(814104),r=t(44303);class s extends Error{constructor({message:e,source:_,stack:t,lineno:o,colno:a,error:n}){super(e),this.name="StaticLoadingError",this.source=_,this.stack=t,this.lineno=o,this.colno=a,this.cause=n}}class c extends Error{constructor({source:e,stack:_}){super(`Timeout for "${e}" loading is over.`),this.name="StaticLoadingTimeout",this.source=e,this.stack=_}}class l extends Error{constructor({source:e,error:_}){super(_.message),this.name="StaticLoadingExecuteError",this.source=e,this.stack=_.stack,this.cause=_}}function d(e){(0,o.logError)(e,{environment:n.staticManagerModuleName,breadcrumb:e instanceof s?{message:String(e.cause)??"Something went wrong.",data:{source:e.source,lineno:e.lineno,colno:e.colno}}:void 0})}function u(e){const[_,t]=(0,i.separateSourceAndHash)(e.source);(0,a.saveStatlogEvents)({name:"static_loading_issues",value:1,keys:[e.name,_,t,(0,r.getRelease)()]})}const E="\\.[0-9a-f]{8,20}\\.js$"},790031:(e,_,t)=>{t.d(_,{VERSION_SKEW_ENABLED_PE:()=>l,VersionSkewManager:()=>D});var o=t(558137),a=t(540462),n=t(396858),i=t(298077),r=t(101272),s=t(560377),c=t(891040);const l="webinf_static_version_skew_manager",d="webinf_static_evergreens",u="webinf_static_poll_loader_nav",E="webinf_static_version_skew_extended_logging",p="webinf_check_staging",h=parseInt(localStorage?.getItem("version_skew_manager_poll_timeout_ms")||"",10)||6e4,w=parseInt(localStorage?.getItem("version_skew_manager_next_version_timeout_ms")||"",10)||3e5,g="web/common_web.js",b=new RegExp(c.DOT_HASH_DOT_JS),P=e=>e.replace(b,".js");class m{get isReloadPlanned(){const e=this._isReloadPlanned;return this._isReloadPlanned=!1,e}planReload(){this.log("Plan reload"),this._isReloadPlanned=!0}collectEvergreens(e){return Object.entries(e).filter((e=>e[0]?.includes("evergreen"))).map((([e,_])=>[P(e),String(_)]))}reportLoaderNavNotLoaded(e,_,t){(0,i.logError)(_,{environment:"ajax_request",breadcrumb:{message:String(t),category:"custom",data:{file:e}}}),(0,a.partConfigEnabled)("global_show_resource_fetch_error")&&(0,s.topMsg)(`Some problems with loading <b>${e}</b>...`,5,void 0)}async checkServerNavVersion(e){try{const _=(0,a.partConfigEnabled)(p)&&this.isStaging?"&ch=true":"",t=await fetch(`/al_loader_nav.php?act=check${_}`,{credentials:"same-origin"}),o=await t.json();if(_){this.log("Check staging status");const _=o?.isStaging,t=o?.isStagingUser;if(this.log(`isStaging: ${_}, isStagingUser: ${t}`),t&&!_)throw(0,r.saveStatlogEvents)({name:"staging_cookie_lost",value:"",keys:[e]}),this.log("Wrong server answer"),new Error("Wrong server");t||(this.log("Remove user from staging"),this.isStaging=!1,this.planReload())}return o?.loaderVersion||e}catch(_){return e}}async pollLoaderNav(e=!1){if((0,a.partConfigEnabled)(u)){if(this.updateNavPromise)this.log("Skip loader_nav polling due to update promise already exists");else{this.log("Poll loader_nav");const e=window.stVersions.nav,_=await this.checkServerNavVersion(e);this.planUpdateNavVersion(String(e),String(_))}e||setTimeout((()=>{this.pollLoaderNav()}),h)}}planUpdateNavVersion(e,_){e===_?(clearTimeout(this.nextVersionTimer),this.nextVersion=null,this.nextVersionTimer=0,this.log("Reset next version timer")):e!==_&&this.nextVersion!==_&&(clearTimeout(this.nextVersionTimer),this.nextVersion=_,this.nextVersionTimer=window.setTimeout((()=>{this.updateNavVersion(_,!1)}),w),this.log("Start next version timer",_))}async updateNavVersion(e,_=!0){const t=window.vk.navPostfix||"",o=window.navMapSection,a=o?`&section=${o}`:"",n=`/al_loader_nav.php?act=nav${t}&l=${window.vk.lang}&v=${e}&f=json${a}`;return this.log("Update loader_nav",n),new Promise(((e,t)=>{fetch(n,{credentials:"same-origin"}).then((e=>e.json())).then((e=>{for(const _ in e)e.hasOwnProperty(_)&&(window[_]=e[_])})).then(this.checkVersions).then(e).catch((o=>{console.error(o);const a=new Error("Can't load loader_nav");this.reportLoaderNavNotLoaded(n,a,a.stack),_?e():t()}))}))}init(){return new Promise((e=>{if(!(0,a.partConfigEnabled)(d))return Promise.resolve();window.stVersions&&Array.isArray(Object.entries(window.stVersions))?(this.collectEvergreens(window.stVersions).forEach((([e,_])=>{this.evergreens.set(e,_)})),this.isInited=!0,e(this.isInited)):setTimeout((()=>{this.init().then(e)}),100)}))}log(...e){(0,a.partConfigEnabled)(E)&&console.log.apply(console,["[VersionSkewManager]",...e])}isReloadRequired(){const e=this.isReloadPlanned,_=window.stVersions[window.jsc(g)],t=window.StaticFiles[window.jsc(g)]?.v,o=e||void 0!==_&&void 0!==t&&_>t;return this.log("Reload is required",o),o}maybeUpdateNav(e){return this.updateNavPromise||(this.updateNavPromise=new Promise((_=>{const t=()=>{this.updateNavPromise=null,_()},o=window.stVersions.nav;String(o)!==String(e)?this.updateNavVersion(e).then(t):queueMicrotask(t)}))),this.updateNavPromise}constructor(){this.updateNavPromise=null,this.evergreens=new Map,this.isInited=!1,this._isReloadPlanned=!1,this.isStaging=!1,this.nextVersion=null,this.nextVersionTimer=0,this.checkVersions=()=>{if((0,a.partConfigEnabled)(d)){this.log("Check evergreen versions"),(0,a.partConfigEnabled)(E)&&console.table(Array.from(this.evergreens.entries()));const e=this.collectEvergreens(window.stVersions);(0,a.partConfigEnabled)(E)&&console.table(e);for(const[_,t]of e){const e=this.evergreens.get(_);e?e!==t&&(this.log(`Evergreen "${_}:${this.evergreens.get(_)}" has new version`,t),this.planReload()):(this.log("New evergeen",_),this.planReload())}}},(0,a.partConfigEnabled)(p)&&(this.isStaging=(0,n.getCookie)("remixst"),this.log(this.isStaging?"Has staging cookie":"Has no staging cookie")),this.init().then((()=>{(0,a.partConfigEnabled)(u)&&setTimeout((()=>{this.pollLoaderNav()}),h)}))}}const D=(0,o.makeSharedState)("version-skew-manager-singleton",(()=>new m),{version:2})();t._dG("__planReload__",D.planReload.bind(D))},334249:(e,_,t)=>{t.d(_,{ajax:()=>o.ajax});var o=t(761520)},659268:(e,_,t)=>{t.d(_,{AjaxCancellationToken:()=>o.AjaxCancellationToken});var o=t(433409)},294866:(e,_,t)=>{t.d(_,{PAGE_ID_CALLS:()=>o.PAGE_ID_CALLS,globalHistoryDestroy:()=>o.globalHistoryDestroy,handlePageView:()=>o.handlePageView});var o=t(664441)},21562:(e,_,t)=>{t.d(_,{updateLocation:()=>o.updateLocation});var o=t(934919)}}])}if("undefined"!=typeof window&&window.partConfigEnabled?.("static_loading_execute_errors"))try{sourceFn(),window.stManager?.done?.("dist/web/chunks/common.evergreen.2d054f28.js")}catch(e){throw window.stManager?.fail?.("dist/web/chunks/common.evergreen.2d054f28.js",e),e}else sourceFn(),"undefined"!=typeof window&&window.stManager?.done?.("dist/web/chunks/common.evergreen.2d054f28.js");