function e(){"use strict";(self.webpackChunkvkweb=self.webpackChunkvkweb||[]).push([[76712],{52905:(e,t,r)=>{r.d(t,{API_VERSION:()=>i,BRIDGE_STAT_CALL_ARGUMENTS_MAX_LENGTH:()=>k,CLOSE_STATUS:()=>d,ERROR_CODES:()=>s,ERROR_REASONS:()=>n,ERROR_TYPES:()=>c,MAX_COUNT_OF_APP_INIT:()=>y,NFT_APP_ID:()=>u,ONE_TIME_DONUT_APP_ID:()=>m,ORD_APP_ID:()=>p,OZON_APP_ID:()=>v,PLATFORM:()=>o,PMC_PART_CONFIG_KEY_LONG_ID:()=>h,SITPOSTING_APP_ID:()=>f,TEXTLIVE_APPS:()=>_,VKPAY_APPS:()=>l,VKPAY_TRANSACTION_EVENT:()=>a,VK_CONNECT_EVENTS:()=>E,VK_CONNECT_SUPERAPPKIT_EVENT_TYPE:()=>g,VMOJI_CONSTRUCTOR_APP_ID:()=>S});const i="5.95",a="VKWebAppActionDone",o={WEB:"web",MOBILE_WEB:"mobile-web"},s={UNKNOWN:1,MISSING_PARAM:2,OLD_MISSING_PARAM:100,CONNECTION_LOST:3,USER_DENIED:4,INVALID_PARAMS:5,UNSUPPORTED_PLATFORM:6,REQUESTS_LIMIT_REACHED:10,ACCESS_DENIED:11,CUSTOM:13,NO_ADS:20},n={ACCESS_DENIED:"Access denied",UNSUPPORTED_PLATFORM:"Unsupported platform",UNSUPPORTED_ACTION:"Unsupported action",NATIVE_APP_IS_NOT_INSTALLED:"VK client is not installed on device",USER_NOT_A_PRIVATE_GROUP_MEMBER:"User is not a member of the given private group",UNKNOWN_ERROR:"Unknown error",CONNECTION_LOST:"Connection lost",NETWORK_ERROR:"Network error",USER_DENIED:"User denied",INVALID_PARAMS:"Invalid params",NO_ADS:"No ads",ADS_ALREADY_PLAYED:"Ads already played",VK_PAY_DISABLED:"This app can't use VK Pay",SCROLL_SUBSCRIBER_ALREADY_EXIST:"Scroll subscriber already exist",SUBSCRIPTION_IS_ALREADY_CANCELLED:"Subscription is in invalid status: subscription is already cancelled",SURVEY_INIT_IN_PROGRESS:"Survey init in progress",SURVEY_ALREADY_INIT:"Survey already init",SURVEY_NO_MATCH:"Survey no match",SURVEY_USER_CANCEL:"Survey user cancel",ALREADY_IN_PROGRESS:"Already in progress",USER_IS_NOT_GROUP_ADMIN:"Only group admins have access to group tokens",DEVICE_CANT_GET_GEODATA:"Device can't get geodata",USER_DIDNT_ALLOWED_ACTION:"User didn't allowed"},c={CLIENT:"client_error",API:"api_error",AUTH:"auth_error"},d=["success","failed"],l=[6217559,7131443],_=[7512376],p=51707812,u=51459963,f=7644481,S=7929683,m=51528700,v=51903384,E={VKWebAppAddToCommunity:"add_to_community",VKWebAppAddToCommunityPreload:"get_groups_list",VKWebAppAddToFavorites:"add_to_favorites",VKWebAppAddToFavoritesPreload:"already_added_to_favorites",VKWebAppAddToMenu:"add_to_menu",VKWebAppAddToMenuPreload:"is_in_left_menu",VKWebAppGetCommunityToken:"get_community_token",VKWebAppGetCommunityTokenPreload:"get_community_preload_settings",VKWebAppGetAuthToken:"get_auth_token",VKWebAppGetAuthTokenPreload:"get_auth_token_info",VKWebAppGetPhoneNumber:"get_phone_number",VKWebAppGetPhoneNumberPreload:"already_get_phone_number",VKWebAppGetEmail:"get_email",VKWebAppGetEmailPreload:"already_get_email",VKWebAppGetFriends:"get_friends",VKWebAppOpenApp:"open_app",VKWebAppSendPayload:"send_payload",VKWebAppSendToClient:"send_to_client",VKWebAppSendToClientPreload:"get_open_in_native_permission",VKWebAppShowOrderBox:"order",VKWebAppShowSubscriptionBox:"subscription",VKWebAppShowLeaderBoardBox:"show_leader_board",VKWebAppShowLinkCardBox:"show_link_card",VKWebAppShowNftPaymentBox:"show_nft_pay_box",VKWebAppShowInviteBox:"invite_friends",VKWebAppShowStoryBox:"story_box",VKWebAppShowRequestBox:"send_request",VKWebAppShowRequestBoxPreload:"request_box_preload",VKWebAppOpenArticleEditor:"open_article_edit",VKWebAppClose:"close",VKWebAppGetSilentToken:"get_silent_token",VKWebAppOpenPayForm:"open_pay_form",VKWebAppAddToChat:"add_to_chat",VKWebAppTrackEvent:"track_event",VKWebAppCallStart:"call_start",VKWebAppCallJoin:"call_join",VKWebAppCallLeft:"call_left",VKWebAppCallFinished:"call_finished",VKWebAppCallGetStatus:"call_get_status",VKWebAppCallStartSharing:"call_start_sharing",VKWebAppCallStopSharing:"call_stop_sharing"},g="vk-sak-sdk",h="mini_apps_long_id",k=256,y=1},541756:(e,t,r)=>{r.d(t,{saveNavigationStatEvent:()=>n,saveViewerStartTime:()=>d});r(351118);var i=r(809152),a=r(601686);function o(){const{connection:e}=navigator;if(!e)return"";const{effectiveType:t,downlink:r}=e;switch(t){case"slow-2g":return"GPRS";case"2g":return"EDGE";case"3g":return"3G";case"4g":return r>8?"wi-fi":"LTE"}return""}let s=[];function n({storyRawId:e,source:t,action:r}){let o=0,n=0;e&&([o,n]=(0,a.splitStoryRawId)(e)),"reply"===t&&(t="replies_list");const c={e:i.STATS_EVENT_TYPE_STORIES_VIEWER_NAVIGATION,owner_id:o,story_id:n,source:t,action:r};s.push(c)}let c=[];function d({storyRawId:e,source:t,time:r}){const[s,n]=(0,a.splitStoryRawId)(e),d={e:i.STATS_EVENT_TYPE_STORIES_VIEWING_START_TIME,owner_id:s,story_id:n,source:t,time:r,internet_type:o()};c.push(d)}},51921:(e,t,r)=>{r.d(t,{connectTrackTmrGroupsJoin:()=>c,groupsJoinAction:()=>d,trackTmrGroupsJoin:()=>s});var i=r(251703),a=r(957994),o=r(32489);const s=()=>(0,i.tmrSendTimespentEvent)(i.MY_TRACKER_COUNT_EVENT_IDS.COMMUNITY_SUBSCRIBE),n=(0,o.createEffect)({name:"fx/track_group_join",handler:s}),c=e=>(0,o.sample)({clock:e.done,target:n}),d=(e,t,r)=>(0,a.api)("groups.join",e,t,r).then((e=>(s(),e)))},869071:(e,t,r)=>{r.d(t,{connectTrackTmrGroupsJoin:()=>i.connectTrackTmrGroupsJoin,groupsJoinAction:()=>i.groupsJoinAction,trackTmrGroupsJoin:()=>i.trackTmrGroupsJoin});var i=r(51921)},910364:(e,t,r)=>{r.d(t,{createCacheService:()=>a});var i=r(746573);const a=e=>{const t=(0,i.getEffectorServiceDomain)(e),r=Object.create(null),a=t.createStore(Object.create(null)),o=t.createEvent("add"),s=t.createEvent("delete");return a.on(o,((e,{key:t,data:r})=>(e[t]=r,e))).on(s,((e,t)=>(delete e[t],e))),{$cache:a,add:o,delete:s,get:e=>a.getState()[e]||null,isWaited:e=>void 0!==r[e],getWaited:e=>r[e],setWaited:(e,t)=>{r[e]=t},deleteWaited:e=>{delete r[e]}}}},136335:(e,t,r)=>{r.d(t,{createOwnerService:()=>a.createOwnerService,createUserService:()=>i.createUserService});var i=r(277594),a=r(43188)},43188:(e,t,r)=>{r.d(t,{createOwnerService:()=>l});var i=r(32489),a=r(805658),o=r(810068),s=r(910364),n=r(746573),c=r(33305);const d=(0,s.createCacheService)(),l=e=>{const t=e.fields||[],r=(0,n.getEffectorServiceDomain)(e),s=r.createStore({id:0}),l=r.createEvent("initialize"),_=r.createEvent("reload"),p=r.createEffect({name:"initializeFx"}),u=p.pending,f=p.doneData;return p.use((({ownerId:e,useCache:r})=>{if(r){const r=d.get(e);if(r){if(t.every((e=>r.hasOwnProperty(e))))return Promise.resolve(r)}}if(d.isWaited(e)){const r=d.getWaited(e).find((e=>t.every((t=>Boolean(e.fields[t])))));if(r)return r.promise.finally((()=>{d.deleteWaited(e)})),r.promise}let i=o.Ranges.isGroupId(e)?(0,a.apiWithPrefetch)("groups.getById",{group_ids:String(e),fields:t.join(",")}).then((t=>t.groups?.[0]||{id:e})):(0,a.apiWithPrefetch)("users.get",{user_ids:String(e),fields:t.join(",")}).then((e=>e[0]));const s={fields:t.reduce(((e,t)=>(e[t]=!0,e)),{}),promise:i},n=d.isWaited(e)?[...d.getWaited(e),s]:[s];return d.setWaited(e,n),i})),(0,i.sample)({clock:l,source:s,filter:(e,t)=>e.id!==t,fn:(t,r)=>({ownerId:r,useCache:Boolean(e?.useCache)}),target:p}),(0,i.sample)({clock:_,source:s,fn:e=>({ownerId:e.id}),target:p}),(0,i.sample)({clock:p.doneData,target:s}),(0,i.sample)({clock:p.doneData,filter:()=>Boolean(e?.useCache),fn:e=>{const t=d.get(e.id);if(t){if((0,c.isOwnerUser)(t)&&(0,c.isOwnerUser)(e))return{key:e.id,data:{...t,...e}};if((0,c.isOwnerGroup)(t)&&(0,c.isOwnerGroup)(e))return{key:e.id,data:{...t,...e}}}return{key:e.id,data:e}},target:d.add}),{$isInitializing:u,$owner:s,initialize:l,onInitialized:f,reload:_}}},277594:(e,t,r)=>{r.d(t,{createUserService:()=>s});var i=r(32489),a=r(957994),o=r(805658);const s=({domain:e})=>{const t=(e,t)=>!(!e||e.id!==t.userId),r=e.createStore(null),s=e.createEffect((({params:e})=>(0,o.apiWithPrefetch)("users.get",e))),n=e.createEffect((async e=>({userId:e.params.owner_id,response:await(0,a.api)("wall.subscribe",e.params)}))),c=e.createEffect((async e=>({userId:e.params.owner_id,response:await(0,a.api)("wall.unsubscribe",e.params)}))),d=e.createEffect((async e=>({userId:e.params.owner_id,response:await(0,a.api)("video.liveSubscribe",e.params)}))),l=e.createEffect((async e=>({userId:e.params.owner_id,response:await(0,a.api)("video.liveUnsubscribe",e.params)}))),_=e.createEffect((async e=>({userId:e.params.user_id,response:await(0,a.api)("fave.addUser",e.params)}))),p=e.createEffect((async e=>({userId:e.params.user_id,response:await(0,a.api)("fave.removeUser",e.params)}))),u=e.createEffect((async e=>({userId:e.params.owner_id,response:await(0,a.api)("account.ban",e.params)}))),f=e.createEffect((async e=>({userId:e.params.owner_id,response:await(0,a.api)("account.unban",e.params)}))),S=e.createEffect((async e=>({userId:e.params.user_id,response:await(0,a.api)("bestFriends.add",e.params)}))),m=e.createEffect((async e=>({userId:e.params.user_id,response:await(0,a.api)("bestFriends.delete",e.params)})));return(0,i.sample)({clock:s.doneData,fn:e=>e[0]||null,target:r}),(0,i.sample)({clock:n.doneData,source:r,filter:t,fn:e=>({...e,is_subscribed:1}),target:r}),(0,i.sample)({clock:c.doneData,source:r,filter:t,fn:e=>({...e,is_subscribed:0}),target:r}),(0,i.sample)({clock:d.doneData,source:r,filter:t,fn:e=>({...e,video_live:e.video_live?{...e.video_live,is_notifications_blocked:0}:void 0}),target:r}),(0,i.sample)({clock:l.doneData,source:r,filter:t,fn:e=>({...e,video_live:e.video_live?{...e.video_live,is_notifications_blocked:1}:void 0}),target:r}),(0,i.sample)({clock:_.doneData,source:r,filter:t,fn:e=>({...e,is_favorite:1}),target:r}),(0,i.sample)({clock:p.doneData,source:r,filter:t,fn:e=>({...e,is_favorite:0}),target:r}),(0,i.sample)({clock:u.doneData,source:r,filter:t,fn:e=>({...e,blacklisted_by_me:1}),target:r}),(0,i.sample)({clock:f.doneData,source:r,filter:t,fn:e=>({...e,blacklisted_by_me:0}),target:r}),(0,i.sample)({clock:S.doneData,source:r,filter:t,fn:e=>({...e,is_best_friend:!0}),target:r}),(0,i.sample)({clock:m.doneData,source:r,filter:t,fn:e=>({...e,is_best_friend:!1}),target:r}),{fetchUserFx:s,subscribeToPostsFx:n,unsubscribeFromPostsFx:c,subscribeToVideoLiveFx:d,unsubscribeFromVideoLiveFx:l,faveAddUserFx:_,faveRemoveUserFx:p,accountBanFx:u,accountUnbanFx:f,bestFriendAddFx:S,bestFriendDeleteFx:m,$user:r,domain:e}}},653422:(e,t,r)=>{r.d(t,{apiFaveAddNarrative:()=>a,apiFaveRemoveNarrative:()=>o});var i=r(957994);function a(e){return(0,i.api)("fave.addNarrative",e)}function o(e){return(0,i.api)("fave.removeNarrative",e)}},373237:(e,t,r)=>{r.d(t,{createFaveService:()=>o});var i=r(32489),a=r(653422);const o=({domain:e})=>{const t=e.createEvent("fire/faveAddNarrative"),r=e.createEvent("fire/faveRemoveNarrative"),o=e.createEffect("fx/faveAddNarrative"),s=e.createEffect("fx/faveRemoveNarrative");return o.use(a.apiFaveAddNarrative),s.use(a.apiFaveRemoveNarrative),(0,i.sample)({clock:t,target:o}),(0,i.sample)({clock:r,target:s}),{fireAddNarrative:t,fireRemoveNarrative:r,addNarrativeFx:o,removeNarrativeFx:s}}},507838:(e,t,r)=>{r.d(t,{findOwnerById:()=>o,isGroup:()=>a});var i=r(468073);function a(e){return i.Ranges.isGroupId(e.id)}const o=(e=0,t=[],r=[])=>{if(e)return i.Ranges.isUserId(e)?t.find((t=>t?.id===e)):r.find((t=>t?.id===Math.abs(e)))}},646938:(e,t,r)=>{r.d(t,{DynamicStickersTypes:()=>d,StickerTypes:()=>c,StoryBlockType:()=>s,StoryEntryPoint:()=>a,StoryListName:()=>n,StoryPollBackgroundType:()=>p,StorySource:()=>o,StoryType:()=>i,dynamicStickerIds:()=>l,staticStickerIds:()=>_});var i=function(e){return e.PHOTO="photo",e.VIDEO="video",e.LIVE="live",e}({}),a=function(e){return e.SWIPE="swipe",e.NAVIGATION_BUTTON="navigation_button",e.SIT_POSTING="sit_posting",e.LINK="link",e.STORY_REPLY="story_reply",e.STORY_REPOST="story_repost",e.CATALOG_ADD="catalog_add",e.DIALOG="dialog",e.STORY_LIVE_FINISHED="story_live_finished",e.DIALOG_VKME="dialog_vkme",e.STORY_VIEWER_FINISHED="story_viewer_finished",e.PUSH_TRY_MASK="push_try_mask",e.STORY_VIEWER_TRY_MASK="story_viewer_try_mask",e.LINK_MASK="link_mask",e.POSTING="posting",e.NEW_STORY_AVATAR="new_story_avatar",e.STORY_REPLIES_LIST="story_replies_list",e.STORIES_FEED="stories_feed",e.STORIES_SEARCH_NEWS="stories_search_news",e.QUESTION_STICKER="question_sticker",e.LIST_MIDDLE="list_middle",e.ARCHIVE_EMPTY_BUTTON="archive_empty_button",e.ARCHIVE_MENU_BUTTON="archive_menu_button",e.IM="im",e.PROFILE_BUTTON="profile_button",e.SHARE="share",e.MINI_APP="mini_app",e.SYSTEM_SHARING="system_sharing",e.SHORTCUT="shortcut",e.ARCHIVE_SHARING="archive_sharing",e.STORY_VIEWER_CAMERA_BUTTON="story_viewer_camera_button",e.STORY_VIEWER_MUSIC="story_viewer_music",e.STORY_VIEWER_MUSIC_SHEET="story_viewer_music_sheet",e.REPOST_TO_STORY_ACTIVITY="repost_to_story_activity",e.CHANGE_AVATAR="change_avatar",e.GROUP_ADD_STORIES_PAGE="group_add_stories_page",e.MUSIC_COVER_SHARING="music_cover_sharing",e}({}),o=function(e){return e.FEED="feed",e.FEED_MIDDLE="feed_middle",e.LINK="link",e.PROFILE="profile",e.IM_DIALOGS="im_dialogs",e.IM_DIALOG_HEADER="im_dialog_header",e.SNIPPET="snippet",e.REPLY="reply",e.REPLIES_LIST="replies_list",e.REPLY_STORY="reply_story",e.DISCOVER="discover",e.STORIES_MANAGE="stories_manage",e.USER_PERSONAL_CARD="user_personal_card",e.GROUP_PERSONAL_CARD="group_personal_card",e.NARRATIVE_SNIPPET="narrative_snippet",e.NARRATIVE_STORY="narrative_story",e.NARRATIVE_LINK="narrative_link",e.NARRATIVE_RECOMMENDATIONS="narrative_recommendations",e.NARRATIVE_SECTION="narrative_section",e.FAVE="fave",e.SPAMFEED="sf",e.ADS_PREVIEW="ads_preview",e.LIST_MIDDLE="list_middle",e.PLACE_STORY_LIST="place_story_list",e.SEARCH_STORY_LIST="search_story_list",e.STORY_ARCHIVE="story_archive",e.IM_MSG_LIST="im_msg_list",e.NOSPAM="nospam",e.PROFILE_SNACKBAR="profile_snackbar",e.MY_QUESTIONS="question_story",e}({}),s=function(e){return e.stories="stories",e.promoStories="promo_stories",e.discover="discover",e.liveActive="live_active",e.liveFinished="live_finished",e}({}),n=function(e){return e.feed="feed",e.discover="discover",e}({});const c={hashtag:1,mention:2,question:3,place:4,music:5,storyReply:6,owner:7,link:8,marketItem:9,post:10,poll:11,sticker:12,app:13,situationalTheme:14,playlist:15,videoButton:16,situationalTemplate:17,spoiler:18,service_yc_item:19,photo:20,album:21},d={situationalTemplate:c.situationalTemplate},l=Object.values(d),_=Object.values(c).filter((e=>!l.includes(e)));var p=function(e){return e.photo="photo",e.gradient="gradient",e.default="default",e}({})},33270:(e,t,r)=>{r.d(t,{apiLikesAdd:()=>a,apiLikesDelete:()=>o});var i=r(957994);function a(e){return(0,i.api)("likes.add",e)}function o(e){return(0,i.api)("likes.delete",e)}},208579:(e,t,r)=>{},733498:(e,t,r)=>{r.d(t,{createLikesService:()=>i.createLikesService});var i=r(921245);r(208579)},921245:(e,t,r)=>{r.d(t,{createLikesService:()=>o});var i=r(32489),a=r(33270);const o=({domain:e})=>{const t=e.createEvent("fire/likesAdd"),r=e.createEvent("fire/likesDelete"),o=e.createEffect("fx/likesAdd"),s=e.createEffect("fx/likesDelete");return o.use(a.apiLikesAdd),s.use(a.apiLikesDelete),(0,i.sample)({clock:t,target:o}),(0,i.sample)({clock:r,target:s}),{fireAdd:t,fireDelete:r,addFx:o,deleteFx:s}}},928410:(e,t,r)=>{r.d(t,{apiMessagesSend:()=>a});var i=r(957994);function a(e){return(0,i.api)("messages.send",e)}},455673:(e,t,r)=>{r.d(t,{createMessagesService:()=>o});var i=r(32489),a=r(928410);const o=({domain:e})=>{const t=e.createEvent("fire/messageSend"),r=e.createEffect("fx/messageSend");return r.use(a.apiMessagesSend),(0,i.sample)({clock:t,target:r}),{fireMessagesSend:t,sendFx:r}}},869397:(e,t,r)=>{r.d(t,{apiNarrativesBatchEdit:()=>s,apiNarrativesCreate:()=>a,apiNarrativesDelete:()=>n,apiNarrativesEdit:()=>o,apiNarrativesGetById:()=>c,apiNarrativesGetCustomCoverUploadServer:()=>u,apiNarrativesGetFeedBlock:()=>d,apiNarrativesGetFromOwner:()=>l,apiNarrativesReorder:()=>p,apiNarrativesSaveCustomCover:()=>_});var i=r(957994);function a(e){return(0,i.api)("narratives.create",e)}function o(e){return(0,i.api)("narratives.edit",e)}function s(e){return(0,i.api)("narratives.batchEdit",e)}function n(e){return(0,i.api)("narratives.delete",e)}function c(e){return(0,i.api)("narratives.getById",e)}function d(e={}){return(0,i.api)("narratives.getFeedBlock",e)}function l(e){return(0,i.api)("narratives.getFromOwner",e)}function _(e){return(0,i.api)("narratives.saveCustomCover",e)}function p(e){return(0,i.api)("narratives.reorder",e)}function u(e){return(0,i.api)("narratives.getCustomCoverUploadServer",e)}},942838:(e,t,r)=>{r.d(t,{createNarrativesService:()=>o});var i=r(32489),a=r(869397);const o=({domain:e})=>{const t=e.createEvent("fire/narrativesGetById"),r=e.createEvent("fire/narrativesGetFromOwner"),o=e.createEvent("fire/narrativesGetFeedBlock"),s=e.createEvent("fire/narrativesCreate"),n=e.createEvent("fire/narrativesEdit"),c=e.createEvent("fire/narrativesBatchEdit"),d=e.createEvent("fire/narrativesDelete"),l=e.createEvent("fire/narrativesSaveCustomCover"),_=e.createEvent("fire/narrativesReorder"),p=e.createEffect("fx/narrativesGetById"),u=e.createEffect("fx/narrativesGetFromOwner"),f=e.createEffect("fx/narrativesGetFeedBlock"),S=e.createEffect("fx/narrativesCreate"),m=e.createEffect("fx/narrativesEdit"),v=e.createEffect("fx/narrativesBatchEdit"),E=e.createEffect("fx/narrativesDelete"),g=e.createEffect("fx/narrativesSaveCustomCover"),h=e.createEffect("fx/narrativesReorder");return p.use(a.apiNarrativesGetById),u.use(a.apiNarrativesGetFromOwner),f.use(a.apiNarrativesGetFeedBlock),S.use(a.apiNarrativesCreate),m.use(a.apiNarrativesEdit),v.use(a.apiNarrativesBatchEdit),E.use(a.apiNarrativesDelete),g.use(a.apiNarrativesSaveCustomCover),h.use(a.apiNarrativesReorder),(0,i.sample)({clock:t,target:p}),(0,i.sample)({clock:r,target:u}),(0,i.sample)({clock:o,target:f}),(0,i.sample)({clock:s,target:S}),(0,i.sample)({clock:n,target:m}),(0,i.sample)({clock:c,target:v}),(0,i.sample)({clock:d,target:E}),(0,i.sample)({clock:l,target:g}),(0,i.sample)({clock:_,target:h}),{fireGetById:t,fireGetFromOwner:r,fireGetFeedBlock:o,fireCreate:s,fireEdit:n,fireBatchEdit:c,fireDelete:d,fireSaveCustomCover:l,fireReorder:_,getByIdFx:p,getFromOwnerFx:u,getFeedBlockFx:f,createFx:S,editFx:m,batchEditFx:v,deleteFx:E,saveCustomCoverFx:g,reorderFx:h}}},616220:(e,t,r)=>{r.d(t,{apiPollsCreate:()=>o,apiPollsGetById:()=>a});var i=r(957994);function a(e){return(0,i.api)("polls.getById",e)}function o(e){return(0,i.api)("polls.create",e)}},49819:(e,t,r)=>{r.d(t,{createPollsService:()=>o});var i=r(32489),a=r(616220);const o=({domain:e})=>{const t=e.createEvent("fire/pollsGetById"),r=e.createEvent("fire/pollsCreate"),o=e.createEffect("fx/pollsGetById"),s=e.createEffect("fx/pollsCreate");return o.use(a.apiPollsGetById),s.use(a.apiPollsCreate),(0,i.sample)({clock:t,target:o}),(0,i.sample)({clock:r,target:s}),{fireGetById:t,fireCreate:r,getByIdFx:o,createFx:s}}},554731:(e,t,r)=>{r.d(t,{HIDE_TOOLTIP_TIMEOUT:()=>i,OPENED_REACTED_USERS_DEFAULT_REACTION_ID:()=>l,REACTION_ID_DEFAULT:()=>o,REACTION_ID_MAX:()=>s,REACTION_ID_MIN:()=>n,REACTION_ID_UNSET:()=>c,REACTION_SET_ITEMS_MIN_COUNT:()=>d,SHOW_TOOLTIP_TIMEOUT:()=>a});const i=600,a=140,o=0,s=7,n=0,c=void 0,d=2,l=o},888065:(e,t,r)=>{r.d(t,{reactionCountsBrandUnwrap:()=>a,reactionCountsBrandWrap:()=>o});var i=r(672330);const a=e=>(0,i.unwrap)(e),o=e=>(0,i.wrap)(e)},369296:(e,t,r)=>{r.d(t,{areCountersEqual:()=>w,calcCounters:()=>h,calcCountersSum:()=>k,calcCountersWeightedSum:()=>y,counterForReactionId:()=>I,getDefaultReaction:()=>d,getDefaultReactionTitle:()=>l,getReaction:()=>c,hasReactionsForCounts:()=>T,isReactionIdSet:()=>u,isReactionIdUnset:()=>f,isUnknownObject:()=>n,isValidReactionId:()=>S,parseReactionId:()=>m,parseReactionIdOrUnset:()=>v,parseReactionMenuConfig:()=>g,prepareReactionMenuSet:()=>p,validateReactionSetPayloaditems:()=>E});var i=r(554731),a=r(888065),o=r(351118);const s=Number.isInteger||(e=>"number"==typeof e&&isFinite(e)&&Math.floor(e)===e),n=e=>null!==e&&"object"==typeof e,c=(e,t)=>e.itemsById[t],d=e=>c(e,i.REACTION_ID_DEFAULT),l=e=>d(e)?.title,_=(e,t)=>0===e.length?"":((e,t,r=!0)=>e.reduce(((e,i)=>{const a=t(i),o=t(e);return o===a?r?e:i:o<a?e:i})))(e,(e=>(t.width-e.width)**2+(t.height-e.height)**2),!1).url,p=(e,t,r)=>{const i=t.map((({asset:e,color_sets:t,id:i,score:a,title:o})=>({animationURL:e.animation_url||void 0,backgroundColor:t?.background,id:i,imageMenuURL:_(e.images,r.imageMenuSize),imagePreviewURL:"imagePreviewSize"in r?_(e.images,r.imagePreviewSize):void 0,imageStoryPanelURL:"imageStoryPanelSize"in r?_(e.images,r.imageStoryPanelSize):void 0,imageStoryPreviewURL:"imageStoryPreviewSize"in r?_(e.images,r.imageStoryPreviewSize):void 0,score:a,title:o,titleColor:t?.foreground}))),a={};return i.forEach((e=>{a[e.id]=e})),{id:e,items:i,itemsById:a}},u=e=>e!==i.REACTION_ID_UNSET,f=e=>e===i.REACTION_ID_UNSET,S=e=>s(e)&&e>=i.REACTION_ID_MIN&&e<=i.REACTION_ID_MAX,m=e=>{const t=parseInt(e,10);return S(t)?{isValid:!0,value:t}:{isValid:!1}},v=e=>{const t=m(e);return t.isValid?t.value:i.REACTION_ID_UNSET},E=(e,t)=>{if(e.length<i.REACTION_SET_ITEMS_MIN_COUNT)return{error:new Error(`Invalid reactions items count in set '${t}': ${e.length}`)}},g=e=>{if(!n(e))return;const t={},{animationShowStaticAfterEnd:r,menuShowDelay:a,openedDefaultReactionId:o,reportJsErrors:s}=e;return"number"!=typeof a&&void 0!==a||(t.menuShowDelay=a),"boolean"==typeof r&&(t.animationShowStaticAfterEnd=r),"boolean"==typeof s&&(t.reportJsErrors=s),"number"==typeof o||null===o?null===o?t.openedDefaultReactionId=void 0:S(o)&&(t.openedDefaultReactionId=o):t.openedDefaultReactionId=i.OPENED_REACTED_USERS_DEFAULT_REACTION_ID,t},h=(e,t)=>{const r=(0,a.reactionCountsBrandWrap)({});return Object.entries((0,a.reactionCountsBrandUnwrap)(e)).forEach((([e,i])=>{const a=e,o=t?.itemsById?.[a]?.score??1;r[a]=o*(i||0)})),r},k=e=>Object.values((0,a.reactionCountsBrandUnwrap)(e)).reduce(((e,t)=>e+(t||0)),0),y=e=>k((0,a.reactionCountsBrandWrap)(e)),T=e=>k(e)>0,I=(e,t)=>e[t]??void 0,w=(e,t)=>e&&t?(0,o.isEqual)(e,t):e===t},672330:(e,t,r)=>{r.d(t,{unwrap:()=>i,wrap:()=>a});const i=e=>e,a=e=>e},913885:(e,t,r)=>{r.d(t,{apiStatsTrackEvents:()=>a});var i=r(957994);function a(e){return(0,i.api)("stats.trackEvents",e)}},809152:(e,t,r)=>{r.d(t,{STATS_EVENT_TYPE_STORIES_VIEWER_NAVIGATION:()=>i,STATS_EVENT_TYPE_STORIES_VIEWING_START_TIME:()=>a,STATS_EVENT_TYPE_STORY_LINK_VIEW:()=>o,STATS_EVENT_TYPE_VIDEO_ONBOARDING:()=>s});const i="stories_viewer_navigation",a="stories_viewing_start_time",o="story_link_view",s="video_onboarding"},744030:(e,t,r)=>{r.d(t,{createStatsService:()=>o});var i=r(32489),a=r(913885);const o=({domain:e})=>{const t=e.createEvent("fire/statsTrackEvents"),r=e.createEffect("fx/statsTrackEvents");return r.use(a.apiStatsTrackEvents),(0,i.sample)({clock:t,target:r}),{fireTrackEvents:t,trackEventsFx:r}}},288191:(e,t,r)=>{r.d(t,{apiStoriesAskQuestion:()=>y,apiStoriesBanOwner:()=>O,apiStoriesBanQuestionAuthor:()=>I,apiStoriesCreatePostponed:()=>D,apiStoriesDelete:()=>k,apiStoriesDeleteQuestion:()=>T,apiStoriesGet:()=>o,apiStoriesGetArchive:()=>d,apiStoriesGetById:()=>n,apiStoriesGetDetailedStats:()=>S,apiStoriesGetDiscover:()=>c,apiStoriesGetPhotoUploadServer:()=>A,apiStoriesGetQuestions:()=>u,apiStoriesGetReplies:()=>_,apiStoriesGetStats:()=>f,apiStoriesGetVideoUploadServer:()=>R,apiStoriesGetViewers:()=>l,apiStoriesGetWithPrefetch:()=>s,apiStoriesHideAllReplies:()=>P,apiStoriesHidePrivacyBlock:()=>h,apiStoriesHideReply:()=>x,apiStoriesMarkNotInterested:()=>v,apiStoriesMarkSeen:()=>g,apiStoriesMarkSkipped:()=>m,apiStoriesSave:()=>b,apiStoriesSearch:()=>E,apiStoriesSeenReplies:()=>p,apiStoriesSetDiscoverVisible:()=>F,apiStoriesUnbanOwner:()=>N,apiStoriesUnbanQuestionAuthor:()=>w});var i=r(957994),a=r(805658);function o(e){return(0,i.api)("stories.get",e)}function s(e){return(0,a.apiWithPrefetch)("stories.get",e)}function n(e){return(0,i.api)("stories.getById",e)}function c(e){return(0,i.api)("stories.getDiscover",e)}function d(e){return(0,i.api)("stories.getArchive",e)}function l(e){return(0,i.api)("stories.getViewers",e)}function _(e){return(0,i.api)("stories.getReplies",e)}function p(e){return(0,i.api)("stories.seenReplies",e)}function u(e){return(0,i.api)("stories.getQuestions",e)}function f(e){return(0,i.api)("stories.getStats",e)}function S(e){return(0,i.api)("stories.getDetailedStats",e)}function m(e){return(0,i.api)("stories.markSkipped",e)}function v(e){return(0,i.api)("stories.markNotInterested",e)}function E(e){return(0,i.api)("stories.search",e)}function g(e){return(0,i.api)("stories.markSeen",e)}function h(e){return(0,i.api)("stories.hidePrivacyBlock",e)}function k(e){return(0,i.api)("stories.delete",e)}function y(e){return(0,i.api)("stories.askQuestion",e)}function T(e){return(0,i.api)("stories.deleteQuestion",e)}function I(e){return(0,i.api)("stories.banQuestionAuthor",e)}function w(e){return(0,i.api)("stories.unbanQuestionAuthor",e)}function A(e){return(0,i.api)("stories.getPhotoUploadServer",e)}function R(e){return(0,i.api)("stories.getVideoUploadServer",e)}function b(e){return(0,i.api)("stories.save",e)}function O(e){return(0,i.api)("stories.banOwner",e)}function N(e){return(0,i.api)("stories.unbanOwner",e)}function F(e){return(0,i.api)("stories.setDiscoverVisible",e)}function x(e){return(0,i.api)("stories.hideReply",e)}function P(e){return(0,i.api)("stories.hideAllReplies",e)}function D(e){return(0,i.api)("stories.createPostponed",{...e,stories:JSON.stringify(e.stories)})}},837066:(e,t,r)=>{r.d(t,{STORIES_ARCHIVE_START_TIME:()=>o,STORIES_EDITOR_FONTS:()=>s,STORIES_MAX_COUNT_REPLIES:()=>a});var i=r(866467);const a=250,o=1559032200,s=[{label:i.getLang("stories_creator_text_label_modern"),fontFamily:"TT Firs Neue"},{label:i.getLang("stories_creator_text_label_playful"),fontFamily:"TT Knickerbockers Script"},{label:i.getLang("stories_creator_text_label_aesthetic"),fontFamily:"TT Knickerbockers Grotesk"},{label:i.getLang("stories_creator_text_label_dynamic"),fontFamily:"TT Commons Bold",fontStyle:"italic"},{label:i.getLang("stories_creator_text_label_classic"),fontFamily:"TT Barrels Trl"},{label:i.getLang("stories_creator_text_label_elegant"),fontFamily:"TT Barrels Trl Italic",fontStyle:"italic"},{label:i.getLang("stories_creator_text_label_rounded"),fontFamily:"TT Rounds Neue",textTransform:"uppercase"},{label:i.getLang("stories_creator_text_label_standard"),fontFamily:"TT Commons"},{label:i.getLang("stories_creator_text_label_handwritten"),fontFamily:"TT Lovelies Script"},{label:i.getLang("stories_creator_text_label_bookish"),fontFamily:"TT Phobos"}]},828912:(e,t,r)=>{r.d(t,{StoryFeedbackLoadMethods:()=>o,fetchFeedbackFx:()=>n,getStoryFeedbackLoadParams:()=>s});var i=r(564586),a=r(594496),o=function(e){return e[e.getViewers=0]="getViewers",e[e.getReplies=1]="getReplies",e[e.seenReplies=2]="seenReplies",e[e.getQuestions=3]="getQuestions",e[e.getDetailedStats=4]="getDetailedStats",e}({});const s=(e,t)=>({0:{owner_id:e,story_id:t,extended:1,count:100,fields:(0,a.makeOwnerFields)(["photo_100","photo_50"])},1:{owner_id:e,story_id:t,extended:1,fields:(0,a.getStoryOwnerFields)()},2:{owner_id:e,story_id:t},3:{owner_id:e,story_id:t,extended:1,fields:(0,a.makeOwnerFields)(["domain","first_name_dat","first_name_ins","last_name_ins","last_name_dat","first_name_gen","last_name_gen"]),count:100},4:{owner_id:e,story_id:t}}),n=i.storiesDomain.createEffect({name:"fire/storiesGetFeedback",handler:({ownerId:e,storyId:t,pollId:r})=>{const a=s(e,t);return Promise.allSettled([i.storiesService.getViewersFx(a[0]),i.storiesService.getRepliesFx(a[1]),i.storiesService.getQuestionsFx(a[3]),r?i.pollsService.getByIdFx({owner_id:e,poll_id:r}):Promise.resolve(null),i.storiesService.getDetailedStatsFx(a[4])]).then((e=>e.map((e=>"fulfilled"===e.status?e?.value:null)))).finally((()=>{i.storiesService.seenRepliesFx(a[2])}))}})},41903:(e,t,r)=>{r.d(t,{STORIES_ARCHIVE_START_TIME:()=>n.STORIES_ARCHIVE_START_TIME,STORIES_EDITOR_FONTS:()=>n.STORIES_EDITOR_FONTS,STORIES_MAX_COUNT_REPLIES:()=>n.STORIES_MAX_COUNT_REPLIES,StoryFeedbackLoadMethods:()=>d.StoryFeedbackLoadMethods,apiStoriesCreatePostponed:()=>s.apiStoriesCreatePostponed,apiStoriesDelete:()=>s.apiStoriesDelete,apiStoriesGet:()=>s.apiStoriesGet,apiStoriesGetArchive:()=>s.apiStoriesGetArchive,apiStoriesGetById:()=>s.apiStoriesGetById,apiStoriesGetDiscover:()=>s.apiStoriesGetDiscover,apiStoriesGetReplies:()=>s.apiStoriesGetReplies,apiStoriesGetWithPrefetch:()=>s.apiStoriesGetWithPrefetch,apiStoriesSearch:()=>s.apiStoriesSearch,createStoriesService:()=>i.createStoriesService,decodeBase64:()=>a.decodeBase64,faveService:()=>c.faveService,fetchFeedbackFx:()=>d.fetchFeedbackFx,getStoryFeedbackLoadParams:()=>d.getStoryFeedbackLoadParams,narrativesService:()=>c.narrativesService,saveNavigationStatEvent:()=>o.saveNavigationStatEvent,saveViewerStartTime:()=>o.saveViewerStartTime,splitStoryRawId:()=>a.splitStoryRawId,statsService:()=>c.statsService,storiesService:()=>c.storiesService,userService:()=>c.userService});var i=r(898368),a=r(601686),o=r(541756),s=r(288191),n=r(837066),c=r(564586),d=r(828912)},927966:(e,t,r)=>{r.d(t,{FEED_STORIES_BLOCK_OWNER_FIELDS:()=>a,FEED_STORIES_BLOCK_OWNER_MINIMIZED_FIELDS:()=>i});const i=["photo_100"],a=["first_name","last_name","first_name_gen","last_name_gen","first_name_ins","last_name_ins","screen_name","name","is_member","is_closed","photo_50","photo_100","photo_200","friend_status","verified","sex"]},594496:(e,t,r)=>{r.d(t,{getStoryOwnerFields:()=>a,makeOwnerFields:()=>o});var i=r(927966);function a(e=!1){return o(e?i.FEED_STORIES_BLOCK_OWNER_MINIMIZED_FIELDS:i.FEED_STORIES_BLOCK_OWNER_FIELDS)}function o(e){return e.join(",")}},117295:(e,t,r)=>{r.d(t,{transformClickableStickers:()=>m});var i=r(351118),a=r(33305),o=r(540462),s=r(52905),n=r(356812),c=r(866467),d=r(507838),l=r(34231),_=r(646938);const p={hashtag:_.StickerTypes.hashtag,mention:_.StickerTypes.mention,question:_.StickerTypes.question,place:_.StickerTypes.place,music:_.StickerTypes.music,story_reply:_.StickerTypes.storyReply,owner:_.StickerTypes.owner,link:_.StickerTypes.link,market_item:_.StickerTypes.marketItem,post:_.StickerTypes.post,poll:_.StickerTypes.poll,sticker:_.StickerTypes.sticker,app:_.StickerTypes.app,situational_theme:_.StickerTypes.situationalTheme,playlist:_.StickerTypes.playlist,clip:_.StickerTypes.videoButton,vk_video:_.StickerTypes.videoButton,situational_template:_.StickerTypes.situationalTemplate,spoiler:_.StickerTypes.spoiler,service_yc_item:_.StickerTypes.service_yc_item,photo:_.StickerTypes.photo,album:_.StickerTypes.album},u={transparent:1,blue_gradient:2,red_gradient:3,underline:4,blue:5,green:6,white:7,question_reply:8,light:9,impressive:10,dark:11,accent_background:12,accent_text:13,dark_unique:14,light_unique:15,light_text:18,dark_text:19,black:20,dark_without_bg:21,light_without_bg:22,rectangle:23,circle:24,poop:25,heart:26,star:27,album:28,horizontal:29,equalizer:30,header_meta:31,preview:32,miniature:33,fullview:34,cta:35,sticker:36,sticker_and_cta:37,accent:38},f=(e,t=6)=>isNaN(e)?NaN:Number(e.toFixed(t)),S=/^\[(id|club)(\d+)\|(.*)]$/;function m(e,t=[],r=[],m){const v=e?.clickable_stickers;if(!(v&&Object.values(v).length&&v.original_width&&v.original_height))return{original_width:0,original_height:0,stickers:[]};let E=v.original_width,g=v.original_height;Number((g/E).toFixed(2))>1.78&&(g=1.78*E);const h=(v.original_height-g)/2,k=E/100,y=g/100;return{original_width:E,original_height:g,stickers:v?.clickable_stickers?.length?v.clickable_stickers.reduce(((e,v)=>{if(!v)return e;if(m&&"situational_template"===v.type&&!(0,o.partConfigEnabled)("stories_mvk_sticker_template"))return e;if(!m&&"situational_template"===v.type&&!(0,o.partConfigEnabled)("stories_sticker_template"))return e;const{clickable_area:E=[]}=v;if(E.length<4)return e;const g=Math.sqrt(Math.pow(E[1].x-E[0].x,2)+Math.pow(E[1].y-E[0].y,2)),T=Math.sqrt(Math.pow(E[1].x-E[2].x,2)+Math.pow(E[1].y-E[2].y,2));if(!g||!T)return e;const I=E[1].x-E[0].x;let w=180*Math.acos(I/g)/Math.PI;isNaN(w)&&(w=0),E[1].y<E[0].y&&(w=-w);const A=p[v.type],R={id:v.id,type:A,top:f((E[0].y-h)/y/100),left:f(E[0].x/k/100),width:f(g/k/100),height:f(T/y/100),rotate:f(w)};v.style&&(R.style=u[v.style],R.stickerStyle=v.style);let b=!1;switch(A){case _.StickerTypes.hashtag:v.hashtag?R.hashtag=v.hashtag:b=!0;break;case _.StickerTypes.mention:{const e=v.mention?.match(S),i=e?.[1],o=Number(e?.[2]);if(!o||isNaN(o)){b=!0;break}const s="id"===i&&t.find((({id:e})=>e===o)),n=!s&&"club"===i&&r.find((({id:e})=>e===o));s?(R.mentionedPhotoUrl=s.photo_100||s.photo_50||"",R.mentionedOwnerHref=(0,a.getOwnerHref)(s),R.mentionedText=(0,a.getOwnerFullName)(s)):n?(R.mentionedText=n.name||"",R.mentionedPhotoUrl=n.photo_100||n.photo_50||"",R.mentionedOwnerHref=(0,a.getOwnerHref)(n)):b=!0;break}case _.StickerTypes.question:R.question=v.question||"";break;case _.StickerTypes.place:v.place_id?R.placeId=v.place_id:b=!0;break;case _.StickerTypes.music:if(!v.audio){b=!0;break}R.audioId=`${v.audio.owner_id}_${v.audio.id}`,R.audioData=JSON.stringify((0,n.apiAudioToAudioTuple)(v.audio)),v.audio_restrictions&&(R.audioRestriction={code:v.audio_restrictions.id,title:v.audio_restrictions.title,buttonText:v.audio_restrictions.button?.title||"",buttonUrl:v.audio_restrictions.button?.action?.url||""});break;case _.StickerTypes.playlist:if(!v.playlist){b=!0;break}R.playlistOwnerId=v.playlist.owner_id,R.playlistId=v.playlist.id,R.playlistFollowed=Boolean(v.playlist.followed);break;case _.StickerTypes.storyReply:v.owner_id&&(R.ownerId=v.owner_id),R.link=(0,a.getOwnerHref)((0,d.findOwnerById)(v.owner_id,t,r)),v.story_id?R.storyId=v.story_id:R.isExpired=!0;break;case _.StickerTypes.owner:v.owner_id&&(R.ownerId=v.owner_id),R.link=(0,a.getOwnerHref)((0,d.findOwnerById)(v.owner_id,t,r));break;case _.StickerTypes.link:v.link_object?(R.link=v.link_object.url?(0,l.wrapAwayIfExternal)(v.link_object.url,!0):"",R.tooltipText=v.tooltip_text||""):b=!0;break;case _.StickerTypes.marketItem:if(v.market_item)if(R.photoUrl=v.market_item.thumb&&(0,i.getPhotoSize)(v.market_item.thumb,50*devicePixelRatio)?.url||"",R.isRestricted=!1,m)R.link=`/product${v.market_item.owner_id}_${v.market_item.id}`;else{const e=(0,a.getOwnerHref)((0,d.findOwnerById)(v.market_item.owner_id,t,r));R.link=`${e}?w=product${v.market_item.owner_id}_${v.market_item.id}`,R.seoSlug=v.market_item.seo_slug}else b=!0;break;case _.StickerTypes.service_yc_item:const e=window.location;try{if(!v.link_object?.title||!v.link_object?.url){b=!0;break}const t=new URL(v.link_object.url);R.link=e.origin+t.pathname+t.search,R.tooltipText=v.link_object.title}catch{b=!0}break;case _.StickerTypes.photo:v.photo_id&&v.photo_owner_id?(R.photoId=v.photo_id,R.photoOwnerId=v.photo_owner_id):b=!0;break;case _.StickerTypes.post:v.post_owner_id&&(R.postOwnerId=v.post_owner_id),v.post_id?R.postId=v.post_id:b=!0;break;case _.StickerTypes.poll:v.poll?(R.pollId=v.poll.id,R.pollOwnerId=v.poll.owner_id):b=!0;break;case _.StickerTypes.sticker:v.sticker_pack_id?(R.stickerPackId=v.sticker_pack_id,v.sticker_id&&(R.stickerId=v.sticker_id),R.tooltipText=(0,c.getLang)("stories_view_sticker_pack")):b=!0;break;case _.StickerTypes.situationalTheme:v.situational_theme_id?(R.situationalAppId=s.SITPOSTING_APP_ID,R.situationalThemeId=v.situational_theme_id):b=!0;break;case _.StickerTypes.videoButton:v.clip_id||v.video_id?(v.owner_id&&(R.videoOwnerId=v.owner_id),R.videoId=v.clip_id||v.video_id||0,R.videoType=v.clip_id?"clip":"video",R.tooltipText=v.clip_id?(0,c.getLang)("stories_link_attach_clip"):(0,c.getLang)("stories_link_attach_video")):b=!0;break;case _.StickerTypes.situationalTemplate:v.situational_theme_id?(R.situationalAppId=s.SITPOSTING_APP_ID,R.situationalThemeId=v.situational_theme_id,v.situational_replied_users&&(R.situationalRepliedUsers=v.situational_replied_users,R.situationalRepliedAvatars=v.situational_replied_users?.items?.map((e=>{const{photo_100:i}=t.find((t=>t.id===e))||{},{photo_100:a}=r.find((t=>t.id===e))||{},o=i||a;if(o)return{photo_100:o}})).filter((e=>Boolean(e)))||[])):b=!0;break;default:b=!0}return b||e.push(R),e}),[]):[]}}},937625:(e,t,r)=>{r.d(t,{transformDetailedStatsData:()=>p,transformPoll:()=>_,transformStoryQuestions:()=>l});var i=r(866467),a=r(351118),o=r(468073),s=r(33305),n=r(646938);const c=(e="",t="")=>e&&t?`${e} ${t}`:e||t,d=(e,t=32)=>(0,a.getPhotoSize)(e??[],t*window.devicePixelRatio),l=(e,t,r=0,i=0)=>(0,a.isArray)(e)&&(0,a.isArray)(t)?e.map((({id:e,is_anonymous:a,question:n,is_owner_blocked:d,is_published:l,owner_id:_})=>{const p=!a&&window.vk.id!=_&&!o.Ranges.isGroupId(r),u=!a&&window.vk.id!=_,f=t?.find((e=>e?.id===_));return{author:f?{link:(0,s.getOwnerHref)(f),name:(0,s.getOwnerFullName)(f),nameDat:c(f?.first_name_dat,f?.last_name_dat),nameGen:c(f?.first_name_gen,f?.last_name_gen),nameIns:c(f?.first_name_ins,f?.last_name_ins)}:{},canAnswer:p,canBlocked:u,id:e,isAnonymous:a,isOwnerBlocked:d,isPublished:l,ownerId:_,storyId:i,storyOwnerId:r,text:n}})):[],_=e=>{if(!e)return null;const{votes:t,id:r,owner_id:a,question:o,photo:s,background:c,can_vote:l}=e;return{ownerId:a,pollId:r,question:o,votersCountText:t?(0,i.getLang)("voting_N_voted",t):(0,i.getLang)("voting_nobody_voted"),background:s?{type:n.StoryPollBackgroundType.photo,photoUrl:d(s?.images)?.url||"",backgroundColor:s?.color||""}:"gradient"===c?.type?{type:n.StoryPollBackgroundType.gradient,angle:c.angle||0,color:c.color||"",points:c.points||[]}:{type:n.StoryPollBackgroundType.default},needShowResults:!l}},p=e=>e?{preview:e.preview||"",achievement:e.achievement||"",achievementSubtitle:e.achievement_subtitle||"",categories:e.categories?.map((e=>({title:e.header,type:e.type,lines:e.lines.map((e=>({name:e.name||"",type:e.type,counter:e.is_unavailable?(0,i.getLang)("stories_stat_off"):String(e.counter??""),unavailable:e.is_unavailable})))})))||[]}:null},591024:(e,t,r)=>{r.d(t,{transformDetailedStatsData:()=>s.transformDetailedStatsData,transformGetNarrativesResponseToLegacy:()=>i.transformGetNarrativesResponseToLegacy,transformNarrativeGetApiResponseToLegacyFormat:()=>o.transformNarrativeGetApiResponseToLegacyFormat,transformPoll:()=>s.transformPoll,transformStoriesToLegacy:()=>o.transformStoriesToLegacy,transformStoryArchiveResponse:()=>a.transformStoryArchiveResponse,transformStoryGetApiResponseToLegacyFormat:()=>o.transformStoryGetApiResponseToLegacyFormat,transformStoryQuestions:()=>s.transformStoryQuestions});r(117295);var i=r(715614),a=r(506492),o=r(529371),s=r(937625)},529371:(e,t,r)=>{r.d(t,{transformNarrativeGetApiResponseToLegacyFormat:()=>h,transformStoriesToLegacy:()=>T,transformStoryGetApiResponseToLegacyFormat:()=>g});var i=r(891281),a=r(418562),o=r(309205),s=r(33305),n=r(908671),c=r(646938),d=r(866467),l=r(351118),_=r(898848),p=r(507838),u=r(117295),f=r(715614),S=r(369296),m=r(540462),v=r(897976),E=r(190438);function g(e,t,r){const{items:i,profiles:o=[],groups:s=[],reaction_sets:n}=e;return i.map((e=>{const i=e.owner_id||e.stories?.[0]?.owner_id||0,d=(0,p.findOwnerById)(i,o,s)||{id:i},l=(0,m.partConfigEnabled)("stories_preview_for_minimized")&&"feed"===t&&"discover"===e.type?[]:e.stories?.filter(Boolean)||[],_=t===c.StoryListName.feed||t===c.StoryListName.discover,u={id:e.id||(0,a.default)(),author:k(d,o,l[0]?.also_subscribed),has_unseen:e.has_unseen,items:l.map((e=>y(e,d,o,s,r,t))),track_code:e.track_code,can_blacklist:_,app:e.app&&(f=e.app,{url:`/app${f.id}`,name:f.title,photoUrl:f.icon_139||f.icon_150||f.icon_75||""}),type:e.type,send_mask_hash:"",remove_from_blacklist_hash:"",is_narrative:!1,next_from:""};var f;return e.grouped?.length&&(u.grouped=g({items:e.grouped,profiles:o,groups:s},t,r)),n&&(u.reaction_set=I(n)),u}))}function h(e,t,r){const{items:i,profiles:o=[],groups:s=[]}=e;return i.map((e=>{const i=e.owner_id||e.stories?.[0]?.owner_id||0,n=(0,p.findOwnerById)(i,o,s)||{id:i},d=e.stories?.filter(Boolean)||[];return{id:(0,a.default)(),author:k(n,o,d[0]?.also_subscribed),items:d.map((e=>y(e,n,o,s,r,t))),can_blacklist:!1,type:c.StoryBlockType.stories,send_mask_hash:"",remove_from_blacklist_hash:"",next_from:"",is_narrative:!0,narrative:(0,f.transformNarrative)(e,n)}}))}function k(e,t=[],r){const i=e.verified?'<div class="page_verified"></div>':"",a=function(e,t=[]){if(!e)return;const r=[],i=e.user_ids||[];return i.forEach((e=>{const i=t.find((t=>t.id===e));i&&r.push({photo_url:i.photo_50||i.photo_100||"",href:(0,s.getOwnerHref)(i),name:i.first_name||"",sex:i.sex||0})})),{total_count:e.count||0,owners:r}}(r,t);if((0,s.isOwnerUser)(e)){const t=e.id,r=e.first_name||"",o=e.last_name||"",n=e.first_name_gen||"",c=e.last_name_gen||"",d=e.first_name_ins||"",_=(0,s.getOwnerFullName)(e),p=o?`${n} ${c}`:n;return{id:t,name:(0,l.escape)(_),name_get:(0,l.escape)(p),firstName:(0,l.escape)(r),first_name_gen:(0,l.escape)(n),first_name_ins:(0,l.escape)(d),photo:e.photo_100||e.photo_50||"",href:(0,s.getOwnerHref)(e),verify:i,gender:e.sex||0,can_follow:A(e),also_subscribed:a}}const o=-e.id,n=(0,l.escape)(e.name||"");return{id:o,name:n,name_get:n,firstName:n,first_name_gen:n,first_name_ins:n,photo:e.photo_100||e.photo_50||"",href:(0,s.getOwnerHref)(e),verify:i,gender:0,can_follow:A(e),also_subscribed:a}}function y(e,t,r,i,a,f){let S,m,g,h,k;if(e.mask?.owner_id){const t=(0,p.findOwnerById)(e.mask?.owner_id,r,i);t&&(S=t.screen_name,(0,s.isOwnerUser)(t)&&(m=t.sex))}const y=R(t,e),T=!y&&(f===c.StoryListName.feed||f===c.StoryListName.discover);return g=(0,u.transformClickableStickers)(e,r,i,a),h=(0,E.toStoryLink)(e,g),k=!!h&&"audio"===h.object_type,{owner_id:e.owner_id,raw_id:`${e.owner_id}_${e.id}`,date:(0,d.getSmDate)(e.date||0),time:e.date||0,type:F(e),unread:!e.seen,canLike:Boolean(e.can_like),can_comment:b(e),can_share:Boolean(e.can_share),can_remove:O(e,t),can_delete_with_reason:Boolean(e.can_delete_with_reason),can_manage:y,can_ask:Boolean(e.can_ask),can_ask_anonymous:Boolean(e.can_ask_anonymous),canAddToNarrative:e.can_use_in_narrative,stats:{follow:{event_type:"subscribe",rhash:""},url_view:{event_type:"url_view",rhash:""}},isLiked:Boolean(e.is_liked),likesCount:e.likes_count||0,reaction_set_id:e.reaction_set_id||"",user_reaction_id:e.user_reaction_id||0,preview_url:e.blurred_preview||"",preview_thumb_hash:e.photo?.thumb_hash||e.video?.thumb_hash,needMute:Boolean(e.need_mute),muteReply:Boolean(e.mute_reply),isPromo:Boolean(e.is_promo),isProfileQuestion:Boolean(e.is_profile_question),promoCaption:e.is_promo&&e.caption||"",track_code:e.track_code||"",video:{owner_id:e.owner_id,video_id:e.video?.id||0,duration:e.video?.duration||0},vkVideoConfig:e.video?.ov_id?(0,v.constructVideoData)(e.video):void 0,link:h??void 0,isPartOfNarrative:Boolean(e.narratives_count),report_hash:"",maskOwnerDomain:S,maskOwnerSex:m,can_hide_reply:N(e,r,i),noSound:Boolean(e.no_sound),isNewQuestions:y&&Boolean(e.questions?.new),views:Boolean(e.views)?(0,n.formatCount)(e.views||0):"",needShowEmptyStats:Boolean(e.need_show_empty_stats),is_expired:Boolean(e.is_expired),is_deleted:Boolean(e.is_deleted),is_private:!Boolean(e.can_see),isAds:Boolean(e.is_ads),isOneTime:Boolean(e.is_one_time),isOneTimeSeen:Boolean(e.is_one_time)&&!Boolean(e.can_see),seenProgress:0,replies:e.replies?.count?(0,n.formatCount)(e.replies.count):"",replies_new_counter:e.replies?.new||0,clickable_stickers:g,canMarkNotInterested:T,photo_url:e.photo?.sizes&&(0,l.getPhotoSize)(e.photo.sizes,(0,_.isRetina)()?1200:600)?.url||"",small_preview:w(e,a),smallest_preview:w(e,a,!0),video_url:e.video?.files?(0,o.getVideoBestQualityUrl)(e.video.files):"",first_frame:e.video?.first_frame&&(0,l.getPhotoSize)(e.video?.first_frame,800)?.url||"",repliesCountText:"",authorId:0,isMusicCover:k,is_authors_ads:e.is_authors_ads,advertiser_info_url:e.advertiser_info_url,ad_marker:e.ad_marker,caption:e.caption,is_best_friends_privacy:e.is_best_friends_privacy,parent_story:e.parent_story}}function T(e,t,r){const{items:i,profiles:o,groups:s,reaction_sets:n}=e,d=i[0]?.owner_id||0,l=(0,p.findOwnerById)(d,o,s)||{id:d},_=t===c.StoryListName.feed||t===c.StoryListName.discover,u=i.some((e=>!e.seen)),f={id:(0,a.default)(),author:k(l,o,i[0]?.also_subscribed),has_unseen:u,items:i.map((e=>y(e,l,o,s,r,t))),track_code:"",can_blacklist:_,type:c.StoryBlockType.stories,send_mask_hash:"",remove_from_blacklist_hash:"",is_narrative:!1,next_from:""};return n&&(f.reaction_set=I(n)),[f]}function I(e){return e.map((({id:e,items:t})=>(0,S.prepareReactionMenuSet)(e,t.map((e=>({...e,id:e.id}))),{imageMenuSize:{width:96,height:96},imagePreviewSize:{width:32,height:32},imageStoryPanelSize:{width:128,height:128},imageStoryPreviewSize:{width:40,height:40}})))}function w(e,t=!1,r=!1){const i=e.photo?.sizes;if(i)return(0,l.getPhotoSize)(i,t||r?10:(0,_.isRetina)()?600:300)?.url||"";const a=e.video?.first_frame;return a&&(0,l.getPhotoSize)(a,t||r?10:320)?.url||""}function A(e){return(0,s.isOwnerUser)(e)?window.vk.id!==e.id&&(e.friend_status===i.FriendsFriendStatusStatusEnumNames.NOT_A_FRIEND||e.friend_status===i.FriendsFriendStatusStatusEnumNames.INCOMING_REQUEST):!e.is_member&&!e.is_closed}function R(e,t){return(0,s.isOwnerUser)(e)?t.owner_id===e.id&&window.vk.id===e.id:t.owner_id===-e.id&&(t.is_ads?Boolean(e.is_advertiser):Boolean(e.is_admin))}function b(e){return e.can_comment?Boolean(e.can_comment):"live_active"===e.type&&Boolean(e.video?.can_comment)}function O(e,t){return!e.is_deleted&&(!e.can_delete_with_reason&&(!!e.can_delete||R(t,e)&&("photo"===e.type||"video"===e.type)))}function N(e,t,r){if(!e.parent_story_owner_id||!e.parent_story_id)return!1;const i=window.vk.id,a=e.parent_story_owner_id;if(a===i)return!0;const o=(0,p.findOwnerById)(a,t,r);return!!(o&&(0,s.isOwnerGroup)(o)&&o.is_admin)}function F(e){return"photo"===e.type?c.StoryType.PHOTO:"video"===e.type?c.StoryType.VIDEO:"live_active"===e.type||"live_finished"===e.type?c.StoryType.LIVE:c.StoryType.PHOTO}},715614:(e,t,r)=>{r.d(t,{transformGetNarrativesResponseToLegacy:()=>c,transformNarrative:()=>n});var i=r(351118),a=r(33305),o=r(507838),s=r(506492);function n(e,t){const r=`${e.owner_id}_${e.id}`,o=(0,a.isOwnerGroup)(t),n=o&&Boolean(t.is_closed),c={id:e.id,rawId:r,ownerId:e.owner_id,ownerName:(0,i.escape)((o?t.name:(0,a.getOwnerFullName)(t))||""),ownerShortName:(0,i.escape)((o?t.name:(0,a.getOwnerShortName)(t))||""),ownerUrl:(0,a.getOwnerHref)(t),ownerPath:`${o?"club":"id"}${e.owner_id}`,ownerAvatarUrl:t.photo_100||t.photo_50||"",title:(0,i.escape)(e.title),isBookmarked:e.is_favorite,bookmarkHash:"",reportHash:"",canEdit:d(e,t),editHash:"",canView:e.can_see,storiesCount:e.story_ids?.length||0,isOwnerClosedGroup:n,isGroupEditor:n&&Boolean(t.is_admin),url:`${window.location.origin}/narrative${r}`,storyIds:e.story_ids||[],stories:e.stories?.map(s.transformStoryArchive)||[],isDeleted:e.is_delete,date:"",coverUrl:""};if(e.cover){Object.assign(c,{coverUrl:e.cover.cropped_sizes&&(0,i.getPhotoSize)(e.cover.cropped_sizes,300)?.url||"",coverCrop:{x:e.cover.crop_x||0,y:e.cover.crop_y||0,width:e.cover.crop_width||0,height:e.cover.crop_height||0}}),e.cover.custom_photo&&(c.customCover=function(e,t=[]){if(!e)return;return{photoId:e.id,originalPhotoUrl:e.orig_photo?.url||e.sizes&&(0,i.getPhotoSize)(e.sizes,600)?.url||"",previewUrl:t&&(0,i.getPhotoSize)(t,300)?.url||e.sizes&&(0,i.getPhotoSize)(e.sizes,300)?.url||""}}(e.cover.custom_photo,e.cover.cropped_sizes));const t=e.cover.cover_story_id;if(t){Object.assign(c,{coverStoryId:t,coverStoryRawId:`${e.owner_id}_${t}`});const r=e.stories?.find((e=>e?.id===t));r&&(c.coverStory=(0,s.transformStoryArchive)(r))}}return c}function c(e){const{items:t,profiles:r=[],groups:i=[]}=e;return t?.length?t.reduce(((e=[],t)=>{if(!t)return e;const a=(0,o.findOwnerById)(t.owner_id,r,i)||{id:t.owner_id};if(!a)return e;const s=n(t,a);return s?e.concat(s):e}),[]):[]}function d(e,t){const r=Boolean(e.can_delete);let i=!1;if((0,a.isOwnerGroup)(t)){if(e.owner_id!==-t.id)return!1;i=Boolean(t.is_admin)}else{if(e.owner_id!==t.id)return!1;i=window.vk.id===t.id}return!!i&&r}},506492:(e,t,r)=>{r.d(t,{transformStoryArchive:()=>n,transformStoryArchiveResponse:()=>c});var i=r(309205),a=r(351118),o=r(41903),s=r(34231);function n(e){const t=Math.max(e.date?Math.ceil(new Date(1e3*e.date).setUTCHours(0,0,0,0)/1e3):0,o.STORIES_ARCHIVE_START_TIME),r=e.photo?.sizes||e.video?.image,n={id:e.id,rawId:`${e.owner_id}_${e.id}`,listId:`archive${e.owner_id}_${t}`,time:Number(e.date),preview:r&&(0,a.getPhotoSize)(r,350)?.url||"",originalPreviewUrl:r&&(0,a.getPhotoSize)(r,600)?.url||""};return"video"===e.type&&e.video&&Object.assign(n,{videoUrl:e.video.files&&(0,i.getVideoBestQualityUrl)(e.video.files)||"",duration:e.video.duration}),e.link&&Object.assign(n,{linkUrl:(0,s.wrapAwayIfExternal)(e.link.url)||"",linkText:e.link.text||"",linkType:""}),n}function c(e){const{items:t=[]}=e;return t.filter(Boolean).map(n)}},190438:(e,t,r)=>{r.d(t,{toStoryLink:()=>l});var i=r(724913),a=r(70148),o=r(768035),s=r(187966),n=r(884921),c=r(298077);const d=RegExp(`^\\/?audio${i.ANY_RAW_ID_INCLUDABLE_PATTERN}\\/?$`);function l(e,t){let r,l=e.link;return l?(r=function(e,t){let r,l;const _=function(e){let t,r;const s=URL.parse(e.url);if(!s||!n.VK_URL_REGEX.test(s.host))return null;if(t=s.pathname,!d.test(t))return null;if(r=t.match(i.ANY_RAW_ID_INCLUDABLE_REGEXP)?.[0],!r)return null;try{return new a.OwnedIdentity((0,o.parseRawId)(r))}catch(e){return(0,c.logError)(e),null}}(e);if(!_)return null;if(l=function(e,t){return e?.stickers?.find((({audioId:e,audioData:r})=>!!r&&(!!(0,s.isAnyRawId)(e)&&[t.rawId,t.accessRawId].includes(e))))}(t,_),!l)return null;try{return r=JSON.parse(l.audioData),{url:e.url,text:e.text,object_type:"audio",object:r}}catch(e){return(0,c.logError)(e),null}}(l,t),r||{url:l.url,text:l.text}):null}},898368:(e,t,r)=>{r.d(t,{createStoriesService:()=>c});var i=r(32489),a=r(288191),o=r(80963),s=r(755812),n=r(869071);const c=({domain:e})=>{const t=e.createEvent("fire/storiesGet"),r=e.createEvent("fire/storiesGetById"),c=e.createEvent("fire/storiesGetArchive"),d=e.createEvent("fire/storiesGetViewers"),l=e.createEvent("fire/storiesGetReplies"),_=e.createEvent("fire/storiesSeenReplies"),p=e.createEvent("fire/storiesGetQuestions"),u=e.createEvent("fire/storiesGetStats"),f=e.createEvent("fire/storiesGetDetailedStats"),S=e.createEvent("fire/storiesMarkSkipped"),m=e.createEvent("fire/storiesMarkNotInterested"),v=e.createEvent("fire/storiesMarkSeen"),E=e.createEvent("fire/storiesHidePrivacyBlock"),g=e.createEvent("fire/storiesDelete"),h=e.createEvent("fire/storiesAskQuestion"),k=e.createEvent("fire/storiesDeleteQuestion"),y=e.createEvent("fire/storiesBanQuestionAuthor"),T=e.createEvent("fire/storiesUnbanQuestionAuthor"),I=e.createEvent("fire/storiesGetPhotoUploadServer"),w=e.createEvent("fire/storiesGetVideoUploadServer"),A=e.createEvent("fire/storiesSave"),R=e.createEvent("fire/storiesSearch"),b=e.createEvent("fire/storiesUnbanOwner"),O=e.createEvent("fire/storiesBanOwner"),N=e.createEvent("fire/storiesSetDiscoverVisible"),F=e.createEvent("fire/storiesHideReply"),x=e.createEvent("fire/storieHideAllReplies"),P=e.createEffect("fx/storiesGet"),D=e.createEffect("fx/storiesGetById"),C=e.createEffect("fx/storiesGetArchive"),G=e.createEffect("fx/storiesGetViewers"),L=e.createEffect("fx/storiesGetReplies"),B=e.createEffect("fx/storiesSeenReplies"),U=e.createEffect("fx/storiesGetQuestions"),V=e.createEffect("fx/storiesGetStats"),M=e.createEffect("fx/storiesGetDetailedStats"),W=e.createEffect("fx/storiesMarkSkipped"),K=e.createEffect("fx/storiesMarkNotInterested"),H=e.createEffect("fx/storiesMarkSeen"),Y=e.createEffect("fx/storiesHidePrivacyBlock"),Q=e.createEffect("fx/storiesDelete"),$=e.createEffect("fx/storiesAskQuestion"),z=e.createEffect("fx/storiesDeleteQuestion"),j=e.createEffect("fx/storiesBanQuestionAuthor"),q=e.createEffect("fx/storiesUnbanQuestionAuthor"),J=e.createEffect("fx/storiesGetPhotoUploadServer"),X=e.createEffect("fx/storiesGetVideoUploadServer"),Z=e.createEffect("fx/storiesSave"),ee=e.createEffect("fx/storiesSearch"),te=e.createEffect("fx/storiesUnbanOwner"),re=e.createEffect("fx/storiesBanOwner"),ie=e.createEffect("fx/storiesSetDiscoverVisible"),ae=e.createEffect("fx/storiesHideReply"),oe=e.createEffect("fx/storiesHideAllReplies"),se=(0,o.createFriendsAddFx)({domain:e}),ne=(0,o.createFriendsDeleteFx)({domain:e}),ce=(0,s.createGroupsJoinFx)({domain:e}),de=(0,s.createGroupsLeaveFx)({domain:e});return P.use(a.apiStoriesGet),D.use(a.apiStoriesGetById),C.use(a.apiStoriesGetArchive),G.use(a.apiStoriesGetViewers),L.use(a.apiStoriesGetReplies),B.use(a.apiStoriesSeenReplies),U.use(a.apiStoriesGetQuestions),V.use(a.apiStoriesGetStats),M.use(a.apiStoriesGetDetailedStats),W.use(a.apiStoriesMarkSkipped),K.use(a.apiStoriesMarkNotInterested),H.use(a.apiStoriesMarkSeen),Y.use(a.apiStoriesHidePrivacyBlock),Q.use(a.apiStoriesDelete),$.use(a.apiStoriesAskQuestion),z.use(a.apiStoriesDeleteQuestion),j.use(a.apiStoriesBanQuestionAuthor),q.use(a.apiStoriesUnbanQuestionAuthor),J.use(a.apiStoriesGetPhotoUploadServer),X.use(a.apiStoriesGetVideoUploadServer),Z.use(a.apiStoriesSave),ee.use(a.apiStoriesSearch),re.use(a.apiStoriesBanOwner),te.use(a.apiStoriesUnbanOwner),ie.use(a.apiStoriesSetDiscoverVisible),ae.use(a.apiStoriesHideReply),oe.use(a.apiStoriesHideAllReplies),(0,n.connectTrackTmrGroupsJoin)(ce),(0,i.sample)({clock:t,target:P}),(0,i.sample)({clock:r,target:D}),(0,i.sample)({clock:c,target:C}),(0,i.sample)({clock:d,target:G}),(0,i.sample)({clock:l,target:L}),(0,i.sample)({clock:_,target:B}),(0,i.sample)({clock:p,target:U}),(0,i.sample)({clock:u,target:V}),(0,i.sample)({clock:f,target:M}),(0,i.sample)({clock:S,target:W}),(0,i.sample)({clock:m,target:K}),(0,i.sample)({clock:v,target:H}),(0,i.sample)({clock:E,target:Y}),(0,i.sample)({clock:g,target:Q}),(0,i.sample)({clock:h,target:$}),(0,i.sample)({clock:k,target:z}),(0,i.sample)({clock:y,target:j}),(0,i.sample)({clock:T,target:q}),(0,i.sample)({clock:I,target:J}),(0,i.sample)({clock:w,target:X}),(0,i.sample)({clock:A,target:Z}),(0,i.sample)({clock:R,target:ee}),(0,i.sample)({clock:b,target:te}),(0,i.sample)({clock:O,target:re}),(0,i.sample)({clock:N,target:ie}),(0,i.sample)({clock:F,target:ae}),(0,i.sample)({clock:x,target:oe}),{fireGet:t,fireGetById:r,fireGetArchive:c,fireGetViewers:d,fireGetReplies:l,fireSeenReplies:_,fireGetQuestions:p,fireGetStats:u,fireGetDetailedStats:f,fireMarkSkipped:S,fireMarkNotInterested:m,fireMarkSeen:v,fireHidePrivacyBlock:E,fireDelete:g,fireAskQuestion:h,fireDeleteQuestion:k,fireBanQuestionAuthor:y,fireUnbanQuestionAuthor:T,fireGetPhotoUploadServer:I,fireGetVideoUploadServer:w,fireSave:A,fireSearch:R,fireUnbanOwner:b,fireBanOwner:O,fireSetDiscoverVisible:N,fireHideReply:F,fireHideAllReplies:x,getFx:P,getByIdFx:D,getArchiveFx:C,getViewersFx:G,getRepliesFx:L,seenRepliesFx:B,getQuestionsFx:U,getStatsFx:V,getDetailedStatsFx:M,markSkippedFx:W,markNotInterestedFx:K,markSeenFx:H,hidePrivacyBlockFx:Y,deleteFx:Q,askQuestionFx:$,deleteQuestionFx:z,banQuestionAuthorFx:j,unbanQuestionAuthorFx:q,getPhotoUploadServerFx:J,getVideoUploadServerFx:X,saveFx:Z,searchFx:ee,unbanOwnerFx:te,banOwnerFx:re,setDiscoverVisibleFx:ie,hideReplyFx:ae,hideAllRepliesFx:oe,friendsAddFx:se,friendsDeleteFx:ne,groupsJoinFx:ce,groupsLeaveFx:de}}},564586:(e,t,r)=>{r.d(t,{faveService:()=>m,narrativesService:()=>S,pollsService:()=>v,statsService:()=>f,storiesDomain:()=>p,storiesService:()=>u,userService:()=>E});var i=r(32489),a=r(41903),o=r(744030),s=r(942838),n=r(733498),c=r(455673),d=r(373237),l=r(49819),_=r(136335);const p=(0,i.createDomain)("stories"),u=(0,a.createStoriesService)({domain:p}),f=(0,o.createStatsService)({domain:p}),S=(0,s.createNarrativesService)({domain:p}),m=((0,n.createLikesService)({domain:p}),(0,c.createMessagesService)({domain:p}),(0,d.createFaveService)({domain:p})),v=(0,l.createPollsService)({domain:p}),E=(0,_.createUserService)({domain:p})},601686:(e,t,r)=>{function i(e){return(e?.split("_")??[]).map(Number)}function a(e,t="windows-1251"){return new TextDecoder(t).decode(function(e){const t=atob(e);return Uint8Array.from(t,(e=>e.codePointAt(0)||0))}(e))}r.d(t,{decodeBase64:()=>a,splitStoryRawId:()=>i})},901089:(e,t,r)=>{r.d(t,{getStoryList:()=>o,removeStoryList:()=>s,setStoryList:()=>a,transformApiStoryList:()=>n});var i=r(591024);function a(e,t){window.cur[`stories_list_${e}`]=t}function o(e){return window.cur[`stories_list_${e}`]}function s(e){delete window.cur[`stories_list_${e}`]}function n(e,t){return(0,i.transformStoryGetApiResponseToLegacyFormat)(t,e,!1)}},309205:(e,t,r)=>{function i(e){if(!e)return"";const t=/^mp4_(\d+)$/,{url:r}=Object.keys(e).reduce(((r,i)=>{const a=i.match(t);if(!a)return r;const o=Number.parseInt(a[1]);return r.quality<o&&(r.quality=o,r.url=String(e[i]??"")),r}),{url:"",quality:0});return r}r.d(t,{getVideoBestQualityUrl:()=>i})},80963:(e,t,r)=>{r.d(t,{createFriendsAddFx:()=>l,createFriendsAddListFx:()=>S,createFriendsDeleteBulkFx:()=>p,createFriendsDeleteFx:()=>_,createFriendsDeleteListFx:()=>m,createFriendsDeleteSubscriberFx:()=>g,createFriendsEditListFx:()=>v,createFriendsGetFriendsDeletionSuggestionsFx:()=>c,createFriendsGetFx:()=>s,createFriendsGetListsFx:()=>a,createFriendsGetRecentFx:()=>T,createFriendsHideSuggestion:()=>w,createFriendsPrefetchCountersFx:()=>y,createFriendsPrefetchFollowersFx:()=>h,createFriendsPrefetchFx:()=>n,createFriendsPrefetchListsFx:()=>o,createFriendsPrefetchMutualFx:()=>I,createFriendsPrefetchOnlineFx:()=>f,createFriendsPrefetchRecommendationsFx:()=>d,createFriendsPrefetchRequestsFx:()=>u,createFriendsRequestsToSubscribersFx:()=>k,createFriendsSearchFx:()=>E});var i=r(412554);const a=e=>(0,i.createApiEffect)("friends.getLists",e),o=e=>(0,i.createPrefetchEffect)("friends.getLists",e),s=e=>(0,i.createApiEffect)("friends.get",e),n=e=>(0,i.createPrefetchEffect)("friends.get",e),c=e=>(0,i.createApiEffect)("friends.getFriendsDeletionSuggestions",e),d=e=>(0,i.createPrefetchEffect)("friends.getRecommendations",e),l=e=>(0,i.createApiEffect)("friends.add",e),_=e=>(0,i.createApiEffect)("friends.delete",e),p=e=>(0,i.createApiEffect)("friends.deleteBulk",e),u=e=>(0,i.createPrefetchEffect)("friends.getRequests",e),f=e=>(0,i.createPrefetchEffect)("friends.getOnline",e),S=e=>(0,i.createApiEffect)("friends.addList",e),m=e=>(0,i.createApiEffect)("friends.deleteList",e),v=e=>(0,i.createApiEffect)("friends.editList",e),E=e=>(0,i.createApiEffect)("friends.search",e),g=e=>(0,i.createApiEffect)("friends.deleteSubscriber",e),h=e=>(0,i.createPrefetchEffect)("friends.getFollowers",e),k=e=>(0,i.createApiEffect)("friends.requestsToSubscribers",e),y=e=>(0,i.createPrefetchEffect)("friends.getCounters",e),T=e=>(0,i.createApiEffect)("friends.getRecent",e),I=e=>(0,i.createPrefetchEffect)("friends.getMutual",e),w=e=>(0,i.createApiEffect)("friends.hideSuggestion",e)},755812:(e,t,r)=>{r.d(t,{createGroupsEditFx:()=>n,createGroupsGetByIdFx:()=>a,createGroupsGetMembersFx:()=>_,createGroupsInviteFx:()=>d,createGroupsIsMemberFx:()=>c,createGroupsJoinFx:()=>o,createGroupsLeaveFx:()=>s,createGroupsRecallInvitationFx:()=>l});var i=r(412554);const a=e=>(0,i.createApiEffect)("groups.getById",e),o=e=>(0,i.createApiEffect)("groups.join",e),s=e=>(0,i.createApiEffect)("groups.leave",e),n=e=>(0,i.createApiEffect)("groups.edit",e),c=e=>(0,i.createApiEffect)("groups.isMember",e),d=e=>(0,i.createApiEffect)("groups.invite",e),l=e=>(0,i.createApiEffect)("groups.recallInvitation",e),_=e=>(0,i.createApiEffect)("groups.getMembers",e)},884921:(e,t,r)=>{function i(){return"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}}function a(){return i().vk?.__domain||"vk.com"}r.d(t,{VK_URL_REGEX:()=>d,getGlobalObject:()=>i,getHostName:()=>a});const o=e=>e.replace(/([.*+?^${}()|[\]\/\\])/g,"\\$1"),s=(o(a()),["vk.com","vk.ru",a()].filter(((e,t,r)=>r.indexOf(e)===t)).concat(["vkontakte.ru","vk.me","userapi.com"])),n=new RegExp("("+s.map(o).join("|")+")"),c=new RegExp(`([a-zA-Z0-9\\.\\_\\-]+\\.)?${n.source}`),d=new RegExp(`^(https?:\\/\\/)?${c.source}($|\\/(.*))`)},908671:(e,t,r)=>{r.d(t,{formatCount:()=>i});const i=(e,t)=>{const r=t?.separator||".",i=t?.maximumFractionDigits??1,a=t?.roundingMode||void 0,o=t?.kLimit||1e3,s=t?.mLimit||1e6,n=t?.bLimit||1e9,c=window.langConfig?.locale||"ru",d=(e,t)=>{"floor"===a&&(e=Math.floor(e*Math.pow(10,i))/Math.pow(10,i));let o=e.toFixed(i);return Number(o).toLocaleString(c).replace(/\./,r)+t};if(e>-o&&e<o)return e.toLocaleString(c);const l=e/n;if(l>=1||l<=-1)return d(e/1e9,"B");const _=e/s;if(_>=1||_<=-1)return d(e/1e6,"M");const p=e/o;return p>=1||p<=-1?d(e/1e3,"K"):String(e)}}}])}if("undefined"!=typeof window&&window.partConfigEnabled?.("static_loading_execute_errors"))try{e(),window.stManager?.done?.("dist/web/chunks/4ffaf673.8b8bfc0e.js")}catch(e){throw window.stManager?.fail?.("dist/web/chunks/4ffaf673.8b8bfc0e.js",e),e}else e(),"undefined"!=typeof window&&window.stManager?.done?.("dist/web/chunks/4ffaf673.8b8bfc0e.js");