function e(){(self.webpackChunkvkweb=self.webpackChunkvkweb||[]).push([[21576],{804552:(e,t,s)=>{"use strict";s.d(t,{API:()=>h});var r=s(365006),i=s(143626),a=s(976725),o=s(471065),n=s(808869),c=s(208409),u=s(549665);const d="undefined"!=typeof window&&window.vk?.apiConfigDomains?.apiDomain||"api.vk.com";class h extends i.CallbackService{setOptions(e){this.options={...this.options,...e}}execute(e){return this.call("execute",e)}procedure(e,t){return this.call(`execute.${e}`,t)}call(e,t){return this.callWithRequest(new i.APIRequest({method:e,params:t,api:this}))}callWithRequest(e){return this.worker.enqueue(e),e.promise}getWorker(){switch(this.options.mode){case u.APIMode.PARALLEL:return new a.ParallelWorker(this);case u.APIMode.SEQUENTIAL:return new o.SequentialWorker(this)}}constructor(e,t={}){super(),this.globalParams=new Map,this.options={token:"",mode:u.APIMode.SEQUENTIAL,requestMode:u.APIRequestMode.SEQUENTIAL,requestMethod:u.APIRequestMethod.FETCH,wait:3e3,limit:3,bridge:!1,version:r.API_VERSION,baseUrl:`https://${d}`,retryLimit:3,timeout:6e4,executeCount:25,language:"ru",executeUnsupportedMethods:["photos.save","photos.saveWallPhoto","photos.saveOwnerPhoto","photos.saveMessagesPhoto","messages.setChatPhoto","photos.saveMarketPhoto","photos.saveMarketAlbumPhoto","audio.save","docs.save","photos.saveOwnerCoverPhoto","stories.save","polls.savePhoto"],logError:()=>{},...e};for(const t of n.methodGroups)this[t]=new Proxy(Object.create(null),{get:(s,r)=>(s,a)=>{if("toJSON"!==r)return this.callWithRequest(new i.APIRequest({api:this,method:`${t}.${r}`,params:s,options:a}));e.logError&&e.logError(new Error("Internal API: Unsupported api method toJSON"))}});this.worker=this.getWorker(),this.updates=new c.Updates(this,t)}}},328233:(e,t,s)=>{"use strict";s.d(t,{CaptchaType:()=>a,MINIMUM_TIME_INTERVAL_API:()=>i,POLLING_VERSION:()=>r});const r=10,i=1133;var a;!function(e){e.API="API",e.DIRECT_AUTH="DIRECT_AUTH",e.IMPLICIT_FLOW_AUTH="IMPLICIT_FLOW_AUTH",e.ACCOUNT_VERIFICATION="ACCOUNT_VERIFICATION"}(a||(a={}))},602598:(e,t,s)=>{"use strict";s.d(t,{APIError:()=>a});var r=s(695368),i=s(615983);class a extends i.VKError{constructor(e){const t=Number(e.error_code);switch(super({code:t,message:`Code №${t} - ${e.error_msg}`}),this.params=e.request_params,t===r.API_ERROR_CAPTCHA&&(this.captchaSid=Number(e.captcha_sid),this.captchaImg=e.captcha_img),t){case r.API_ERROR_CAPTCHA:this.captchaSid=Number(e.captcha_sid),this.captchaImg=e.captcha_img;break;case r.API_ERROR_AUTH_VALIDATION:this.redirectUri=e.redirect_uri;break;case r.API_ERROR_NEED_CONFIRMATION:this.confirmationText=e.confirmation_text}}}},679885:(e,t,s)=>{"use strict";s.d(t,{ExecuteError:()=>i});var r=s(602598);class i extends r.APIError{constructor(e){super({error_code:e.error_code,error_msg:e.error_msg,request_params:[]}),this.method=e.method}}},149057:(e,t,s)=>{"use strict";s.d(t,{OAuthError:()=>i});var r=s(615983);class i extends r.VKError{constructor({error:e,error_description:t}){super({code:e,message:t})}}},245684:(e,t,s)=>{"use strict";s.d(t,{UpdatesError:()=>i});var r=s(615983);class i extends r.VKError{}},615983:(e,t,s)=>{"use strict";var r;s.d(t,{SharedErrorCode:()=>r,VKError:()=>i}),function(e){e.UNSUPPORTED_MODE="UNSUPPORTED_MODE",e.MISSING_CAPTCHA_HANDLER="MISSING_CAPTCHA_HANDLER",e.MISSING_TOKEN_REGENERATE_HANDLER="MISSING_TOKEN_REGENERATE_HANDLER"}(r||(r={}));class i extends Error{constructor({code:e,message:t}){super(t),this.code=e,this.name=this.constructor.name}}},928388:(e,t,s)=>{"use strict";s.d(t,{CallbackService:()=>i});var r=s(615983);class i{get hasCaptchaHandler(){return void 0!==this.captchaHandler}onCaptcha(e){return this.captchaHandler=e,this}processingCaptcha(e){const{captchaHandler:t}=this;return t?new Promise(((s,r)=>{t(e,(e=>new Promise(((t,i)=>{if(e instanceof Error)return i(e),void r(e);s({key:e,validate:{resolve:t,reject:i}})}))))})):Promise.reject(new r.VKError({code:r.SharedErrorCode.MISSING_CAPTCHA_HANDLER,message:"Missing captcha handler"}))}get hasTokenRegenerateHandler(){return void 0!==this.tokenRegenerateHandler}onTokenRegenerate(e){return this.tokenRegenerateHandler=e,this}processingTokenRegenerate(){const{tokenRegenerateHandler:e}=this;return void 0===e?Promise.reject(new r.VKError({code:r.SharedErrorCode.MISSING_TOKEN_REGENERATE_HANDLER,message:"Missing token regenerate handler"})):new Promise(((t,s)=>{e((e=>new Promise(((r,i)=>{if(e instanceof Error)return i(e),void s(e);t({token:e,validate:{resolve:r,reject:i}})}))))}))}}},317267:(e,t,s)=>{"use strict";s.d(t,{EventDispatcher:()=>r});class r{hasEventListener(e,t,s){return this.listeners.some((r=>!(!s||r.id!==s)||r.type===e&&r.listener===t))}addEventListener(e,t,s={},r){return this.hasEventListener(e,t,r)||this.listeners.push({type:e,listener:t,options:s,id:r}),this}removeEventListener(e,t,s){if(s)return this.listeners=this.listeners.filter((e=>e.id!==s)),this;const r=this.listeners.findIndex((s=>s.type===e&&s.listener===t));return-1!==r&&this.listeners.splice(r,1),this}removeEventListeners(){return this.listeners=[],this}dispatchEvent(e){return this.listeners.filter((t=>t.type===e.type)).forEach((t=>{const{type:s,listener:r,options:{once:i}}=t;r.call(this,e),i&&this.removeEventListener(s,r)})),this}constructor(){this.listeners=[]}}},143626:(e,t,s)=>{"use strict";s.d(t,{APIRequest:()=>r.APIRequest,CallbackService:()=>i.CallbackService});var r=s(176227),i=s(928388)},176227:(e,t,s)=>{"use strict";s.d(t,{APIRequest:()=>n});var r=s(783541),i=s.n(r),a=s(349758),o=s(35006);class n{toString(){return(0,o.getExecuteMethod)(this.method,this.params)}buildParams(e={}){const{options:{token:t,version:s,language:r}}=this.api;return Object.fromEntries([...Object.entries({...!this.isCustomMethod&&{v:s,access_token:t},lang:r,...e}),...this.api.globalParams.entries()].filter((([,e])=>void 0!==e)))}get filteredParams(){return this.buildParams(this.params)}get isCustomMethod(){const{requestMethod:e}=this.api.options;return"function"==typeof e}async make(){const{options:{timeout:e,requestMethod:t}}=this.api;this.timeout=setTimeout((()=>this.options.abortController?.abort()),e);try{return this.isCustomMethod?await this.custom():await this[t]()}finally{clearTimeout(this.timeout)}}fetch(){const{abortController:e,body:t}=this.options,{options:{baseUrl:s}}=this.api,r=new URL(`/method/${this.method}`,s);return void 0!==t&&(r.search=new URLSearchParams(this.buildParams()).toString()),fetch(r,{method:"POST",signal:e?.signal,headers:{connection:"keep-alive"},body:t??new URLSearchParams(this.filteredParams)}).then((e=>e.json()))}bridge(){const{abortController:e}=this.options;return new Promise(((t,s)=>{e?.signal.aborted&&s(e.signal.reason),e?.signal.addEventListener("abort",(()=>{s(e.signal.reason)})),i().send("VKWebAppCallAPIMethod",{method:this.method,params:this.filteredParams}).then(t).catch((e=>{const{error_data:s}=e;t({error:s?.error_reason||s||e})}))}))}script(){const{abortController:e}=this.options,{options:{baseUrl:t}}=this.api;return new Promise(((s,r)=>{e?.signal.aborted&&r(e.signal.reason);const i=(0,a.generateId)(20),o=new URLSearchParams(this.filteredParams);o.set("callback",i);const n=document.createElement("script");n.type="text/javascript",n.async=!0,n.src=new URL(`/method/${this.method}?${o}`,t).toString(),window[i]=e=>{n.remove(),delete window[i],s(e)},e?.signal.addEventListener("abort",(()=>{n.remove(),delete window[i],r(e.signal.reason)})),document.head.appendChild(n)}))}custom(){const{abortController:e}=this.options,{requestMethod:t}=this.api.options;if("function"==typeof t)return new Promise(((s,r)=>{e?.signal.aborted&&r(e.signal.reason),e?.signal.addEventListener("abort",(()=>{r(e.signal.reason)})),t(this.method,this.filteredParams).then(s).catch(r)}))}constructor({api:e,method:t,params:s={},options:r={}}){var i;this.retries=0,this.api=e,this.method=t,this.params={...s},this.options={...r},(i=this.options).abortController??(i.abortController=new AbortController),this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}},840661:(e,t,s)=>{"use strict";s(296540)},767396:(e,t,s)=>{"use strict";s.d(t,{API:()=>r.API,StaticUpdatesManager:()=>o.StaticUpdatesManager,StickersQueueEventType:()=>c.StickersQueueEventType,UpdatesSource:()=>a.UpdatesSource,VKError:()=>i.VKError,VmojiQueueEventType:()=>n.VmojiQueueEventType,getRandomId:()=>u.getRandomId});var r=s(804552),i=(s(549665),s(149057),s(245684),s(679885),s(615983)),a=(s(602598),s(208409)),o=s(987088),n=s(202062),c=s(136331),u=(s(593233),s(417327),s(749495),s(892711),s(677343),s(840661),s(656936));s(209676),s(737328)},808869:(e,t,s)=>{"use strict";s.d(t,{methodGroups:()=>r});const r=["account","accountPersonal","accountVerification","achievements","actionLinks","address","adex","admin","admins","ads","adsint","adsweb","antispam","appWidgets","apps","appsModeration","appsSDK","articles","assets","audio","audioAdmin","audioBooks","audioSearch","auth","authorsMarketplace","autotests","backoffice","badges","bandLink","bestFriends","bid","biz","blogforce","board","bot","botsConf","botscores","bugtracker","bugtrackerAdmin","businessGroups","calls","callsOk","captcha","captchaNotRobot","cashout","catalog","channels","classifieds","combo","coupons","crowd","crowdAdmin","crowdCustomer","crowdService","cua","database","devAdmin","docs","documentation","donut","downloadedGames","ecosystem","ecosystemManager","education","educationCloud","educationEjd","educationExercise","educationExternal","educationMembership","educationOrganization","educationParents","educationPolls","educationReport","educationSchool","educationUser","email","esia","eventHub","exchange","exchangeRates","execute","explore","externalAudioMatching","fave","feedbacks","finance","findMe","fortuneSquare","fortuneWheel","friends","gamesPromo","geo","gifts","goodsOrders","government","groups","healthApp","healthCommon","healthCourses","healthFeed","healthLoyalty","healthSteps","healthWorkouts","id","identity","internal","jobs","leadForms","likes","lovina","loyaltyTeen","market","marketIntegrations","marusia","masks","massClaim","meEducation","memories","messages","messagesEdu","microlandings","moderation","moderationMark","money","multiaccount","music","musicAdmin","musicManager","musicSubscriptions","narratives","newsfeed","nft","nftAdmin","nftMarket","nospam","notes","notifications","odnoklassniki","onboarding","orders","pages","phones","photos","places","platform","platformConsole","podcasts","podcastsOffice","polls","prettyCards","promoCodes","questions","queue","recomSettings","reports","restore","rewardedAds","rightholders","safety","search","secure","serverEffects","serviceBooking","services","settings","settingsGeneral","shortVideo","shortVideoAdmin","situationalSuggests","sms","social","spaces","specials","splashscreens","splashscreensAdmin","statEvents","stats","statsDashboard","status","stickers","storage","store","stories","streaming","strikeSystem","studentsVerification","studio","superApp","superAppPromo","support","supportInternal","tabbar","tags","textlives","tickets","tinkoff","translations","uma","unitedContentPlatform","userActionLog","userLinking","users","utils","uxpolls","verification","video","videoPostcards","vkCharity","vkIdB2BHub","vkIdHub","vkMaps","vkMusic","vkProtect","vkRun","vkStart","vkUp","vkidmail","vkstore","vmoji","voicerooms","wall","weather","widgets","widgetsIOS","widgetsKit","wishlists","zeus"]},549665:(e,t,s)=>{"use strict";var r,i,a;s.d(t,{APIMode:()=>r,APIRequestMethod:()=>a,APIRequestMode:()=>i}),function(e){e.PARALLEL="parallel",e.SEQUENTIAL="sequential"}(r||(r={})),function(e){e.SEQUENTIAL="sequential",e.BURST="burst"}(i||(i={})),function(e){e.FETCH="fetch",e.SCRIPT="script",e.BRIDGE="bridge"}(a||(a={}))},136331:(e,t,s)=>{"use strict";var r;s.d(t,{StickersQueueEvent:()=>i,StickersQueueEventType:()=>r}),function(e){e.UGC_USER_UPDATE="ugc_user_update",e.UGC_PACK_UPDATE="ugc_pack_update",e.UGC_OWNER_UPDATE="ugc_owner_update",e.UGC_STICKER_UPDATE="ugc_sticker_update",e.CACHE_UPDATE="cache_update"}(r||(r={}));class i extends CustomEvent{constructor(e,t){super(e,{detail:t})}}},677343:(e,t,s)=>{"use strict";s.d(t,{StickersCacheUpdate:()=>i});var r=s(136331);class i extends r.StickersQueueEvent{constructor(e){super(r.StickersQueueEventType.CACHE_UPDATE,e)}}},615492:(e,t,s)=>{"use strict";s.d(t,{handlerStickersQueueEvent:()=>u});var r=s(136331),i=s(593233),a=s(417327),o=s(749495),n=s(892711),c=s(677343);function u(e,{data:t}){const{type:s}=t;switch(s){case r.StickersQueueEventType.UGC_PACK_UPDATE:e.dispatchEvent(new i.StickersUGCPackUpdate(t));break;case r.StickersQueueEventType.UGC_USER_UPDATE:e.dispatchEvent(new a.StickersUGCUserUpdate(t));break;case r.StickersQueueEventType.UGC_OWNER_UPDATE:e.dispatchEvent(new o.StickersUGCOwnerUpdate(t));break;case r.StickersQueueEventType.UGC_STICKER_UPDATE:e.dispatchEvent(new n.StickersUGCStickerUpdate(t));break;case r.StickersQueueEventType.CACHE_UPDATE:e.dispatchEvent(new c.StickersCacheUpdate(t))}}},749495:(e,t,s)=>{"use strict";s.d(t,{StickersUGCOwnerUpdate:()=>i});var r=s(136331);class i extends r.StickersQueueEvent{constructor(e){super(r.StickersQueueEventType.UGC_OWNER_UPDATE,e)}}},593233:(e,t,s)=>{"use strict";s.d(t,{StickersUGCPackUpdate:()=>i});var r=s(136331);class i extends r.StickersQueueEvent{constructor(e){super(r.StickersQueueEventType.UGC_USER_UPDATE,e)}}},892711:(e,t,s)=>{"use strict";s.d(t,{StickersUGCStickerUpdate:()=>i});var r=s(136331);class i extends r.StickersQueueEvent{constructor(e){super(r.StickersQueueEventType.UGC_STICKER_UPDATE,e)}}},417327:(e,t,s)=>{"use strict";s.d(t,{StickersUGCUserUpdate:()=>i});var r=s(136331);class i extends r.StickersQueueEvent{constructor(e){super(r.StickersQueueEventType.UGC_USER_UPDATE,e)}}},202062:(e,t,s)=>{"use strict";var r;s.d(t,{VmojiQueueEvent:()=>i,VmojiQueueEventType:()=>r}),function(e){e.AVATAR="avatar",e.STICKERS="stickers",e.CHARACTER="character",e.STICKERS_PRINT_REQUEST="stickers_print_request"}(r||(r={}));class i extends CustomEvent{constructor(e,t){super(e,{detail:t})}}},755315:(e,t,s)=>{"use strict";s.d(t,{handleVmojiQueueEvent:()=>i});var r=s(202062);function i(e,{data:t}){const{type:s,query_id:i}=t;i&&e.dispatchEvent(new r.VmojiQueueEvent(i,t)),e.dispatchEvent(new r.VmojiQueueEvent(s,t))}},208409:(e,t,s)=>{"use strict";s.d(t,{Updates:()=>p,UpdatesSource:()=>r});var r,i,a,o=s(245684),n=s(317267),c=s(755315),u=s(615492),d=s(738193),h=s(328233);!function(e){e.USER="user",e.GROUP="group",e.VMOJI="vmoji",e.STICKERS="stickers"}(r||(r={})),function(e){e.CHECK="a_check",e.RELEASE="a_release"}(i||(i={})),function(e){e.NEED_RESTART="NEED_RESTART",e.POLLING_REQUEST_FAILED="POLLING_REQUEST_FAILED"}(a||(a={}));class p extends n.EventDispatcher{async start(){if(!this.started){this.started=!0;try{const e=await this.getLongPollServer();if(!e)return;const{server:t,key:s,ts:a}=e;switch(0===this.ts&&(this.ts=a),this.url=new URL(t),this.url.searchParams.set("key",s),this.url.searchParams.set("act",i.CHECK),this.url.searchParams.set("wait","25"),this.url.searchParams.set("mode",String(this.mode)),this.url.searchParams.set("version",String(h.POLLING_VERSION)),this.source){case r.VMOJI:case r.STICKERS:this.url.searchParams.set("id",String(this.userId))}this.startFetchLoop()}catch(e){throw this.started=!1,e}}}async getLongPollServer(){let e;switch(this.source){case r.GROUP:e=await this.api.groups.getLongPollServer({group_id:this.groupId});break;case r.VMOJI:case r.STICKERS:e=await this.api[this.source].subscribeToQueue().then((({base_url:e,...t})=>({server:e,...t})));break;default:return}const{server:t}=e;return e.server=`${t.startsWith("https")?"":"https://"}${t}`,e}async stop(){this.started=!1,this.restarted=0}async startFetchLoop(){try{for(;this.started;)await this.fetchUpdates()}catch(e){if(e.code!==a.NEED_RESTART&&this.restarted!==this.retryLimit)return this.restarted+=1,await(0,d.wait)(3e3),void this.startFetchLoop();for(;this.started;)try{await this.stop(),await this.start();break}catch(e){console.log(e),this.started=!0,await(0,d.wait)(this.wait)}}}async fetchUpdates(){this.url.searchParams.set("ts",String(this.ts));const e=new AbortController,t=setTimeout((()=>e.abort()),3e4);let s;try{const t=await fetch(this.url,{method:"GET",signal:e.signal,headers:{connection:"keep-alive"}});if(!t.ok)throw new o.UpdatesError({code:a.POLLING_REQUEST_FAILED,message:"Polling request failed"});s=await t.json()}finally{clearTimeout(t)}if(void 0!==s.failed){if(1===s.failed)return void(this.ts=s.ts);throw this.ts=0,new o.UpdatesError({code:a.NEED_RESTART,message:"The server has been failed"})}this.restarted=0,this.ts=s.ts,s.pts&&(this.pts=Number(s.pts)),s.updates=s.updates||s.events||[];for(const e of s.updates)this.handleUpdate(e)}handleUpdate(e){switch(this.source){case r.VMOJI:(0,c.handleVmojiQueueEvent)(this,e);break;case r.STICKERS:(0,u.handlerStickersQueueEvent)(this,e)}}constructor(e,t={}){super(),this.mode=202,this.started=!1,this.ts=0,this.pts=0,this.restarted=0,this.api=e;const{source:s,userId:r,groupId:i,wait:a,retryLimit:o}=t;this.source=s,this.userId=r,this.groupId=i,this.wait=a||3e3,this.retryLimit=o||3}}},987088:(e,t,s)=>{"use strict";s.d(t,{StaticUpdatesManager:()=>a});var r=s(208409);class i{createObjectWithQueueKeys(e,t){const s={};return e.forEach((e=>{s[e]=t(e)})),s}startListenToQueue(e){this.activeQueues.add(e),this.queues[e].start()}stopListenToQueue(e){this.activeQueues.delete(e),this.listenersCount[e]=0,this.queues[e].stop()}started(e){return this.activeQueues.has(e)}start(e){this.listenersCount[e]+=1,this.started(e)||this.startListenToQueue(e)}stop(e){this.listenersCount[e]<2?this.stopListenToQueue(e):this.listenersCount[e]-=1}constructor(e,t){this.api=e;const s=[r.UpdatesSource.STICKERS,r.UpdatesSource.VMOJI,r.UpdatesSource.GROUP,r.UpdatesSource.USER];this.queues=this.createObjectWithQueueKeys(s,(s=>new r.Updates(e,{...t,source:s}))),this.listenersCount=this.createObjectWithQueueKeys(s,(e=>0)),this.activeQueues=new Set}}class a{static setup(e,t){return a.updates||(a.updates=new i(e,t)),a.updates}}a.updates=void 0},349758:(e,t,s)=>{"use strict";function r(e){const t="abcdefghijklmnopqrstuvwxyz";let s="";for(let r=0;r<e;r++)s+=t.charAt(Math.floor(26*Math.random()));return s}s.d(t,{generateId:()=>r})},737328:(e,t,s)=>{"use strict";var r;s(783541);!function(e){e.WALL="wall",e.DOCS="docs",e.STATS="stats",e.VIDEO="video",e.PAGES="pages",e.NOTES="notes",e.MANAGE="manage",e.MARKET="market",e.PHOTOS="photos",e.STATUS="status",e.GROUPS="groups",e.OFFLINE="offline",e.STORIES="stories",e.FRIENDS="friends",e.MESSAGES="messages",e.APP_WIDGET="app_widget"}(r||(r={}))},93419:(e,t,s)=>{"use strict";function r(e){return`return [${e.join(",")}];`}s.d(t,{getChainReturn:()=>r})},35006:(e,t,s)=>{"use strict";s.d(t,{getExecuteMethod:()=>i});var r=s(9141);function i(e,t={}){return`API.${e}(${(0,r.getExecuteParams)(t)})`}},9141:(e,t,s)=>{"use strict";function r(e){return JSON.stringify(e,((t,s)=>"object"==typeof s&&s!==e?String(s):s))}s.d(t,{getExecuteParams:()=>r})},209676:(e,t,s)=>{"use strict";s(602598),s(149057),s(738193)},656936:(e,t,s)=>{"use strict";function r(){const e=Math.pow(2,32)/2-1;return Math.floor(Math.random()*e)}s.d(t,{getRandomId:()=>r})},764538:(e,t,s)=>{"use strict";function r(e,t){let s=0;t.response.forEach(((r,i)=>{const a=e[i];!1===r?(a.reject(t.errors[s]),s++):a.resolve(r)}))}s.d(t,{resolveExecuteTask:()=>r})},738193:(e,t,s)=>{"use strict";function r(e){return new Promise((t=>{setTimeout(t,e)}))}s.d(t,{wait:()=>r})},976725:(e,t,s)=>{"use strict";s.d(t,{ParallelWorker:()=>n});var r=s(143626),i=s(471065),a=s(93419),o=s(764538);class n extends i.SequentialWorker{async execute(){const{queue:e}=this;if(this.isAllowedMethod(e[0].method))return void super.execute();const{executeCount:t}=this.api.options,s=[];for(let r=0;r<this.queue.length&&(this.isAllowedMethod(e[r].method)||(s.push(e.splice(r,1)[0]),r-=1,!(s.length>=t)));r+=1);if(0===s.length)return;const i=new r.APIRequest({api:this.api,method:"execute",params:{code:(0,a.getChainReturn)(s.map(String))}});super.execute(i);try{(0,o.resolveExecuteTask)(s,await i.promise)}catch(e){for(const t of s)t.reject(e)}}isAllowedMethod(e){return e.startsWith("execute")||this.api.options.executeUnsupportedMethods.includes(e)}}},471065:(e,t,s)=>{"use strict";s.d(t,{SequentialWorker:()=>u});var r=s(695368),i=s(255500),a=s(602598),o=s(679885),n=s(738193),c=s(328233);class u extends i.APIWorker{async execute(e){if(e||(e=this.queue.shift()),!e)return;const{method:t}=e;let s;try{s=await e.make()}catch(t){const{options:s}=this.api;return e.retries===s.limit?(e.captchaValidate?.reject(t),void e.reject(t)):(e.retries+=1,await(0,n.wait)(s.wait),void this.requeue(e))}void 0===s.error?(e.captchaValidate?.resolve(),t.startsWith("execute")?e.resolve({response:s.response,errors:(s.execute_errors||[]).map((e=>new o.ExecuteError(e)))}):e.resolve(s.response??s)):this.handleError(e,new a.APIError(s.error))}async handleError(e,t){const{code:s}=t,{options:i}=this.api;if(e.retries!==i.limit){if(e.retries+=1,s===r.API_ERROR_TOO_MANY)return this.paused?void this.requeue(e):(this.pause(),await(0,n.wait)(c.MINIMUM_TIME_INTERVAL_API),this.requeue(e),void this.resume());if(e.captchaValidate?.reject(t),e.tokenRegenerateValidate?.reject(t),s===r.API_ERROR_CAPTCHA&&this.api.hasCaptchaHandler)try{const{captchaSid:s}=t,{key:r,validate:i}=await this.api.processingCaptcha({type:c.CaptchaType.API,src:t.captchaImg,sid:s,request:e});e.captchaValidate=i,e.params.captcha_sid=s,e.params.captcha_key=r,this.requeue(e)}catch(t){e.reject(t)}else if(s===r.API_ERROR_AUTH&&this.api.hasTokenRegenerateHandler)try{const{token:t,validate:s}=await this.api.processingTokenRegenerate();this.api.options.token=t,e.tokenRegenerateValidate=s,await(0,n.wait)(c.MINIMUM_TIME_INTERVAL_API),this.requeue(e)}catch(t){e.reject(t)}else e.reject(t)}else e.reject(t)}}},255500:(e,t,s)=>{"use strict";s.d(t,{APIWorker:()=>i});var r=s(328233);class i{enqueue(e){this.queue.push(e),this.immediateHeat()}requeue(e){this.queue.unshift(e),this.immediateHeat()}pause(){this.paused=!0}resume(){this.paused=!1,this.immediateHeat()}heat(){if(this.paused||this.busy||!this.queue.length)return;this.busy=!0;const{requestMode:e}=this.api.options;this[e]()}sequential(){this.execute(),setTimeout((()=>{this.busy=!1,this.immediateHeat()}),this.intervalPerRequests)}burst(){const e=Math.min(this.api.options.limit,this.queue.length);for(let t=0;t<e&&0!==this.queue.length;t+=1)this.execute();const t=Math.ceil(r.MINIMUM_TIME_INTERVAL_API-e*this.intervalPerRequests);setTimeout((()=>{this.busy=!1,this.immediateHeat()}),t<=0?r.MINIMUM_TIME_INTERVAL_API:t)}immediateHeat(){setTimeout((()=>this.heat()))}constructor(e){this.busy=!1,this.paused=!1,this.queue=[],this.api=e,this.intervalPerRequests=Math.ceil(r.MINIMUM_TIME_INTERVAL_API/this.api.options.limit)}}},838221:(e,t,s)=>{"use strict";s.d(t,{AsyncAtom:()=>a});var r=s(77783),i=s(879168);class a extends i.Atom{async get(){const e=this.getKey();try{return await(0,r.get)(e,this.base.store)||this.cache||null}catch(t){return console.log(`${e}: Ошибка чтения данных из хранилища`),console.log(t),this.cache||null}}async set(e,t){const s=this.getKey();try{await(0,r.set)(s,e,this.base.store)}catch(t){console.log(`${s}: Не удалось записать данные в хранилище`),console.log(t),this.cache=e}super.set(e,t)}async delete(){const e=this.getKey();delete this.cache;try{await(0,r.del)(e,this.base.store),this.base.notify(this.key)}catch(t){console.log(`${e}: Ошибка удаления ключа из хранилища`),console.log(t)}}constructor(e){super(e);const{base:t}=e;this.base=t}}},955326:(e,t,s)=>{"use strict";s.d(t,{createAsyncStore:()=>n});var r=s(77783),i=s(98184),a=s(838221);class o extends i.Store{createAtom(e){return new a.AsyncAtom({key:e,base:this})}async clear(){await(0,r.clear)(this.store),this.notify()}constructor(e){super(e);const{dbName:t,version:s}=e;try{this.store=(0,r.createStore)(`${t}-v${s}`,t)}catch{}}}function n(e){return new o(e)}},270634:(e,t,s)=>{"use strict";s.d(t,{$context:()=>c,CONTEXT:()=>o,ContextGate:()=>u});var r=s(32489),i=s(293721),a=s(175325),o=function(e){return e.PHOTO_EDITOR="photoEditor",e}({});const n=a.stickersEmojiKeyboard.createEvent(),c=a.stickersEmojiKeyboard.createStore(null).on(n,((e,{context:t})=>t??null)),u=(0,i.createGate)();(0,r.forward)({from:u.state,to:n})},895380:(e,t,s)=>{"use strict";s.d(t,{AtomNameByHelpHintId:()=>n,AtomNameByPromoId:()=>u,AvatarSuggestionAtomName:()=>a,HelpHintAtomNames:()=>o,HelpHintIdTypes:()=>r,HelpHintPromoTypes:()=>i});var r=function(e){return e.VMOJI_AVATAR_SUGGESTION="keyboard:stickers_vmoji_avatar_suggestion",e}({}),i=function(e){return e.VMOJI_AVATAR_SUGGESTION="vmoji_avatar_suggestion_stickers_keyboard_hint",e}({});const a="avatarSuggestion",o=[a],n={"keyboard:stickers_vmoji_avatar_suggestion":a},c="newAvatarSuggestionCounter",u={vmoji_avatar_suggestion_stickers_keyboard_hint:c}},990490:(e,t,s)=>{"use strict";s.d(t,{API:()=>c});var r=s(767396),i=s(719628),a=s(764891),o=s(285627),n=s(869343);class c extends r.API{constructor({onAPIRequest:e,language:t,context:s,logError:c,...u}){super({requestMethod:e,language:t,logError:c},(0,n.isStaticUpdatesManagerEnabled)()?void 0:{userId:u?.userId,source:"stickers"}),this.cache=new i.Cache({api:this,context:s,...u}),(0,n.isStaticUpdatesManagerEnabled)()||(this.updates.addEventListener(r.StickersQueueEventType.UGC_OWNER_UPDATE,a.stickersUGCOwnerUpdateHandler.bind(this)),this.updates.addEventListener(r.StickersQueueEventType.UGC_STICKER_UPDATE,o.stickersUGCStickerUpdateHandler.bind(this)))}}},764891:(e,t,s)=>{"use strict";function r({detail:{owner_global_id:e}}){this.cache.reloadUGC(e)}s.d(t,{stickersUGCOwnerUpdateHandler:()=>r})},285627:(e,t,s)=>{"use strict";s.d(t,{stickersUGCStickerUpdateHandler:()=>a});const r=new Map,i=new Set;async function a({detail:{stickers:e}}){const{peerId:t}=this.cache.options;e.forEach((e=>{if(e.owner_id!==t)return;let s=r.get(t);s||(s=[],r.set(t,s));const i=s.findIndex((t=>t.id===e.id&&t.pack_id===e.pack_id&&t.owner_id===e.owner_id));-1!==i?s[i]=e:s.push(e)})),o.call(this)}async function o(){const{peerId:e}=this.cache.options;if(!e||i.has(e))return;const t=r.get(e);if(!t?.length)return;i.add(e),r.delete(e);const s=await this.cache.ugcPacks.get();if(!s?.length)return;const a=new Map(s.map((e=>[e.id,e])));t.forEach((e=>{const{id:t,pack_id:s}=e;if(void 0===s)return;const r=a.get(s);if(!r)return;const i=r.stickers.findIndex((e=>e.id===t));-1!==i&&(r.stickers[i]=e)}));try{await this.cache.ugcPacks.set(s)}catch{}i.delete(e),o.call(this)}},140143:(e,t,s)=>{"use strict";async function r(){let e=null;try{e=(await this.options.api.store.getFavoriteStickers()).items}catch{}return!!e&&(await this.favoriteStickers.set(e),!0)}s.d(t,{reloadFavoriteStickers:()=>r})},310622:(e,t,s)=>{"use strict";s.d(t,{reloadGlobal:()=>i});var r=s(270634);async function i(e){var t;if(this.reloading)return!0;this.setReloading(!0);const s=await this.global.get();let[i,a,o]=await Promise.all([this.options.api.store.hasNewItems({type:"stickers",version_hash:String(s?.stickers_version_hash)}).catch((()=>null)),this.stockItems.get(),this.imageConfigs.get()]);if(!i)return this.setReloading(!1),!1;(t=i).sticker_packs_version_hashes||(t.sticker_packs_version_hashes=s?.sticker_packs_version_hashes);const{stickers_version_hash:n,sticker_packs_version_hashes:c,favorite_stickers_version_hash:u,image_configs_version_hash:d,sticker_packs_chunk_size_limit:h,vmoji_promotion:p}=i;(n!==s?.stickers_version_hash||e)&&(a=null,await this.stickers.set(new Map));const l=[this.reloadStockItems({cachedStockItems:e?null:a,actualPacksHashes:e?void 0:c,chunkSize:h}),this.reloadUGC(),this.reloadVmoji(),this.reloadRecentStickers()];this.options.context===r.CONTEXT.PHOTO_EDITOR&&l.push(this.reloadPhotoEditorStickers()),(u!==s?.favorite_stickers_version_hash||e)&&l.push(this.reloadFavoriteStickers()),o&&d===s?.image_configs_version_hash&&!e||l.push(this.reloadImageConfigs());const m=!p?.avatar_suggestion?.character_id;!m&&p?.avatar_suggestion?.character_id!==s?.vmoji_promotion?.avatar_suggestion?.character_id?l.push(this.reloadHelpHint()):m&&this.clearAllHelpHint();const g=await Promise.all(l);this.setReloading(!1);const v=-1===g.findIndex((e=>!e));return v&&i&&(this.global.set(i),this.stickersSync.notify(void 0,!0)),v}},187791:(e,t,s)=>{"use strict";s.d(t,{clearAllHelpHint:()=>a,clearHelpHintById:()=>i});var r=s(895380);function i(e){this[r.AtomNameByHelpHintId[e]]?.delete()}function a(){r.HelpHintAtomNames.forEach((e=>this[e].delete()))}},599024:(e,t,s)=>{"use strict";async function r(e){this.clearHelpHintById(e);try{const t=await this.options.api.account.hideHelpHint({hint_id:e});return Boolean(t)}catch(e){return!1}}s.d(t,{hideHelpHint:()=>r})},520729:(e,t,s)=>{"use strict";s.d(t,{reloadHelpHint:()=>i});var r=s(895380);async function i(){let e=r.HelpHintAtomNames.slice(),t=null;try{t=await this.options.api.account.getHelpHints({categories:"vmoji_promo"})}catch{}return t?.items?(t.items.forEach((t=>{const s=t.id,i=r.AtomNameByHelpHintId[s];i in this&&(this[i]?.set(t,{notify:!0}),e=e.filter((e=>e!==i)))})),e.forEach((e=>{this[e].delete()})),!0):(this.clearAllHelpHint(),!0)}},540468:(e,t,s)=>{"use strict";s.d(t,{markHelpHintAsViewed:()=>a});var r=s(895380);const i=(0,s(351118).throttle)((function(e,t,s){e.options.api.stickers.markPromoAsViewed({promo_id:t,count:s}).then((s=>{if(s){e[r.AtomNameByPromoId[t]].set(0)}}))}),3e4);function a(e){const t=this[r.AtomNameByPromoId[e]],s=(t?.get()||0)+1;t.set(s),i(this,e,s)}},741707:(e,t,s)=>{"use strict";async function r(){let e=null;try{e=await this.options.api.store.getStickersImageConfigs()}catch{}return!!e&&(this.imageConfigs.set(e),!0)}s.d(t,{reloadImageConfigs:()=>r})},318680:(e,t,s)=>{"use strict";async function r(){try{const e=await this.options.api.photos.getEditorStickers();this.photoEditorStickers.set(e.items)}catch{}return!0}s.d(t,{reloadPhotoEditorStickers:()=>r})},456690:(e,t,s)=>{"use strict";async function r(){let e=null;try{e=(await this.options.api.messages.getRecentStickers()).items}catch{}return e&&this.recentStickers.set(e),!0}s.d(t,{reloadRecentStickers:()=>r})},598284:(e,t,s)=>{"use strict";async function r(e){if(!e.length)return[];const t=await this.stickers.get()??new Map,s=[];let r=[];for(const i of e){const e=t.get(i);e?r.push(e):s.push(i)}if(!s.length)return r;const i=await this.options.api.store.getStickers({sticker_ids:String(s.join(","))});for(const e of i)e.sticker_id&&t.set(e.sticker_id,e);this.stickers.set(t),r=[];for(const s of e){const e=t.get(s);e&&r.push(e)}return r}s.d(t,{getStickers:()=>r})},514658:(e,t,s)=>{"use strict";async function r({active:e}){let t=await this.stockItems.get();return t&&(t=t.sort((({product:{vmoji_avatar:e}},{product:{vmoji_avatar:t}})=>Number(Boolean(t))-Number(Boolean(e)))),e&&(t=t.filter((({product:e})=>e.active)))),t}s.d(t,{getStockItems:()=>r})},432924:(e,t,s)=>{"use strict";async function r({productId:e,stickerId:t}){const s=await this.stockItems.get();let r;if(s&&(e&&(r=s.find((({product:{id:t}})=>t===e))),t&&!r&&(r=s.find((({product:{stickers:e}})=>e&&-1!==e.findIndex((({sticker_id:e})=>e===t)))))),r)return r;if(e)try{r=await this.options.api.store.getStockItemByProductId({type:"stickers",product_id:String(e)})}catch(e){r=void 0}if(r)return this.updateStockItems([r]),r;if(t)try{r=await this.options.api.store.getStockItemByStickerId({sticker_id:t})}catch(e){r=void 0}return r&&this.updateStockItems([r]),r}s.d(t,{loadStockItems:()=>r})},74737:(e,t,s)=>{"use strict";s.d(t,{reloadStockItems:()=>a});var r=s(351118);const i=new Map;async function a({chunkSize:e=25,cachedStockItems:t,actualPacksHashes:s}){let a=i.get(this.stickersSync.key);a||(a=new Map,i.set(this.stickersSync.key,a));let o=t?.reduce(((e,{product:{id:t},version_hash:r})=>{const i=s?.find((({pack_id:e})=>e===t));if(!i)return e;return i.hash!==r&&e.push(t),e}),[]);const n=!o;if(n)try{const{items:e}=await this.options.api.store.getProducts({type:"stickers",filters:"purchased"});o=e.map((({id:e})=>e))}catch(e){o=void 0}if(!o?.length)return!0;await this.stickers.set(new Map);let c=await Promise.all((0,r.chunkArray)(o,e).map((e=>{const t=String(e);return a?.get(t)||this.options.api.store.getStockItems({type:"stickers",product_ids:t}).then((e=>(a?.set(t,e),e)))}))).then((e=>e.reduce(((e,{items:t})=>(e.push(...t),e)),[]).filter((e=>!Array.isArray(e))))).catch((()=>null));if(!c)return!1;if(t?.length){const e=new Map(c.map((e=>[e.product.id,e])));c=t=t.map((t=>e.get(t.product.id)||t))}return c&&o&&n&&(c=c.sort((({product:{id:e}},{product:{id:t}})=>Number(o?.indexOf(e))-Number(o?.indexOf(t))))),await this.stockItems.set(c),i.delete(this.stickersSync.key),!0}},261657:(e,t,s)=>{"use strict";async function r(e,t){let s=await this.stockItems.get();if(s){const t=new Map(s.map((e=>{const{product:{id:t}}=e;return[t,e]})));e.forEach((e=>{const{product:{id:s}}=e;t.set(s,e)})),s=[...t.values()]}return this.stockItems.set(s||e,t)}s.d(t,{updateStockItems:()=>r})},892816:(e,t,s)=>{"use strict";function r(){this.ugcInfo.delete(),this.ugcPacks.delete()}s.d(t,{clearUGC:()=>r})},843356:(e,t,s)=>{"use strict";async function r(){const e=await this.ugcInfo.get();if(!e?.show_keyboard_onboarding)return!1;const{owner_id:t}=e;e.show_keyboard_onboarding=!1,this.ugcInfo.set(e);try{const e=await this.options.api.stickers.hideUGCKeyboardOnboarding({owner_id:t});return Boolean(e)}catch(e){return!1}}s.d(t,{hideUGCOnboarding:()=>r})},593920:(e,t,s)=>{"use strict";s.d(t,{reloadUGC:()=>a});var r=s(468073),i=s(869343);async function a(e){if(!(0,i.isUgcStickersEnabled)())return this.clearUGC(),!0;const{peerId:t}=this.options;if(!t||!r.Ranges.isChatOrChannelPeer(t))return!0;const s=await this.ugcPacks.get();let a;try{a=(await this.options.api.stickers.getUGCPackLists({owner_ids:String(t),owner_global_ids:e})).lists[0]}catch{}if(!a)return this.ugcInfo.delete(),this.ugcPacks.delete(),!0;this.ugcInfo.set(a);const{items:o}=a;if(!o.length)return this.ugcPacks.delete(),!0;const n=s?new Map(s.map((({id:e,hash:t})=>[e,t]))):void 0,c=o.reduce(((e,{pack_id:t,hash:s})=>{const r=n?.get(t);return r!==s&&e.push(t),e}),[]);if(!c.length)return!0;let u;try{u=(await this.options.api.stickers.getUGCPacks({owner_id:t,pack_ids:String(c)})).packs}catch{}return!u||(this.ugcPacks.set(u),!0)}},938690:(e,t,s)=>{"use strict";async function r(){const e=await this.global.get();e?.vmoji_promotion&&(e.vmoji_promotion.dot_color=void 0,this.global.set(e,{notify:!1}))}s.d(t,{clearVmojiPromotionDot:()=>r})},163034:(e,t,s)=>{"use strict";async function r(){if(this.hasAvatar.get())return!0;try{const e=await this.options.api.vmoji.getAvatar();this.hasAvatar.set(Boolean(e.characters?.length))}catch{}return!0}s.d(t,{reloadVmoji:()=>r})},719628:(e,t,s)=>{"use strict";s.d(t,{Cache:()=>y});var r=s(724361),i=s(955326),a=s(100596),o=s(892816),n=s(593920),c=s(163034),u=s(598284),d=s(599024),h=s(310622),p=s(514658),l=s(520729),m=s(432924),g=s(74737),v=s(261657),f=s(540468),k=s(843356),E=s(741707),A=s(456690),_=s(318680),S=s(938690),b=s(140143),w=s(187791);class y{subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}get reloading(){return this.isReloading}setReloading(e){this.isReloading=e}destroy(){this.stickersSync.destroy(),this.stickersAsync.destroy()}constructor(e){this.isReloading=!1,this.listeners=new Set,this.reload=h.reloadGlobal.bind(this),this.reloadVmoji=c.reloadVmoji.bind(this),this.clearVmojiPromotionDot=S.clearVmojiPromotionDot.bind(this),this.getStockItem=m.loadStockItems.bind(this),this.getStockItems=p.getStockItems.bind(this),this.updateStockItems=v.updateStockItems.bind(this),this.reloadStockItems=g.reloadStockItems.bind(this),this.reloadUGC=n.reloadUGC.bind(this),this.clearUGC=o.clearUGC.bind(this),this.hideUGCOnboarding=k.hideUGCOnboarding.bind(this),this.reloadRecentStickers=A.reloadRecentStickers.bind(this),this.reloadPhotoEditorStickers=_.reloadPhotoEditorStickers.bind(this),this.reloadFavoriteStickers=b.reloadFavoriteStickers.bind(this),this.reloadImageConfigs=E.reloadImageConfigs.bind(this),this.getStickers=u.getStickers.bind(this),this.reloadHelpHint=l.reloadHelpHint.bind(this),this.clearHelpHintById=w.clearHelpHintById.bind(this),this.clearAllHelpHint=w.clearAllHelpHint.bind(this),this.hideHelpHint=d.hideHelpHint.bind(this),this.markHelpHintAsViewed=f.markHelpHintAsViewed.bind(this);const{userId:t,peerId:s}=e;this.options=e;const y=(0,r.createSyncStore)({dbName:"stickers",storeName:String(t),version:1}),I=(0,i.createAsyncStore)({dbName:"stickers",storeName:String(t),version:1});this.stickersSync=y,this.stickersAsync=I,this.global=I.createAtom("global"),this.stockItems=I.createAtom("stockItems"),this.imageConfigs=I.createAtom("imageConfigs"),this.recentStickers=I.createAtom("recentStickers"),this.photoEditorStickers=I.createAtom("photoEditorStickers"),this.favoriteStickers=I.createAtom("favoriteStickers"),this.avatarSuggestion=I.createAtom("avatarSuggestion"),this.stickers=I.createAtom("stickers"),this.hasAvatar=y.createAtom("hasAvatar",a.SyncAtomType.BOOLEAN),this.recentEmoji=y.createAtom("recentEmoji",a.SyncAtomType.OBJECT),this.tabbarActiveTab=y.createAtom("tabbarActiveTab",a.SyncAtomType.STRING),this.stickersActiveTab=y.createAtom("stickersActiveTab",a.SyncAtomType.NUMBER),this.newAvatarSuggestionCounter=y.createAtom("newAvatarSuggestionCounter",a.SyncAtomType.NUMBER);const P=(0,i.createAsyncStore)({dbName:"stickers-ugc",storeName:`${t}-${s}`,version:1});this.ugcAsync=P,this.ugcInfo=P.createAtom("ugcInfo"),this.ugcPacks=P.createAtom("ugcPacks"),this.getStickersImageConfigs=this.imageConfigs.get.bind(this.imageConfigs)}}},869343:(e,t,s)=>{"use strict";s.d(t,{isPopUpStickersEnabled:()=>n,isPromoVmojiCounterEnabled:()=>o,isStaticUpdatesManagerEnabled:()=>c,isUgcStickersEnabled:()=>a});var r=s(528079);function i(e){return Boolean(r.$userEnv.getState()[e])}const a=()=>i("stickers.ugc"),o=()=>i("vmoji.promo.avatar_suggestion.promo_counter"),n=()=>i("stickers.popup"),c=()=>i("static_updates_manager_in_sticker_picker")},783541:function(e,t){!function(e){"use strict";var t=function(){return t=Object.assign||function(e){for(var t,s=1,r=arguments.length;s<r;s++)for(var i in t=arguments[s])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},t.apply(this,arguments)};function s(e,t,s){if(s||2===arguments.length)for(var r,i=0,a=t.length;i<a;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function r(e,s,r){var i=function(e){var t={current:0,next:function(){return++this.current}},s={};return{add:function(r,i){var a=null!=i?i:"".concat(t.next(),"_").concat(e);return s[a]=r,a},resolve:function(e,t,r){var i=s[e];i&&(r(t)?i.resolve(t):i.reject(t),s[e]=null)}}}(r);return s((function(e){if(e.detail&&e.detail.data&&"object"==typeof e.detail.data&&"request_id"in e.detail.data){var t=e.detail.data,s=t.request_id,r=function(e,t){var s={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(s[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(s[r[i]]=e[r[i]])}return s}(t,["request_id"]);s&&i.resolve(s,r,(function(e){return!("error_type"in e)}))}})),function(s,r){return void 0===r&&(r={}),new Promise((function(a,o){var n=i.add({resolve:a,reject:o},r.request_id);e(s,t(t({},r),{request_id:n}))}))}}var i,a,o,n,c,u,d,h="undefined"!=typeof window,p=Boolean(h&&window.AndroidBridge),l=Boolean(h&&window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.VKWebAppClose),m=Boolean(h&&window.ReactNativeWebView&&"function"==typeof window.ReactNativeWebView.postMessage),g=h&&!p&&!l,v=g&&/(^\?|&)vk_platform=mobile_web(&|$)/.test(location.search),f=g?"message":"VKWebAppEvent",k=s(["VKWebAppInit","VKWebAppGetCommunityAuthToken","VKWebAppAddToCommunity","VKWebAppAddToHomeScreenInfo","VKWebAppClose","VKWebAppCopyText","VKWebAppCreateHash","VKWebAppGetUserInfo","VKWebAppSetLocation","VKWebAppSendToClient","VKWebAppGetClientVersion","VKWebAppGetPhoneNumber","VKWebAppGetEmail","VKWebAppGetGroupInfo","VKWebAppGetGeodata","VKWebAppGetCommunityToken","VKWebAppGetConfig","VKWebAppGetLaunchParams","VKWebAppSetTitle","VKWebAppGetAuthToken","VKWebAppCallAPIMethod","VKWebAppJoinGroup","VKWebAppLeaveGroup","VKWebAppAllowMessagesFromGroup","VKWebAppDenyNotifications","VKWebAppAllowNotifications","VKWebAppOpenPayForm","VKWebAppOpenApp","VKWebAppShare","VKWebAppShowWallPostBox","VKWebAppScroll","VKWebAppShowOrderBox","VKWebAppShowLeaderBoardBox","VKWebAppShowInviteBox","VKWebAppShowRequestBox","VKWebAppAddToFavorites","VKWebAppShowStoryBox","VKWebAppStorageGet","VKWebAppStorageGetKeys","VKWebAppStorageSet","VKWebAppFlashGetInfo","VKWebAppSubscribeStoryApp","VKWebAppOpenWallPost","VKWebAppCheckAllowedScopes","VKWebAppCheckBannerAd","VKWebAppHideBannerAd","VKWebAppShowBannerAd","VKWebAppCheckNativeAds","VKWebAppShowNativeAds","VKWebAppRetargetingPixel","VKWebAppConversionHit","VKWebAppShowSubscriptionBox","VKWebAppCheckSurvey","VKWebAppShowSurvey","VKWebAppScrollTop","VKWebAppScrollTopStart","VKWebAppScrollTopStop","VKWebAppShowSlidesSheet","VKWebAppTranslate","VKWebAppRecommend","VKWebAppAddToProfile"],g&&!v?["VKWebAppResizeWindow","VKWebAppAddToMenu","VKWebAppShowInstallPushBox","VKWebAppGetFriends","VKWebAppShowCommunityWidgetPreviewBox","VKWebAppCallStart","VKWebAppCallJoin","VKWebAppCallGetStatus"]:["VKWebAppShowImages"],!0),E=h?window.AndroidBridge:void 0,A=l?window.webkit.messageHandlers:void 0,_=g?parent:void 0;e.EAdsFormats=void 0,(i=e.EAdsFormats||(e.EAdsFormats={})).REWARD="reward",i.INTERSTITIAL="interstitial",e.BannerAdLayoutType=void 0,(a=e.BannerAdLayoutType||(e.BannerAdLayoutType={})).RESIZE="resize",a.OVERLAY="overlay",e.BannerAdLocation=void 0,(o=e.BannerAdLocation||(e.BannerAdLocation={})).TOP="top",o.BOTTOM="bottom",e.EGrantedPermission=void 0,(n=e.EGrantedPermission||(e.EGrantedPermission={})).CAMERA="camera",n.LOCATION="location",n.PHOTO="photo",e.EGetLaunchParamsResponseLanguages=void 0,(c=e.EGetLaunchParamsResponseLanguages||(e.EGetLaunchParamsResponseLanguages={})).RU="ru",c.UK="uk",c.UA="ua",c.EN="en",c.BE="be",c.KZ="kz",c.PT="pt",c.ES="es",e.EGetLaunchParamsResponseGroupRole=void 0,(u=e.EGetLaunchParamsResponseGroupRole||(e.EGetLaunchParamsResponseGroupRole={})).ADMIN="admin",u.EDITOR="editor",u.MEMBER="member",u.MODER="moder",u.NONE="none",e.EGetLaunchParamsResponsePlatforms=void 0,(d=e.EGetLaunchParamsResponsePlatforms||(e.EGetLaunchParamsResponsePlatforms={})).DESKTOP_WEB="desktop_web",d.DESKTOP_WEB_MESSENGER="desktop_web_messenger",d.DESKTOP_APP_MESSENGER="desktop_app_messenger",d.MOBILE_WEB="mobile_web",d.MOBILE_ANDROID="mobile_android",d.MOBILE_ANDROID_MESSENGER="mobile_android_messenger",d.MOBILE_IPHONE="mobile_iphone",d.MOBILE_IPHONE_MESSENGER="mobile_iphone_messenger",d.MOBILE_IPAD="mobile_ipad";var S=function(e){var t=void 0,i=[],a=Math.random().toString(36).substring(2,5);function o(e){i.push(e)}function n(){return l||p}function c(){return g&&window.parent!==window}function u(){return n()||c()}function d(e){if(l||p)return s([],i,!0).map((function(t){return t.call(null,e)}));var r=null==e?void 0:e.data;if(g&&r){if(m&&"string"==typeof r)try{r=JSON.parse(r)}catch(e){}var a=r.type,o=r.data,n=r.frameId;a&&("VKWebAppSettings"!==a?s([],i,!0).map((function(e){return e({detail:{type:a,data:o}})})):t=n)}}m&&/(android)/i.test(navigator.userAgent)?document.addEventListener(f,d):"undefined"!=typeof window&&"addEventListener"in window&&window.addEventListener(f,d);var h=r((function(s,r){E&&E[s]?E[s](JSON.stringify(r)):A&&A[s]&&"function"==typeof A[s].postMessage?A[s].postMessage(r):m?window.ReactNativeWebView.postMessage(JSON.stringify({handler:s,params:r})):_&&"function"==typeof _.postMessage&&_.postMessage({handler:s,params:r,type:"vk-connect",webFrameId:t,connectVersion:e},"*")}),o,a);return{send:h,sendPromise:h,subscribe:o,unsubscribe:function(e){var t=i.indexOf(e);t>-1&&i.splice(t,1)},supports:function(e){return p?!(!E||"function"!=typeof E[e]):l?!(!A||!A[e]||"function"!=typeof A[e].postMessage):!!g&&k.includes(e)},isWebView:n,isIframe:c,isEmbedded:u,isStandalone:function(){return!u()}}}("2.12.2");e.applyMiddleware=function e(){for(var s=[],r=0;r<arguments.length;r++)s[r]=arguments[r];return s.includes(void 0)||s.includes(null)?e.apply(void 0,s.filter((function(e){return"function"==typeof e}))):function(e){if(0===s.length)return e;var r,i={subscribe:e.subscribe,send:function(){for(var t=[],s=0;s<arguments.length;s++)t[s]=arguments[s];return e.send.apply(e,t)}},a=s.filter((function(e){return"function"==typeof e})).map((function(e){return e(i)})).reduce((function(e,t){return function(s){return e(t(s))}}));return r=a(e.send),t(t({},e),{send:r})}},e.default=S,e.parseURLSearchParamsForGetLaunchParams=function(t){var s={};try{new URLSearchParams(t).forEach((function(t,r){switch(r){case"vk_ts":case"vk_is_recommended":case"vk_profile_id":case"vk_has_profile_button":case"vk_testing_group_id":case"vk_user_id":case"vk_app_id":case"vk_group_id":s[r]=Number(t);break;case"sign":case"vk_chat_id":case"vk_ref":case"vk_access_token_settings":s[r]=t;break;case"odr_enabled":s.odr_enabled="1"===t?1:void 0;break;case"vk_is_app_user":case"vk_are_notifications_enabled":case"vk_is_favorite":s[r]=function(e){switch(e){case"0":return 0;case"1":return 1;default:return}}(t);break;case"vk_language":s.vk_language=function(t){return Object.values(e.EGetLaunchParamsResponseLanguages).some((function(e){return e===t}))}(t)?t:void 0;break;case"vk_viewer_group_role":s.vk_viewer_group_role=function(t){return Object.values(e.EGetLaunchParamsResponseGroupRole).some((function(e){return e===t}))}(t)?t:void 0;break;case"vk_platform":s.vk_platform=function(t){return Object.values(e.EGetLaunchParamsResponsePlatforms).some((function(e){return e===t}))}(t)?t:void 0}}))}catch(e){console.warn(e)}return s},Object.defineProperty(e,"__esModule",{value:!0})}(t)},77783:(e,t,s)=>{"use strict";function r(e){return new Promise(((t,s)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>s(e.error)}))}function i(e,t){const s=indexedDB.open(e);s.onupgradeneeded=()=>s.result.createObjectStore(t);const i=r(s);return(e,s)=>i.then((r=>s(r.transaction(t,e).objectStore(t))))}let a;function o(){return a||(a=i("keyval-store","keyval")),a}function n(e,t=o()){return t("readonly",(t=>r(t.get(e))))}function c(e,t,s=o()){return s("readwrite",(s=>(s.put(t,e),r(s.transaction))))}function u(e,t,s=o()){return s("readwrite",(s=>new Promise(((i,a)=>{s.get(e).onsuccess=function(){try{s.put(t(this.result),e),i(r(s.transaction))}catch(e){a(e)}}}))))}function d(e,t=o()){return t("readwrite",(t=>(t.delete(e),r(t.transaction))))}function h(e=o()){return e("readwrite",(e=>(e.clear(),r(e.transaction))))}s.d(t,{clear:()=>h,createStore:()=>i,del:()=>d,get:()=>n,set:()=>c,update:()=>u})}}])}if("undefined"!=typeof window&&window.partConfigEnabled?.("static_loading_execute_errors"))try{e(),window.stManager?.done?.("dist/web/chunks/812ea4bd.21385c0a.js")}catch(e){throw window.stManager?.fail?.("dist/web/chunks/812ea4bd.21385c0a.js",e),e}else e(),"undefined"!=typeof window&&window.stManager?.done?.("dist/web/chunks/812ea4bd.21385c0a.js");