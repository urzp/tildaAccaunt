function t(){"use strict";(self.webpackChunkvkweb=self.webpackChunkvkweb||[]).push([[2276],{551859:(t,e,o)=>{function n(){return{icon:'<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><g id="user_outline_20__Icons" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="user_outline_20__Icons-20/user_outline_20"><g id="user_outline_20__user_outline_20"><path opacity=".1" d="M0 0h20v20H0z"/><path d="M12.5 5a2.5 2.5 0 1 0-5 0 2.5 2.5 0 0 0 5 0ZM14 5a4 4 0 1 1-8 0 4 4 0 0 1 8 0ZM4 15.5c0 .72.36 1 1 1h10c.64 0 1-.28 1-1 0-2.33-2.57-3.5-6-3.5s-6 1.17-6 3.5Zm-1.5 0c0-3.48 3.33-5 7.5-5s7.5 1.52 7.5 5c0 1.63-1.1 2.5-2.5 2.5H5c-1.4 0-2.5-.87-2.5-2.5Z" id="user_outline_20__Icon-Color" fill="currentColor" fill-rule="nonzero"/></g></g></g></svg>',name:"user_outline_20"}}o.d(e,{getIcon20UserOutline:()=>n})},649e3:(t,e,o)=>{function n(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M12.73 11.48a.75.75 0 0 1 .94-.5 7.26 7.26 0 0 1 1.64.71 4.22 4.22 0 0 1 2.15 3.2.75.75 0 0 1-1.49.19 2.72 2.72 0 0 0-1.43-2.1 5.76 5.76 0 0 0-1.3-.56.75.75 0 0 1-.5-.94ZM6 5a4 4 0 1 1 4 4 .75.75 0 0 1 0-1.5A2.5 2.5 0 1 0 7.5 5 .75.75 0 0 1 6 5ZM3.22 17.36c.45.42 1.08.64 1.78.64h9.44l.78.78a.75.75 0 1 0 1.06-1.06L3.78 5.22a.75.75 0 0 0-1.06 1.06l4.48 4.48c-.95.2-1.8.5-2.51.93A4.23 4.23 0 0 0 2.5 15.5c0 .81.27 1.44.72 1.86Zm2.24-4.38A2.74 2.74 0 0 0 4 15.5c0 .46.14.67.25.77.12.11.35.23.75.23h7.94l-4.42-4.42c-1.27.13-2.31.45-3.06.9Z" clip-rule="evenodd"/></svg>',name:"user_slash_outline_20"}}o.d(e,{getIcon20UserSlashOutline:()=>n})},586520:(t,e,o)=>{o.d(e,{EVENT_REPLY_FIELD_IS_NFT_INDEX:()=>l,EVENT_REPLY_FIELD_IS_POST_AUTHOR_INDEX:()=>c,MIN_NFT_IMAGE_SIZE:()=>i,REPLY_IMAGE_DEFAULT_SIZE:()=>a,REPLY_IMAGE_REDESIGN_V3_SIZE:()=>r,REPLY_IMAGE_SMALL_SIZE:()=>s,VISIBILITY_ACCESS_OPTIONS:()=>n});const n={PUBLIC:0,ONLY_FRIENDS:1,ONLY_BEST_FRIENDS:2},i=29,a=34,s=24,r=28,l=16,c=17},821834:(t,e,o)=>{o.d(e,{AddAttachmentEventType:()=>i,AttachmentType:()=>n,POSTING_STATS_NAMES:()=>r,PostingNavScreen:()=>s,SettingsEventType:()=>a});var n=function(t){return t.GeoPlace="geo_place",t.PhotosList="photos_list",t.Group="group",t.PostedPhoto="posted_photo",t.Goods="goods",t.Mask="mask",t.VideoPlaylist="video_playlist",t.Video="video",t.TextpostPublish="textpost_publish",t.Textpost="textpost",t.Textlive="textlive",t.SituationalTheme="situational_theme",t.PrettyCards="pretty_cards",t.Poll="poll",t.Podcast="podcast",t.Photo="photo",t.Page="page",t.Note="note",t.Narrative="narrative",t.MarketAlbum="market_album",t.Market="market",t.Link="link",t.Graffiti="graffiti",t.Geo="geo",t.DonutLink="donut_link",t.Doc="doc",t.Curator="curator",t.AudioPlaylist="audio_playlist",t.Audio="audio",t.Artist="artist",t.Article="article",t.PhotoAlbum="photo_album",t.OnlineBooking="online_booking",t}({}),i=function(t){return t.DeleteAttach="delete_attach",t.AttachPhoto="attach_photo",t.AttachVideo="attach_video",t.AttachMusic="attach_music",t.AttachMyPhoto="attach_my_photo",t.AttachMyVideo="attach_my_video",t.AttachPlaylists="attach_playlists",t.AttachDoc="attach_doc",t.AttachPoll="attach_poll",t.AttachProduct="attach_product",t.AttachAlbum="attach_album",t.AttachArticle="attach_article",t.AttachPlace="attach_place",t}({}),a=function(t){return t.Zoom="zoom",t.RatioChange="ratio_change",t.SelectAuthor="select_author",t.ChangeAuthor="change_author",t.ChangePrivacy="change_privacy",t.SelectPostponed="select_postponed",t.ChangePostponed="change_postponed",t.SelectSubjects="select_subjects",t.ChangeSubjects="change_subjects",t.OpenSettings="open_settings",t.CreateCopyright="create_copyright",t.AttachCopyright="attach_copyright",t.TurnOnNotifications="turn_on_notifications",t.TurnOffNotifications="turn_off_notifications",t.AdTurnOn="ad_turn_on",t.AdTurnOff="ad_turn_off",t.ShowDonsOnly="show_dons_only",t.ShowAll="show_all",t.DonsPostLifetimeChange="dons_post_lifetime_change",t}({}),s=function(t){return t.Profile="profile",t.Feed="feed",t.Community="community",t.Posting="posting",t.PostingAttachPhoto="posting_attach_photo",t.PostingAttachPhotoProfile="posting_attach_photo_profile",t.PostingAttachPhotoCommunity="posting_attach_photo_community",t.PostingAttachMusic="posting_attach_music",t.PostingAttachVideo="posting_attach_video",t.PostingAttachVideoProfile="posting_attach_video_profile",t.PostingAttachVideoCommunity="posting_attach_video_community",t.PostingAttachDocument="posting_attach_document",t.PostingAttachPlace="posting_attach_place",t.PostingAttachPlaylist="posting_attach_playlist",t.PostingAttachPoll="posting_attach_poll",t.PostingAttachGood="posting_attach_good",t.PostingAttachArticle="posting_attach_article",t.PostingAttachArticleProfile="posting_attach_article_profile",t.PostingAttachArticleCommunity="posting_attach_article_community",t.PostingAttachAlbum="posting_attach_album",t.PostingAttachAlbumProfile="posting_attach_album_profile",t.PostingAttachAlbumCommunity="posting_attach_album_community",t.PostingSettings="posting_settings",t.POSTINGTIMEDIALOG="POSTING_TIME_DIALOG",t.PostingCreateCustomPoster="posting_create_custom_poster",t.PostingCloseFriendsSelector="posting_close_friends_selector",t}({});const r={POSTING_INIT:"posting_init",UPLOAD_VIDEO_BY_LINK:"upload_video_by_link",CLOSE_ADD_PHOTO:"close_add_photo",CLOSE_ADD_VIDEO:"close_add_video",UPLOAD_PHOTO:"upload_photo",ATTACH_PHOTO:"attach_photo",ATTACH_ALBUM:"attach_album",SHOW_ALBUM:"show_albums",UPLOAD_VIDEO:"upload_video",ATTACH_VIDEO:"attach_video",CLOSE_MUSIC:"close_music",OPEN_MY_PHOTO:"open_my_photo",OPEN_MY_VIDEO:"open_my_video",OPEN_MUSIC:"open_music",ATTACH_MUSIC:"attach_music",ADD_ARTICLE:"add_article",ADD_CLIP:"add_clip",ADD_FILE:"add_file",UPLOAD_FILE:"upload_file",ADD_MAP:"add_map",ADD_PRODUCT:"add_product",ADD_SURVEY:"add_survey"}},58752:(t,e,o)=>{o.d(e,{PostingItemStatCollector:()=>a});var n=o(317216),i=o(314309);class a{logEvent(t){const e={type:n.ClickProductionStatEventTypes.TYPE_POSTING_ITEM,[n.ClickProductionStatEventTypes.TYPE_POSTING_ITEM]:t},o={type:n.EventItemType.POST};this.clickStatCollector.logEvent(e,o)}constructor(){this.productStatCollector=new i.ProductionStatCollector,this.clickStatCollector=new i.ClickStatCollector(this.productStatCollector)}}},859103:(t,e,o)=>{o.d(e,{getPrimaryCarouselGallery:()=>i});var n=o(335700);function i(t){const e=t.closest(`.${n.UI_GALLERY_CLASSNAME}`);if(!e)return;const o=(0,n.uiGetGallery)(e);return o||void 0}},157281:(t,e,o)=>{o.d(e,{AttachmentsViewSelector:()=>d});var n=o(318227),i=o(972332),a=o(723294),s=o(587258),r=o(58752),l=o(351118);const c=new r.PostingItemStatCollector;class d{setMediaSelectedValue(t){this.addMedia.setAttachView(t)}createTooltip(){const t=this.selectorEl.querySelector(".post_action_tt_content"),e=this.selectorEl.querySelector(".post_action_btn_layout");if(!t||!e)return;const o=(0,n.createPostTooltip)(a.ACTION_BUTTON_ID,this.linkId,void 0,{customShow:!0})?.toooltip;return o&&((0,i.addEvent)(e,"click",(()=>{this._isEnabled&&o.toggle()})),this.selectorEl.querySelectorAll(".radiobtn").forEach((t=>{(0,i.addEvent)(t,"click",this.handleOptionClick.bind(this))}))),o}handleOptionClick(t){if(!(t.currentTarget instanceof HTMLElement))return;const e=t.currentTarget.getAttribute("data-value");if(this.tooltip?.hide(),e){this.setMediaSelectedValue(e),this.selectOption(e);const t=s.ATTACH_VIEW_EVENTS[e];t&&c.logEvent({primary_mode_event:{primary_mode_event_type:t}})}}updateTooltipRadioBtn(t,e){(0,n.updatePostTooltipActionRadioBtn)(t,e,`post_settings_btn${a.ACTION_BUTTON_ID}${this.linkId}`)}updateActionButtonText(t,e){if(e){const o=(0,l.decodeHTMLEntities)(e);t.innerHTML=o,t.setAttribute("aria-label",o)}}selectOption(t){const e=this.selectorEl.querySelector(`[data-value="${t}"]`),o=this.selectorEl.querySelector(".post_action_btn_text");if(!(e instanceof HTMLElement&&o instanceof HTMLElement))return;this.updateTooltipRadioBtn(e,t);const n=e.getAttribute("aria-label")||"";this.updateActionButtonText(o,n)}isHidden(){return this._isHidden}setVisibility(t){let e=t;this._forceHidden&&(e=!1),this.selectorEl.style.display=e?"":"none",this._isHidden=!t}isEnabled(){return this._isEnabled}setEnabled(t){t?this.selectorEl.classList.remove(a.ACTION_BUTTON_DISABLED):this.selectorEl.classList.add(a.ACTION_BUTTON_DISABLED),this._isEnabled=t}constructor(t,e,o,n,i={isHidden:!0,isEnabled:!1,forceHidden:!1}){this.linkId=e,this.selectorEl=o,this.tooltip=this.createTooltip(),this.addMedia=t,this._forceHidden=i.forceHidden,this.selectOption(n),this.setVisibility(!i.isHidden),this.setEnabled(i.isEnabled),this.setMediaSelectedValue(n)}}},926812:(t,e,o)=>{o.d(e,{initAttachmentsViewSelector:()=>r});var n=o(157281),i=o(644742),a=o(540462),s=o(723294);const r=({linkId:t,postActionsEl:e,addMedia:o,initValue:r,isGridOnly:l,isCarouselOnly:c})=>{if(!(e instanceof HTMLElement))return;const d=(0,i.renderTemplate)("primary_attachments_view_template",{link_id:t});if(!d)return;const _=e.querySelector(".post_postpone")||e.querySelector(".PostDonutDuration")||e.querySelector(".post_available");_?_.parentNode?.insertBefore(d,_.nextSibling):e.insertBefore(d,e.firstChild);const u=new n.AttachmentsViewSelector(o,t,d,r??(0,i.getAttachmentsPrimaryModeDefaultValue)(),{isHidden:!0,isEnabled:!1,forceHidden:Boolean(l||c)}),p=t=>{t?(u.setVisibility(!0),u.setEnabled(!0)):u.setVisibility(!1)};return p(o.getMediaUIViewSelectorAvailable()),o.emitter.on(o.eventTypes.previewUpdate,p),o.emitter.on(o.eventTypes.viewDraw,p),{setOption:t=>{u.selectOption(t)},onClear:()=>{u.setVisibility(!1),(0,a.partConfigEnabled)("attachments_primary_mode_web_carousel_force_default")&&u.selectOption(s.ATTACHMENT_PRIMARY_MODE.carousel)}}}},644742:(t,e,o)=>{o.d(e,{getAttachmentsPrimaryModeDefaultValue:()=>h,getAttachmentsPrimaryModeParam:()=>d,renderTemplate:()=>c,saveAttachmentsPrimaryModeDefaultValue:()=>p});var n=o(723294),i=o(593159),a=o(754866),s=o(469004),r=o(540462),l=o(700230);const c=(t,e)=>{const o=(0,i.getTemplate)(t,e);return o?(0,a.se)(o):null},d=t=>{const e=document.getElementById(`${n.ACTION_BUTTON_ID}${t}`);if(e?.classList.contains(n.ACTION_BUTTON_DISABLED))return;const o=e?.querySelector(".radiobtn.on")?.getAttribute("data-value");return o?{primary_attachments_mode:o}:void 0},_="posting_attachments_primary_mode_default_value",u=()=>`${_}_${window.vk.id}`,p=t=>{s.ls.set(u(),t)},h=t=>{if((0,r.partConfigEnabled)("attachments_primary_mode_web_carousel_force_default"))return n.ATTACHMENT_PRIMARY_MODE.carousel;if(t?.isCarouselOnly)return n.ATTACHMENT_PRIMARY_MODE.carousel;if(t?.isGridOnly)return n.ATTACHMENT_PRIMARY_MODE.grid;const e=(0,r.partConfigEnabled)("attachments_primary_mode_web_carousel_default_feature")||(0,l.isCarouselCropEnabled)()?n.ATTACHMENT_PRIMARY_MODE.carousel:n.ATTACHMENT_PRIMARY_MODE.grid;let o;return o=s.ls.get(u())??s.ls.get(_)??e,n.ATTACHMENT_PRIMARY_MODE[o]??e}},272556:(t,e,o)=>{o.d(e,{getPostTopicSelectorParams:()=>i.getPostTopicSelectorParams,initPostTopicCreatingSelector:()=>c,initPostTopicEditingSelector:()=>d,isPostTopicEditingEnabled:()=>i.isPostTopicEditingEnabled,isPostTopicSettingEnabled:()=>i.isPostTopicSettingEnabled,topicUISelectorHide:()=>r.topicUISelectorHide});var n=o(525179),i=o(359813),a=o(974189),s=o(898e3),r=o(337249);const l=(t,e,o,i)=>{const r=n.TopicUISelector.create(e,{linkId:t,selectTopicId:a.selectTopicId});if(r)return(0,a.initActionsParamsState)(t,r,i),r.selectTopicId(o[s.WallPostParams.topicId]),{clearSelection:()=>{r.clearSelection()},onDestroy:()=>{r.destroy()}}},c=(t,e,o)=>l(t,e,{[s.WallPostParams.topicId]:i.TOPIC_ID_NONE},o),d=(t,e,o,n)=>l(t,e,{[s.WallPostParams.topicId]:o[s.WallPostParams.topicId]??i.TOPIC_ID_NONE},n)},898e3:(t,e,o)=>{o.d(e,{WallPostParams:()=>n});var n=function(t){return t.topicId="topic_id",t}({})},974189:(t,e,o)=>{o.d(e,{getActionParams:()=>r,getSelectorRegistry:()=>a,initActionsParamsState:()=>s,selectTopicId:()=>c});var n=o(898e3);let i=new Map;const a=t=>i.get(t),s=(t,e,o)=>((t,e)=>i.set(t,e))(t,{actionParams:void 0,selector:e,onChange:o}),r=t=>i.get(t)?.actionParams,l=(t,e)=>{((t,e)=>{const o=i.get(t);void 0!==o&&i.set(t,e(o))})(t,(t=>(t?.onChange&&t.onChange(e?.topic_id),{...t,actionParams:e})))},c=(t,e)=>{l(t,{[n.WallPostParams.topicId]:e})}},359813:(t,e,o)=>{o.d(e,{TOPIC_ID_NONE:()=>a,getPostTopicSelectorParams:()=>s,isPostTopicEditingEnabled:()=>l,isPostTopicSettingEnabled:()=>r});var n=o(898e3),i=o(974189);const a=-1,s=t=>{const e=(0,i.getActionParams)(t)?.[n.WallPostParams.topicId];return void 0!==e&&e!==a?{[n.WallPostParams.topicId]:e}:void 0},r=t=>!0===t?.wallPostTopicSettingEnabled,l=t=>void 0!==t.topic_options},525179:(t,e,o)=>{o.d(e,{TopicUISelector:()=>_});var n=o(250598),i=o(754866),a=o(972332),s=o(337249),r=o(359813),l=o(898848),c=o(581197),d=o(318227);class _{static create(t,e){const o=(0,s.renderSelector)(t,e.linkId);if(!o)return;const n=this.getSelectorContentEl(o),a=(0,i.domQuery1)(".post_action_btn_layout",o);return n&&a?new _(a,o,e,n):void 0}static getSelectorContentEl(t){return(0,i.domQuery1)(".post_action_tt_content",t)}destroy(){this.tooltip.destroy(),delete window.radioBtns[this.radioBtnId]}tooltipHide(){this.tooltip.hide()}selectTopicId(t){this.options.selectTopicId(this.linkId,t),this.updateViewForSelectedTopic({isTopicSelected:t!==r.TOPIC_ID_NONE,topicId:t})}clearSelection(){this.selectTopicId(r.TOPIC_ID_NONE)}updateViewForSelectedTopic({isTopicSelected:t,topicId:e}){const o=_.getSelectOptionEl(this.containerEl,e),n=o&&(0,c.getJsonDataValue)(o,"data-click-params"),a=(0,i.domQuery1)(".post_action_btn_text",this.containerEl);if(!o||!n||!a)return;const{label:r}=n;(0,d.updatePostTooltipActionRadioBtn)(o,void 0,(0,s.getTooltipId)(this.options.linkId));const u=a.getAttribute("data-empty")||"",p=t?r:u;a.innerHTML=p,a.setAttribute("aria-label",(0,l.replaceEntities)(p)),(0,i.toggleClass)(this.containerEl,"on",t)}static getSelectOptionEl(t,e){return(0,i.domQuery1)(`[data-value="${e}"]`,t)}constructor(t,e,o,r){this.btnEl=t,this.containerEl=e,this.options=o,this.selectorContentEl=r,this.onOptionClickWrapper=(...t)=>{this.tooltip.hide();const e=t[0].currentTarget;if(!(e instanceof HTMLElement))return;const o=(0,c.getJsonDataValue)(e,"data-click-params");o&&this.selectTopicId(o.value)},this.linkId=this.options.linkId,this.radioBtnId=(0,s.getTooltipId)(this.options.linkId),window.radioBtns[this.radioBtnId]={val:!1,els:r.children},this.tooltip=new n.ElementTooltip(t,{appendTo:e,forceSide:"bottom",autoShow:!1,cls:"eltt_fancy eltt_fancy_actions",noOverflow:!1,centerShift:0,offset:[-12*(window.vk.rtl?-1:1),7],content:r,align:"left",onFirstTimeShow:()=>{(0,i.show)(r)}}),(0,i.domQuery)('[data-onclick="togglePostTopic"]',e).forEach((t=>{(0,a.addEvent)(t,"click",this.onOptionClickWrapper)}))}}},337249:(t,e,o)=>{o.d(e,{getTooltipId:()=>s,renderSelector:()=>r,topicUISelectorHide:()=>l});var n=o(754866),i=o(593159),a=o(974189);const s=t=>`post_discover_category_btn${t}`,r=(t,e)=>{const o=(t=>{const e=(0,i.getTemplate)("postCategorySelect",t);return e?(0,n.se)(e):null})({link_id:String(e)});if(t instanceof HTMLElement&&o instanceof HTMLElement)return t.appendChild(o),o},l=t=>{(0,a.getSelectorRegistry)(t)?.selector?.tooltipHide()}},68586:(t,e,o)=>{o.d(e,{updatePost:()=>l});var n=o(581197),i=o(538522),a=o(15874),s=o(540462),r=o(27276);function l(t,e,o={}){const{ownerId:l,itemId:c}=(0,a.getOriginalId)((0,i.joinRawId)({ownerId:e,itemId:t}));if(!l||!c)return Promise.reject();const d=(0,i.joinRawId)({ownerId:l,itemId:c});let _="feed";return window.wkcur?.shown||window.cur?.onepost?_="post":["wall","profile","groups","wall_donut","public"].includes(window.cur?.module)&&(_="wall"),new Promise(((t,e)=>{window.ajax.post("al_wall.php",{act:"s_one",post_id:c,owner_id:l,render_context:_,only_post:!0,...o},{onDone:(e,o,i)=>{let l=!1;if(!e)return void t({newPostString:e,params:o,postWasEdited:l});const c=(0,a.getWallPostElemByFullId)(d),u=(0,a.getLayerPostElemByFullId)(d),p=window.wkcur?.pageReplaced?.[0]?.[0];if(!c&&!u)return void t({newPostString:e,params:o,postWasEdited:l});const h=(0,n.createElementFromHTML)(e);if(h){l=!0;const t=".PostHeader",e=".CoauthorInviteBanner",o=".wall_post_cont",n=h.querySelector(t),i=h.querySelector(o),a=h.querySelector(e);[c,u,p].filter(Boolean).forEach((s=>{if(!s)return;const r=s.querySelector(t);if(r&&n&&r.replaceWith(n.cloneNode(!0)),i&&s.querySelector(o)?.replaceWith(i.cloneNode(!0)),"post"!==_)return;const l=s.querySelector(e);if(a){const e=s.querySelector(t);l?l.replaceWith(a.cloneNode(!0)):e&&e.parentElement.insertBefore(a.cloneNode(!0),e)}else l?.remove()}))}i&&(0,s.partConfigEnabled)("feed_fix_restoration_of_posts")&&(0,r.updatePostContentContainerDataCopy)(i),t({newPostString:e,params:o,postWasEdited:l})},onFail:t=>(e(t),!1)})}))}},614320:(t,e,o)=>{o.d(e,{checkPostLen:()=>p,getPostAvatarString:()=>h,removeUnseenStories:()=>_,showPostponePostWithVideoInfo:()=>m});var n=o(754866),i=o(593159),a=o(952661),s=o(866467),r=o(15874),l=o(783759),c=o(43899),d=o(586520);function _(t){if(u(document,t),window.wkcur?.pageReplaced)for(let e of window.wkcur.pageReplaced)u(e[0],t)}function u(t,e){const o=t.querySelectorAll(".reply_image_stories_unseen"+e);for(const t of o)t.classList.remove("reply_image_stories_unseen","reply_image_stories_unseen"+e),(0,r.replyUserImageLinkClosest)(t)?.removeAttribute("onclick");(0,l.removeRichAvatarOutlineAtNode)(t,String(e),"stories_unseen");const n=t.querySelectorAll(".post_image_stories_unseen"+e);for(const t of n)t.classList.remove("post_image_stories_unseen","post_image_stories_unseen"+e),t.closest(".post_image, ._post_image")?.removeAttribute("onclick")}function p(t,e,o,r){if(!t)return;const l=window.cur.options?.max_post_full_length;if(!l)return!0;const c=(0,n.ge)(t);if(!c)return;let d=(0,i.trim)(window.Emoji.val(c)).replace(/\n\n\n+/g,"\n\n");if(c.lastLen===d.length&&!r)return c.lastLen<=l;const _=c.lastLen=d.length;if(e=(0,n.ge)(e),_>l-100){const t=_>l;if(e&&(t?(o&&(a.FlatButton.isFlatButton(o)?a.FlatButton.setDisabled(o,!0):(0,n.toggleClass)(o,"button_disabled",!0)),e.innerHTML=(0,s.getLang)("text_exceeds_symbol_limit",_-l),(0,n.toggleClass)(e,"post_field_warning_red",!0)):e.innerHTML=(0,s.getLang)("text_N_symbols_remain",l-_),(0,n.show)(e)),t)return!1}else e&&(0,n.hide)(e);return e&&(0,n.toggleClass)(e,"post_field_warning_red",!1),o&&(a.FlatButton.isFlatButton(o)?a.FlatButton.setDisabled(o,!1):(0,n.toggleClass)(o,"button_disabled",!1)),!0}const h=(t,e,o=d.REPLY_IMAGE_DEFAULT_SIZE,n=!1,i,a="")=>{const s=[e,"_post_field_image"];return i&&s.push(i),(0,c.renderAvatarToString)(t,o,null,s,null,void 0,!1,void 0,a,!(o<d.MIN_NFT_IMAGE_SIZE)&&n)},m=(t,e,o)=>{const n=document.querySelector(`#${t}`);if(!n)return;let i="",a="";const r=o.filter((t=>"video"===t[0])),l=Number(r.reduceRight(((t,e)=>e[e.length-1]?.publish_date||t),0));if(l)if(e){if(1===r.length&&e===l||0===r.length)return void(n.innerHTML="");r.length>1?(i=(0,s.getLang)("wall_post_with_video_different_dates_title"),a=(0,s.getLang)("wall_post_with_video_different_dates_info")):e>l?(i=(0,s.getLang)("wall_post_with_video_later_title"),a=(0,s.langDate)(1e3*l,(0,s.getLang)("wall_post_with_video_later_info"),0,(0,s.getLang)("months_of"))):e<l&&(i=(0,s.getLang)("wall_post_with_video_earlier_title"),a=(0,s.langDate)(1e3*e,(0,s.getLang)("wall_post_with_video_earlier_info"),0,(0,s.getLang)("months_of")))}else r.length>1?(i=(0,s.getLang)("wall_post_with_video_different_dates_title"),a=(0,s.getLang)("wall_post_with_video_different_dates_info")):1===r.length&&(i=(0,s.getLang)("wall_post_with_video_publish_together_title"));n.innerHTML=i?`\n      <div class="BannerInfo BannerInfo--warn BannerInfo--hasIcon BannerInfo--noHorizontalMargin BannerInfo--noTopMargin">\n        <div class="media_info_title">${i}</div>\n        ${a?`<div class="media_info_desc">${a}</div>`:""}\n      </div>`:""}},27276:(t,e,o)=>{o.d(e,{legacyActions:()=>c,onInitiatorRender:()=>d,restorePostContentContainer:()=>u,updatePostContentContainerDataCopy:()=>_});var n=o(396445),i=o(414623),a=o(142278),s=o(351118),r=o(866467),l=o(40103);const c={navigate:(t,e,o)=>{t&&(e||window.nav.go(t),(o||e)&&window.open(t,"_blank","noopener,noreferrer"))},showDonutSubscribePopup:(t,e,o)=>{(0,n.showDonutSubscribePopup)(t,e,window.nav.objLoc.source,{type:"subscribe",params:{act:"subscribe_popup"},levelId:o?.levelId,onSuccessPayment:o?.onSuccessPayment})},showWiki:i.showWiki,onBlurredObsceneTextClick:(t,e)=>window.ObsceneTextAlertBox?.showBox(t.currentTarget,t,(0,r.getLang)("wall_obscene_box_alert_title"),(0,r.getLang)("wall_obscene_box_alert_content"),(0,r.getLang)("wall_obscene_box_alert_confirmation_button"),e),showOneTimeDonutLayer:t=>{(0,l.initOneTimeDonut)(t)}},d=t=>{const e=`${t.item.owner_id}_${t.item.id}`;window.cur.postContentContainerDataCopy?.[e]||(window.cur.postContentContainerDataCopy={...window.cur.postContentContainerDataCopy,[e]:t})},_=t=>{const e=`${t.owner_id}_${t.id}`,o=window.cur.postContentContainerDataCopy;o?.[e]&&(o[e]={...o[e],item:t})},u=t=>{const e=document.getElementById(`post${t}`),n=e?.querySelector(".PostContentContainer");if(!n)return;const i=(0,a.createReactLazyInitiator)((()=>(0,s.asyncImportLoader)((()=>Promise.all([o.e(91498),o.e(89631),o.e(762),o.e(79210),o.e(63616),o.e(20157),o.e(25990),o.e(17e3),o.e(15113),o.e(28261),o.e(12164),o.e(6591),o.e(28816),o.e(79331),o.e(78917),o.e(66119),o.e(72516),o.e(29528),o.e(34934),o.e(63453),o.e(60229),o.e("langs/web/PostContentContainer")]).then(o.bind(o,386757))),3).then((({PostContentContainerWeb:t})=>t))),n);window.cur.postContentContainerDataCopy?.[t]&&i.render(window.cur.postContentContainerDataCopy[t])}},562436:(t,e,o)=>{o.d(e,{CarouselRatioSelector:()=>m});var n=o(318227),i=o(972332),a=o(806917),s=o(866467),r=o(553608),l=o(984745),c=o(632731),d=o(58752),_=o(821834),u=o(935531),p=o(700230);const h=new d.PostingItemStatCollector;class m{checkOriginalRatio(){if(!(0,p.isCarouselCorridorEnabled)())return;const t=this.addMedia.getAutoRatio(),e=t&&!p.ratioValues.includes(t),o=this.selectorEl.querySelector(`.${a.ORIGINAL_RATIO_CLASS_NAME}`);o&&(e?(o.dataset.value=String(t),o.style.display=""):(o.dataset.value="",o.style.display="none"))}setCarouselRatio(t){this.addMedia.setCarouselRatio(t)}createTooltip(){const t=this.selectorEl.querySelector(".post_action_tt_content"),e=this.selectorEl.querySelector(".post_action_btn_layout");if(!t||!e)return;const o=(0,n.createPostTooltip)(a.ACTION_BUTTON_ID,this.linkId,void 0,{customShow:!0,width:a.RATIO_TOOLTIP_WIDTH})?.toooltip;return o&&((0,i.addEvent)(e,"click",(()=>{this._isEnabled&&o.toggle()})),this.selectorEl.querySelectorAll(".radiobtn").forEach((t=>{(0,i.addEvent)(t,"click",this.handleOptionClick.bind(this))}))),o}handleOptionClick(t){if(!(t.currentTarget instanceof HTMLElement))return;const e=t.currentTarget.getAttribute("data-value");this.tooltip?.hide(),e&&(this.setCarouselRatio(Number(e)),this.selectOption(Number(e)),h.logEvent({settings_event:{settings_event_type:_.SettingsEventType.RatioChange}}))}updateTooltipRadioBtn(t,e){(0,n.updatePostTooltipActionRadioBtn)(t,e,`post_settings_btn${a.ACTION_BUTTON_ID}${this.linkId}`)}updateActionButtonText(t,e){e&&(t.innerText=e,t.setAttribute("aria-label",e))}selectOption(t){this.checkOriginalRatio();const e=this.selectorEl.querySelector(`[data-value="${t}"]`),o=this.selectorEl.querySelector(".post_action_btn_text");if(!(e instanceof HTMLElement&&o instanceof HTMLElement))return;this.updateTooltipRadioBtn(e,t);const n=e.getAttribute("aria-label")||"";this.updateActionButtonText(o,n)}isHidden(){return this._isHidden}setVisibility(t){this.checkOriginalRatio();let e=t;this.selectorEl.style.display=e?"":"none",this._isHidden=!t}isEnabled(){return this._isEnabled}setEnabled(t){this.selectorEl.classList.toggle(a.ACTION_BUTTON_DISABLED,!t),this._isEnabled=t}showHintTooltip(t){if((0,l.ensureAccountHelpHintsService)().canShow(c.AvailableHelpHints.ACCOUNT_HINT_POSTING_EDITOR_PHOTO_ATTACHMENTS_CROP)){const e=Number(r.vkLocalStorage.getItem(a.STORAGE_HINT_NAME));e&&e+1>=5?((0,l.ensureAccountHelpHintsService)().hideHelpHint({hintId:c.AvailableHelpHints.ACCOUNT_HINT_POSTING_EDITOR_PHOTO_ATTACHMENTS_CROP}),r.vkLocalStorage.removeItem(a.STORAGE_HINT_NAME)):r.vkLocalStorage.setItem(a.STORAGE_HINT_NAME,e+1),(0,u.renderCarouselRatioSelectorHint)({element:this.selectorEl,text:(0,s.getLang)("global_posting_carousel_ratio_hint")+" "+a.RatioShowValue[t]})}}constructor(t,e,o,n,i={isHidden:!0,isEnabled:!1}){this.linkId=e,this.selectorEl=o,this.tooltip=this.createTooltip(),this.addMedia=t,n&&(this.selectOption(n),this.setCarouselRatio(n)),this.setVisibility(!i.isHidden),this.setEnabled(i.isEnabled)}}},935531:(t,e,o)=>{o.d(e,{renderCarouselRatioSelectorHint:()=>_});var n=o(474848),i=o(296540),a=o(578392),s=o(373080),r=o(239808),l=o(205338),c=o(342018);const d=({element:t,text:e,onClose:o})=>{const[l,c]=(0,i.useState)(!0),d=(0,i.useCallback)((()=>{o?.(),c(!1)}),[o,c]);return(0,i.useEffect)((()=>(window.addEventListener("mousedown",d,{once:!0}),()=>window.removeEventListener("mousedown",d))),[d]),(0,n.jsx)(a.TextTooltip,{appearance:"neutral",hideWhenReferenceHidden:!0,placement:"top-end",offsetByMainAxis:0,shown:l,onClose:d,text:(0,n.jsx)(s.InnerHTML,{children:e}),children:(0,n.jsx)(r.ElementPortal,{element:t})})},_=({onClose:t,...e})=>{const o=document.createElement("div");document.body.append(o),e.element.parentElement&&e.element.parentElement.setAttribute("data-onboarding-tooltip-container","true");const i=(0,l.createRoot)(o),a=()=>{i.unmount(),o.remove()};i.render((0,n.jsx)(d,{...e,onClose:()=>{t?.(),a()}})),(0,c.pushNavDestroy)((()=>{o&&a()}))}},94470:(t,e,o)=>{o.d(e,{initCarouselRatioSelector:()=>_});var n=o(562436),i=o(806917),a=o(791947),s=o(600222),r=o(723294),l=o(700230),c=o(866467);const d=({title:t,value:e,icon:o,className:n})=>`<div class="FancyElementTT__item radiobtn ${n??""}" ${e?"":'style="display: none;"'} role="radio" data-value="${e}" aria-label="${t}">\n    ${o}\n  <div class="FancyElementTT__itemLabel">${t}</div>\n</div>`,_=({linkId:t,postActionsEl:e,addMedia:o,initValue:_})=>{if(!(e instanceof HTMLElement))return;let u="";const p=`<span class="FancyElementTT__checkIcon">${(0,a.getIcon16Done)().icon}</span>`,h=(0,l.isCarouselCorridorEnabled)(),m=h&&_&&!l.ratioValues.includes(_),g=(0,c.getLang)("global_posting_carousel_ratio_original");if(h){const t=m?p:"";u+=d({title:g,value:String(_||""),icon:t,className:i.ORIGINAL_RATIO_CLASS_NAME})}Object.values(l.ratioValues).forEach((t=>{const e=i.RatioShowValue[t],o=t===_?p:"";u+=d({title:e,value:String(t),icon:o})}));let T=_&&i.RatioShowValue[_]?i.RatioShowValue[_]:"";h&&(T=_?i.RatioShowValue[_]||g:"");const E=document.createElement("div");E.classList.add("post_action_btn"),E.id=i.ACTION_BUTTON_ID+(t??""),E.innerHTML=`<div class="post_action_btn_layout">\n    <span class="post_action_btn_text">${T}</span>\n    <span class="post_action_image_btn">${(0,s.getIcon12Dropdown)().icon}</span>\n    <div class="post_action_tt_content">\n      ${u}\n    </div>\n  </div>`;const f=e.querySelector(`#${r.ACTION_BUTTON_ID}`)||e.querySelector(`#${r.ACTION_BUTTON_ID}${t}`);if(!f)return;f.after(E);const w=new n.CarouselRatioSelector(o,t,E,_,{isHidden:!0,isEnabled:!1}),A=(t,e)=>{e?(w.setVisibility(!0),w.setEnabled(!0)):w.setVisibility(!1)};return A(0,o.isRatioSelectorVisible()),o.emitter.on(o.eventTypes.previewUpdate,A),o.emitter.on(o.eventTypes.viewDraw,A),{setOption:t=>{w.selectOption(t)},onClear:()=>{w.setVisibility(!1)},showHintTooltip:t=>{w.showHintTooltip(t)}}}},711373:(t,e,o)=>{o.d(e,{getThumbsCount:()=>h,isCarouselAllowed:()=>m,isGridAllowed:()=>g,makeReactCarouselRenderer:()=>p,mediaDataToAttachments:()=>T,mediaDataToClickHandlers:()=>E,renderCarousel:()=>w});var n=o(26023),i=o(115208),a=o(298077),s=o(859103),r=o(342879),l=o(142278),c=o(351118),d=o(866467),_=o(700230);const u="PrimaryAttachmentCarouselWrapper",p=()=>{let t;return({thumbs:e,onDelete:n,ratio:i,changeRatio:a},s)=>{const r=()=>{t&&t.isMounted()&&t.unmount(),t=void 0;const e=s.querySelector(`.${u}`);e?.remove()};if(!e.length)return r(),()=>{};if(!t?.isMounted()){s.innerHTML=`<div class="${u}"></div>`;if(!s.querySelector(`.${u}`))return()=>{};t||(t=(0,l.createReactLazyInitiator)((()=>(0,c.asyncImportLoader)((()=>Promise.all([o.e(91498),o.e(89631),o.e(762),o.e(28657),o.e(52781),o.e("langs/web/primary_attachments_carousel")]).then(o.bind(o,171790)).then((({PrimaryAttachmentsCarousel:t})=>t))))),(()=>s.querySelector(".PrimaryAttachmentCarouselWrapper"))))}return t?.render({thumbs:e,onDelete:n,ratio:i,changeRatio:a}),r}},h=t=>(0,i.getThumbsMediaItems)(t).length,m=(t,{skipClipsCheck:e=!1}={})=>{const o=(0,_.isCarouselCropEnabled)()||h(t)>1,n=e||t?.every((([t,,e])=>!(t===i.THUMB_TYPE_VIDEO&&e?.editable?.is_short_video)));return Boolean(o&&n)},g=(t,e=!1)=>{const o=t?.every((([t,,e])=>t===i.THUMB_TYPE_VIDEO&&e?.editable?.is_short_video));return Boolean((!e||o)&&(!(0,_.isCarouselCropEnabled)()||h(t)>1||o&&1===h(t)))},T=t=>[...new Set((0,i.getThumbsMediaItems)(t).map((([t,e])=>`${t}${e}`)))].join(","),E=t=>t?.reduce(((t,e)=>{if(e[2]&&"editable"in e[2]){const o=e[2]?.editable?.click;t[e[1]]=o??t[e[1]]}return t}),{})??{},f=t=>e=>{if(!t)return;if(!(e.target instanceof HTMLElement))return;const o=function(t){const e=".js-PrimaryAttachment",o=t.closest(e);if(!o)return void(0,a.logError)(new Error("PrimaryAttachment: posting delete handler: missing card"));const n=o.closest(".js-PrimaryAttachmentCarousel");if(!n)return void(0,a.logError)(new Error("PrimaryAttachment: posting delete handler: missing carousel"));const i=n.querySelectorAll(e),r=Array.prototype.indexOf.call(i,o);if(-1===r)return void(0,a.logError)(new Error("PrimaryAttachment: posting delete handler: card not in carousel"));const l=(0,s.getPrimaryCarouselGallery)(o);if(!l)return;return{gallery:l,index:r}}(e.target);if(!o)return void(0,a.logError)(new Error("PrimaryAttachment: posting delete handler: missing gallery instance"));const{gallery:n,index:i}=o;n.removeItem(i),t(i)},w=({oid:t,postId:e,attachments:o,photoClickHandlers:i,onDelete:a,wkView:s=!1},l)=>{l.firstChild||(l.innerHTML='<div class="PrimaryAttachmentCarousel__skeleton"></div>');let c=()=>{},_=!1,u=!1;return{renderCarouselPromise:new Promise(((n,i)=>{const a=window.ajax.post("al_wall.php",{act:"render_carousel",post_id:e,owner_id:t,attachments:o,wk_view:s?1:0},{onDone:n,onFail:()=>(i(),!1)});c=()=>{u||(_=!0,a.abort(),i())}})).catch((()=>({carousel_html:""}))).then((t=>{const e=t?.carousel_html;if(!_&&l&&e){l.innerHTML=`<div class="PrimaryAttachmentCarouselWrapper">${String(e)}</div>`,Object.keys(i).forEach((t=>{const e=l.querySelector(`[data-photo-id="${t}"]`);e?.addEventListener("click",(e=>{e.stopPropagation(),e.preventDefault(),i[t]?.()}))}));const t=l.querySelector(".PrimaryAttachmentCarouselWrapper")??void 0;l.querySelectorAll(".js-PrimaryAttachmentCarousel__close").forEach((e=>{e.addEventListener("mouseover",(()=>{(0,r.showTooltip)(e,{text:(0,d.getLang)("dont_attach"),shift:[11,8],black:1,appendEl:t,dir:void 0})}))})),(0,n.default)(l,".js-PrimaryAttachmentCarousel__close","click",f(a))}u=!0})),abort:c}}},300469:(t,e,o)=>{o.d(e,{getFixedReplyField:()=>r,initCommentsHandlers:()=>_,isInlineCommentsEnabled:()=>c,replyBoxOwnerIsNftFromAttr:()=>l});var n=o(338329),i=o(15874),a=o(153663),s=o(540462);const r=()=>window.cur.wallLayer?document.getElementById("wl_reply_form")??void 0:"full"===window.cur.wallType?document.querySelector(`#reply_box_wrap${window.cur.oid}_${window.cur.pid} .reply_box_inner_wrap`)??void 0:void 0,l=t=>"1"===t;function c(){return(0,s.partConfigEnabled)("feed_inline_comments_web")}function d(t,e,o){const n=t.match(/^(-?\d+)_(wall)?(\d+)$/);if(!n)return;const i=(s=e,s?.closest(".reply"));var s;const r=i?.id.split("_")[1],l=(0,a.getTrackCodeFromPost)(e),c=`wall${n[1]}_${n[3]}`;window.Wall.postFull(c,!1,{isPostCommentsDisabled:o.isPostCommentsDisabled,isInlineCommentsEnabled:o.isInlineCommentsEnabled,isInputFocusEnabled:o.isPostCommentsDisabled&&!o.isInputFocusDisabled,reply:o.isInlineCommentsEnabled?r:null,clickSource:o.clickSource,trackCode:l})}function _(){(0,n.tq)().setInteractiveHandler("PostBottomAction/comment",(t=>{const e=t.payload.target;if(!e)return;const o=(0,i.getPostElemByChildEl)(e),n=o?.getAttribute("data-post-id");if(!n||!o)return;if((0,s.partConfigEnabled)("post_layer_disabled"))return void window.open(`/wall${n}`);const a=e?.classList.contains("replies_next_inline");d(n,e,{isPostCommentsDisabled:"true"===o?.getAttribute("data-post-comments-disabled"),isInlineCommentsEnabled:!1,isInputFocusDisabled:a,clickSource:"comments_button"})})),(0,n.tq)().setInteractiveHandler("FeedReplies/showCommentInLayer",(t=>{if(window.cur.editingPost)return;const e=t.payload.target;if(!e)return;const o=t.payload.event?.target;if(function(t){return t?.closest(".wall_reply_text a")}(o))return;const n=(0,i.getPostElemByChildEl)(e),a=n?.getAttribute("data-post-id");if(!a||!n)return;if((0,s.partConfigEnabled)("post_layer_disabled"))return void window.open(`/wall${a}`);d(a,e,{isPostCommentsDisabled:!1,isInlineCommentsEnabled:"true"===n?.getAttribute("data-post-inline-comments"),clickSource:"inline_comment"})}))}}}])}if("undefined"!=typeof window&&window.partConfigEnabled?.("static_loading_execute_errors"))try{t(),window.stManager?.done?.("dist/web/chunks/bdf39731.213910d5.js")}catch(t){throw window.stManager?.fail?.("dist/web/chunks/bdf39731.213910d5.js",t),t}else t(),"undefined"!=typeof window&&window.stManager?.done?.("dist/web/chunks/bdf39731.213910d5.js");