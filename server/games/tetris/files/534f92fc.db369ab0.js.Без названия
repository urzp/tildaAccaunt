function sourceFn(){"use strict";(self.webpackChunkvkweb=self.webpackChunkvkweb||[]).push([[33585],{720357:(_,e,o)=>{o.d(e,{ExternalEvents:()=>i});class i{dispose(){}constructor(){this.listeners=[],this.send=(_,e)=>{for(const o of this.listeners)o(_,e)},this.subscribe=_=>(this.listeners.push(_),()=>{this.listeners=this.listeners.filter((e=>e!==_))})}}},875781:(_,e,o)=>{function i(){return{icon:'<svg fill="none" height="12" viewBox="0 0 12 12" width="12" xmlns="http://www.w3.org/2000/svg"><path d="M3.53 2.46a.75.75 0 0 0-1.07 1.07L4.94 6 2.46 8.47a.75.75 0 1 0 1.07 1.07L6 7.06l2.47 2.48a.75.75 0 0 0 1.07-1.07L7.06 6l2.48-2.47a.75.75 0 1 0-1.07-1.07L6 4.94z" fill="currentColor"/></svg>',name:"cancel_12"}}o.d(e,{getIcon12Cancel:()=>i})},908166:(_,e,o)=>{function i(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16"><path fill="#fff" d="m6.55 5.05 4.77 2.64a.35.35 0 0 1 0 .62l-4.77 2.64a.37.37 0 0 1-.5-.13.34.34 0 0 1-.05-.17v-5.3A.36.36 0 0 1 6.37 5c.06 0 .12.02.18.05Z"/></svg>',name:"play_marusia_foreground_16"}}o.d(e,{getIcon16PlayMarusiaForeground:()=>i})},792112:(_,e,o)=>{function i(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16"><path fill="#fff" d="M5 7.4c0-.84 0-1.26.16-1.58a1.5 1.5 0 0 1 .66-.66C6.14 5 6.56 5 7.4 5h1.2c.84 0 1.26 0 1.58.16a1.5 1.5 0 0 1 .66.66c.16.32.16.74.16 1.58v1.2c0 .84 0 1.26-.16 1.58a1.5 1.5 0 0 1-.66.66c-.32.16-.74.16-1.58.16H7.4c-.84 0-1.26 0-1.58-.16a1.5 1.5 0 0 1-.66-.66C5 9.86 5 9.44 5 8.6V7.4Z"/></svg>',name:"stop_marusia_foreground_16"}}o.d(e,{getIcon16StopMarusiaForeground:()=>i})},817882:(_,e,o)=>{function i(){return{icon:'<svg fill="none" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M16.87 2c1.79 0 2.43.19 3.08.53.66.35 1.17.86 1.52 1.52s.53 1.3.53 3.08v9.74c0 1.79-.19 2.43-.53 3.08a3.63 3.63 0 0 1-1.52 1.52c-.65.34-1.3.53-3.08.53H7.13c-1.79 0-2.43-.19-3.08-.53s-1.17-.86-1.52-1.52C2.2 19.3 2 18.65 2 16.87V7.13c0-1.79.19-2.43.53-3.08.35-.66.86-1.17 1.52-1.52C4.7 2.2 5.35 2 7.13 2zm.57 2H6.56c-.89 0-1.21.1-1.54.27-.32.17-.58.43-.75.75-.18.33-.27.65-.27 1.54v10.88c0 .89.1 1.21.27 1.54.17.32.43.58.75.75.33.18.65.27 1.54.27h10.88c.89 0 1.21-.1 1.54-.27.32-.17.58-.43.75-.75.18-.33.27-.65.27-1.54V6.56c0-.89-.1-1.21-.27-1.54a1.82 1.82 0 0 0-.75-.75c-.33-.18-.65-.27-1.54-.27z" fill="currentColor"/></svg>',name:"check_box_off_24"}}o.d(e,{getIcon24CheckBoxOff:()=>i})},895798:(_,e,o)=>{function i(){return{icon:'<svg fill="none" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M2.44 4.18C2 5.04 2 6.16 2 8.4v7.2c0 2.24 0 3.36.44 4.22a4 4 0 0 0 1.74 1.74c.86.44 1.98.44 4.22.44h7.2c2.24 0 3.36 0 4.22-.44a4 4 0 0 0 1.74-1.74c.44-.86.44-1.98.44-4.22V8.4c0-2.24 0-3.36-.44-4.22a4 4 0 0 0-1.74-1.74C18.96 2 17.84 2 15.6 2H8.4c-2.24 0-3.36 0-4.22.44a4 4 0 0 0-1.74 1.74zM18.2 9.21a1 1 0 0 0-1.42-1.42L10 14.6l-2.8-2.8a1 1 0 0 0-1.4 1.42l3.5 3.5a1 1 0 0 0 1.4 0z" fill="currentColor" fill-rule="evenodd"/></svg>',name:"check_box_on_24"}}o.d(e,{getIcon24CheckBoxOn:()=>i})},265658:(_,e,o)=>{o.d(e,{VKWebAppCustomMessage:()=>u});var i=o(939659),s=o(298077),l=o(290788),a=o(565703),n=o(889438),d=o(105330),E=o(540462),c=o(52905),p=o(837207);o._dG("VKWebAppCustomMessageExternalHandlers",window.VKWebAppCustomMessageExternalHandlers??{});const P=(0,n.getMessengerSharedState)().externalEvents;class u extends l.Handler{actionHandler(_){if(_.action&&_.payload){if(this.app.isTextliveApp){const e=window.Textlives?.onBridgeEvent(_);return void(e&&e.then(this.successHandler).catch(this.errorHandler))}if(this.app.appId===c.NFT_APP_ID)return this.handleSetNftAvatar(_),void this.successHandler({result:!0});if(this.app.appId===c.ORD_APP_ID)return this.handleSetOrdData(_),void this.successHandler({result:!0},(()=>{if((0,E.partConfigEnabled)("messages_enable_vk_web_app_custom_message_processing"))try{P.send(this.params.handlerName,_)}catch(_){console.error(_)}}));if(this.app.appId===c.VMOJI_CONSTRUCTOR_APP_ID)return this.handleOpenStickerPicker(_),void this.successHandler({result:!0});if(this.app.appId===c.OZON_APP_ID&&window.cur?.handleOzonAppCustomMessage&&"function"==typeof window.cur.handleOzonAppCustomMessage)return window.cur.handleOzonAppCustomMessage(_),void this.successHandler({result:!0});if(this.app.appId===c.ONE_TIME_DONUT_APP_ID){try{this.handleWithExternalHandlers(_)}catch(_){(0,s.logError)(_)}return void this.successHandler({result:!0})}}this.errorHandler("unknown error")}handleSetNftAvatar({action:_,payload:e}){"VKWebAppSetNFTAvatar"===_&&((0,d.isMvk)()?window.OwnerPhotoUpload2.setNftAvatar(e):window.ajax.post("al_page.php",{act:"owner_avatar_upload",oid:e?.oid},{onDone:(_,o)=>{window.handleVKBridgeSetNftAvatar(e,_,o)}}))}handleOpenStickerPicker({action:_,payload:e}){if("vmoji_character_recereate"!==_)return;const{promo:o,page:s}=e;o&&(0,a.isNewStickerPicker)()&&!(0,d.isMvk)()&&(window.StickerPickerViewer?.showLastPicker(i.ServicePackKey.VMOJI),s?.match("/preview")||window.stManager.add(window.jsc("web/vmoji.js")).then((()=>{window.Vmoji.showAddedToStickerSnackbar()})))}handleSetOrdData({action:_,payload:e}){"ord_data"===_&&e&&(0,p.getStore)().onOrdData({is_ad:e.isAd||!1,ord_pred_id:e.predId||"",erid:e.erId||""})}handleWithExternalHandlers(_){window.VKWebAppCustomMessageExternalHandlers[_.action]?.(_.payload)}constructor(_){super(_),this.params.handlerName="VKWebAppCustomMessage"}}},234430:(_,e,o)=>{o.d(e,{CLOSE_BUTTON_MODES:()=>b,UIAction:()=>h,renderCounter:()=>w,setCounter:()=>m});var i=o(105330),s=o(453736),l=o(150585),a=o(950189),n=o(801746),d=o(680208),E=o(936492),c=o(895798),p=o(817882),P=o(540462),u=o(670053);const b={INNER:0,OUTER:1},O="success",D="deny",M="extra",w=_=>{const e=document.createElement("span");return e.classList.add("VkAppModal__buttonCounter"),e.innerText=_,e},m=(_,e)=>{const o=_.find((_=>_.hasCounter));o&&o.counterElement&&(o.counterElement.innerText=e)};class h{addScroll(){(0,s.addPopupScroll)(this.modal.children[0],this.modalParentLayer)}init(){this.containerNode&&this.containerNode.appendChild(this.modal),this.modalParentLayer=this.modal.closest(".layer_wrap"),!1!==this.props.withScroll&&(this.modalParentLayer?this.modalParentLayer.addEventListener("scroll",this.addScroll):window.addEventListener("scroll",this.addScroll))}show(){(0,i.isMvk)()&&document.body.classList.add("vk_app_fixed"),this.props.withoutAnimation?this.modal.classList.add("show"):setTimeout((()=>this.modal.classList.add("show")),300),this.initMvkCloseActions(),this.addScroll()}initMvkCloseActions(){(0,i.isMvk)()&&(window.DirectGames&&(0,u.getCurrentApp)().isDirectGame&&window.DirectGames.onBoxOpen?.(this),this.props.onlyButtonHide||(this.modal.onclick=_=>{_.target===this.modal&&this.onAction(this.props.cancelAction)}))}close(){this.props.onlyButtonHide||this.onAction(this.props.cancelAction)}destroy(){if(!1!==this.props.withScroll&&(window.removeEventListener("scroll",this.addScroll),this.modalParentLayer&&this.modalParentLayer.removeEventListener("scroll",this.addScroll)),!this._destroyed){if((0,i.isMvk)()){document.body.classList.remove("vk_app_fixed");const _=(0,u.getCurrentApp)();window.DirectGames&&_.isDirectGame&&(window.DirectGames.onBoxClose?.(this),_.frame.focus())}this.modal.parentNode.removeChild(this.modal),this.callback&&this.callback(),this._destroyed=!0}}_disableButton(_,e=!0){_.disabled=e,_.element.disabled=e}_lockButton(_,e=!0){const o=(0,i.isMvk)()?(0,a.getIcon24Spinner)().icon:(0,n.getIcon16Spinner)().icon,s=`\n    <span class="vk_app_modal_btn__content">${_.title}</span>\n    <span class="vk_app_modal_btn__spinner">${o}</span>\n    `;_.loading=e,_.element.innerHTML=e?s:_.title,_.element.classList.toggle("vk_app_modal_btn--loading",e)}async onAction(_){await _(),this.destroy()}lockButtons(_=!0){const e={[O]:this._lockButton,[D]:this._disableButton,[M]:this._disableButton};this.props.buttons.forEach((o=>e[o.type](o,_)))}_setCounter(_){m(this.props.buttons,_)}_renderBtn(_){const e=document.createElement("button");if(e.setAttribute("type","button"),e.classList.add("vk_app_modal_btn"),e.classList.add(`vk_app_modal_btn--${_.type}`),e.innerText=_.title,e.addEventListener("click",(()=>_.type===M?_.action():this.onAction(_.action))),_.hasCounter){const o=w(0);e.appendChild(o),_.counterElement=o}return _.dataTestId&&e.setAttribute("data-testid",_.dataTestId),_.element=e,_.disabled&&this._disableButton(_),_.loading&&this._lockButton(_),e}_renderBtns(_){const e=_.querySelector(".vk_app_modal_btns"),{buttons:o}=this.props;if(e){o.forEach((_=>e.appendChild(this._renderBtn(_))));const _=o.find((_=>_.type===M));1===o.length&&e.classList.add("vk_app_modal_btns--single-btn"),_&&e.classList.add("vk_app_modal_btns--hasExtraButton")}}_renderCloseBtn(_){const e=document.createElement("button");e.setAttribute("type","button"),e.setAttribute("data-testid","apps_connect_modal_close_button"),e.classList.add("vk_app_modal_close_btn"),(0,i.isMvk)()||this.props.closeButtonMode!==b.OUTER?e.innerHTML=(0,E.getIcon24Cancel)().icon:(e.classList.add("vk_app_modal_close_btn--outer"),e.innerHTML=(0,d.getIcon20Cancel)().icon),e.addEventListener("click",(()=>this.onAction(this.props.cancelAction))),_.children[0].appendChild(e)}_renderCheckboxFields(_,e){const o=document.createElement("div");o.classList.add("MiniAppsCheckbox__fields");const i=document.createElement("h5");if(i.classList.add("MiniAppsCheckbox__fields-title"),i.innerHTML=_,o.appendChild(i),e){const _=document.createElement("h6");_.classList.add("MiniAppsCheckbox__fields-description"),_.innerHTML=e,o.appendChild(_)}return o}_renderCheckbox(_){const{title:e,description:o,...s}=_,l=document.createElement("label");l.classList.add("MiniAppsCheckbox");const a=document.createElement("input");if(a.type="checkbox",a.classList.add("MiniAppsCheckbox__checkbox"),a.addEventListener("change",(e=>_.checked=e.target.checked)),l.appendChild(a),Object.entries(s).forEach((([_,e])=>{a[_]=e})),(0,i.isMvk)()){const _=document.createElement("div");_.classList.add("MiniAppsCheckbox__fake_checkbox","MiniAppsCheckbox__fake_checkbox--checked"),_.innerHTML=(0,c.getIcon24CheckBoxOn)().icon,l.appendChild(_);const e=document.createElement("div");e.classList.add("MiniAppsCheckbox__fake_checkbox","MiniAppsCheckbox__fake_checkbox--unchecked"),e.innerHTML=(0,p.getIcon24CheckBoxOff)().icon,l.appendChild(e)}else{const _=document.createElement("div");_.classList.add("MiniAppsCheckbox__fake_checkbox"),l.appendChild(_)}const n=this._renderCheckboxFields(e,o);return l.appendChild(n),l}_renderCheckboxWrap(_){const e=_.querySelector(".MiniAppsModalCheckbox");e&&this.props.checkbox.map((_=>e.appendChild(this._renderCheckbox(_))))}_renderOuter(){const _=document.createElement("div");return _.classList.add("vk_app_modal_outer"),_}_enhanceBtnsWithActions(){this.props.buttons&&this.props.buttons.forEach(((_,e)=>{_.type===D?this.props.buttons[e].action=this.props.cancelAction:_.type===M?this.props.buttons[e].action=this.props.extraAction:this.props.buttons[e].action=this.props.allowAction}))}_renderScopes(_){return _.map(((_,e)=>{const o=getLang(`vkapps_scope_${_}`);return 0===e?o:o.toLowerCase()})).join(", ")}prepareScopes(_){return 0===_.length?["general"]:_}prepareExtraBtn(){const _=document.createElement("button");return _.setAttribute("type","button"),_.setAttribute("data-testid","apps_connect_modal_scopes_edit"),_.classList.add("vk_app_modal_btn","VkAppModal__button--extra","vk_app_modal_btn--transparent"),_.innerHTML=getLang("apps_connect_modal_messages_scopes_edit"),_.addEventListener("click",this.props.extraAction),_}getThumb(){if(this.props.svgIcon)return this.props.svgIcon;const _=this.props.picClass?this.props.picClass:"";return this.props.pic?`<img src="${this.props.pic}" class="vk_app_modal_container__pic MiniAppModalContainer__pic ${_}" alt aria-label="product">`:""}isHorizontalLayoutSupported(){return(0,i.isMvk)()&&(0,P.partConfigEnabled)("vk_bridge_modals_horizontal_layout")}renderModal(){this.props.containerClass=this.props.containerClass||"",this.props.buttonsClass=this.props.buttonsClass||"",this.props.isGradientModal&&(0,i.isMvk)()&&(this.props.containerClass+=" MiniAppsGradientModal"),this.props.isNoWrapButtons&&(0,i.isMvk)()&&(this.props.buttonsClass+=" MiniAppsNoWrapButtons");const _=this.props.scopes&&this.props.scopes.length&&this.props.extraAction;this.isHorizontalLayoutSupported()&&(this.props.containerClass+=" VkAppModal__Container--horizontalSupport",_&&(this.props.containerClass+=" VkAppModal__Container--withExtraButton"));let e=`\n    <div class="vk_app_modal_container vk_app_modal_container--flex ${this.props.containerClass||""}">\n      <div class="vk_app_modal_content">\n        ${this.getThumb()}\n        <h2 class="vk_app_modal_container__heading">${this.props.title}</h2>\n        ${this._renderSubheading()}\n        ${this._renderTextSeparator()}\n        ${this._renderText(this.props.text)}\n      `;this.props.scopes&&(e+=`\n          <p class="vk_app_modal_container__text">${getLang("apps_connect_modal_messages_scopes_text")}</p>\n          <p class="vk_app_modal_container__list">${this._renderScopes(this.prepareScopes(this.props.scopes))}.</p>`),e+=`\n          </div>\n          ${this.props.checkbox?'<div class="MiniAppsModalCheckbox"></div>':""}\n          <div class="vk_app_modal_btns ${this.props.buttonsClass}"></div>\n      </div>`,this._enhanceBtnsWithActions(),this.modal=this._renderOuter(),this.modal.innerHTML=e,this.props.showCloseBtn&&this._renderCloseBtn(this.modal),_&&this.modal.getElementsByClassName("vk_app_modal_content")[0].appendChild(this.prepareExtraBtn()),this._renderBtns(this.modal),this.props.checkbox&&this._renderCheckboxWrap(this.modal),this.props.scopes&&this._setCounter(this.props.scopes.length)}_renderText(_){if(!_)return"";return(Array.isArray(_)?_:[_]).map((_=>`<p class="vk_app_modal_container__text">${_}</p>`)).join("")}_renderSubheading(){return this.props.subheading?`<h3 class="vk_app_modal_container__subheading">${this.props.subheading}</h3>`:""}_renderTextSeparator(){return this.props.isTextSeparated?'<div class="vk_app_modal_container__text_separator"></div>':""}constructor(_,e){this.props={..._},e&&(this.callback=e),this.props.buttons=this.props.buttons||[],this.containerNode=document.getElementById(this.props.containerId),this.modal=null,this.modalParentLayer=null,this.onAction=this.onAction.bind(this),this.addScroll=(0,l.throttle)(this.addScroll.bind(this),s.THROTTLE_TIME),this.renderModal(),this._destroyed=!1}}},453736:(_,e,o)=>{o.d(e,{THROTTLE_TIME:()=>l,addPopupScroll:()=>a});var i=o(105330),s=o(670053);const l=300,a=(_,e)=>{const o=e?e.scrollTop:window.pageYOffset,l=(0,s.getCurrentApp)();if(l&&!(0,i.isMvk)()){const e=50*(Boolean(window.vk?.rtl)?1:-1),i=l.frame.clientHeight-360,s=Math.max(103,Math.min(o,i)+102);requestAnimationFrame((function(){_.style.transform=`translateX(${e}%) translateY(${s}px)`}))}}},520637:(_,e,o)=>{o.d(e,{default:()=>s});var i=o(52905);const s=class{_errorStrucuture(_,e){let o={type:this.method,data:{error_type:this.type,error_data:{error_code:_}}};return this.type===i.ERROR_TYPES.API?(o.data.error_data.error_msg=e,this.data.request_params&&(o.data.error_data.request_params=this.data.request_params)):o.data.error_data.error_reason=e,this.data.request_id&&(o.data.request_id=this.data.request_id),this.data.description&&(o.data.error_data.error_description=this.data.description),o}getReadableMessage(){const{error_reason:_,error_msg:e,error_description:o}=this.selectErrorType().data.error_data;return _||e||o}selectErrorType(){if(!this.data.hasOwnProperty("code"))return this.data.hasOwnProperty("error_code")?this._errorStrucuture(this.data.error_code,this.data.error_msg||i.ERROR_REASONS.UNKNOWN_ERROR):this.data.error_msg&&"operation denied by user"===this.data.error_msg.toLowerCase()?this._errorStrucuture(i.ERROR_CODES.USER_DENIED,"User denied"):this._errorStrucuture(i.ERROR_CODES.UNKNOWN,this.data.reason||this.data.error_msg||i.ERROR_REASONS.UNKNOWN_ERROR);switch(this.data.code){case i.ERROR_CODES.MISSING_PARAM:return this._errorStrucuture(i.ERROR_CODES.MISSING_PARAM,this.data.reason||"Missing required params or wrong type of param");case i.ERROR_CODES.CONNECTION_LOST:return this._errorStrucuture(i.ERROR_CODES.CONNECTION_LOST,this.data.reason||i.ERROR_REASONS.CONNECTION_LOST);case i.ERROR_CODES.USER_DENIED:return this._errorStrucuture(i.ERROR_CODES.USER_DENIED,this.data.reason||i.ERROR_REASONS.USER_DENIED);case i.ERROR_CODES.INVALID_PARAMS:return this._errorStrucuture(i.ERROR_CODES.INVALID_PARAMS,this.data.reason||i.ERROR_REASONS.INVALID_PARAMS);case i.ERROR_CODES.ACCESS_DENIED:return this._errorStrucuture(i.ERROR_CODES.ACCESS_DENIED,this.data.reason||i.ERROR_REASONS.ACCESS_DENIED);case i.ERROR_CODES.CUSTOM:return this._errorStrucuture(i.ERROR_CODES.CUSTOM,this.data.reason||this.data.error_msg);case i.ERROR_CODES.REQUESTS_LIMIT_REACHED:return this._errorStrucuture(i.ERROR_CODES.REQUESTS_LIMIT_REACHED,"Requests limit reached");case i.ERROR_CODES.UNKNOWN:return this._errorStrucuture(i.ERROR_CODES.UNKNOWN,this.data.reason||i.ERROR_REASONS.UNKNOWN_ERROR);default:return this._errorStrucuture(this.data.code?this.data.code:i.ERROR_CODES.UNKNOWN,this.data.reason||this.data.error_msg||i.ERROR_REASONS.UNKNOWN_ERROR)}}constructor(_,e,o=i.ERROR_TYPES.CLIENT){this.data=e||{},this.method=_,this.type=o}}},494565:(_,e,o)=>{o.d(e,{destroyOpenedApp:()=>a,filterPostMessageOrigin:()=>d,getHostName:()=>l,isAllowedPostMessageOriginHost:()=>E,isVKPayApp:()=>n,objectToQuerystring:()=>s});var i=o(52905);const s=(_,e="?",o=!1)=>Object.keys(_).reduce(((i,s,l)=>[i,0===l?e:"&",encodeURIComponent(s),"=",o&&Array.isArray(_[s])?_[s].map(encodeURIComponent).join(","):encodeURIComponent(_[s])].join("")),""),l=_=>{const e=_.match(/:\/\/(www[0-9]?\.)?(.[^/:]+)/i);return null!=e&&e.length>2&&"string"==typeof e[2]&&e[2].length>0?e[2].toLowerCase():null},a=_=>{if(cur.vkAppQueue){const e=Object.keys(cur.vkAppQueue).filter((e=>~e.indexOf(_)));if(e.length>0){const _=e[0];cur.vkAppQueue[_].destroyView(),delete cur.vkAppQueue[_]}}},n=_=>i.VKPAY_APPS.includes(_);function d(_,e){const o=l(e),i=_.vkApp?_.vk_app_url:_.src,s=l(i);if(o!==s&&!E(_,o))throw Error(`Insecure method call from ${o}. Call must be from ${s}`);return!0}function E(_,e){if(!_.allowed_origin_regexp)return!1;return new RegExp(_.allowed_origin_regexp).test(e)}},22285:(_,e,o)=>{function i(_,e,o,i){const s=e?"article.php":"al_articles.php";ajax.post(s,{act:"tts",article_owner_id:_.owner_id,article_id:_.id,hash:_.tts_hash,support_streaming:o?1:0},{onDone:_=>{i(_)}})}o.d(e,{loadArticle:()=>i})},150585:(_,e,o)=>{function i(_,e){let o,i,s=!1;return function l(){if(s)return o=arguments,void(i=this);_.apply(this,arguments),s=!0,setTimeout((function(){s=!1,o&&(l.apply(i,o),o=i=null)}),e)}}o.d(e,{throttle:()=>i})},6204:(_,e,o)=>{o.d(e,{ArticleTts:()=>P});var i=o(400160),s=o(867366),l=o(219095),a=o(983567),n=o(392358),d=o(423015),E=o(138586),c=o(482310),p=o(22285);class P{static load(_,e,o,i){this.loadingArticleRawId=_.raw_id,(0,p.loadArticle)(_,e,o,(_=>{this.loadingArticleRawId=null,i(_)}))}static getAudio(_,e,o){const i=[],l=JSON.stringify({articleTts:!0,articleId:_,articleOwnerId:e,externalStream:!0});return i[s.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_ID]=`${e}${_}`,i[s.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_OWNER_ID]=e,i[s.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_URL]=o.url,i[s.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_TITLE]=o.title,i[s.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_PERFORMER]=o.artist,i[s.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_DURATION]=o.duration,i[s.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_AUTHOR_LINK]="",i[s.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_LYRICS]=0,i[s.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_FLAGS]=0,i[s.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_CONTEXT]="",i[s.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_EXTRA]=l,i[s.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_HASHES]="",i[s.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_COVER_URL]="",i[s.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_ADS]={},i[s.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_SUBTITLE]="",i[s.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_MAIN_ARTISTS]="",i[s.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_FEAT_ARTISTS]="",i[s.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_ALBUM]=!1,i[s.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_TRACK_CODE]="",i[s.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_RESTRICTION]=0,i[s.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_ALBUM_PART]=0,i[s.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_ACCESS_KEY]="",i[s.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_CHART_INFO_INDEX]=!1,i}static play(_,e,o,s){this.onArticleTtsExpire=s,this.statsHandlersInitialized||(this._audioPlayer().subscribe(n.AudioPlayerEventType.PLAY,(()=>{if(this.isAnyArticleInPlayer()){const _=this._audioPlayer().getCurrentProgress()>0?i.ArticleTtsActionType.CONTINUE:i.ArticleTtsActionType.START;this.sendStats(_)}})),this._audioPlayer().subscribe(n.AudioPlayerEventType.PAUSE,(()=>{this.isAnyArticleInPlayer()&&this.sendStats(i.ArticleTtsActionType.PAUSE)})),this._audioPlayer().subscribe(n.AudioPlayerEventType.ENDED,(()=>{if(this.isAnyArticleInPlayer()){let _=this._audioPlayer();if(_._impl?._hlsError||_._impl?._currentAudioEl?.error){_._impl&&(_._impl._hlsError=void 0);const e=(0,c.getAudioExtra)(_.getCurrentAudio());_.deleteCurrentPlaylist(),P.retryCount<3&&(P.retryCount+=1,setTimeout((()=>{this.onArticleTtsExpire?.(e)}),P.RETRY_TIMEOUT))}this.sendStats(i.ArticleTtsActionType.P100)}})),this.statsHandlersInitialized=!0);const l=this.getAudio(_,e,o),a=this._audioPlayer().getPlaylist(E.AudioPlaylist.TYPE_ARTICLE_TTS,e,_);a.mergeWith({list:[l]}),this._audioPlayer().play(l,a)}static _audioPlayer(){return(0,a.getAudioPlayer)()}static _audioExtra(){const _=this._audioPlayer().getCurrentAudio();return(0,c.getAudioExtra)(_)??{}}static isLoadingArticle(_){return this.loadingArticleRawId===_.raw_id}static isArticleInPlayer(_){return _.owner_id===this._audioExtra().articleOwnerId&&_.id===this._audioExtra().articleId}static isAnyArticleInPlayer(){return(0,l.isArticleTts)(this._audioPlayer().getCurrentAudio())}static sendStats(_){const{articleId:e,articleOwnerId:o}=this._audioExtra();i.articleTtsActionStatController.logEvent({action:_,nav_screen:"article_read",article_id:e,owner_id:o,audio_length:(0,d.audioTupleToAudioObject)(this._audioPlayer().getCurrentAudio())?.duration??0,speed:Math.round(100*AudioPlayer.podcastGetPlaybackRate()),volume:Math.round(100*this._audioPlayer().getVolume())})}}P.statsHandlersInitialized=!1,P.retryCount=0,P.RETRY_TIMEOUT=1e3},402096:(_,e,o)=>{o.d(e,{ON_BOARDING_BG_RECT_ID:()=>d,default:()=>p});var i=o(754866),s=o(972332),l=o(672277),a=o(287470),n=o(250598);const d="onboarding_bg_rect",E="page_header_cont",c="onboarding";class p{initOnboardingBG(){if(!window.onboardingBG){let _='\n<div id="onboarding_layout">\n  <svg id="onboarding_bg_header" width="100%" height="49px">\n    <rect id="onboarding_bg_rect" class="GroupOnboardingBg" x="0" y="0" width="100%" height="100%" fill-opacity="0.8" fill="#000"></rect>\n  </svg>\n  <svg id="onboarding_bg" width="100%" height="100%">\n  <defs>\n    <mask id="mask" x="0" y="0" width="100%" height="100%">\n      <rect x="0" y="0" width="100%" height="100%" fill="#fff"></rect>\n      <rect id="onboarding_bg_clip" class="GroupOnboardingBgClip" x="0" y="0" width="0" height="0" fill="#000" rx="8" ry="8"></rect>\n    </mask>\n  </defs>\n  <rect id="onboarding_bg_rect" class="GroupOnboardingBg" x="0" y="42" width="100%" height="100%" mask="url(#mask)" fill-opacity="0.8"></rect>\n  </svg>\n</div>\n      ',e=(0,i.se)(_);(0,i.domInsertBefore)(e,window.layerBG),o._dG("onboardingBGHeader",(0,i.ge)("onboarding_bg_header")),o._dG("onboardingBG",(0,i.ge)("onboarding_bg")),o._dG("onboardingBGRect",(0,i.ge)(d)),o._dG("onboardingBGClip",(0,i.ge)("onboarding_bg_clip")),window.cur.destroy.push((()=>{(0,i.hide)(window.onboardingBG),(0,i.hide)(window.onboardingBGHeader),(0,i.removeClass)((0,i.ge)(E),c),this.hideDarkness=!0,this.hideTT(),delete window.onboardingBG,delete window.onboardingBGHeader,delete window.onboardingBGRect,delete window.onboardingBGClip,this.opts.onBGClick&&(0,s.removeEvent)(window.onboardingBG,"click",this.opts.onBGClick)}))}this.opts.onBGClick&&(0,s.addEvent)(window.onboardingBG,"click",this.opts.onBGClick)}showTT(){const[,_]=(0,i.getXY)(this.el);this.tt=new n.ElementTooltip(this.el,this.ttParams),this.opts.highlight&&(this.addDarkness(),this.addHighlight()),this.tt.show();const e=this.tt.getContent();(0,a.isElementInViewport)(this.el)&&(0,a.isElementInViewport)(e)||(0,l.scrollToY)(_-42-this.ttParams.scrollOffset)}hideTT(){this.tt&&(this.tt.destroy(),this.removeDarkens(),this.hideDarkness&&((0,s.removeEvent)(window,"scroll"),(0,s.removeEvent)(window,"resize")),this.opts.onBGClick&&window.onboardingBG&&(0,s.removeEvent)(window.onboardingBG,"click",this.opts.onBGClick),this.opts.onHide&&this.opts.onHide())}addHighlight(){window.onboardingBGClip&&(this.highlightElement(),(0,s.addEvent)(window,"scroll",this.onScrollTT.bind(this)),(0,s.addEvent)(window,"resize",this.onResizeTT.bind(this)))}highlightElement(){let _=this.el.offsetWidth,e=this.el.offsetHeight,o=(0,i.getXY)(this.el);(0,i.attr)(window.onboardingBGClip,"width",_+this.border[1]+this.border[3]),(0,i.attr)(window.onboardingBGClip,"height",e+this.border[0]+this.border[2]),(0,i.attr)(window.onboardingBGClip,"x",o[0]-this.border[1]),(0,i.attr)(window.onboardingBGClip,"y",o[1]-this.border[0])}onResizeTT(){this.setDartToFullWidth(),this.highlightElement()}onScrollTT(){let _=this.getPageHeight();window.onboardingBG.height!=_&&this.setDartToFullHeight()}setDartToFullHeight(){(0,i.attr)(window.onboardingBG,"height",this.getPageHeight())}setDartToFullWidth(){(0,i.attr)(window.onboardingBG,"width",this.getPageWidth()),(0,i.attr)(window.onboardingBGHeader,"width",this.getPageWidth())}addDarkness(){(0,i.isVisible)(window.onboardingBG)||(this.setDartToFullHeight(),this.setDartToFullWidth(),(0,i.show)(window.onboardingBG),(0,i.isVisible)(window.onboardingBGHeader)||((0,i.show)(window.onboardingBGHeader),(0,i.addClass)((0,i.ge)(E),c)))}removeDarkens(){this.hideDarkness&&((0,i.hide)(window.onboardingBG),(0,i.hide)(window.onboardingBGHeader),(0,i.removeClass)((0,i.ge)(E),c))}ttOnHide(){this.hideTT()}show(){setTimeout(this.showTT.bind(this),1e3)}getPageWidth(){const _=document.documentElement,e=document.body;return Math.max(e.scrollWidth,_.scrollWidth,e.offsetWidth,_.offsetWidth,e.clientWidth,_.clientWidth)}getPageHeight(){const _=document.documentElement,e=document.body;return Math.max(e.scrollHeight,_.scrollHeight,e.offsetHeight,_.offsetHeight,e.clientHeight,_.clientHeight)}constructor(_,e,o={}){this.el=_,this.text=e,this.hideDarkness=!0,this.oldColor=!1;let i={autoShow:!1,noAutoHideOnWindowClick:o.noAutoHideOnWindowClick??!0,content:e instanceof HTMLElement?e:`${e}`,cls:`feature_intro_tt tutorial_tip_tt ${(()=>{const _=o.class??"";return o.tooltipWhite?_:_+" feature_intro_blue_tt"})()}`,appendToParent:!0,onHide:this.ttOnHide.bind(this),scrollOffset:o.scrollOffset||0,align:o.align||n.ElementTooltip.ALIGN_CENTER};o.side&&(i.forceSide=o.side),o.offset&&(i.offset=o.offset),o.width&&(i.width=o.width),o.shift&&(i.centerShift=o.shift),o.border?this.border=o.border:this.border=[10,10,10,10],o.ttOnHide&&(i.onHide=o.ttOnHide),o.withCloseButton&&(i.withCloseButton=o.withCloseButton,i.onCloseButtonClick=o.onCloseButtonClick),o.align&&(i.align=o.align),this.ttParams=i,this.opts=o,this.initOnboardingBG()}}},287470:(_,e,o)=>{function i(_){const e=_.getBoundingClientRect();return e.top>=0&&e.left>=0&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth)}o.d(e,{isElementInViewport:()=>i})},549906:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{evalWithLogging:()=>evalWithLogging});var _web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(237625);const evalWithLogging=evalString=>{try{return eval(evalString)}catch(_){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_0__.logEvalError)(_,evalString)}}},273583:(_,e,o)=>{o.d(e,{setAdReportHandler:()=>n});var i=o(866467),s=o(754866),l=o(246429),a=o(952661);const n=(_,e,o)=>{const n="ad_report_"+_,d=(0,s.ge)(n+"_send");if(!d)return;const E=(0,s.geByClass)("radiobtn",n),c=(0,s.geByClass1)("radiobtn on",n);window.radioBtns[n]={val:c.dataset.value||1,els:E};const p=()=>{const[s,E]=_.split("_"),c=window.radioBtns[n].val;ajax.post("reports.php",{act:"report_ad_common",type:"ad",oid:s,item_id:E,hash:o,reason:c,ad_data:e},{onDone:()=>{delete window.radioBtns[n],d.removeEventListener("click",p),window.closeChosenReportReasonBlock(s,E),(0,l.showDoneBox)((0,i.getLang)("reports_warning_sent"))},onFail:_=>((0,l.showDoneBox)(_),!1),showProgress:()=>a.FlatButton.lock(d),hideProgress:()=>a.FlatButton.unlock(d)})};d.addEventListener("click",p)}},528290:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var _web_audio_player_utils__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(909436),_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(575753),_web_lib_market__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(191468),_shared_lib_site__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(105330),_web_wall_post_subscribe_action_post_subscribe_action__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(348320),_web_wall_post_update_view_utils__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(390199),_web_wall_wall_post_elem_utils__WEBPACK_IMPORTED_MODULE_111__=__webpack_require__(15874),_vkontakte_vkjs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(351118),_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(866467),_web_feed_utils_renderNewPostInFeed__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(377330),_vkontakte_internal_shared__WEBPACK_IMPORTED_MODULE_110__=__webpack_require__(361121),_vkontakte_internal_shared__WEBPACK_IMPORTED_MODULE_114__=__webpack_require__(984745),_vkontakte_internal_shared__WEBPACK_IMPORTED_MODULE_115__=__webpack_require__(632731),_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(754866),_web_lib_feature_entries_showWiki__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(414623),_web_feed_utils_isWkLayerOpened__WEBPACK_IMPORTED_MODULE_107__=__webpack_require__(979707),_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_102__=__webpack_require__(983567),_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(972332),_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(342879),_web_lib_message_box__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(270959),_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(683234),_shared_lib_ls__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(469004),_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(593159),_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(246429),_web_lib_stats__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(568129),_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(636576),_web_lib_scroll__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(672277),_web_lib_fx__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(939646),_web_lib_revertLastInlineVideo__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(892848),_web_lib_lang__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(102088),_shared_lib_convert__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(969686),_web_lib_accessibility__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(576854),_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(237625),_web_lib_input_utils__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__(749284),_web_lib_utils__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__(449299),_web_donut__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__(367105),_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__(586520),_web_reactions_reactions_wall_reactions_wall__WEBPACK_IMPORTED_MODULE_31__=__webpack_require__(163790),_web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_32__=__webpack_require__(401397),_web_discover_category_post_topic__WEBPACK_IMPORTED_MODULE_33__=__webpack_require__(272556),_shared_lib_common__WEBPACK_IMPORTED_MODULE_34__=__webpack_require__(898848),_web_page_wall_post_tooltip__WEBPACK_IMPORTED_MODULE_35__=__webpack_require__(318227),_web_wall_deep_replies_utils__WEBPACK_IMPORTED_MODULE_36__=__webpack_require__(429748),_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_37__=__webpack_require__(996531),_web_wall_reply_utils__WEBPACK_IMPORTED_MODULE_38__=__webpack_require__(300469),_web_wall_wall_post_render__WEBPACK_IMPORTED_MODULE_39__=__webpack_require__(174623),_web_wall_wall_utils__WEBPACK_IMPORTED_MODULE_40__=__webpack_require__(254961),_wall_tabs_utils__WEBPACK_IMPORTED_MODULE_41__=__webpack_require__(554311),_web_lib_date__WEBPACK_IMPORTED_MODULE_42__=__webpack_require__(101148),_shared_donut_stats_donut_log__WEBPACK_IMPORTED_MODULE_43__=__webpack_require__(701563),_shared_lib_best_friends_analytics__WEBPACK_IMPORTED_MODULE_44__=__webpack_require__(267757),_web_stories_narrative_utils__WEBPACK_IMPORTED_MODULE_45__=__webpack_require__(118628),_web_articles_article_utils__WEBPACK_IMPORTED_MODULE_46__=__webpack_require__(787476),_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__=__webpack_require__(540462),_web_likes_helpers__WEBPACK_IMPORTED_MODULE_109__=__webpack_require__(890332),_icons_desktop__WEBPACK_IMPORTED_MODULE_103__=__webpack_require__(551859),_icons_desktop__WEBPACK_IMPORTED_MODULE_104__=__webpack_require__(649e3),_icons_desktop__WEBPACK_IMPORTED_MODULE_105__=__webpack_require__(81930),_icons_desktop__WEBPACK_IMPORTED_MODULE_106__=__webpack_require__(875781),_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_48__=__webpack_require__(952661),_web_page_wall_utils__WEBPACK_IMPORTED_MODULE_49__=__webpack_require__(614320),_web_stickers_utils__WEBPACK_IMPORTED_MODULE_50__=__webpack_require__(177838),_shared_groups_constants__WEBPACK_IMPORTED_MODULE_51__=__webpack_require__(3171),_web_lib_layout_utils__WEBPACK_IMPORTED_MODULE_52__=__webpack_require__(226220),_web_profile_profile_utils__WEBPACK_IMPORTED_MODULE_53__=__webpack_require__(120101),_shared_components_avatar_renderAvatarToString__WEBPACK_IMPORTED_MODULE_54__=__webpack_require__(43899),_shared_utils_reflow__WEBPACK_IMPORTED_MODULE_113__=__webpack_require__(38462),_shared_lib_nav_helpers__WEBPACK_IMPORTED_MODULE_108__=__webpack_require__(342018),_web_Badges_constants__WEBPACK_IMPORTED_MODULE_55__=__webpack_require__(673006),_web_ecomm_onboarding_Tooltips_services_TooltipEventService__WEBPACK_IMPORTED_MODULE_56__=__webpack_require__(622048),_shared_ranges__WEBPACK_IMPORTED_MODULE_57__=__webpack_require__(810068),_web_attachments_view_selector_init_view_ui_selector__WEBPACK_IMPORTED_MODULE_58__=__webpack_require__(926812),_web_attachments_view_selector_utils__WEBPACK_IMPORTED_MODULE_59__=__webpack_require__(644742),_shared_attachments_utils_sharedUtils__WEBPACK_IMPORTED_MODULE_60__=__webpack_require__(115208),_web_posting_carousel_posting_carousel__WEBPACK_IMPORTED_MODULE_61__=__webpack_require__(711373),_web_ord_utils__WEBPACK_IMPORTED_MODULE_62__=__webpack_require__(60411),_web_attachments_view_selector_constants__WEBPACK_IMPORTED_MODULE_63__=__webpack_require__(723294),_web_feed_feed_common__WEBPACK_IMPORTED_MODULE_64__=__webpack_require__(153663),_web_Badges_helpers__WEBPACK_IMPORTED_MODULE_65__=__webpack_require__(735786),_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_66__=__webpack_require__(51839),_shared_production_stats_types__WEBPACK_IMPORTED_MODULE_67__=__webpack_require__(317216),_shared_production_stats_click_feed_post_interaction__WEBPACK_IMPORTED_MODULE_68__=__webpack_require__(666994),_shared_feed_feed_utils__WEBPACK_IMPORTED_MODULE_69__=__webpack_require__(54998),_shared_short_video_utils__WEBPACK_IMPORTED_MODULE_70__=__webpack_require__(652547),_web_feed_components_text_stats__WEBPACK_IMPORTED_MODULE_71__=__webpack_require__(292985),_web_stickers_Stickers_helpers__WEBPACK_IMPORTED_MODULE_72__=__webpack_require__(996849),_web_feed_feed_stats__WEBPACK_IMPORTED_MODULE_73__=__webpack_require__(92187),_web_feed_feed_stats_utils__WEBPACK_IMPORTED_MODULE_74__=__webpack_require__(870465),_vkontakte_internal_api_client__WEBPACK_IMPORTED_MODULE_116__=__webpack_require__(957994),_shared_counters_tmr__WEBPACK_IMPORTED_MODULE_75__=__webpack_require__(251703),_shared_stickers_refactor_constants__WEBPACK_IMPORTED_MODULE_76__=__webpack_require__(33732),_shared_production_stats_click_feed_comments_sort_tab_click__WEBPACK_IMPORTED_MODULE_77__=__webpack_require__(160971),_web_feed_utils_miscellaneous__WEBPACK_IMPORTED_MODULE_78__=__webpack_require__(626209),_shared_feed_adblock_protection_attributes_hider__WEBPACK_IMPORTED_MODULE_79__=__webpack_require__(374339),_shared_feed_adblock_protection_post_masker__WEBPACK_IMPORTED_MODULE_80__=__webpack_require__(115939),_shared_pixels__WEBPACK_IMPORTED_MODULE_81__=__webpack_require__(248199),_web_posting_carousel_components_CarouselRatioSelector_initCarouselRatioSelector__WEBPACK_IMPORTED_MODULE_82__=__webpack_require__(94470),_web_posting_carousel_components_utils__WEBPACK_IMPORTED_MODULE_83__=__webpack_require__(700230),_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_84__=__webpack_require__(396482),_shared_feed_stats_click_three_dots__WEBPACK_IMPORTED_MODULE_85__=__webpack_require__(457872),_shared_posting_analytics_utils__WEBPACK_IMPORTED_MODULE_86__=__webpack_require__(971878),_shared_posting_analytics_types__WEBPACK_IMPORTED_MODULE_87__=__webpack_require__(821834),_shared_evbus__WEBPACK_IMPORTED_MODULE_88__=__webpack_require__(338329),_shared_adblock_protection_locator__WEBPACK_IMPORTED_MODULE_89__=__webpack_require__(962724),_shared_adblock_protection_detector__WEBPACK_IMPORTED_MODULE_90__=__webpack_require__(270262),_web_page_wall_report_voting_utils__WEBPACK_IMPORTED_MODULE_91__=__webpack_require__(164043),_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__=__webpack_require__(36644),_web_lib_nav_helpers__WEBPACK_IMPORTED_MODULE_112__=__webpack_require__(127609),_web_feed_utils_updatePost__WEBPACK_IMPORTED_MODULE_93__=__webpack_require__(68586),_web_page_tools_markAsSpam__WEBPACK_IMPORTED_MODULE_94__=__webpack_require__(763270),_web_page_tools_markAdAsSpam__WEBPACK_IMPORTED_MODULE_95__=__webpack_require__(497719),_web_page_tools_isAdPostMarkingAsSpam__WEBPACK_IMPORTED_MODULE_96__=__webpack_require__(763879),_web_page_tools_showIgnoreItemReasons__WEBPACK_IMPORTED_MODULE_97__=__webpack_require__(488737),_web_page_tools_ignoreAdsItem__WEBPACK_IMPORTED_MODULE_98__=__webpack_require__(468479),_web_page_tools_setAdReportHandler__WEBPACK_IMPORTED_MODULE_99__=__webpack_require__(273583),_shared_video_isFakeVideoStandalone__WEBPACK_IMPORTED_MODULE_100__=__webpack_require__(680261),_shared_video_isStandaloneOrVideoPage__WEBPACK_IMPORTED_MODULE_101__=__webpack_require__(11387);const renderReactCarousel=(0,_web_posting_carousel_posting_carousel__WEBPACK_IMPORTED_MODULE_61__.makeReactCarouselRenderer)(),noAttOnPage=(0,_shared_video_isStandaloneOrVideoPage__WEBPACK_IMPORTED_MODULE_101__.isStandaloneOrVideoPage)(),Wall={LS_ADS_EVENTS:"ads.events",postponedPosts:null,deleteAll:function(_,e,o){ajax.post("al_wall.php",{act:"delete_all",post:e,hash:o},{onDone:function(e){const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domPN)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domPN)(_));o.oldt=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(o,e)},showProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domNS)(_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domPN)(_).appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ce)("div",{className:"progress"})))},hideProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domNS)(_))}})},restoreAll:function(_,e,o){const i=Math.floor(1e5*Math.random());cur.wallRnd=i,ajax.post("al_wall.php",{act:"restore_all",post:e,hash:o,rnd:i},{onDone:function(e){const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domPN)(_);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(o,o.oldt)},showProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domNS)(_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domPN)(_).appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ce)("span",{className:"progress_inline"})))},hideProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domNS)(_))}})},deleteThread:function(_,e,o){ajax.post("al_wall.php",{act:"delete_thread",post:e,hash:o,from_deleted:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post"+e),"reply_deleted")},{onDone:function(o){let i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("dld_inner",_);if(i)i.oldElements=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(i),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(i,o);else{const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post"+e),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("reply_wrap",_);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)(s),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ce)("div",{id:"post_del"+e,className:"dld",innerHTML:'<span class="dld_inner">'+o+"</span>"}),_.appendChild(i)}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("replies_wrap_deep"+e)},showProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)(_);const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("post_actions",_);if(e)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)(e,"post_actions_progress");else{let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domNS)(_);e||(e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ce)("div",{className:"progress"}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domPN)(_).appendChild(e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)(e))}},hideProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)(_);const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("post_actions",_);e?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)(e,"post_actions_progress"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domNS)(_))}})},restoreThread:function(_,e,o){ajax.post("al_wall.php",{act:"restore_thread",post:e,hash:o},{onDone:function(){const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domPN)(_);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("replies_wrap_deep"+e),o.oldElements)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(o,o.oldElements);else{const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("reply_wrap","post"+e);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)("post_del"+e)}},showProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)(_);let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domNS)(_);e||(e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ce)("div",{className:"progress"}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domPN)(_).appendChild(e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)(e))},hideProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domNS)(_))}})},block:function(_,e,o,i,s){ajax.post("al_wall.php",{act:"block",post:e,hash:o,bl:i,from:s},{onDone:function(e){i?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domPN)(_).insertBefore((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ce)("span",{innerHTML:e}),_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)(_)):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domNS)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domPN)(_))),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domPN)(_)))},showProgress:function(){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.showProgress)(_,"post_inline_progress","post_inline_progress",!0)},hideProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)("post_inline_progress")}})},blockEx:function(_,e){(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_13__.showBox)("groupsedit.php",{act:"bl_edit",name:"id"+e,gid:_,auto:1},{stat:["page.css","ui_controls.js","ui_controls.css"]})},withMentions:!(_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.mozilla&&_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.version.match(/^2\./)||_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.mobile),editPost:function(_,e,o,i,s){if((0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_66__.isPostponedPostsUpdateEnabled)()&&Wall.postponedPosts?.isLocked())return;let l=_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.POSTING_TIMELINE_CREATION_ENTRY_POINTS.OTHER;if("groups"===cur.module?l=_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.POSTING_TIMELINE_CREATION_ENTRY_POINTS.COMMUNITY_INPUT:"feed"===cur.module?l=_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.POSTING_TIMELINE_CREATION_ENTRY_POINTS.FEED_INPUT:"profile"===cur.module&&(l=_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.POSTING_TIMELINE_CREATION_ENTRY_POINTS.PROFILE_INPUT),_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.postingTimelineLogger.logStartTimeline({isEditing:!0,creationEntryPoint:l,postType:_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.POSTING_TIMELINE_POST_TYPES.REGULAR}),cur.editingPost&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("wpe_text")){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("wall_posts",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("wpe_text"));if(!_||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)(_))return i&&i(),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.notaBene)("wpe_text");Wall.cancelEdit()}if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("feed_post_menu_stats")){const e=_ instanceof HTMLElement?(0,_web_feed_feed_common__WEBPACK_IMPORTED_MODULE_64__.getTrackCodeFromPost)(_):null;_shared_feed_stats_click_three_dots__WEBPACK_IMPORTED_MODULE_85__.FeedPostMenuStats.editPost(e,(0,_web_feed_feed_common__WEBPACK_IMPORTED_MODULE_64__.resolveRefFromCur)())}let a=null;(0,_web_wall_reply_utils__WEBPACK_IMPORTED_MODULE_38__.isInlineCommentsEnabled)()&&(a=_?.closest?.(".reply_inline"),a?.classList.remove("reply_inline"),a?.setAttribute("data-inline-comment-editing","")),cur.editingPost=[e],Wall.withMentions?window.stManager.add(["ui_controls.css","ui_controls.js",window.jsc("web/wall_edit.js")]):window.stManager.add([window.jsc("web/wall_edit.js")]);ajax.post("al_wall.php",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)({act:"edit",post:e,mention:Wall.withMentions?1:""},o),{onDone:async function(..._){if(_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.postingTimelineLogger.logScreenInteractionReady(),_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.postingTimelineLogger.logScreenInitialization(),(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_34__.isArray)(_[4])&&cur.options&&(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_34__.isArray)(cur.options.filter_media_types)){const e=[];(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.each)(_[4],(function(_,o){(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.each)(cur.options.filter_media_types,(function(_,i){if(o[0]===i[0])return e.push(i),!1}))})),_[4]=e}_.unshift(e),o&&o.fromAds&&_.push(o.fromAds);const[i,l,a,n,d,E,c]=_;WallEdit.editPost.call(window,i,l,a,n,d,E,c),s&&s()},onFail:()=>{cur.editingPost=!1,(0,_web_wall_reply_utils__WEBPACK_IMPORTED_MODULE_38__.isInlineCommentsEnabled)()&&(a?.classList.add("reply_inline"),a?.removeAttribute("data-inline-comment-editing")),i&&i()},showProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(_,"ui_actions_menu_item")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockActionsMenuItem)(_):_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_48__.FlatButton.isFlatButton(_)?_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_48__.FlatButton.lock(_):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("post_actions","post"+e),"post_actions_progress")},hideProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(_,"ui_actions_menu_item")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockActionsMenuItem)(_):_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_48__.FlatButton.isFlatButton(_)?_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_48__.FlatButton.unlock(_):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("post_actions","post"+e),"post_actions_progress")},noSort:!0})},editPostAsClip:function(_){Promise.all([__webpack_require__.e(91498),__webpack_require__.e(308),__webpack_require__.e(28261),__webpack_require__.e(71301),__webpack_require__.e(95432),__webpack_require__.e("langs/web/EditClipModal")]).then(__webpack_require__.bind(__webpack_require__,954653)).then((({initEditClipModal:e})=>{e(_,(_=>{if(_.wallPostId)return(0,_web_feed_utils_updatePost__WEBPACK_IMPORTED_MODULE_93__.updatePost)(_.wallPostId,_.ownerId).then((()=>{const _=Videoview.getPlayerObject();_&&_.isInline&&_.destroy()}))}))}))},fixPost:function(link,post,hash,value){return ajax.post("al_wall.php",{act:"a_fix_post",post,hash,value},{onDone:function(js){if(js)try{eval(js)}catch(_){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_26__.logEvalError)(_,js)}const postEl=cur.wallLayer==post?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("wl_post"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post"+post);(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("post_fixed"),(function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)(this,"post_fixed")})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.toggleClass)(postEl,"post_fixed",value),link&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(link,value?(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_unfix_post"):(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_fix_post")),link.onclick=function(){return Wall.fixPost(link,post,hash,value?0:1)}),cur.onWKFix&&(cur.onWKFix(value),delete cur.onWKFix)},showProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(link,"ui_actions_menu_item")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockActionsMenuItem)(link):_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockButton.pbind("wpe_fix"+post)},hideProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(link,"ui_actions_menu_item")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockActionsMenuItem)(link):_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton.pbind("wpe_fix"+post)}}),!1},cancelEdit:function(_){if(cur.editingPost){if(!0===_&&cur.editingPost[0].match(/^-?\d+_/))return;window.WallEdit?WallEdit.cancelEditPost():cur.editingPost=!1}},searchWall:function(){},switchTabContent:function(_){switch((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("page_wall_posts","page_postponed_posts","page_suggested_posts","page_search_posts","page_top_posts","page_archive_posts","page_donut_posts"),_){case"own":case"all":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("page_wall_posts");break;case"postponed":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("page_postponed_posts"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("wall_more_link");break;case"suggested":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("page_suggested_posts");break;case"search":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("page_search_posts");break;case"top":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("page_top_posts");break;case"archive":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("page_archive_posts");break;case"donut":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("page_donut_posts")}},switchWall:function(_,e,o){if(e&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.checkEvent)(e))return!0;if(o||(o="own"==cur.wallType?"all":"own"),e&&"click"==e.type&&e.clientX&&e.offsetX&&cur.wallTab==o&&cur.wallType==o&&"top"!==o)return nav.go(_,e);if("postponed"==cur.wallTab&&(console.log("clean up on switch wall"),Wall.postponedPosts?.cleanUp(),wall.checkPostponedCount(),uiTabs.hideSort()),"archive"!==cur.wallTab&&"archive"!==o||((cur.wallLayer?wkcur:cur).wallMyDeleted={}),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.isFunction)(cur.wallArchiveFeatureTooltipHide)&&cur.wallArchiveFeatureTooltipHide(),!(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.inArray)(o,["top","archive","donut"])){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("page_wall_posts");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)(_,"own"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)(_,"all"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)(_,o)}cur.wallType=o,cur.wallTab=o,uiTabs.switchTab(_),uiTabs.hideProgress(_),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.inArray)(o,["top","archive","donut"])?(cur.baseWallModule=cur.module,cur.module="wall_"+o,cur.topWallFeatureTT&&cur.topWallFeatureTT.hide()):cur.baseWallModule&&(cur.module=cur.baseWallModule,delete cur.baseWallModule);const i="donut"===o&&Wall.cantAccessDonutPosts();return Wall.hasPosts()||i?(Wall.update(),Wall.showWall()):(cur.wallNextFrom=0,cur.wallTopNextFrom=0,cur.wallArchiveNextFrom=0,cur.wallArchiveRestored=0,cur.wallArchiveArchived=0,cur.wallArchiveRolledback=0,cur.wallDonutNextFrom=0,"top"===o?delete cur.wallTopFinished:"archive"===o?delete cur.wallArchiveFinished:"donut"===o&&delete cur.wallDonutFinished,uiTabs.showProgress(_),Wall.showMore(0,_)),_?.dataset?.donutLogEvent&&(0,_shared_donut_stats_donut_log__WEBPACK_IMPORTED_MODULE_43__.logDonutEvent)(_.dataset.donutLogEvent),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.cancelEvent)(e)},resetWall:function(){if(cur.wallType&&cur.wallTab){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("_wall_tab_"+cur.wallType);_&&(cur.wallNextFrom=0,cur.wallTopNextFrom=0,cur.wallArchiveNextFrom=0,(cur.wallLayer?wkcur:cur).wallMyDeleted={},"top"===cur.wallType?delete cur.wallTopFinished:"archive"===cur.wallType?delete cur.wallArchiveFinished:"donut"===cur.wallType&&delete cur.wallDonutFinished,uiTabs.showProgress(_),Wall.showMore(0,_,!0))}},hasPosts:function(_){_=_||cur.wallType;const e=Wall.getPostsWrap(_);return!!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("post",e)},getPostsWrap:function(_){switch(_){case"archive":return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("page_archive_posts");case"top":return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("page_top_posts");case"donut":return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("page_donut_posts");default:return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("page_wall_posts")}},showSuggested:function(ev,rows,notAll){if(ev&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.checkEvent)(ev))return!0;if(!cur.oid)return!1;let el=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("page_wall_suggest");if(el=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(el,"unshown")?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domQuery1)("#page_wall_suggest_more .ui_tab_group_item"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("ui_tab",el),!el)return!1;if(uiTabs.switchTab(el),cur.wallTab="suggested",delete cur.suggestedDeletedCount,void 0!==rows)wall.suggestLoaded(rows,notAll);else{if(cur.suggestedLoading)return!1;const curOid=cur.suggestedLoading=cur.oid;uiTabs.showProgress(el),ajax.post("al_wall.php",{act:"get_suggests",owner_id:cur.oid},{onDone:function(rows,notAll,js,count){if(js)try{eval(js)}catch(_){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_26__.logEvalError)(_,js)}cur.suggestedLoading=!1,uiTabs.hideProgress(el),Wall.updateTabCounter("page_wall_suggested_cnt",count),curOid===cur.oid&&"suggested"==cur.wallTab&&wall.suggestLoaded.apply(window,arguments)}})}return!1},deleteSuggested:function(_,e,o,i){if((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isButtonLocked)(i))return;(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockButton)(i);const s=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_13__.showFastBox)({title:(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("global_action_confirmation"),onHide:function(){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton)(i)}},(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_delete_suggested_box"),(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_delete_suggested_btn"),(function(i){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isButtonLocked)(i)||((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockButton)(i),ajax.post("al_wall.php",{act:"delete_suggested",post_id:_,hash:o,group_id:e},{onDone:function(_){if("full_own"==cur.wallType||"full_all"==cur.wallType){const e=(Math.ceil(_/cur.pgPerPage)-1)*cur.pgPerPage;e<cur.pgOffset&&(e>0?nav.objLoc.offset=e:delete nav.objLoc.offset,nav.setLoc(nav.objLoc)),nav.reload()}else Wall.showSuggested();s.hide()},showProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockButton)(i),hideProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton)(i)}))}),(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("global_cancel"))},suggestLoaded:function(_,e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("page_suggested_posts",_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.toggle)("wall_more_link",e),wall.switchTabContent("suggested")},suggestMore:function(){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("page_suggested_posts"),e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("wall_more_link");(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isButtonLocked)(e)||ajax.post("al_wall.php",{act:"get_suggests",owner_id:cur.oid,offset:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("post",_).length-(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("dld",_).length},{onDone:function(o,i){const s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ce)("div",{innerHTML:o});let l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domFC)(s);for(;l;)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)(l.id)||!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(l,"post")?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)(l):_.appendChild(l),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domFC)(s);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.toggle)(e,i)},showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockButton.pbind(e),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton.pbind(e)})},suggestUpdate:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("page_suggests_count");let o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(e));e&&(-1!==_&&1!==_||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(e,o+=_),Wall.updateTabCounter("page_wall_suggested_cnt",o))},suggestPublished:function(_,e,o){if(_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.postingTimelineLogger.logSuccessfullySend(),cur.onepost)return nav.go("/wall"+cur.oid);if(Wall.suggestUpdate(-1),(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("posting_web_react_form")||(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_17__.showDoneBox)(e),cur.wallMyDeleted[_]=1,cur.editingPost=!1,(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("posting_web_react_form")||(Wall.deinitComposer((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("wpe_text")),Wall.deinitHashtagComposer((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("wpe_text"))),"full_own"!=cur.wallType&&"full_all"!=cur.wallType||(Pagination.recache(-1),FullWall.updateSummary(cur.pgCount)),cur.postWpeIsPoster=!!cur.posterWpeSendParams,cur.posterWpe&&cur.posterWpeSendParams&&WallEdit.posterDestroy(),o){const _=document.getElementById("page_postponed_posts");let e="";(0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_66__.isPostponedPostsActResult)(o)?(Wall.postponedPosts?.updateState({postsSize:o.count}),wall.postponeUpdateCount(Wall.postponedPosts?.getPostsSize()),e=o.rendered_posts):(wall.postponeUpdateCount(),e=o),_&&(_.innerHTML=e)}if((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("page_suggests_count")))(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)("post"+_);else{const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("wall_rmenu");_?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("ui_rmenu_item",_).click(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("_wall_menu_suggested",_))):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("wall_tabs")&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("ui_tab",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("wall_tabs")).click(),wall.updateTabVisibility("page_wall_suggest",!1))}},showDonutWall:function(_){if(!cur.oid)return!1;const e="donut";Wall.updateTabVisibility("page_wall_donut",!0);const o=Wall.getWallTabLink(e);if(!o)return!1;uiTabs.switchTab(o),cur.wallTab=e,cur.wallType=e,void 0!==_&&Wall.donutWallSetRows(_)},donutWallSetRows(_){const e="donut",o=Wall.getPostsWrap(e);o&&(o.innerHTML=_,Wall.switchTabContent(e),Wall.update())},getWallTabLink:_=>{const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)(`page_wall_${_}`);return((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(e,"unshown")?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domQuery1)(`#page_wall_${_}_more .ui_tab_group_item`):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("ui_tab",e))||null},showPostponedFull:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("ui_rmenu_postponed"),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("page_wall_posts");if(!e||!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(e,"ui_rmenu_item_sel")||!o){const _={0:nav.objLoc[0],postponed:1};return nav.go(_)}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(o,_),FullWall.updateSummary((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("post",o).length)},initPostponedSort(){const _=document.querySelector(".js-ui_tab_sort_wrap");function e(){Wall.postponedPosts?.toggleSort(),Wall.showPostponed({},void 0,!0)}return _?.addEventListener("click",e),()=>{_?.removeEventListener("click",e)}},showPostponed:function(_,e,o=!1){const i=Number(document.querySelector(".page_wall_postponed_cnt")?.innerHTML||0),s=Number(Wall.postponedPosts?.getPostsSize()||window.cur.postponedPostsCount||0),l=Boolean(o||i!==s);if(_&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.checkEvent)(_)&&!l)return!0;if(!cur.oid)return!1;if("postponed"===cur.wallTab&&!e&&!l)return!1;let a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("page_wall_postponed");if(a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(a,"unshown")?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domQuery1)("#page_wall_postponed_more .ui_tab_group_item"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("ui_tab",a),!a)return!1;if(uiTabs.switchTab(a),cur.wallTab="postponed",void 0!==e){const _=(0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_66__.isPostponedPostsActResult)(e)?e.rendered_posts:e,o=(0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_66__.isPostponedPostsActResult)(e)?e.count:void 0;Wall.postponedLoaded(_,o),Wall.postponedPosts?.updateState({offset:e.starts_from??0,limit:e.limit,postsSize:e.count}),(0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_66__.isPostponedPostsActResult)(e)&&(0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_66__.isPostponedPostsParallelLoadingEnabled)()?Wall.postponedPosts?.loadAllAfterPosting(e):(0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_66__.isPostponedPostsActResult)(e)&&Wall.postponedPosts?.loadAfterPosting(e)}else{if(cur.postponedLoading)return!1;const _=cur.postponedLoading=cur.oid;uiTabs.showProgress(a);const e=()=>{cur.postponedLoading=!1,uiTabs.hideProgress(a),uiTabs.showSort(),_===cur.oid&&cur.wallTab};if(Wall.postponedPosts?.canStartInitialLoading()||l){if((0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_66__.isPostponedPostsParallelLoadingEnabled)())return Wall.postponedPosts?.updateState({offset:0,ownerId:window.cur.oid,limit:window.cur.postponedPostsRequestLimit,postsSize:window.cur.postponedPostsCount}),Wall.postponedPosts?.loadInParallel(0,{onLoaded:_=>{e(),Wall.postponedLoaded(_.rendered_posts,_.count)}}),!1;Wall.postponedPosts?.loadInitialForPagination({onLoaded:_=>{e(),Wall.postponedLoaded(_.rendered_posts,_.count)},onError:()=>{cur.postponedLoading=!1,uiTabs.hideProgress(a)}})}else cur.postponedLoading=!1,uiTabs.hideProgress(a),uiTabs.showSort(),wall.switchTabContent("postponed"),Wall.postponedPosts?.loadOnTabReturn()}return!1},showSortTooltip(_,e){(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_12__.showTooltip)(_,{text:e,typeClass:"tt_black",slide:4,shift:[10,8],hasover:1,showdt:50,hidedt:50,dir:"auto"})},postponedLoaded:function(_,e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("page_postponed_posts",_),wall.switchTabContent("postponed"),e?wall.postponeUpdateCount(e):wall.postponeUpdateCount()},postponeUpdateCount:function(_){let e=0;if(_)e=_;else{const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("page_postponed_posts");if(e=_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("post",_).length-(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("dld",_).length||0,!_)return}Wall.updateTabCounter("page_wall_postponed_cnt",e)},checkPostponedCount:function(){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("post","page_postponed_posts");let e=0;(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.each)(_,(function(){const _=this.id.replace("post","");cur.wallMyDeleted[_]||e++})),e||wall.updateTabVisibility("page_wall_postponed",!1)},updateTabCounter:function(_,e){e=e?(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_23__.langNumeric)(e,"%s",!0):"",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)(_).forEach((function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(_,e);const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domPN)(_);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(o,"ui_tab_group_item")&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(o,"default-label",o.innerHTML)}))},updateTabVisibility:function(_,e){const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("page_wall_more_tab");if(o)if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)(o))if(e){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(_,"unshown")&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(_+"_more","unshown")){let e=!1;cur.wallTabsMorePriority.forEach((function(o){e||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(o,"unshown")||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)(o,"unshown"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)(o+"_more","unshown"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)(_,"unshown"),e=!0)})),e||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)(_+"_more","unshown")}}else{const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)(_);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(e,"unshown"))(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)(_+"_more"),"unshown");else{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)(e,"unshown");const _=cur.wallTabsLimit-1-(0,_wall_tabs_utils__WEBPACK_IMPORTED_MODULE_41__.getNavigableTabs)(o).length;if(_>0){let e=_;cur.wallTabsMorePriority.forEach((function(_){if(e<=0)return;const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)(_+"_more");o&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(o,"unshown")&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)(_),"unshown"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)(o,"unshown"),e--)}))}}const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("ui_tab_group_item",o);i.length-(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("unshown",o).length<=1&&(i.forEach((function(_){_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domPN)(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(_,"unshown")||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)(_.id.replace(/_more$/,"")),"unshown"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)(_,"unshown"))})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)(o,"unshown"))}else{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.toggleClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)(_),"unshown",!e);const i=(0,_wall_tabs_utils__WEBPACK_IMPORTED_MODULE_41__.getNavigableTabs)(o).length;if(i>cur.wallTabsLimit){let _=i-(cur.wallTabsLimit-1);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("ui_tab_group_item",o).forEach((function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)(_,"unshown")})),cur.wallTabsMorePriority.forEach((function(e){if(_<=0)return;const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)(e);o&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(o,"unshown")&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)(o,"unshown"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)(e+"_more"),"unshown"),_--)})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)(o,"unshown"),(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_19__.statlogsValueEvent)("wall_more_tab_shown",cur.oid)}}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.toggleClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)(_),"unshown",!e)},postponedPublished:function(_,e){if(cur.onepost)return nav.go("/wall"+cur.oid);if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("post_context_menu_web")&&window.cur.wallLayer)return nav.go("/wall"+cur.oid);"full_own"!=cur.wallType&&"full_all"!=cur.wallType||(Pagination.recache(-1),FullWall.updateSummary(cur.pgCount)),e&&(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_17__.showDoneBox)(e),cur.wallMyDeleted[_]=1;const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("post",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("page_postponed_posts")),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post"+_);if(o.length<=1&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.inArray)(i,o)){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("wall_rmenu");_?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("ui_rmenu_item",_).click(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("_wall_menu_postponed",_))):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("wall_tabs")&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("ui_tab",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("wall_tabs")).click(),wall.updateTabVisibility("page_wall_postponed",!1))}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)(i),Wall.postponedPosts?.removePost(),wall.postponeUpdateCount(Wall.postponedPosts?.getPostsSize())},onWallSearchSend:function(_,e){e?Wall.showSearch(e,0):Wall.hideSearch()},showSearch:function(_,e){if(cur.searchLoading&&cur.searchLoading==_||!cur.oid)return!1;const o=cur.oid;cur.wallQuery=cur.searchLoading=_,"search"!=cur.wallTab&&(cur.prevWallTab=cur.wallTab,cur.wallTab="search");const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("wall_more_link"),s=+new Date;return ajax.post("al_wall.php",{act:"s",search:1,q:_,owner_id:cur.oid,offset:e,inline:1,owners_only:1},{onDone:function(l,a,n){if(o!==cur.oid)return;if("search"!=cur.wallTab)return;const d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("page_search_posts");e||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(d,""),d.appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.cf)(l)),wall.switchTabContent("search"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.toggle)(i,a<n),i.onclick=Wall.showSearch.pbind(_,a);const E=_shared_ranges__WEBPACK_IMPORTED_MODULE_57__.Ranges.isUserIdTransitional(cur.oid)?_web_lib_stats__WEBPACK_IMPORTED_MODULE_18__.serviceWallUsers:_web_lib_stats__WEBPACK_IMPORTED_MODULE_18__.serviceWallGroups,c=+new Date-s;(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_18__.saveSearchAttemptStats)(E,0,n,_,0,0,c)},showProgress:function(){uiSearch.showProgress("wall_search"),e&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockButton)(i)},hideProgress:function(){cur.searchLoading=!1,uiSearch.hideProgress("wall_search"),e&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton)(i)}}),!1},hideSearch:function(){if(delete cur.wallQuery,!cur.prevWallTab)return;const _=(_shared_ranges__WEBPACK_IMPORTED_MODULE_57__.Ranges.isUserIdTransitional(cur.oid),_web_lib_stats__WEBPACK_IMPORTED_MODULE_18__.serviceWallUsers);(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_18__.removeSearchPositionTracker)(_),cur.wallTab=cur.prevWallTab,cur.prevWallTab=!1,wall.switchTabContent(cur.wallTab),wall.update(),(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("hide_feed_post_search")&&window.nav.objLoc.q&&(delete nav.objLoc.q,window.nav.setLoc(nav.objLoc))},publishPostponedPost:function(_,e,o){(0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_66__.isPostponedPostsUpdateEnabled)()&&Wall.postponedPosts?.isLocked()||(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_13__.showFastBox)((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("global_action_confirmation"),(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_publish_postponed_confirm"),(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_publish_postponed_btn"),(function(){(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_17__.curBox)().hide(),ajax.post("al_wall.php",{act:"publish_postponed",post:_,from:o,hash:e},{onDone:Wall.postponedPublished.pbind(_),showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockButton.pbind("wpe_publish"+_),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton.pbind("wpe_publish"+_)})}),(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("global_cancel"))},publishFreeDonutCopy:function(_,e,o,i,s=!1){const l=_.currentTarget,a=i?{title:(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("global_warning"),content:(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_publish_donut_as_free_confirmation_warn")}:{title:(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_publish_donut_as_free_confirmation_title"),content:(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_publish_donut_as_free_confirmation_confirm")},n=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_13__.showFastBox)(a.title,a.content,(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_publish_donut_as_free_confirmation_btn"),(()=>{const _=()=>{n.hide()},i=n.btns.ok[0];ajax.post("al_wall.php",{act:"publish_free_donut_copy",post_id:e,hash:o},{onDone:e=>{s?e&&(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_17__.showDoneBox)(e,{timeout:3e3}):Wall.publishFreeDonutCopyDone({menuActionEl:l,message:e}),_()},onFail:()=>{_()},showProgress:()=>{(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockButton)(i)},hideProgress:()=>{(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton)(i)}})}),(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("global_cancel"))},publishFreeDonutCopyDone({message:_,menuActionEl:e}){"full_own"!==cur.wallType&&"full_all"!==cur.wallType||(Pagination.recache(-1),FullWall.updateSummary(cur.pgCount)),_&&(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_17__.showDoneBox)(_,{timeout:3e3}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)(e)},cmp:function(_,e){const o=_.length,i=e.length;return o<i?-1:o>i?1:_<e?-1:_>e?1:0},cleanBlocksDefault:["page_top_posts","page_wall_posts","page_archive_posts","page_donut_posts"],cleanBlocks:function(_=Wall.cleanBlocksDefault){_.forEach((function(_){if("page_donut_posts"===_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("wall_donut_info"))return;let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domFC)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)(_));for(;e;){const _=e;e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domNS)(e),_.tagName&&"input"===_.tagName.toLowerCase()||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)(_)}}))},receive:function(_,e,o,i){o=o||cur.wallType,i=!0===i;const s=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("post_adblock_protection_promo")?_shared_adblock_protection_locator__WEBPACK_IMPORTED_MODULE_89__.Locator.getInstance().lookupClassName("_ads_promoted_post"):"_ads_promoted_post",l="top"===o,a="archive"===o,n="donut"===o,d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ce)("div",{innerHTML:_}),E=!!cur.options.revert,c=Wall.getPostsWrap(o),p=[];let P,u,b,O,D=[],M=0;if(i)D=Wall.cleanBlocksDefault;else{const[,_]=[[a,"page_archive_posts"],[l,"page_top_posts"],[n,"page_donut_posts"],[!0,"page_wall_posts"]].find((([_])=>_));D=Wall.cleanBlocksDefault.filter((e=>e!==_)),b=E?c.firstChild:c.lastChild}function w(_){return!!(_&&_.tagName&&"div"===_.tagName.toLowerCase()&&_.id&&"post"===_.id.substr(0,4))&&_.id}Wall.cleanBlocks(D);for(let _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)(E?d.firstChild:d.lastChild);_;_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)(E?d.firstChild:d.lastChild)){if("input"==_.tagName.toLowerCase()){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)(_.id);e?c.replaceChild(_,e):c.firstChild?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domInsertBefore)(_,c.firstChild):c.appendChild(_);continue}if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(_,"post_fixed")&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)(_.id))continue;if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(_,s)){p.push({el:_,beforePost:w(E?d.firstChild:P),afterPost:w(E?P:d.lastChild)});continue}const e=(_,e)=>{const o=_?.dataset?.slavePostId?`post${_?.dataset?.slavePostId}`:_?.id,i=e?.dataset?.slavePostId?`post${e?.dataset?.slavePostId}`:e?.id;return Wall.cmp(o,i)};for(;b&&b.tagName&&"div"==b.tagName.toLowerCase()&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(b,"post_fixed")&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(b,s)||!l&&!a&&e(b,_)<0);)b=E?b.nextSibling:b.previousSibling;++M,b?e(b,_)?(O=b,u=E?b.previousSibling:b.nextSibling,u&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(u,s)&&(O=u),E?c.insertBefore(_,O):c.insertBefore(_,O.nextSibling)):(c.replaceChild(_,b),b=_,--M):E?c.appendChild(_):c.insertBefore(_,c.firstChild),P=_,(0,_web_lib_input_utils__WEBPACK_IMPORTED_MODULE_27__.placeholderSetup)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByTag1)("textarea",_),{fast:1})}if(p.length)for(let _=0,e=p.length;_<e;++_){const e=p[_];if(!e.beforePost&&!e.afterPost)continue;let o="no_position";for(let _=E?c.firstChild:c.lastChild;_;_=E?_.nextSibling:_.previousSibling){O=null;const i=w(_);if(i){if(e.beforePost===i?O=_:e.afterPost===i&&(O=_.nextSibling),O&&(O.previousSibling&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(O.previousSibling,s)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(O,s))){O=null,o="ads_sibling";break}if(O){c.insertBefore(e.el,O),o=!1;break}}}o&&(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_19__.statlogsValueEvent)("debug_watch",1,"js_page_ads_promoted_post_no_position",o)}l&&!M?cur.wallTopFinished=cur.oid:a&&!M?cur.wallArchiveFinished=cur.oid:n&&!M&&(cur.wallDonutFinished=cur.oid),"full_own"!==o&&"full_all"!==o||(Pagination.recache(M),FullWall.updateSummary(cur.pgCount)),Wall.update(),wall.addReplyNames(e),Wall.updateMentionsIndex(),M&&(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_102__.getAudioPlayer)().updateCurrentPlaying()},showMore:function(_,e,o){if(cur.viewAsBox)return cur.viewAsBox();if(cur.wallLayer)return;if("suggested"===cur.wallTab)return Wall.suggestMore();if(cur.wallTypeLoading&&cur.wallTypeLoading[cur.wallType]||"top"===cur.wallType&&cur.wallTopFinished===cur.oid||"archive"===cur.wallType&&cur.wallArchiveFinished===cur.oid||"donut"===cur.wallType&&cur.wallDonutFinished===cur.oid)return;const i=cur.wallType,s="top"===i,l="archive"===i,a="donut"===i,n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("wall_more_link"),d=cur.wallLoading=cur.oid,E=s&&!!cur.wallTopOnlyCache;let c="";0!==_&&(c=l?cur.wallArchiveNextFrom:s?cur.wallTopNextFrom:a?cur.wallDonutNextFrom:cur.wallNextFrom),cur.wallTypeLoading=cur.wallTypeLoading||{},cur.wallTypeLoading[i]=!0,o=!0===o&&!_;let p={};(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("post_adblock_protection_promo")&&(0,_shared_adblock_protection_detector__WEBPACK_IMPORTED_MODULE_90__.getAdblockState)().detected&&(p.adblock=1),ajax.post("al_wall.php",{act:"get_wall",owner_id:cur.oid,offset:_,type:i,fixed:cur.options.fixed_post_id||"",wall_start_from:c,onlyCache:E,...p},{local:1,onDone:function(n,E,c,p){return e&&uiTabs.hideProgress(e),d!==cur.oid||i!==cur.wallType?(delete cur.wallLoading,void delete cur.wallTypeLoading[i]):s&&(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_34__.isObject)(n)&&n.wait?(cur.wallTopLoadingDelay=cur.wallTopLoadingDelay?cur.wallTopLoadingDelay+100:200,void(cur.wallTopLoadingDelay<500?setTimeout((function(){delete cur.wallLoading,delete cur.wallTypeLoading[i],Wall.showMore(_)}),cur.wallTopLoadingDelay):(delete cur.wallLoading,delete cur.wallTypeLoading[i],cur.wallTopOnlyCache=!1,Wall.showMore(_)))):(delete cur.wallTopLoadingDelay,cur.wallVideos&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.each)(c,(function(_,e){cur.wallVideos[_]&&(cur.wallVideos[_].list=cur.wallVideos[_].list.concat(e.list))})),l?cur.wallArchiveNextFrom=p:s?cur.wallTopNextFrom=p:a?cur.wallDonutNextFrom=p:cur.wallNextFrom=p,void setTimeout((function(){Wall.receive(n,E,i,o),_||i!==cur.wallType||Wall.showWall(),delete cur.wallLoading,delete cur.wallTypeLoading[i]}),0))},showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockButton.pbind(n),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton.pbind(n)})},showWall:function(){wall.switchTabContent(cur.wallType);const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getXY)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domClosest)("wall_module",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("page_wall_posts")))[1];_<(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_20__.scrollGetY)()&&(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_20__.scrollToY)(_-15)},checkTextLen:function(_,e,o){const i=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.trim)(Emoji.editableVal(_).replace(/\n\n\n+/g,"\n\n"));if(_.lastLen===i.length&&!o)return void(window.FullWall&&cur.onepost&&FullWall.onePostOnScroll());const s=_.lastLen=i.length,l=(cur.options||{}).max_post_len||(window.mvcur||{}).maxReplyLength,a=s-i.replace(/\n/g,"").length;e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)(e),s>l-100||a>4?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)(e),e.innerHTML=s>l?(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("global_recommended_exceeded",s-l):a>4?(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("global_recommended_lines",a-4):(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("text_N_symbols_remain",l-s)):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)(e),window.FullWall&&cur.onepost&&FullWall.onePostOnScroll()},checkPostLen:_web_page_wall_utils__WEBPACK_IMPORTED_MODULE_49__.checkPostLen,postChanged:function(_,e){const o=Wall.isPosterEditorOpen();if((o||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("submit_post"))&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("submit_post_box"),"shown")||Wall.showEditPost(void 0,!1,Boolean(e)),vk.id&&!vk.widget&&!cur.options?.no_draft){clearTimeout(cur.postAutosave);const e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)(cur.oid)==vk.id?Wall.saveDraft:Wall.saveOwnerDraftText.pbind(cur.oid);!0===_?e():cur.postAutosave=setTimeout(e,10===_?10:1e3)}o||(setTimeout((()=>Wall.checkPostLen(window.cur.postField,window.cur.postWarningField,window.cur.sendPostBtn))),setTimeout(Wall.checkPosterAvailability))},ownerDraftKey:function(_){return(0,_web_wall_wall_utils__WEBPACK_IMPORTED_MODULE_40__.buildOwnerDraftKey)(_)},ownerDraftData:function(){return cur.wallDraftData||(cur.wallDraftData={}),cur.wallDraftData},addOwnerDraftMedia:function(_,e){if(cur.options?.no_draft)return;const o=Wall.ownerDraftData(),i=e[0],s=e[1];let l=e[2];o._attach_cache=o._attach_cache||{},l?o._attach_cache[i+s]=l:l=o._attach_cache[i+s],o.attaches=o.attaches||[];const a=ls.get(Wall.ownerDraftKey(_))||{};!1!==i?o.attaches.push([i,s,l,o.attaches.length]):!1===i&&void 0!==s&&(o.attaches=o.attaches.filter((function(_){return _[3]!==s}))),ls.set(Wall.ownerDraftKey(_),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)(a,{txt:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.clean)(Wall.getDraftData().message||""),medias:o.attaches}))},cleanOwnerDraftMedia:function(_){if(cur.options?.no_draft)return;const e=Wall.ownerDraftData(),o=ls.get(Wall.ownerDraftKey(_))||{};e.attaches=[],ls.set(Wall.ownerDraftKey(_),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)({txt:""},o,{medias:[]}))},saveOwnerDraftText:function(_){if(cur.postFieldZoomText&&cur.postFieldZoomText(cur.postField,cur.wallAddMedia),cur.options?.no_draft)return;const e=Wall.ownerDraftData(),o=ls.get(Wall.ownerDraftKey(_))||{},i=Wall.getDraftData(),s=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.clean)(i.message||"");let l=null;if(e.txt=s,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.each)(o.medias||{},(function(_,e){switch(e[0]){case"postpone":i.postpone&&(o.medias[_][1]=i.postpone,o.medias[_][2].draft=1);break;case"poll":const e=(cur.wallAddMedia||{}).pollData(!0,!0);e&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)(o.medias[_][2],e);break;case"copyright":const s=(cur.wallAddMedia||{}).copyrightData(!0);s&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)(o.medias[_][2],s);break;case _web_donut__WEBPACK_IMPORTED_MODULE_29__.ATTACH_DATA_DONUT_DURATION:i[_web_donut__WEBPACK_IMPORTED_MODULE_29__.ATTACH_DATA_DONUT_DURATION]&&(o.medias[_][2]=Object.assign(o.medias[_][2]||{},{[_web_donut__WEBPACK_IMPORTED_MODULE_29__.ATTACH_DATA_DONUT_DURATION]:i[_web_donut__WEBPACK_IMPORTED_MODULE_29__.ATTACH_DATA_DONUT_DURATION]}))}})),s&&i.bkg_id&&(l={id:i.bkg_id},cur.poster&&cur.poster.isCustomBkgId(i.bkg_id)&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)(l,cur.poster.getCustomBkg()),o.bkg_id&&delete o.bkg_id),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)(o,{txt:s,bkg:l}),cur.shareShowImg&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)(o,{shareShowImg:cur.shareShowImg}),_shared_ranges__WEBPACK_IMPORTED_MODULE_57__.Ranges.isGroupId(_)){const _=cur.poster?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("submit_post_box"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domClosest)("_submit_post_box",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("official"));(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)(o,{from:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(_,"from-oid")||vk.id,signed:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isChecked)("signed")?1:0});(0,_web_donut__WEBPACK_IMPORTED_MODULE_29__.fieldValueIsDonutOnlyPost)(_,cur.wallAddMedia)?o.donutOnly=1:delete o.donutOnly}ls.set(Wall.ownerDraftKey(_),o)},getOwnerDraft:function(_){if(cur.options?.no_draft)return[];const e=ls.get(Wall.ownerDraftKey(_))||[],o={from:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)(e.from),signed:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)(e.signed),shareShowImg:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)(e.shareShowImg)};return(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)(e.donutOnly)&&(o.donutOnly=1),[e.txt,e.medias,!0,o,e.bkg]},saveOwnerDraftMedia:function(_,e,o,i){if(cur.options?.no_draft)return;Wall.cleanOwnerDraftMedia(_);const s=cur.wallAddMedia||{};let l=[],a=(cur.wallAddMedia?s.getMedias():[]).slice().map((function(_){return _.slice(0,2)}));void 0!==o&&e?l=[[e,o,i]]:e||void 0===o||a.splice(o,1),a=a.concat(l),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.each)(a,(function(){Wall.addOwnerDraftMedia(_,this)}))},saveDraft:function(){if(cur.postFieldZoomText&&cur.postFieldZoomText(cur.postField,cur.wallAddMedia),cur.options?.no_draft)return;if(cur.noDraftSave)return void(cur.noDraftSave=!1);if(cur.postSent||vk.id!=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)(cur.oid))return;const _=Wall.getDraftData();_.delayed||ajax.post("al_wall.php",Wall.fixPostParams((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)({act:"save_draft",hash:cur.options.post_hash},_)),{onFail:function(){return!0}})},getDraftData:function(){if(cur.options?.no_draft)return{};const _=cur.wallAddMedia||{},e=_.chosenMedia||{},o=cur.wallAddMedia?_.getMedias():[],i=_.shareData||{};let s="",l=0,a=null;if(Wall.isPosterEditorOpen())s=cur.poster.getText(),a=s?cur.poster.getBkgId():null;else{const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post_field");s=window.Emoji?Emoji.editableVal(_):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(_),s=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.trim)(s)}let n={message:s,bkg_id:a};return(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_34__.isArray)(e)&&e.length&&o.push((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.clone)(e)),o.length&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.each)(o,(function(e,o){if(!o)return;const a=this[0];let d=this[1];switch(a){case"poll":const e=_.pollData(!0,!0);if(!e)return n.delayed=!0,!1;d=e.question,delete e.question,n=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)(n,e);break;case"copyright":const l=_.copyrightData(!0);if(l)return void(n=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)(n,l));break;case"share":if(i.failed||!i.title&&(!i.images||!i.images.length)&&!i.photo_url&&!i.video)return cur.shareLastParseSubmitted&&Date.now()-cur.shareLastParseSubmitted<2e3?(n.delayed=!0,!1):void 0;i.video?(d=i.video_owner_id+"_"+i.video_id,n.snippet_video=1):d=i.user_id&&i.photo_id&&!i.noPhoto?i.user_id+"_"+i.photo_id:"",i.initialPattern&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.trim)(s)==i.initialPattern&&(n.message=""),i.is_vk_mini_app&&(n.is_vk_mini_app=!0,n.is_photo_edit=i.isPhotoEdit,n.image_offset=cur.shareShowImg),n=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)(n,{url:i.url,module:cur.module,mode:i.mode,title:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.replaceEntities)(i.title),description:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.replaceEntities)(i.description),button_text:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.replaceEntities)(i.button_text),button_action:i.button_action,extra:i.extra,extra_data:i.extraData,photo_url:i.video?"":(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.replaceEntities)(i.photo_url),open_graph_data:(i.openGraph||{}).data,open_graph_hash:(i.openGraph||{}).hash});break;case"page":i.initialPattern&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.trim)(s)==i.initialPattern&&(n.message="");break;case"postpone":const a=+_.postponeDate;return void(n=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)(n,{postpone:a}));case"mark_as_ads":return void(n=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)(n,{mark_as_ads:1}));case _web_donut__WEBPACK_IMPORTED_MODULE_29__.ATTACH_DATA_DONUT_DURATION:return void(n=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)(n,(0,_web_donut__WEBPACK_IMPORTED_MODULE_29__.getPostParamsFromDurationMedia)(o)))}this[3]&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.trim)(s)==this[3]&&(n.message=""),n["attach"+(l+1)+"_type"]=a,n["attach"+(l+1)]=d,l++})),n},setDraft:function(_){if(cur.options?.no_draft)return;if(!(_[0]||_[1]&&_[1].length||null!=_[4]))return;const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post_field");if(!e)return;const o=_[4];o||Emoji.val(e,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.clean)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.replaceEntities)(_[0]||"")).replace(/\n/g,"<br/>")),Wall.showEditPost((function(){setTimeout((function(){if(o&&cur.poster){Wall.hidePosterFeatureTooltip();const i={text:_[0]||""};if((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.isString)(o)?i.bkgId=_[4]:(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_34__.isObject)(o)&&(cur.poster.isCustomBkgId(o.id)&&cur.poster.addCustomBkg(o),i.bkgId=o.id),!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)(Wall.getMainPostBlock()))return cur.poster.setBkg(i.bkgId,!0),cur.poster.setText(i.text),void Emoji.val(e,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.clean)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.replaceEntities)(_[0])).replace(/\n/g,"<br/>"));Wall.openPosterEditor(i)}window.cur.addPostData=Array.isArray(_[1])?_[1]:[],Wall.drawMedia({skipClear:!0}),Wall.checkPosterAvailability(),Wall.saveDraft(),Wall.checkPostLen(window.cur.postField,window.cur.postWarningField,window.cur.sendPostBtn)}),0)}),!0),_[2]&&wall.focusOnEnd(),_[3]&&(wall.setReplyAsGroup((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("official"),_[3]),_[3].shareShowImg&&(cur.shareShowImgRestored=_[3].shareShowImg),_[3].donutOnly&&cur.wallAddMedia&&cur.wallAddMedia.donutPostSettings&&cur.wallAddMedia.donutPostSettings.setPostDonutOnly&&cur.wallAddMedia.donutPostSettings.setPostDonutOnly()),cur.postFieldZoomText&&cur.postFieldZoomText(cur.postField,cur.wallAddMedia)},onThumbUpdate:({id:_,thumb:e})=>{window.cur.addPostData=(window.cur.addPostData??[]).map((o=>o[1]===_?e:o)),Wall.drawMedia({skipPoll:!0,skipPostpone:!0,skipCopyright:!0})},drawMedia:function({skipPoll:_=!1,skipClear:e=!1,skipPostpone:o=!1,skipCopyright:i=!1}={}){if(window.cur.addPostData&&cur.wallAddMedia){e||cur.wallAddMedia.clearMedia({skipPoll:_,skipPostpone:o,skipNotifications:!0,skipCopyright:i});for(const e in window.cur.addPostData){const o=window.cur.addPostData[e];_&&o[0]===_web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_32__.MEDIA_SELECTOR_POLL||(cur.noDraftSave=!0,cur.wallAddMedia.chooseMediaNoNotify(...o))}}},initPostEditable:function(_){const e=cur.postField;if(!e||e.emojiInited)return!1;e.emojiInited=!0,window.stManager.add([window.jsc("web/emoji.js"),"notifier.css"],(function(){let o=Wall.sendPost;(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("wall_send_to_in_html_override")&&(o="function"==typeof e.onkeydown&&"cards"===cur.wallType?e.onkeydown:Wall.sendPost),Emoji.init(e,{ttDiff:-42,rPointer:!0,controlsCont:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domPN)(e),noStickers:!0,onSend:o,noEnterSend:!0,ref:"post",checkEditable:Wall.postChanged,initUploadForImagePasteCallback:function(_,e,o){window.Upload&&Upload.onFileApiSend(cur.wallUploadInd,[o])}}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)(e,"submit_post_inited"),_?setTimeout(Wall.setDraft.pbind(_),0):cur.postFieldZoomText&&cur.postFieldZoomText(cur.postField,cur.wallAddMedia)})),setTimeout((function(){cur.postFieldZoomText&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.addEvent)(e,"keydown paste",(function(){setTimeout((function(){cur.postFieldZoomText(cur.postField,cur.wallAddMedia)}),0)}))}),0)},initEmoji:function(){window.stManager.add([window.jsc("web/emoji.js")])},showEditPost:function(_,e,o){const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post_field");if(cur.viewAsBox)return setTimeout((function(){i.blur()}),0),cur.viewAsBox();if(0===cur.editing)return;(0,_shared_posting_analytics_utils__WEBPACK_IMPORTED_MODULE_86__.sendPostingEvent)(_shared_posting_analytics_types__WEBPACK_IMPORTED_MODULE_87__.POSTING_STATS_NAMES.POSTING_INIT);let s=_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.POSTING_TIMELINE_CREATION_ENTRY_POINTS.OTHER;"groups"===cur.module?s=_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.POSTING_TIMELINE_CREATION_ENTRY_POINTS.COMMUNITY_INPUT:"feed"===cur.module?s=_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.POSTING_TIMELINE_CREATION_ENTRY_POINTS.FEED_INPUT:"profile"===cur.module&&(s=_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.POSTING_TIMELINE_CREATION_ENTRY_POINTS.PROFILE_INPUT),_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.postingTimelineLogger.logStartTimeline({isEditing:!1,creationEntryPoint:s,postType:_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.POSTING_TIMELINE_POST_TYPES.REGULAR});const l=document.getElementById("submit_post_box");setTimeout(WallUpload.init,0),Wall.initComposer(i,{lang:{introText:(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("profile_mention_start_typing"),noResult:(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("profile_mention_not_found")},checkLen:Wall.postChanged,onValueChange:Wall.onPostValChange,onItemSelect:Wall.onPostItemSelect},_),Wall.initHashtagComposer(i,{checkLen:Wall.postChanged,onValueChange:Wall.onPostValChange,onItemSelect:Wall.onPostItemSelect}),Wall.hideEditPostReply(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)("submit_post_box","shown"),cur.editing=0,Wall.showPosterFeatureTooltip(),Wall.showPostCopyrightFeatureTooltip(),Wall.showPostOnlineBookingTooltip(l),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.isFunction)(cur.onShowEditPost)&&cur.onShowEditPost(),window.stManager.add(["ui_controls.css","ui_controls.js","datepicker.css",window.jsc("web/datepicker.js")]).then((()=>{_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.postingTimelineLogger.logScreenInteractionReady(),_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.postingTimelineLogger.logScreenInitialization()}))},postBoxFocus:function(_,e){(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.stopEvent)(_||window.event);const o=Wall.isPosterEditorOpen();(cur.postField&&window.Emoji||o)&&setTimeout((function(){e?o?(cur.poster.focusPoster(),(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_20__.scrollToY)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getXY)(cur.poster.getPosterElement())[1]-15)):(Emoji.focus(cur.postField),(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_20__.scrollToY)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getXY)(cur.postField)[1]-15)):o?cur.poster.focusPoster():Emoji.focus(cur.postField,!0,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("submit_post_box"))}),0)},initComposer:function(_,e,o){const i=e.hashtagEnable?"composer_hashtag":"composer";if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.data)(_,i))o&&o();else if(cur.composerAdded){const i=Composer.init(_,e);o&&o(),cur.destroy.push(Composer.destroy.bind(Composer).pbind(i))}else window.stManager.add(["wide_dd.css",window.jsc("web/wide_dd.js")],(function(){cur.composerAdded=!0;const i=Composer.init(_,e);o&&o(),cur.destroy.push(Composer.destroy.bind(Composer).pbind(i))}))},deinitComposer:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.data)(_,"composer");e&&Composer.destroy(e),_.emojiId&&window.Emoji&&Emoji.destroy(_.emojiId)},hasComposerMedia:function(_){const e=_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.data)(_,"composer");return!!(e&&e.addMedia&&e.addMedia.attachCount)&&e.addMedia.attachCount()>0},composerListShown:function(_){const e=_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.data)(_,"composer");if(!e)return!1;const o=e.wdd;let i=0;for(const _ in o.shown)i+=1;return!!(o&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)(o.listWrap)&&i)},onPostValChange:function(_){if(cur.wallAddMedia&&!cur.isUrlsRecognitionDisabled&&cur.wallAddMedia.checkMessageURLs.apply(window,arguments),"full_own"!=cur.wallType&&"full_all"!=cur.wallType||Pagination.pageTopUpdated(),_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.msie&&!_){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post_field");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.elfocus)(_)}},onPostItemSelect:function(_){if(!_||(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)(_[0])>=0||!cur.wallAddMedia)return;const e=`${(0,_shared_lib_site__WEBPACK_IMPORTED_MODULE_3__.getHostName)()}/event${-_[0]}`;cur.wallAddMedia.checkMessageURLs(e,!0)},hideEditPost:function(_){cur.editing=!1;const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post_field"),o=cur.wallAddMedia||{},i=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.trim)((window.Emoji?Emoji.editableVal:_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(e));!_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.opera_mobile&&e&&(!_&&(i||o.chosenMedia||o.getMedias&&o.getMedias().length>0||o.activeState||o.attachCount&&o.attachCount()>0)||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)("submit_post_box","shown"),e&&!i&&cur.postMention&&(cur.postMention.options.minHeight=cur.emptyPostheight||14),cur.onWallSendCancel&&cur.onWallSendCancel(),window.WallUpload&&WallUpload.hide(),cur.wallAddMedia&&cur.wallAddMedia._hideAddMedia(!0)))},clearInput:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("page_add_media"),window.cur.addPostData=[],window.cur?.wallAddMedia&&(cur.wallAddMedia.clearCarouselRatio?.(),(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("attachments_primary_mode_web_carousel_force_default")&&cur.wallAddMedia.setAttachView(_web_attachments_view_selector_constants__WEBPACK_IMPORTED_MODULE_63__.ATTACHMENT_PRIMARY_MODE.carousel));const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post_field");if(Wall.withMentions){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.data)(_,"mention");e&&(e.rtaEl.innerHTML="",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)(e.cont),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)(_))}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(_,""),_.blur(),_.phonblur(),Wall.hideEditPost(!0),cur.wallAddMedia&&cur.wallAddMedia.unchooseMedia(void 0,void 0,{isReset:!0}),Wall.resetPostVisibilityAccess();const e=document.querySelector("#submit_post_box");e&&Wall.resetPostOrdData(e),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.checkbox)("export_status",!1),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.checkbox)("close_comments",!1),(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_34__.isArray)(window.cur.wallOnClearInput)&&window.cur.wallOnClearInput.forEach((_=>{_()}));const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.data)(_,"composer");o&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)(o.articleConvertEl),o.articleConvertEl=!1)},fixPostParams:function(_){const e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.clone)(_);return e.Message=_.message,delete e.message,e},focusOnEnd:function(_){if(!(_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)(_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post_field")))return;if("TEXTAREA"==_.tagName)return void(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.elfocus)(_);const e=_.innerHTML?_.innerHTML.length:_.length?_.length:_.childNodes.length-1;if(_.focus(),document.selection){const _=document.selection.createRange();_.moveStart("character",e),_.select()}else window.getSelection().collapse(_,_.childNodes.length)},showPostSettings:function(_,e){if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.data)(_,"ett")){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domNS)(_),o=e&&e.querySelector("#post-copyright-button");new ElementTooltip(_,{cls:"post_settings_tooltip"+(o?" post_settings_tooltip_with_custom_btn":""),content:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(e),defaultSide:"top",offset:[0,-5],appendTo:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domPN)(_)}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)(e)}e&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.checkKeyboardEvent)(e)&&"click"===e.type&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.data)(_,"ett").toggle()},togglePostVisibilityAccess:function(_,e,o,i){o=o||"";const s="post_visibility_btn",l=cur[s+o];l&&l.hide(),(0,_web_page_wall_post_tooltip__WEBPACK_IMPORTED_MODULE_35__.updatePostTooltipActionRadioBtn)(_.closest(".radiobtn"),e,"post_settings_btn"+s+o);const a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post_visibility_btn"+o),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("post_action_btn_text",a),d=![_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_30__.VISIBILITY_ACCESS_OPTIONS.ONLY_FRIENDS,_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_30__.VISIBILITY_ACCESS_OPTIONS.ONLY_BEST_FRIENDS].includes(e);if(e===_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_30__.VISIBILITY_ACCESS_OPTIONS.ONLY_BEST_FRIENDS){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("best_friends_only"+o).querySelector(".PostVisibilityBestFriendsOnlyOption"),i=Number(e.dataset.count);_.classList.contains("PostVisibilityBestFriendsOnlyOption__editLink")||0===i?((0,_shared_lib_best_friends_analytics__WEBPACK_IMPORTED_MODULE_44__.sendBestFriendsAnalytic)(_shared_lib_best_friends_analytics__WEBPACK_IMPORTED_MODULE_44__.BestFriendsEventType.editBestFriends),this.resetPostVisibilityAccess(),window.stManager.add([window.jsc("web/best_friends.js")],(()=>{window.bestFriendsBoxSettings((_=>{const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("best_friends_only"+o);if(0===_)e.innerHTML=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.getTemplate)("visibility_access_best_friends_only_option",{html:(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_choose_best_friends"),count:_}),this.togglePostVisibilityAccess((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("no_friends_only"+o),_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_30__.VISIBILITY_ACCESS_OPTIONS.PUBLIC,o,!0);else{const i=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_best_friends_settings_box_conversation_friends_count",_);e.innerHTML=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.getTemplate)("visibility_access_best_friends_only_option",{html:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.getTemplate)("visibility_access_best_friends_only_item",{count_text:i}),count:_}),this.togglePostVisibilityAccess(e,_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_30__.VISIBILITY_ACCESS_OPTIONS.ONLY_BEST_FRIENDS,o,!0)}}))}))):((0,_shared_lib_best_friends_analytics__WEBPACK_IMPORTED_MODULE_44__.sendBestFriendsAnalytic)(_shared_lib_best_friends_analytics__WEBPACK_IMPORTED_MODULE_44__.BestFriendsEventType.selectBestFriends),n.innerHTML=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_best_friends_only"),n.setAttribute("aria-label",(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_best_friends_only")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)(a,"best_friends_only"))}else if(d){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("no_friends_only"+o).querySelector(".FancyElementTT__itemLabel").innerHTML;n.innerHTML=_,n.setAttribute("aria-label",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.replaceEntities)(_)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)(a,"on"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)(a,"best_friends_only")}else{const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("friends_only"+o).querySelector(".FancyElementTT__itemLabel").innerHTML;n.innerHTML=_,n.setAttribute("aria-label",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.replaceEntities)(_)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)(a,"on"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)(a,"best_friends_only")}i||Wall.postChanged()},resetPostVisibilityAccess(){Wall.canChangeVisibilityForNewPost()&&Wall.togglePostVisibilityAccess((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("no_friends_only"),_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_30__.VISIBILITY_ACCESS_OPTIONS.PUBLIC,!1,!0)},resetPostOrdData(_){const e=_.querySelector("#post_icon_gear_settings"),o=_.querySelector("#ads_ord_mini_app_option"),i=o&&o.querySelector('[name="ord_pred_id"]'),s=o&&o.querySelector('[name="erid"]');e&&e.classList.remove("PostOption__iconWrapperApplied","on"),o&&o.classList.remove("PostOption__withMarkAdsOrdMiniApp","on"),i&&(i.value=""),s&&(s.value="")},canChangeVisibilityForNewPost:()=>!!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post_visibility_btn"),initPostVisibilitySelector(_){Wall.canChangeVisibilityForNewPost()&&(0,_web_page_wall_post_tooltip__WEBPACK_IMPORTED_MODULE_35__.createPostTooltip)("post_visibility_btn",_.id)},cantAccessDonutPosts:()=>!1===window.cur.donutGroupUserHasWallAccess,togglePostMarkAsAds:function(_,e){e=e||"mute_notifications";const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)(e);if(!o)return;const i=(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isChecked)(_);if((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.disable)(o,i),i)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(o,"prev-state",+(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isChecked)(o)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)(o,"on");else{const _=+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(o,"prev-state");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.toggleClass)(o,"on",_)}},needCheckSign:function(){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("check_sign");return _&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isChecked)(_)},saveCheckSign:function(_){const e=(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isChecked)(_),o=_.querySelector(".PostOption__iconWrapper");let i="",s="";e?(i=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_check_sign_disabled"),s=(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_103__.getIcon20UserOutline)().icon):(i=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_check_sign_enabled"),s=(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_104__.getIcon20UserSlashOutline)().icon),o.innerHTML=s,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(_,"title",i),window.tooltips&&tooltips.hide(_,{onHide:_.onmouseover.bind(_)}),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.checkbox)(_,!e)},checkAsGroup:function(_){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.checkbox)(_),wall.setReplyAsGroup(_,{fromGroup:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isChecked)(_)})},showBoxError:function(_){const e=document.getElementById("submit_post_error");if(e.innerHTML=_.length>60?'<div class="msg_text">'+_+"</div>":_,!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)(e)){const _=document.getElementById("box_layer_wrap");(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_21__.slideDown)(e,100),(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_21__.animate)(_,{scrollTop:0})}},messageGetter:()=>window.Emoji?Emoji.editableVal:_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val,getMessage:function(_){const e=_||document.getElementById("post_field");return(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.trim)(Wall.messageGetter()(e))},sendPost:function({skipLocked:_=!1,posterSendParams:e,toOwnerId:o}={}){if(Wall.postponedPosts?.isLocked()&&"postponed"===window.cur.wallTab)return;const i=cur.wallAddMedia||{},s=i.chosenMedia||{};let l=cur.wallAddMedia?i.getMedias():[];const a=i.shareData||{},n=cur.poster&&!!e;if(!Wall.checkPostLen(cur.postField))return;_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.postingTimelineLogger.logStartSending();let d=n?e.text:Wall.getMessage(),E=!1;const c=n?null:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("send_post");let p=cur.options.suggesting?"suggest":cur.wallType;"top"===p&&(p="all"),n&&(l=l.filter((_=>{if((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_34__.isArray)(_)){const[e]=_;return["copyright","postpone",_web_donut__WEBPACK_IMPORTED_MODULE_29__.MEDIA_TYPE_DONUT_DURATION].includes(e)}})));const P=n?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("submit_post_box"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domClosest)("_submit_post_box",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("official")),u=(0,_web_donut__WEBPACK_IMPORTED_MODULE_29__.fieldValueIsDonutOnlyPost)(P,i);let b=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(P,"from-oid")==cur.postTo?1:"";P&&cur.postTo||b||cur.defaultPostSettings&&(b=cur.defaultPostSettings.official?1:"");const{ord_is_ad:O,ord_erid:D,ord_external_id:M}=(()=>{const _=document.getElementById("ads_ord_mini_app_option"),e=_&&_.querySelector('[name="ord_pred_id"]'),o=_&&_.querySelector('[name="erid"]'),i=_&&_.classList.contains("on"),s=e&&e.value;return{ord_is_ad:i,ord_erid:o&&o.value,ord_external_id:s}})();let w=cur.postTo;o&&(w=o);let m={act:"post",message:d,to_id:w,type:p,friends_only:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isChecked)("friends_only"),best_friends_only:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isChecked)("best_friends_only"),check_sign:Wall.needCheckSign(),close_comments:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("close_comments")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isChecked)("close_comments")?1:0:"",mute_notifications:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("mute_notifications")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isChecked)("mute_notifications")?1:0:"",mute_notifications_in_mentions:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("mute_notifications_in_mentions")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isChecked)("mute_notifications_in_mentions")?1:0:"",mark_as_ads:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isChecked)("mark_as_ads")||O?1:0,ord_erid:D,ord_external_id:M,official:b,signed:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isChecked)("signed"),hash:cur.options.post_hash,from:cur.from?cur.from:"",fixed:cur.options.fixed_post_id||"",situational_suggest_id:cur.options.situational_suggest_id||null},h=0;(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)(m,(0,_web_donut__WEBPACK_IMPORTED_MODULE_29__.getDonutPostParams)(u,i)),cur.options.additional_save_params&&(m=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)(m,cur.options.additional_save_params));const C=cur.wallAddMedia&&cur.wallAddMedia.id||"";if((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)(m,(0,_web_discover_category_post_topic__WEBPACK_IMPORTED_MODULE_33__.getPostTopicSelectorParams)(String(C))),(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("attachments_primary_mode_web_feature")){const _=(0,_web_attachments_view_selector_utils__WEBPACK_IMPORTED_MODULE_59__.getAttachmentsPrimaryModeParam)(String(C));(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)(m,_),_&&((0,_web_attachments_view_selector_utils__WEBPACK_IMPORTED_MODULE_59__.saveAttachmentsPrimaryModeDefaultValue)(_.primary_attachments_mode),cur?.attachmentsViewSelectorResult?.setOption(_.primary_attachments_mode)),(0,_web_posting_carousel_components_utils__WEBPACK_IMPORTED_MODULE_83__.isCarouselCropEnabled)()&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)(m,i.getPrimaryAttachmentsRatioAnalyticsParam())}(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_34__.isArray)(s)&&s.length&&l.push((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.clone)(s)),n&&(m.poster_bkg_id=e.bkgId,m.poster_bkg_access_hash=e.accessHash,e.fallbackObj&&(l.push(["photo",e.fallbackObj.owner_id+"_"+e.fallbackObj.id,!1]),m.poster_photo_hash=e.fallbackObj.post_hash),m.poster_bkg_id!==cur.posterCtaBkgId&&(m.poster_author_bkg_check=!0)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("submit_post_error");const g=_=>{if(this.showBoxError(_),Wall.isPosterEditorOpen()){const _=cur.poster.getErrorWrapperElement();_.innerHTML="",_.appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("submit_post_error"))}};let T;if(l.length&&(T=!1,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.each)(l,(function(_,e){if(!e)return;const o=this[0];let s=this[1];switch(o){case"poll":const _=i.pollData();if(!_)return T=!0,!1;s=_.question,delete _.question,m=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)(m,_);break;case"copyright":const e=i.copyrightData();if(e)return void(m=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)(m,e));break;case"share":if(a.failed||!a.title&&(!a.images||!a.images.length)&&!a.photo_url&&!a.video)return cur.shareLastParseSubmitted&&Date.now()-cur.shareLastParseSubmitted<2e3?(T=!0,!1):void 0;if((cur.options.share||{}).button_exclusive&&a.button_text&&a.button_action){let _;l.length>1&&(_=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("global_share_too_many_attachments")),d.split("\n").length-1>(cur.options.share||{}).button_exclusive_max_message_newlines&&(_=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("global_ads_post_too_many_newlines")),d.length>(cur.options.share||{}).button_exclusive_max_message_len&&(_=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("global_ads_post_too_long_message"));const e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extractUrls)(" "+d+" "),o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extractUrls)(" "+a.url+" ")[0];if(o&&e.length){"/"===o.query&&(o.query=""),"www."===o.domain.substr(0,4)&&(o.domain=o.domain.substr(4));for(let i=0;i<e.length;++i){const s=e[i];if("/"===s.query&&(s.query=""),"www."===s.domain.substr(0,4)&&(s.domain=s.domain.substr(4)),o.domain!=s.domain||o.query!=s.query){_=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("global_share_too_many_links");break}}}if(_)return g(_),T=!0,!1}if(!a.title)return g((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("global_share_title_required")),T=!0,!1;if(!a.url)return g((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("global_share_url_required")),T=!0,!1;if(a.url=new URL(a.url).href,a.video?(s=a.video_owner_id+"_"+a.video_id,m.snippet_video=1):s=a.user_id&&a.photo_id&&!a.noPhoto?a.user_id+"_"+a.photo_id:"",a.share_upload_failed&&!s)return void(a.share_upload_failed=0);if(a.images&&a.images.length&&!(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_34__.isArray)(a.images[cur.shareShowImg])&&!s&&!a.noPhoto&&!a.share_own_image&&!a.video)return(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockButton)(c),i.uploadShare((function(){Wall.sendPost({skipLocked:!0})})),T=!0,!1;if((cur.options.share||{}).require_image&&!s)return g((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("global_share_image_required")),T=!0,!1;a.initialPattern&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.trim)(d)==a.initialPattern&&(m.message=""),a.is_vk_mini_app&&(m.is_vk_mini_app=!0,m.is_photo_edit=a.isPhotoEdit,m.image_offset=cur.shareShowImg),m=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)(m,{url:a.url,module:cur.module,mode:a.mode,title:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.replaceEntities)(a.title),description:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.replaceEntities)(a.description),button_text:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.replaceEntities)(a.button_text),button_action:a.button_action,extra:a.extra,extra_data:a.extraData,photo_url:a.noPhoto||a.video?"":(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.replaceEntities)(a.photo_url),open_graph_data:(a.openGraph||{}).data,open_graph_hash:(a.openGraph||{}).hash});break;case"page":a.initialPattern&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.trim)(d)==a.initialPattern&&(m.message="");break;case"postpone":const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("postpone_date"+i.lnkId);return m=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)(m,{postpone:o}),cur.postponedLastDate=o,void(E=!0);case"mark_as_ads":return void(m=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)(m,{mark_as_ads:1}));case"pretty_cards":if(!i.prettyCardGallery)return;if(i.prettyCardGallery.needSendData())return i.prettyCardGallery.saveCards(Wall.sendPost,(function(_){g(_)})),T=!0,!1;s=i.prettyCardGallery.getSendData().attachVal;break;case"podcast":if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(this[2],"attach_disabled"))return!1;break;case _web_donut__WEBPACK_IMPORTED_MODULE_29__.MEDIA_TYPE_DONUT_DURATION:return;case"donut_link":m["attach"+(h+1)+"_owner_id"]=this[5]?.owner_id}this[3]&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.trim)(d)==this[3]&&(m.message=""),m["attach"+(h+1)+"_type"]=o,m["attach"+(h+1)]=s;const n=this[5]?.crop_data;n&&(m["attach"+(h+1)+"_crop"]=(0,_web_posting_carousel_components_utils__WEBPACK_IMPORTED_MODULE_83__.changeCropDataFromArrayToString)(n)),h++})),T))return void(_&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton)(c));if(!h&&!d)return _&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton)(c),void(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.elfocus)("post_field");if(c&&!_&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isButtonLocked)(c))return;cur.postAutosave&&clearTimeout(cur.postAutosave),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("submit_post_error"),cur.postSent=!0;const A=window.GroupsAdminTips&&window.GroupsAdminTips.isShownSection()?1:0;m.update_admin_tips=A;const I=(0,_web_donut__WEBPACK_IMPORTED_MODULE_29__.isPaidAttachPicked)(i,cur.oid);if(m.donut_duration&&-1!==m.donut_duration&&I&&!cur.donutAttachesApproved)return void(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_13__.showFastBox)({title:(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("global_action_confirmation"),onHide:()=>{(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton)(c)}},(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_publish_donut_freeing_attaches_confirmation_title"),(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_publish_postponed_btn"),(()=>{(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_17__.curBox)().hide(),cur.donutAttachesApproved=!0,Wall.sendPost({skipLocked:_,posterSendParams:e})}),(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("global_cancel"),(()=>{(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_17__.curBox)().hide(),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton)(c)}));let R=_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.POSTING_TIMELINE_POST_TYPES.REGULAR;m.postpone&&(R=_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.POSTING_TIMELINE_POST_TYPES.POSTPONED),m.donut_duration&&(R=_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.POSTING_TIMELINE_POST_TYPES.POST_DONUT),"suggest"===m.type&&(R=_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.POSTING_TIMELINE_POST_TYPES.SUGGESTED),_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.postingTimelineLogger.changePostType(R),setTimeout((function(){ajax.post("al_wall.php",Wall.fixPostParams(m),{onDone:function(_,e,o,s){if(_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.postingTimelineLogger.logSuccessfullySend(),(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("posting_track_event_count")){const _=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("posting_track_event_count_log");_&&("suggest"===p&&console.log("suggest post"),E&&console.log("postpone post")),"suggest"===p||E||((0,_shared_counters_tmr__WEBPACK_IMPORTED_MODULE_75__.tmrSendTimespentEvent)(_shared_counters_tmr__WEBPACK_IMPORTED_MODULE_75__.MY_TRACKER_COUNT_EVENT_IDS.POST_PUBLISH),_&&console.log("simple post"))}_web_ecomm_onboarding_Tooltips_services_TooltipEventService__WEBPACK_IMPORTED_MODULE_56__.TooltipEventService.onAddPost(),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.isString)(o)||(o=null),cur.poster&&n&&(cur.poster.unlockEditPoster(),cur.poster.closeEditor(),cur.poster.resetPoster(),cur.posterCtaBkgId&&(cur.posterCtaBkgId=null)),cur.posterFeatureTT&&cur.posterFeatureTT.hide(),Wall.clearInput(),cur.postSent=!1,cur.donutAttachesApproved=!1;const a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("mark_as_ads"),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("mute_notifications");if((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isChecked)(a)&&d&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)(d,"on"),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.disable)(d,0)),a&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)(a,"on"),i.donutUpdateVisibility()),cur.options.onSendPostDone)return void cur.options.onSendPostDone.apply(window,arguments);if(s&&(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_17__.showDoneBox)(s),(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_34__.isObject)(_)&&_.redirect)return void nav.go(_.redirect);(0,_wall_tabs_utils__WEBPACK_IMPORTED_MODULE_41__.showHiddenNavigableTabs)();let c=(0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_66__.isPostponedPostsActResult)(_)?_.rendered_posts:_;if(E){if("feed"==p)(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_17__.showDoneBox)(c,{out:3e3});else if("full_own"==p||"full_all"==p)return Wall.showPostponedFull(c);return wall.updateTabVisibility("page_wall_postponed",!0),void Wall.showPostponed(!1,_)}if(("full_own"==p||"full_all"==p)&&(cur.pgStart||nav.objLoc.postponed)){const _=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.clone)(nav.objLoc);return delete _.offset,delete _.postponed,vk.id!=cur.oid&&delete _.own,nav.go(_)}if(vk.id!=cur.oid&&"full_own"==p){const _=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.clone)(nav.objLoc);return delete _.own,nav.go(_)}if("feed"==p)return cur.wallPostCb();if("suggest"==p)return wall.updateTabVisibility("page_wall_suggest",!0),Wall.showSuggested(!1,c,e),Wall.suggestUpdate();if(u)return void Wall.showDonutWall(c);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("wall_tabs")&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("ui_tab",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("wall_tabs")).click(),Wall.receive(c,e),cur.onWallSendPost&&cur.onWallSendPost(),A&&null!==o&&window.GroupsAdminTips&&window.GroupsAdminTips.refreshSection(o);if((0,_web_profile_profile_utils__WEBPACK_IMPORTED_MODULE_53__.isVKCOMProfileRedesignedEnabled)()&&"profile"===window.cur.module){l.some((([_])=>"article"===_))&&window.Profile?.reloadOwnerContentTab("articles")}},onFail:function(_){if(_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.postingTimelineLogger.logPostPublishingError({message:_?String(_):""}),cur.postSent=!1,cur.donutAttachesApproved=!1,cur.poster&&n&&cur.poster.unlockEditPoster(),cur.posterFeatureTT&&cur.posterFeatureTT.hide(),cur.options.onSendPostFail)return void cur.options.onSendPostFail.apply(window,arguments);if(!_)return!0;const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("submit_post_error");if(e.innerHTML=_.length>60?'<div class="msg_text">'+_+"</div>":_,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("submit_post_error")||(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_21__.slideDown)("submit_post_error",100),Wall.isPosterEditorOpen()){const _=cur.poster.getErrorWrapperElement();_.innerHTML="",_.appendChild(e)}return!0},showProgress:function(){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockButton)(c)},hideProgress:function(){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton)(c)},noSort:!0})}),0)},_repliesLoaded:function(_,e,o,i,s){const l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("replies"+_);if(!l)return;const a=l.nextSibling;if(e){const _=l.offsetHeight;l.innerHTML=o,(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_20__.scrollToY)((0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_20__.scrollGetY)()+(l.offsetHeight-_),0,void 0,!0),setTimeout(Wall.scrollHighlightReply.pbind("post"+e),0)}else l.innerHTML=o;if(a&&"replies_open"==a.className&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)(a),ajax._framenext(),_==cur.wallLayer){const _=wkcur.reverse;(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)(wkcur,{offset:!_&&s.offset||0,loaded:s.num||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("reply",l,"div").length,count:s.count}),wall.addReplyNames(i),WkView.wallUpdateReplies(),_||(wkLayerWrap.scrollTop=wkLayerWrap.scrollHeight,WkView.wallUpdateRepliesOnScroll())}else wall.addReplyNames(i),Wall.repliesSideSetup(_);Wall.updateMentionsIndex(),setTimeout((function(){(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_102__.getAudioPlayer)().updateCurrentPlaying()}),10),s&&Likes.updateComments("wall"+_,s.count)},repliesSideSetup:function(_){if(cur.wallLayer==_)return void WkView.wallUpdateReplies();const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("replies"+_);if(!e)return;const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("wr_header",e,"a"),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post"+_),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(i,"deep_active");let l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("replies_side"+_);if(cur.wallMyOpened[_]&&(o||s)){if(!l){const o=(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_105__.getIcon24ChevronUp)().icon,i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.se)(`<div class="replies_side_wrap"><div id="replies_side${_}" class="replies_side"><div class="replies_side_icon">${o}</div></div></div>`);e.parentNode.insertBefore(i,e),l=i.firstChild,l.onmouseover=Wall.repliesSideOver.pbind(_),l.onmouseout=Wall.repliesSideOut.pbind(_),l.onclick=s?Wall.hideDeepReplies.pbind(_):Wall.repliesSideClick.pbind(_)}e.onmouseover=Wall.repliesSideOver.pbind(_),e.onmouseout=Wall.repliesSideOut.pbind(_),Wall.repliesSideOver(_)}else(0,_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_37__.floatingButtonCollapseAllRepliesHide)(l),e.onmouseover=null,e.onmouseout=null},repliesSideClick:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("replies"+_),o=(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_20__.scrollGetY)(),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getXY)(e)[1];return o>i&&(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_20__.scrollToY)(i-100,0),(0,_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_37__.floatingButtonCollapseAllRepliesHide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("replies_side"+_)),Wall.showReplies(_,3,!1)},repliesSideOver:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("replies"+_),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("replies_side"+_);if(!e)return;const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getXY)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domPN)(o))[1],s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getSize)(o)[1],l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getXY)(e)[1],a=e.offsetHeight,n=window.lastWindowHeight||0,d=i+s-n+15,E=l+a-n;cur.wallRepliesSideOver=[_,o,d,E],Wall.repliesSideUpdate()},repliesSideOut:function(_){cur.wallRepliesSideOver&&cur.wallRepliesSideOver[0]==_&&delete cur.wallRepliesSideOver},repliesSideUpdate:function(_){const e=cur.wallRepliesSideOver;if(!e)return;const o=e[1],i=e[4]||{},s=e[5]||"";let l,a="replies_side";void 0===_&&(_=(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_20__.scrollGetY)()),_<e[2]?((0,_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_37__.floatingButtonCollapseAllRepliesShow)(o),l={marginTop:0,opacity:1}):_<e[3]?((0,_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_37__.floatingButtonCollapseAllRepliesShow)(o),a+=" replies_side_fixed",l={opacity:Math.max(0,Math.min(1,(e[3]-_)/200))}):(a+=" replies_side_hidden",l={marginTop:e[3]-e[2],opacity:0,display:null}),(0,_vkontakte_vkjs__WEBPACK_IMPORTED_MODULE_6__.isEqual)(i,l)||((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.each)(i,(function(_,e){i[_]=null})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.setStyle)(o,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)(i,l)),e[4]=l),s!=a&&(o&&(o.className=a),e[5]=a)},highlightReply:function(_){(_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)(_))&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)(_,"reply_highlighted"),setTimeout((function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)(_,"reply_highlighted")}),1500))},scrollHighlightReply:function(_){if(!(_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)(_)))return;if(cur.wallLayer||_.id.match(/^post-?\d+(photo|video|market)?_\d+$/)&&(window.wkcur&&wkcur.shown||window.mvcur&&mvcur.mvShown||cur.pvShown)){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getXY)(_,!0)[1];return void(e<0||e>lastWindowHeight-200?(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_21__.animate)(wkLayerWrap,{scrollTop:wkLayerWrap.scrollTop+e-50},300,Wall.highlightReply.pbind(_)):Wall.highlightReply(_))}const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getXY)(_)[1];e<(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_20__.scrollGetY)()+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getSize)("page_header")[1]?((0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_20__.scrollToY)(e,300),setTimeout(Wall.highlightReply.pbind(_),300)):Wall.highlightReply(_)},showReply:function(_,e,o,i){if(cur.viewAsBox)return!1;if(i&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.checkEvent)(i))return!0;if(window.mvcur&&mvcur.post==e)return Videoview.showComment(o),!1;const s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post"+o);if(s)Wall.scrollHighlightReply(s);else if(cur.wallLayer==e)WkView.wallShowPreviousReplies(o);else if(e.match(/market/))Market.comments(e);else{if(_.tt&&_.tt.hide&&_.tt.hide(),"full"==cur.wallType){const _=o.split("_");return delete nav.objLoc.offset,nav.go((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)(nav.objLoc,{reply:_[1]}))}Wall.showReplies(e,!1,o)}return!1},showReplies:function(_,e,o,i){if((0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.checkEvent)(i||window.event))return!0;if(cur.viewAsBox)return cur.viewAsBox();if(cur.wallLayer==_&&wkcur.reverse)return;cur.wallMyOpened[_]=3!=e;const s={act:"get_replies",post:_,count:e},l={onDone:Wall._repliesLoaded.pbind(_,o),showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockButton.pbind("wrh"+_),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton.pbind("wrh"+_),local:1};if(o||e&&!(e>20)||((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)(s,{cont:"replies"+_}),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)(l,{frame:1}),cur.onFrameBlocksDone=function(){setTimeout(Wall.repliesSideSetup.pbind(_),_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.msie?100:10)}),ajax.post("al_wall.php",s,l),!_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.msie&&e>0&&e<10){const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("replies"+_);let i=o&&o.lastChild;const s=[];for(;s.length<e&&i;)"DIV"==i.tagName&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(i,"reply")&&s.push(i),i=i.previousSibling;if(s.length==e){const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("reply",o,"div").length;for((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(o,'<a class="wr_header wrh_all"></a>'),Wall.updateRepliesHeader(_,o.firstChild,e,i),(0,_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_37__.floatingButtonCollapseAllRepliesHide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("replies_side"+_));s.length;)o.appendChild(s.pop());(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockButton)("wrh"+_)}}return!1},moreReplies:function(_,e,o,i){let s;if(i.deep){const l=_.split("_");s={act:"get_post_replies",offset:e,owner_id:l[0],item_id:l[1],count:o},i.order&&(s.order=i.order)}else s={act:"get_replies",offset:e,post:_,count:o};return(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)(s,{rev:i.rev,from:i.from}),ajax.post("al_wall.php",s,{onDone:function(e,o,s){const l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("replies"+_);i.clear?l.innerHTML=e:i.rev||i.append?l.appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.cf)(e)):l.innerHTML=e+l.innerHTML,wall.addReplyNames(o),i.onDone&&i.onDone(e,o,s),Wall.updateMentionsIndex()},onFail:()=>!1,showProgress:i.showProgress,hideProgress:i.hideProgress}),!1},openDeepShortReplies:function(_,e){const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("replies_next",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domPN)(_));return o&&((0,_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_37__.loadRepliesLinkShow)(o),o.focus(),o.click(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)(_)),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.cancelEvent)(e)},collapseDeepReplies:function(_,e){const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("replies"+e);if(!o||!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(o,"replies_list_deep"))return;const i=(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_20__.scrollGetY)();let s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getXY)(_)[1];const l=Math.round((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.clientHeight)()/2);cur.wallLayer?(s-=i,s<l&&(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_21__.animate)(wkLayerWrap,{scrollTop:wkLayerWrap.scrollTop+s-l},300)):i>s-l&&(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_20__.scrollToY)(s-l);const a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post"+e);a&&(0,_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_37__.highlightUpdatedReply)(a);const n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ce)("span",{className:"progress_inline replies_next_loader"});(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)(_),o.innerHTML="";const d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_box_wrap"+e);d&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)(d);const E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("replies_wrap_deep"+e),c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("wl_post",o)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("post",o),p=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(c,"post-id"),P=wall.getRepliesOrder(p);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)(E,"replies_deep_has_field"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)(E,"replies_deep_has_short"),wall.updateRepliesOnScroll(),ajax.post("al_wall.php",{act:"get_collapsed_replies",reply_id:e,order:P},{onDone:function(_){o.innerHTML=_},onFail:function(){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.rs)(cur.wallTpl.reply_deep_next,{post_id:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(c,"post-id"),reply_id:e,offset:0,text:(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_next_n_replies",cur.options&&cur.options.replies_page_count||20),class:" replies_next_deep",post_author_suffix:""}));o.appendChild(_),(0,_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_37__.loadRepliesLinkShow)(_)},showProgress:function(){o.appendChild(n),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)(n)},hideProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)(n)}})},overCollapseDeepReplies:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("replies_deep_collapse_icon",_),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getSize)(e),i=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getStyle)(e,"bottom")),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getSize)(_),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getXY)(_),a=(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_20__.scrollGetY)(),n=cur.wallLayer?wkLayerWrap.scrollTop:a;cur.wallLayer&&(l[1]-=a);const d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.clientHeight)(),E=l[1]+s[1];let c,p,P=(0,_web_wall_reply_utils__WEBPACK_IMPORTED_MODULE_38__.getFixedReplyField)(),u=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getSize)(P)[1];cur.wallLayer?(c=n+E-d,p=n+l[1]+o[1]+i+i-d):(c=E-d,p=l[1]+o[1]+i+i-d),cur.onScrollCollapseDeepReplies=wall.updCollapseDeepRepliesIcon.pbind(_,e,{iconSize:o,iconBottom:i,collapseSize:s,collapsePos:l,fixedField:P,fixedFieldSize:u,maxFixedScroll:c,topMaxScroll:p}),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.addEvent)(cur.wallLayer?wkLayerWrap:window,"scroll",cur.onScrollCollapseDeepReplies),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.addEvent)(window,"resize",cur.onScrollCollapseDeepReplies),cur.onScrollCollapseDeepReplies()},outCollapseDeepReplies:function(_){cur.onScrollCollapseDeepReplies&&((0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.removeEvent)(cur.wallLayer?wkLayerWrap:window,"scroll",cur.onScrollCollapseDeepReplies),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.removeEvent)(window,"resize",cur.onScrollCollapseDeepReplies),delete cur.onScrollCollapseDeepReplies);const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("replies_deep_collapse_icon",_);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.setStyle)(e,{position:null,bottom:null,left:null,right:null})},updCollapseDeepRepliesIcon:function(_,e,o){const i=cur.wallLayer?wkLayerWrap.scrollTop:(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_20__.scrollGetY)();let s=o.maxFixedScroll;if((cur.wallLayer&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(o.fixedField,"wl_reply_form_fixed")||"full"===cur.wallType&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(o.fixedField,"fixed"))&&(s+=o.fixedFieldSize),i<s){const _=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)((o.collapseSize[0]-o.iconSize[0])/2),s=o.topMaxScroll+o.fixedFieldSize-i;let l=o.fixedFieldSize+o.iconBottom;s>0&&(l-=s),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.setStyle)(e,{position:"fixed",bottom:l,left:o.collapsePos[0]+_,right:"auto"})}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.setStyle)(e,{position:null,bottom:null,left:null,right:null})},updateCollapseDeepReplies:function(_){if(!cur.wallTpl||!cur.wallTpl.reply_deep_collapse)return;const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("replies_wrap_deep"+_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("replies_wrap_deep",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post"+_));if(!e)return;_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(e,"post-id");const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("replies"+_);if(!o)return o;const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("reply",o).length>=2;let s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("replies_deep_collapse",e);if(i){if(s)return;s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.rs)(cur.wallTpl.reply_deep_collapse,{reply_id:_})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domInsertBefore)(s,o)}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)(s)},showNextReplies:function(_,e,o){const i=e.split("_"),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(_,"offset"),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(_,"count"),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(_,"collapse");let n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(_,"replies_prev"),d=cur.wallLayer?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("wl_post"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post"+e);const E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)("post"+e,"reply"),c={act:"get_post_replies",owner_id:i[0],item_id:i[1],offset:s,count:l,collapse:a,ref:(0,_web_feed_feed_common__WEBPACK_IMPORTED_MODULE_64__.resolveRefFromCur)()},p=n?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domNS)(_):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domPS)(_);if(p&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(p,"reply")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(p,"replies_wrap_deep"))){const _=((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(p,"post-id")||"").split("_")[1];n?c.next_id=_:c.prev_id=_}if(E)cur.wallLayer||(d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("post",d));else{const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("replies"+e),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(_,"top-ids");o&&(c.top_replies=o)}const P=d.offsetHeight,u=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(d,"post-id");c.order=wall.getRepliesOrder(u);const b=E&&wall.isDescRepliesOrder(u,c.order);b&&(n=!n);const O=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ce)("span",{className:"progress_inline replies_next_loader"});return ajax.post("al_wall.php",c,{onDone:function(o,i,l){const E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domChildren)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ce)("div",{innerHTML:o})),c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.cf)();let p=!1;E.forEach((function(_){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(_,"wr_header"))return;const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)(_.id);e&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(e,"reply")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(e,"replies_wrap_deep"))||(c.appendChild(_),p=!0)}));const O=n&&!b||!n&&b;let D,M,w=!1;if(O){if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("replies_wrap_deep"+e),"replies_deep_has_short")){const e=window.innerHeight||document.documentElement.clientHeight,o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getSize)("page_header")[1],i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domNS)(_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domPN)(_),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getXY)(i)[1];D=cur.wallLayer?wkLayerWrap.scrollTop:(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_20__.scrollGetY)(),w=cur.wallLayer?s<e:s<D+e-o}M=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domFC)(c),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domInsertBefore)(c,_)}else M=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domLC)(c),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domInsertAfter)(c,_);const m=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)(l.num),h=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)(l.offset),C=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)(l.count),g=Boolean(l.has_author_replies),T=Math.max(0,h+(n?-m:m)),A=C-T;let I=0;if(p&&(n&&h>0||!n&&A>0)&&(I=n?s-T:Math.min(A,m),l.closest_inx>=0&&(I=Math.min(I,l.closest_inx))),document.activeElement===_?(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.addEvent)(_,"focusout",(function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)(_)})):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)(_),I){const e=_.cloneNode(!0),o=e.querySelector(".js-replies_next_label");if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)(e,"replies_next_pre_deleted"),!a){if(g){let _="";O?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domInsertBefore)(e,M),_=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_prev_n_replies",I)):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domInsertAfter)(e,M),_=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_next_n_replies",I)),o.removeChild(o.firstChild),o.insertBefore(document.createTextNode(_),o.firstChild)}else O?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domInsertBefore)(e,M),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(o,(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_prev_n_replies",I))):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domInsertAfter)(e,M),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(o,(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_next_n_replies",I)));(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(e,"count",I),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(e,"offset",T)}}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("replies_wrap_deep"+e),"replies_deep_has_short");const R=d.offsetHeight-P;if(w&&R){const _=D+R;cur.wallLayer?wkLayerWrap.scrollTop=_:(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_20__.scrollToY)(_,0,!1,!0)}wall.updateCollapseDeepReplies(e),wall.updateMentionsIndex(),wall.addReplyNames(i),wall.addDeepRepliesBlock(e),cur.wallMyOpened=cur.wallMyOpened||{},cur.wallMyOpened[u]=1,wall.repliesSideSetup(u),wall.updateRepliesOnScroll()},onFail:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)(_,"replies_next_pre_deleted")},showProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)(_,"replies_next_pre_deleted"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domInsertAfter)(O,_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)(O)},hideProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)(O)}}),o&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.cancelEvent)(!1)},emojiOpts:{},emojiShowTT:function(_,e,o){return void 0!==Wall.emojiOpts[_]&&Emoji.ttShow(Wall.emojiOpts[_],e,o)},emojiHideTT:function(_,e,o){return void 0!==Wall.emojiOpts[_]&&Emoji.ttHide(Wall.emojiOpts[_],e,o)},initReplyEditable:function(_,e,o,i,s){if(_.emojiInited)return!1;const l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_button"+o),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_media_preview"+o),n="undefined"!=typeof mvcur&&!!mvcur.noStickers||noAttOnPage;_.emojiInited=!0,window.stManager.add([window.jsc("web/emoji.js"),"notifier.css"],(function(){const d=Emoji.init(_,{ttDiff:i?-40:-42,rPointer:!0,controlsCont:e,noStickers:n,shouldFocus:!s,ref:"reply",onSend:function(){Wall.sendReply(o),_.blur()},ctrlSend:function(){return Wall.customCur().wallTpl.reply_multiline||Wall.composerListShown(_)},checkEditable:function(){cur.onReplyChanged&&cur.onReplyChanged(_,o),Wall.checkTextLen(_,"reply_warn"+o)},onChange:function(){l&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.toggleClass)(l,"reply_send_disabled",!(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.trim)(Emoji.editableVal(_))&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(a,"media_preview_has_medias")),Wall.hideCheckTimer(o,"editing")},onStickerSend:function(_,e){Wall.sendReply(o,!1,{stickerId:_,sticker_referrer:e})},initUploadForImagePasteCallback:Page.initUploadForImagePaste});if(vk.widget&&!window.emojiStickers&&Emoji.updateTabs(),Wall.emojiOpts[o]=d,cur.afterEmojiInit&&cur.afterEmojiInit[o]){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("emoji_smile",Emoji.opts[d].controlsCont);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)(_)&&(cur.afterEmojiInit[o](),delete cur.afterEmojiInit[o])}}))},initEditReply:function(_,e,o,i){if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("fix_anonymous_reply")&&!window.vk.id)return;let s=_,l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_field"+_);const a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post"+_);let n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_fakebox"+_),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_box"+_);const E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(a,"reply"),c=cur.wallLayer?wkcur:cur;let p,P=!1;if(E){if(p=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("wl_post",a)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("post",a),P=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(p,"deep_active"),P){if(!cur.reply_to){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(a,"answering-id");if(e){const o=_.split("_")[1];cur.reply_to=[(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)(e),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)(o)],(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("reply_to"+_,o)}}wall.addDeepRepliesBlock(_),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_fakebox"+_)}s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(p,"post-id")}else cur.wallLayer?(P=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("wl_post"),"deep_active"),p=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("wl_reply_form_inner")):(p=a,P=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(p,"deep_active"));if(!p&&n?p=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("_post_wrap",n):p&&!cur.pvShown||!d||(p=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("_post_wrap",d)),n){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("replies"+s),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(e,"can_reply_as_group"),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(e,"can_reply_as_any_group"),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(n,"owner-photo")||"",p=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(n,"owner-href")||"",u=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(n,"owner-name")||"",b=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(n,"owner-is-nft")||"",O=(0,_web_wall_reply_utils__WEBPACK_IMPORTED_MODULE_38__.replyBoxOwnerIsNftFromAttr)(b),D=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(n,"user-name")||"";let M="";i?M=c.wallTpl.reply_form_any_group:o&&(M=c.wallTpl.reply_form_group);const{is_nft:w,avatar_url:m}=c.wallTpl.default_replier,h=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("feed_small_avatars_in_comments")?_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_30__.REPLY_IMAGE_REDESIGN_V3_SIZE:_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_30__.REPLY_IMAGE_DEFAULT_SIZE,C=E&&P?_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_30__.REPLY_IMAGE_SMALL_SIZE:h,g=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.rs)(c.wallTpl.reply_form_user_image,{href:"",primary_image:(0,_web_page_wall_utils__WEBPACK_IMPORTED_MODULE_49__.getPostAvatarString)(m,"post_field_user_image",C,w,null,D),secondary_image:(0,_web_page_wall_utils__WEBPACK_IMPORTED_MODULE_49__.getPostAvatarString)(a,"post_field_user_image",C,O,"post_field_image_secondary",u)});d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.rs)(P&&c.wallTpl.reply_form_new?c.wallTpl.reply_form_new:c.wallTpl.reply_form,{add_buttons:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.rs)(M,{post_id:_,oid:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)(_),owner_photo:a||"/images/blank.gif",primary_image:(0,_web_page_wall_utils__WEBPACK_IMPORTED_MODULE_49__.getPostAvatarString)(m,"post_field_choose_image",C,w,null,D),secondary_image:(0,_web_page_wall_utils__WEBPACK_IMPORTED_MODULE_49__.getPostAvatarString)(a,"post_field_choose_image",C,O,"post_field_choose_secondary",u)}),post_id:_,oid:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)(_),owner_is_nft:b,owner_photo:a,owner_href:p,owner_name:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.clean)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.unclean)(u)),reply_image:g})),n.parentNode.replaceChild(d,n),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_field"+_)}if(!l){throw new Error("Failed to init new reply or edit reply: no reply field")}if(Wall.initReplyEditable(l,d,_,e,o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.data)(l,"composer"))i&&i();else{const e=[];let o,a,n,d,E=!1;window.mvcur&&mvcur.mvShown&&!noAttOnPage?o=mvcur.mvMediaTypes:cur.wallLayer==s?o=wkcur.options.rmedia_types:window.pvcur&&cur.pvShown?(o=pvcur.rmedia_types,a=0,n=0):o=noAttOnPage?[]:(0,_shared_video_isStandaloneOrVideoPage__WEBPACK_IMPORTED_MODULE_101__.isVideoPageOpen)()&&window.vpcur.mvMediaTypes&&!noAttOnPage?window.vpcur.mvMediaTypes:c.options&&c.options.rmedia_types,(P||p?.parentElement?.classList.contains("VerticalVideoLayerInfo__commentsReply"))&&(E=!0,a=0,n=0),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.each)(o||c.options&&c.options.media_types||[],(function(){(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.inArray)(this[0],["photo","video","audio","doc","link","page"])&&e.push(this)}));let u=!1;const b=s.match(/^(\d+_)?-?\d+_(photo|video|topic|market)?\d+(mv)?(_\d+)?$/);e.length>0&&b?(d={lnk:P?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_more_attaches"+_):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_add_media_"+_),preview:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_media_preview"+_),actionsEl:!1,gearEl:!1,types:e,options:{from:"topic"===b[2]?"board":"comment",limit:2,disabledTypes:["album","market","market_album","online_booking","poll",_web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_32__.MEDIA_SELECTOR_GROUP],toggleLnk:!0,maxShown:void 0!==a?a:void 0,hideAfterCount:void 0!==n?n:void 0,vectorIcon:E,hideLabel:(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_reply_add_attach_label"),toId:"full"===cur.wallType?cur.oid:cur.postTo,onToggleBlock:function(e){const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_box"+_),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("reply_box_photo",o);i&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.toggle)(i,e)},onMediaChanged:function(){Wall.hideCheckTimer(_,"editing"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.toggleClass)("reply_button"+_,"reply_send_disabled",!(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.trim)(Emoji.editableVal(l))&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)("reply_media_preview"+_,"media_preview_has_medias"))}}},s.match(/^-?\d+_topic/)&&((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)(d.options,{disabledTypes:["album","share","link","page"],limit:10,editable:1,sortable:1,teWidth:280,teHeight:200}),u=!0)):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)("reply_add_media_"+_),Wall.initComposer(l,{lang:{introText:(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("profile_mention_start_typing"),noResult:(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("profile_mention_not_found")},toup:u,wddClass:"reply_composer_dd",width:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getSize)(l.parentNode)[0],media:d,isReply:!0},i)}return void 0!==l.emojiId&&cur.afterEmojiInit&&cur.afterEmojiInit[_]&&(cur.afterEmojiInit[_](),delete cur.afterEmojiInit[_]),{postId:s,postEl:p,isReply:E,rf:l}},showEditReply:function(_,e,o,i,s,l){if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("fix_anonymous_reply")&&!window.vk.id)return;if(cur.viewAsBox)return setTimeout((function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_field"+_).blur()}),0),cur.viewAsBox();if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)("post"+_,"Post--with_closed_comments_donut"))return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.setStyle)("replies_wrap"+_,{display:""}),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.cancelEvent)(e);const a=wall.initEditReply(_,o,s,l);if(a.rf){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domClosest)("reply_box_wrap",a.rf));const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("replies_wrap_deep",a.rf);_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)(_,"replies_deep_has_field")}return cur.wallMyOpened&&(cur.wallMyOpened[_]=cur.wallMyOpened[_]||!1),cur.editing===_?(Emoji.editableFocus(a.rf,!1,!0,void 0,(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("feed_post_comment_input_focus_no_force")),!1):(Wall.hideEditPostReply(),a.isReply?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("replies_wrap_deep"+_),"deep_reply_box_open"):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)(a.postEl,"reply_box_open"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)(a.postEl,"post--replyBoxWasOpened")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.setStyle)("replies_wrap"+_,{display:""}),cur.editing=_,window.Emoji&&setTimeout((function(){Emoji.editableFocus(a.rf,!1,!0,void 0,(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("feed_post_comment_input_focus_no_force")),Wall.repliesSideOver(_)}),0),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.triggerEvent)(window,"scroll"),void 0!==a.rf.emojiId&&cur.afterEmojiInit&&cur.afterEmojiInit[_]&&(cur.afterEmojiInit[_](),delete cur.afterEmojiInit[_]),cur.wallTpl&&cur.wallTpl.reply_multiline_intro&&ajax.post("al_wall.php",{act:"a_ctrl_submit_intro",hash:cur.wallTpl.poll_hash},{onDone:function(e){e&&cur.editing===a.postId&&Wall.replySubmitTooltip(_,1)},onFail:function(){return!0}}),window.mvcur&&(mvcur.post==a.postId&&Videoview.onShowEditReply(),mvcur.onReplyFormSizeUpdate&&mvcur.onReplyFormSizeUpdate(),mvcur.scrollBottom&&mvcur.scrollBottom()),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.isFunction)(cur.onReplyFormSizeUpdate)&&cur.onReplyFormSizeUpdate(a.rf),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.isFunction)(cur.onReplyFormFocus)&&cur.onReplyFormFocus(a.rf),!1)},hideEditReply:function(_,e){cur.editing=!1;const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_field"+_),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post"+_),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_box"+_),l=cur.reply_to&&Wall.getReplyName(cur.reply_to[0]);let a=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.trim)(window.Emoji?Emoji.editableVal(o):"");const n=Wall.hasComposerMedia(o);let d;const E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(i,"reply");if(d=cur.wallLayer?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("wl_reply_form_inner"):E?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("post",i):i,d&&!cur.pvShown||!s||(d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("_post_wrap",s)),!o||n&&!e)return;if(l&&(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_34__.isArray)(l)&&l[1]&&(a&&l[1].indexOf(a)||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(o,""),a="")),e&&(a||n)){const _=o&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.data)(o,"composer");_?Composer.reset(_):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(o,""),a="",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("reply_warn",d))}if(_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.opera_mobile||_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.safari_mobile||a)return;(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_17__.curBox)()&&(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_17__.curBox)().isVisible()||(E?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("replies_wrap_deep"+_),"deep_reply_box_open"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)(d,"reply_box_open")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_link"+_)&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("replies_wrap"+_),window.tooltips&&s&&tooltips.hideAll(s),o.blur(),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.triggerEvent)(window,"scroll"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("reply_to"+_,""),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("reply_to_title"+_),cur.reply_to=!1;const c=Wall.emojiOpts[_];c>=0&&Emoji.opts[c]&&Emoji.opts[c].onChange&&Emoji.opts[c].onChange(),cur.onReplyFormSizeUpdate&&cur.onReplyFormSizeUpdate();const p=cur.replySubmitSettings;p&&p.tt&&p.tt.el&&p.tt.destroy(),window.mvcur&&mvcur.post==_&&(Videoview.onHideEditReply(),mvcur.onReplyFormSizeUpdate&&mvcur.onReplyFormSizeUpdate())},replyNamesRE:function(){wall.addReplyNames({});const _=wall.getReplyNames();if((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.isEmpty)(_))return!1;const e=[];return(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.each)(_,(function(_,o){o&&((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_34__.isArray)(o)&&(o=o[1]),"string"==typeof o&&e.push((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.escapeRE)(o)))})),new RegExp("^("+e.join("|")+")")},replyTo:function(_,e,o,i){if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("fix_anonymous_reply")&&!window.vk.id)return;const s=window.cur.wallLayer==_?wkcur:window.cur;Wall.showEditReply(_,i),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("reply_to"+_,e);const l=s.reply_to&&Wall.getReplyName(s.reply_to[0]);s.reply_to=[o,e];const a=Wall.getReplyName(o),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_as_group"+_),d=_.replace("topic","").match(/^(-?\d+)_([a-z]+)?(\d+)([a-z]+)?$/),E=d[1],c=d[2]||"",p=d[4]||"",P=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post"+E+c+"_"+e),u=P&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("reply_to",P,"a"),b=Wall.replyNamesRE(),O=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("wl_post",P)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("post",P),D=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(O,"deep_active"),M=D?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("replies_wrap_deep",P):null,w=M?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(M,"post-id"):_;let m="";if(!D||M){let _=((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_34__.isArray)(a)?a[0]:a)||"";_='<a class="reply_to_mem" onclick="return wall.showReply(this, \''+w+"', '"+E+c+"_"+e+p+"', event);\">"+_+"</a>";const o=`<span class="reply_to_cancel" onclick="return Wall.cancelReplyTo('${w}', event);">${(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_106__.getIcon12Cancel)().icon}</span>`,i='<div class="reply_to_label">'+(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.langStr)((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("global_reply_to"),"user",_)+"</div>";m=D?i+o:o+i}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("reply_to_title"+w,m);const h=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_field"+w);if((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_34__.isArray)(a)&&a[1]&&window.Emoji){const e=h;let o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.clean)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.trim)(Emoji.val(e)));o=o.replace(/&nbsp;/g," "),!o||l&&(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_34__.isArray)(l)&&!(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.winToUtf)(l[1]).indexOf((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.winToUtf)(o))?Emoji.val(e,a[1]):b&&(o=o.replace(b,a[1]),Emoji.val(e,o));const i=Wall.emojiOpts[_];i>=0&&Emoji.opts[i]&&Emoji.opts[i].onChange&&Emoji.opts[i].onChange(),Emoji.focus(e,!0)}if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.toggle)("reply_to_title"+w,m),n){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)(n.parentNode)&&_shared_ranges__WEBPACK_IMPORTED_MODULE_57__.Ranges.isGroupId(E)&&u&&u.getAttribute("rid")===E;Wall.setReplyAsGroup(n,{from:_?E:vk.id})}const C=(0,_web_wall_reply_utils__WEBPACK_IMPORTED_MODULE_38__.getFixedReplyField)();return D&&h&&C&&(0,_web_wall_deep_replies_utils__WEBPACK_IMPORTED_MODULE_36__.scrollOutsideFixedReplyArea)(h,C),s.onReplyFormSizeUpdate&&s.onReplyFormSizeUpdate(),window.mvcur&&mvcur.onReplyFormSizeUpdate&&mvcur.onReplyFormSizeUpdate(),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.stopEvent)(i),!1},cancelReplyTo:function(_,e){const o=window.cur.wallLayer==_?wkcur:window.cur,i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_field"+_),s=o.reply_to&&Wall.getReplyName(o.reply_to[0]);let l=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.clean)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.trim)(window.Emoji?Emoji.editableVal(i):""));const a=Wall.replyNamesRE(),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post"+_),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("wl_post",n)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("post",n),E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(d,"deep_active");if((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_34__.isArray)(s)&&s[1]&&window.Emoji){l&&s[1].indexOf(l)?a&&(l=l.replace(a,""),Emoji.val(i,l)):(l="",Emoji.val(i,l));const e=Wall.emojiOpts[_];e>=0&&Emoji.opts[e]&&Emoji.opts[e].onChange&&Emoji.opts[e].onChange(),Emoji.focus(i,!0)}if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("reply_to_title"+_),E){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(n,"answering-id");if(e){const i=_.split("_")[1];o.reply_to=[(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)(e),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)(i)],(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("reply_to"+_,i)}else o.reply_to=!1,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("reply_to"+_,"")}else window.mvcur&&mvcur.post==_?mvcur.mvReplyTo=!1:o.reply_to=!1,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("reply_to"+_,"");return o.onReplyFormSizeUpdate&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.isFunction)(o.onReplyFormSizeUpdate)&&o.onReplyFormSizeUpdate(i),window.mvcur&&mvcur.onReplyFormSizeUpdate&&mvcur.onReplyFormSizeUpdate(),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.stopEvent)(e),!1},replySubmitTooltip:function(_,e,o){if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("fix_anonymous_reply")&&!window.vk.id)return;const i=_&&window.cur.wallLayer==_?wkcur:window.cur,s=_&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_box"+_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_fakebox"+_)),l=s&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("button_blue",s,"div");let a=i.replySubmitSettings;if(o&&l&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)(l))return;if(o=o||l,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(o,"flat_button")&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isButtonLocked)(o)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(o,"button_disabled"))return void(!e&&a&&a.tt&&a.tt.hide&&a.tt.hide());if(a||(a=i.replySubmitSettings=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ce)("div",{className:"reply_submit_hint_tt_point"})),!e)return void(a&&a.tt&&a.tt.hide&&a.tt.hide());if(!o)return;if(a.parentNode==o&&a.tt&&a.tt.show)return void a.tt.show();a.tt&&a.tt.el&&a.tt.destroy(),o.insertBefore(a,o.firstChild);const n=Wall.customCur().wallTpl.reply_multiline?1:0,d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.rs)(Wall.customCur().wallTpl.reply_multiline_hint,{enabled:n?"on":"",disabled:n?"":"on",wall_reply_submit_settings:(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_reply_submit_settings"),wall_reply_submit_settings_1:(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_reply_submit_settings_1"),wall_reply_submit_settings_2:(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_reply_submit_settings_2")}),E=s&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("wl_post",s)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("post",s)),c=E&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(E,"deep_active");(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_12__.showTooltip)(a,{text:d,typeClass:"tt_default_right",slide:15,shift:c?[15,8]:[0,8],asrtl:1,hasover:1,toup:!1,showdt:700,hidedt:700,dir:"auto",noZIndex:!0,onCreate:function(){radioBtns.reply_submit={els:Array.prototype.slice.apply((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("radiobtn",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_submit_hint_opts"))),val:d?1:0}}})},onReplySubmitChanged:function(_,e){if(cur.wallTpl?cur.wallTpl.reply_multiline=_:mvcur.wallTpl&&(mvcur.wallTpl.reply_multiline=_),Wall.customCur().wallTpl&&(Wall.customCur().wallTpl.reply_multiline=_),e){const _=cur.replySubmitSettings;_&&_.tt&&_.tt.el&&_.tt.destroy()}else ajax.post("al_wall.php",{act:"a_save_ctrl_submit",value:_,hash:Wall.customCur().wallTpl.poll_hash}),window.Notifier&&Notifier.lcSend("wall_reply_multiline",{value:_})},getReplyFromId:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_as_group"+_);return!(!e||!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)(e.parentNode))&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domClosest)("_submit_post_box",e),"from-oid")},showCheckTimer(_,e,o){const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_field"+_),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_box"+_),l=s&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("WallCheckComment__timer",s);if(!i||!l)return;(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_12__.showTooltip)(i,{text:o.description,showdt:0,hidedt:0,shift:[0,-1],width:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getSize)(i)[0],forcetoup:!0,nohide:!0,noZIndex:_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.msie_edge,className:"WallCheckComment__tt"}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByTag)("span",l).forEach((_=>{_.style.animationDuration=`${o.delay}s`})),s.classList.add("WallCheckComment--shown");const a=setTimeout((()=>{s.classList.remove("WallCheckComment--shown"),Wall.sendReply(_,void 0,e)}),1e3*o.delay);l.timeout=a,l.onclick=()=>{Wall.hideCheckTimer(_,"button")},cur.destroy||(cur.destroy=[]),cur.destroy.push((()=>{a&&clearTimeout(a)})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.elfocus)(i)},hideCheckTimer(_,e=!1){const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_field"+_),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_box"+_),s=i&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("WallCheckComment__timer",i);if(!o||!s)return;const l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(o,"check_timestamp");e&&l&&Wall.isCheckTimerShown(_)&&ajax.post("al_wall.php",{act:"check_comment_cancelled",post_raw:_,timestamp:l,reason:e}),s.timeout&&clearTimeout(s.timeout),o.tt&&o.tt.hide&&o.tt.hide(),i.classList.remove("WallCheckComment--shown"),"button"===e&&setTimeout((()=>(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.elfocus)(o)),0)},isCheckTimerShown(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_box"+_);return e&&e.classList.contains("WallCheckComment--shown")},isPostAuthor(_,e){const o=parseInt(_.dataset.postSignerOrAuthorId);return!!o&&!!e&&o===e},sendReply:function(_,e,o){o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)({},o);const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("replies_wrap_deep"+_);let s,l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("reply_to"+_);if(i?(s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("post",i)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("wl_post",i),"post-id"),l=l||_.split("_")[1]):s=_,window.mvcur&&mvcur.post==s||(0,_shared_video_isStandaloneOrVideoPage__WEBPACK_IMPORTED_MODULE_101__.isVideoPageOpen)()||(0,_shared_video_isFakeVideoStandalone__WEBPACK_IMPORTED_MODULE_100__.isFakeVideoStandalone)())return Videoview.sendComment(s,e,o);const a=window.cur.wallLayer==s,n=a?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("wl_post"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post"+s),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("replies"+_),E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(n,"deep_active"),c=a?wkcur:window.cur,p=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_field"+_),P=p&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.data)(p,"composer"),u=c.reply_to&&Wall.getReplyName(c.reply_to[0]);let b,O;const D=p&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.data)(p,"send");if(D&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.isFunction)(D))return D(_,e,o);if(o.stickerId)O={message:"",attach1_type:"sticker",attach1:o.stickerId,sticker_referrer:o.sticker_referrer};else if(o.suggest)O={message:o.suggest};else{if(O=P?Composer.getSendParams(P,Wall.sendReply.pbind(_)):{message:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.trim)(Emoji.editableVal(p))},O.delayed)return;if(!O.attach1_type&&(!O.message||(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_34__.isArray)(u)&&u[1]&&!u[1].indexOf(O.message)))return void Emoji.editableFocus((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_field"+_),!1,!0)}let M;const w=window.wkcur&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("wk_content");if(p&&(w&&w.contains(p)?wkcur.wallCheckComments:c.wallCheckComments)){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(p,"check_in_progress"))return;if(M=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(p,"check_timestamp")||void 0,!M)return(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.stopEvent)(e),void ajax.post("al_wall.php",{act:"check_comment",post_raw:s,text:O.message},{onDone(e){e&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(p,"check_timestamp",e.timestamp),e.description&&e.delay)?Wall.showCheckTimer(_,o,e):Wall.sendReply(_,void 0,o)},onFail:()=>((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(p,"check_timestamp",Date.now()),Wall.sendReply(_,void 0,o),!0),showProgress(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(p,"check_in_progress",!0)},hideProgress(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(p,"check_in_progress",null)}});if(Wall.isCheckTimerShown(_))return void Wall.hideCheckTimer(_,"button");Wall.hideCheckTimer(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(p,"check_timestamp",null)}o.stickerId||o.suggest||(P?b=Composer.reset(P):window.Emoji&&Emoji.val(p,""),p.autosize&&p.autosize.update()),c.wallMyOpened=c.wallMyOpened||{},c.wallMyReplied[s]=1,c.wallMyOpened[s]=1;const m=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post_hash"+s)?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post_hash"+s).value:c.options.post_hash;let h=null,C=E&&(i||!a&&"full"!==c.wallType);const g=wall.getRepliesOrder(s),T=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(d,"top-ids");let A=!1;if(C&&d){const _=!i&&wall.isDescRepliesOrder(s,g)?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domFC)(d):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domLC)(d);_?.classList.contains("replies_next_inline")?(C=!0,A=!1):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(_,"replies_next")&&(C=!1,A=!0)}const I=(0,_web_feed_feed_common__WEBPACK_IMPORTED_MODULE_64__.getTrackCodeFromPost)(n);(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)(O,{act:"post",type:c.wallType,reply_to:s,reply_to_msg:l,reply_to_user:c.reply_to&&c.reply_to[0]||0,start_id:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("start_reply"+s),from:a?"wkview":"",hash:m,only_new:C?1:0,need_last:A?1:0,order:g,top_replies:T||null,timestamp:M,ref:(0,_web_feed_feed_common__WEBPACK_IMPORTED_MODULE_64__.resolveRefFromCur)(),track_code:I,event_subtype:(0,_web_feed_feed_stats_utils__WEBPACK_IMPORTED_MODULE_74__.getFeedEventSubtype)()}),c.reverse&&(O.rev=1);const R=wall.getReplyFromId(_);let L;if(R&&(O.from_oid=R),L=c.wallType?"feed"==c.wallType?"news"==c.section?"feed_"+(c.subsection?c.subsection:c.section):"recommended"==c.section?"feed_recommended"+("recent"!=c.subsection?"_"+c.subsection:""):-1!==["friends","groups","videos","photos","list"].indexOf(c.section)?"feed_"+c.section+(c.subsection?"_"+c.subsection:""):"feed_"+c.section:"top"==c.wallType?"wall_top":"wall_"+(c.onepost?"one":(c.wallType||"").indexOf("full_")?"page":"full"):c.module,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)(O,{ref:L}),_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.mobile?Wall.hideEditReply(_):(Emoji.editableFocus(p,!1,!0),Wall.cancelReplyTo(_,e)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("reply_warn"+_),ajax.post("al_wall.php",Wall.fixPostParams(O),{onDone:function(e,o,i,l){if(E){if(C)return wall.onOnlyNewReplySent.apply(window,arguments);if(A)return wall.onLastChunkReplySent.apply(window,arguments);if(a)return wall.onNewReplySentLayer.apply(window,arguments)}if("full"===c.wallType)return E?FullWall.onNewReplySent.apply(window,arguments):FullWall.onReplySent.apply(window,arguments);c.wallMyReplied[s]=0,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)("reply_link"+s),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("reply_warn"+s),Wall._repliesLoaded(_,!1,o,i,l),Wall.processPostReplyActions(e)},onFail:function(_){if(h&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)(h),P?b=Composer.restore(P,b):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(p,O.message),p.autosize&&p.autosize.update(),_)return(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_13__.showFastBox)((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("global_error"),_),!0},showProgress:function(){E?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.disableButton)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_button"+_),!0):(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockButton)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_button"+_))},hideProgress:function(){E?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.disableButton)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_button"+_),!1):(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_button"+_))}}),window.cur.onPostReply&&window.cur.onPostReply(_),O.from_oid||!O.message||C)return;const B=-++c.wallMyRepliesCnt,W=Emoji.emojiToHTML((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.clean)(O.message),!0),U=wall.getReplyNames(),f=_shared_ranges__WEBPACK_IMPORTED_MODULE_57__.Ranges.isGroupId(O.reply_to_user)?(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_replied_to_group"):U[O.reply_to_user]&&U[O.reply_to_user][0],K=f?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.rs)(c.wallTpl.reply_link_to,{to_user:f}):"";if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("feed_author_replies_new_reply_fast_web")){const[_,e,,,,o]=this.replyAsProfileData(),s=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("feed_small_avatars_in_comments")?_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_30__.REPLY_IMAGE_REDESIGN_V3_SIZE:_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_30__.REPLY_IMAGE_DEFAULT_SIZE,l=(0,_web_page_wall_utils__WEBPACK_IMPORTED_MODULE_49__.getPostAvatarString)(e,"reply_image",i?_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_30__.REPLY_IMAGE_SMALL_SIZE:s,o);h=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.rs)(c.wallTpl.reply_fast,{reply_id:"0_"+B,message:W.replace(/\n/g,"<br/>"),to_link:K,date:Wall.getNowRelTime(c),is_author_suffix:this.isPostAuthor(n,_)?c.wallTpl.is_author_suffix:"",reply_image:l}))}else h=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.rs)(c.wallTpl.reply_fast,{reply_id:"0_"+B,message:W.replace(/\n/g,"<br/>"),to_link:K,date:Wall.getNowRelTime(c)}));if(d&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)(d)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_link"+_))(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)("reply_link"+_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("replies_wrap"+_);else if(!c.onepost){const e=d.nextSibling;if(e&&"replies_open"==e.className&&Wall.openNewComments(_),!a){let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("wr_header",d,"a"),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("reply",d,"div").length+1,i=o;e&&(i=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)(e.getAttribute("offs").split("/")[1])+1),(i>5||o<i)&&(e||d.insertBefore(e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ce)("a",{className:"wr_header"}),d.firstChild),Wall.updateRepliesHeader(_,e,o,i))}}c.reverse?d.insertBefore(h,d.firstChild):d.appendChild(h),a&&(WkView.wallUpdateReplies(),c.reverse||(wkLayerWrap.scrollTop=wkLayerWrap.scrollHeight,WkView.wallUpdateRepliesOnScroll()))},onOnlyNewReplySent:function(_,e,o){const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post"+_),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(i,"reply"),l=s?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("wl_post",i)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("post",i):i,a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(l,"post-id"),n=!s&&wall.isDescRepliesOrder(a);if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(l,"deep_active"))return;const d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("replies_wrap_deep",i);s&&d&&(_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(d,"post-id"));const E=cur.wallLayer===a,c=Wall._getRepliesInfoBeforeAddNewReply(_,E),p=Wall._checkVisibilityBeforeAddNewReply(_,c,n,E);s&&wall.addDeepRepliesBlock(_);const P=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.se)(e),u=c?.repliesListEl?.querySelector(".replies_next_inline");n&&c.repliesListEl.firstChild?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domInsertBefore)(P,c.repliesListEl.firstChild):u?u.insertAdjacentElement("beforebegin",P):c.repliesListEl.appendChild(P),Wall._fixScrollAfterAddNewReply(_,c,p,n,E),s&&wall.updateCollapseDeepReplies(_),(0,_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_37__.highlightUpdatedReply)(P),wall.incReplyCounter(l),wall.addReplyNames(o)},onLastChunkReplySent:function(_,e,o,i,s,l){const a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post"+s),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(a,"reply"),d=n?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("wl_post",a)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("post",a):a,E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(d,"post-id"),c=!n&&wall.isDescRepliesOrder(E);if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(d,"deep_active"))return;const p=cur.wallLayer===E,P=Wall._getRepliesInfoBeforeAddNewReply(s,p),u=Wall._checkVisibilityBeforeAddNewReply(s,P,c,p);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(P.repliesListEl,e),Wall._fixScrollAfterAddNewReply(s,P,u,c,p);const b=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post"+l);b&&(0,_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_37__.highlightUpdatedReply)(b),n&&wall.updateCollapseDeepReplies(s),wall.incReplyCounter(d,1,_),wall.addReplyNames(i)},_getRepliesInfoBeforeAddNewReply:function(_,e){const o=e?wkLayerWrap.scrollTop:(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_20__.scrollGetY)(),i=window.innerHeight||document.documentElement.clientHeight,s=o+(e?0:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getSize)("page_header_cont")[1]),l=o+i,a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("replies"+_),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getXY)(a,e)[1],d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getSize)(a)[1];return{repliesListEl:a,scrollY:o,topY:s,bottomY:l,viewportHeight:i,repliesListY:n,repliesListH:d,repliesListEndY:n+d,layerFieldH:e?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getSize)("wl_reply_form")[1]:0}},_checkVisibilityBeforeAddNewReply:function(_,e,o,i){let s=!1;return s=o?i?e.repliesListY>0&&e.repliesListY<e.viewportHeight-e.layerFieldH:e.topY<e.repliesListY&&e.bottomY>e.repliesListY:i?e.repliesListEndY>0&&e.repliesListEndY<e.viewportHeight-e.layerFieldH:e.topY<e.repliesListEndY&&e.bottomY>e.repliesListEndY,s},_fixScrollAfterAddNewReply:function(_,e,o,i,s){const l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getSize)(e.repliesListEl)[1];if(i)o||(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_20__.scrollToY)(e.repliesListY-100,300,!1,!0);else if(o){const _=e.scrollY+l-e.repliesListH;s?wkLayerWrap.scrollTop=_:(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_20__.scrollToY)(_,0,!1,!0)}else{const _=e.repliesListY+l-300;s?(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_21__.animate)(wkLayerWrap,{scrollTop:e.scrollY+_},300):(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_20__.scrollToY)(_,300,!1,!0)}},incReplyCounter:function(_,e,o){e=e||1;const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(_,"post-id"),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("comment",_);let l;s&&(o||(l=+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(s,"count"),o=Math.max(0,l+e)),Likes.update("wall"+i,{comment_num:o}))},onNewReplySentLayer:function(_,e,o,i){const s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("wl_post"),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("wl_replies",s);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(l,e);const a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domChildren)(l).filter((function(_){return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(_,"reply")})).length;(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)(wkcur,{offset:o,loaded:a,count:_}),wall.addReplyNames(i),WkView.wallUpdateReplies();const n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(s,"post-id");wall.isDescRepliesOrder(n)?wkLayerWrap.scrollTop=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getSize)(s)[1]-(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getSize)("wl_replies_wrap")[1]-30:wkLayerWrap.scrollTop=wkLayerWrap.scrollHeight,WkView.wallUpdateRepliesOnScroll()},postTooltip:function(_,e,o,i){if(cur.viewAsBox)return;const s=(o||{}).reply,l=(o||{}).className||"",a=s&&!(s%2)&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getXY)(_)[0]>420;i=i||{},s||(i.appendEl=document.body),(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_12__.showTooltip)(_,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)({url:"al_wall.php",params:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)({act:"post_tt",post:e},o||{}),slide:15,shift:[a?417:27,6,6],ajaxdt:100,showdt:400,hidedt:200,dir:"auto",className:"rich wall_tt"+l,typeClass:a?"tt_default_right":"tt_default"},i))},adsMarkTooltip:function(_){cur.viewAsBox||(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_12__.showTooltip)(_,{black:1,shift:[15,7,0],text:_.getAttribute("data-tooltip")})},hideEditPostReply:function(_,e){if(!1===cur.editing)return;if(cur.wallLayer&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)("wl_post","deep_active")&&(e=!0),!e&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)(boxLayerBG)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)(layerBG)))return;const o=_&&_.target?_.target:{},i=o.id;cur.editing?cur.editingHide?cur.editingHide(cur.editing,o):_&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domClosest)("_reply_wrap",o)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(o,"reply_link")||i=="reply_field"+cur.editing||"reply_to_link"==o.className)||Wall.hideEditReply(cur.editing):(cur.wallAddMedia||{}).chosenMedia||_&&"post_field"==i||Wall.hideEditPost()},postShowDeletedMessage:function(_,e){const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post"+_);if(o){const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("_post_content",o)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("feedback_row_t",o);(0,_web_lib_revertLastInlineVideo__WEBPACK_IMPORTED_MODULE_22__.revertLastInlineVideo)(i),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)(i),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domNS)(i),"post_publish")&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domNS)(i));const s="post_del"+_,l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)(s),a='<span class="dld_inner">'+e+"</span>";return l?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(l,a),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)(l)):o.appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ce)("div",{id:s,className:"dld",innerHTML:a})),!0}return!1},postHideDeletedMessage:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post"+_);if(e){const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("_post_content",e)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("feedback_row_t",e);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)(o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domNS)(o),"post_publish")&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domNS)(o));const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post_del"+_);return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)(i),!0}return!1},isArchiveWall:function(){return cur.pgParams&&cur.pgParams.archive||"wall_archive"===cur.module},rollbackPostsArchiveState:function(_,e,o){if(!Wall.isArchiveWall()||(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.linkLocked)(_))return;const i=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)(e.split("_")[1]);ajax.post("al_wall_archive.php",{act:"a_rollback_state",from:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("page_wall_more_tab")?"profile":"wall",postId:i,hash:o},{onDone:function(_){cur.wallArchiveRolledback=!0,Wall.postShowDeletedMessage(e,_)},showProgress:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockLink)(_),hideProgress:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockLink)(_)})},restoreLastRollbackPostsArchiveState:function(_,e,o){if(!Wall.isArchiveWall()||(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.linkLocked)(_))return;const i=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)(e.split("_")[1]);ajax.post("al_wall_archive.php",{act:"a_restore_last_rollback",from:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("page_wall_more_tab")?"profile":"wall",postId:i,hash:o},{onDone:function(_){delete cur.wallArchiveRolledback,Wall.postShowDeletedMessage(e,_)},showProgress:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockLink)(_),hideProgress:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockLink)(_)})},postSetArchiveState:function(actionEl,postRaw,hash,state,isRollback){if((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.actionsMenuItemLocked)(actionEl)||(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.linkLocked)(actionEl))return;const postId=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)(postRaw.split("_")[1]),isActionMenuItem=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(actionEl,"ui_actions_menu_item"),localCur=cur.wallLayer?wkcur:cur;localCur&&(localCur.wallMyDeleted||(localCur.wallMyDeleted={}),localCur.wallMyDeleted[postRaw]=!Wall.isArchiveWall()==!state?0:1);const extended=!isRollback&&(Wall.isArchiveWall()?cur.wallArchiveRestored>=3&&!cur.wallArchiveRolledback:!cur.wallArchiveArchived);if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("feed_post_menu_stats")&&1===state){const _=actionEl instanceof HTMLElement?(0,_web_feed_feed_common__WEBPACK_IMPORTED_MODULE_64__.getTrackCodeFromPost)(actionEl):null;_shared_feed_stats_click_three_dots__WEBPACK_IMPORTED_MODULE_85__.FeedPostMenuStats.archivePost(_,(0,_web_feed_feed_common__WEBPACK_IMPORTED_MODULE_64__.resolveRefFromCur)())}ajax.post("al_wall_archive.php",{act:"a_set_state",from:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("page_wall_more_tab")?"profile":cur.pid?"post":"wall",hash,state:state?1:void 0,extended:extended?1:void 0,postId},{onDone:function(msg,js){if(Wall.isArchiveWall()&&(state=!state,isRollback||(cur.wallArchiveRestored||(cur.wallArchiveRestored=0),cur.wallArchiveRestored++)),state&&(cur.wallArchiveArchived=!0),isRollback?Wall.postHideDeletedMessage(postRaw):Wall.postShowDeletedMessage(postRaw,msg)){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post"+postRaw);"full_own"==cur.wallType||"full_all"==cur.wallType?(Pagination.recache(state?-1:1),FullWall.updateSummary(cur.pgCount)):"full"==cur.wallType&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(_,"reply")&&(state?--cur.pgOffset:++cur.pgOffset,state?--cur.pgCount:++cur.pgCount,FullWall.repliesSummary(cur.pgCount)),"own"!=cur.wallType&&"all"!=cur.wallType&&"archive"!=cur.wallType||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(_,"own")&&(state?++cur.deletedCnts.own:--cur.deletedCnts.own),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(_,"all")&&(state?++cur.deletedCnts.all:--cur.deletedCnts.all),Wall.isArchiveWall()&&(state?--cur.deletedCnts.archive:++cur.deletedCnts.archive),Wall.update())}if(js)try{eval(js)}catch(_){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_26__.logEvalError)(_,js)}},showProgress:isActionMenuItem?_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockActionsMenuItem.pbind(actionEl):(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockLink)(actionEl),hideProgress:isActionMenuItem?_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockActionsMenuItem.pbind(actionEl):(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockLink)(actionEl)})},deletePost:function(_,e,o,i,s){if((0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_66__.isPostponedPostsUpdateEnabled)()&&Wall.postponedPosts?.isLocked())return;(cur.wallLayer?wkcur:cur).wallMyDeleted[e]=1;const l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post"+e),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("post_actions",l),n={act:"delete",post:e,hash:o,root:i?1:0,confirm:s?1:0,from:"wall"};if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("feed_post_menu_stats")){const e=_ instanceof HTMLElement?(0,_web_feed_feed_common__WEBPACK_IMPORTED_MODULE_64__.getTrackCodeFromPost)(_):null;_shared_feed_stats_click_three_dots__WEBPACK_IMPORTED_MODULE_85__.FeedPostMenuStats.deletePost(e,(0,_web_feed_feed_common__WEBPACK_IMPORTED_MODULE_64__.resolveRefFromCur)())}cur.suggestedDeletedCount&&cur.suggestedDeletedCount>=2&&(n.delete_all=1),(0,_web_lib_utils__WEBPACK_IMPORTED_MODULE_28__.isClaimContent)()&&(n._nol=JSON.stringify(window.nav.objLoc)),ajax.post("al_wall.php",n,{onDone:function(s,a,n,d){if(d)return void(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_13__.showFastBox)((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("global_error"),s);if(n){const l=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_13__.showFastBox)(s,n,(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("global_delete"),(function(){l.hide(),wall.deletePost(_,e,o,i,1)}),(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("box_cancel"));return}Wall.postShowDeletedMessage(e,s),"full_own"==cur.wallType||"full_all"==cur.wallType?(Pagination.recache(-1),FullWall.updateSummary(cur.pgCount)):"full"==cur.wallType&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(l,"reply")&&(cur.pgOffset--,cur.pgCount--,FullWall.repliesSummary(cur.pgCount));const E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post_publish_wrap"+e);E&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(E,"suggest")&&(void 0===cur.suggestedDeletedCount&&(cur.suggestedDeletedCount=0),cur.suggestedDeletedCount++),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(l,"suggest")?Wall.suggestUpdate(-1):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(l,"postponed")?(Wall.postponedPosts?.removePost(),wall.postponeUpdateCount(Wall.postponedPosts?.getPostsSize())):"own"!=cur.wallType&&"all"!=cur.wallType&&"archive"!=cur.wallType||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(l,"own")&&++cur.deletedCnts.own,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(l,"all")&&++cur.deletedCnts.all,Wall.isArchiveWall()&&++cur.deletedCnts.archive,Wall.update())},showProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(_,"ui_actions_menu_item")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockActionsMenuItem)(_):_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_48__.FlatButton.isFlatButton(_)?_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_48__.FlatButton.lock(_):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)(a,"post_actions_progress")},hideProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(_,"ui_actions_menu_item")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockActionsMenuItem)(_):_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_48__.FlatButton.isFlatButton(_)?_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_48__.FlatButton.unlock(_):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)(a,"post_actions_progress")}});const d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("delete_post"+e);d&&d.tt&&d.tt.el&&d.tt.destroy()},markAsSpam:_web_page_tools_markAsSpam__WEBPACK_IMPORTED_MODULE_94__.markAsSpam,pinReply:function(_,e,o,i){const s={act:"reply_pin",post_raw_id:_,reply_raw_id:e,hash:o,action:i};ajax.post("al_wall.php",s,{onDone:function(_,e){(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_13__.showFastBox)(_,e)}})},isAdPostMarkingAsSpam:_web_page_tools_isAdPostMarkingAsSpam__WEBPACK_IMPORTED_MODULE_96__.isAdPostMarkingAsSpam,markAdAsSpam:_web_page_tools_markAdAsSpam__WEBPACK_IMPORTED_MODULE_95__.markAdAsSpam,_setAdReportHandler:_web_page_tools_setAdReportHandler__WEBPACK_IMPORTED_MODULE_99__.setAdReportHandler,showIgnoreItemReasons:_web_page_tools_showIgnoreItemReasons__WEBPACK_IMPORTED_MODULE_97__.showIgnoreItemReasons,ignoreAdsItem:_web_page_tools_ignoreAdsItem__WEBPACK_IMPORTED_MODULE_98__.ignoreAdsItem,ignoreAdsOwner:function(_,e,o,i){let s="post"+_;(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("post_adblock_protection_promo")&&(s=_shared_feed_adblock_protection_post_masker__WEBPACK_IMPORTED_MODULE_80__.AdBlockPostMasker.getInstance().getMaskedPostId(s));const l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)(s);l&&ajax.post("/al_feed.php",{act:"a_ignore_owner",post_raw:_,owner_id:e,hash:o,list:0,no_html:1},{onDone:function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)(l)},showProgress:i&&_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockButton.pbind(i),hideProgress:i&&_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton.pbind(i)})},markAsAds:function(_,e,o,i){ajax.post("al_wall.php",{act:"mark_as_ads",post:_,hash:e,full:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)(i)},{onDone:function(e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("ui_actions_menu_item_mark_as_ads"+_).innerHTML=e}})},restorePost:function(_,e,o){return(cur.wallLayer?wkcur:cur).wallMyDeleted[_]=0,ajax.post("al_wall.php",{act:"restore",post:_,hash:e,root:o?1:0},{onDone:function(e){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)("post_del_btn"+_),!Wall.postHideDeletedMessage(_))return;const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post"+_);"full_own"==cur.wallType||"full_all"==cur.wallType?(Pagination.recache(1),FullWall.updateSummary(cur.pgCount)):"full"==cur.wallType&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(o,"reply")&&(cur.pgOffset++,cur.pgCount++,FullWall.repliesSummary(cur.pgCount)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(o,"suggest")?Wall.suggestUpdate(1):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(o,"postponed")?(Wall.postponedPosts?.restorePost(),wall.postponeUpdateCount(Wall.postponedPosts?.getPostsSize())):"own"!=cur.wallType&&"all"!=cur.wallType&&"archive"!=cur.wallType||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(o,"own")&&--cur.deletedCnts.own,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(o,"all")&&--cur.deletedCnts.all,Wall.isArchiveWall()&&--cur.deletedCnts.archive,Wall.update())}}),!1},blockPostApp:function(_,e,o,i){ajax.post("al_wall.php",{act:"block_post_app",aid:_,from:e,hash:o},{onDone:function(_){i.parentNode.parentNode.innerHTML=_},showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockButton.pbind(i),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton.pbind(i)})},sendExpandStatsGlobal:_=>{const e=document.getElementById("post"+_);(0,_web_feed_components_text_stats__WEBPACK_IMPORTED_MODULE_71__.sendExpandStats)(e)},checkPostClick:function(_,e,o){if(e=e||window.event,!_||!e)return!0;let i=e.target||e.srcElement,s=8,l=!1,a=/wall_post_text|published_comment|post_media|page_event_share|page_public_share|page_group_share|feed_friends|feed_videos|feed_explain_list|explain|feed_photos|feedback_row/;do{if(!i||i==_||i.onclick||i.onmousedown||(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.inArray)(i.tagName,["A","IMG","TEXTAREA","EMBED","OBJECT"])||(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.inArray)(i.className,["play_new","video_box_wrap"])||(l=i.className.match&&i.className.match(a))||i?.closest("."+_shared_stickers_refactor_constants__WEBPACK_IMPORTED_MODULE_76__.POPUP_STICKER_ICON_CLASS))break}while(s--&&(i=i.parentNode));if(!l)return!1;if(cur.postClicked||(cur.postClicked={}),!o||!cur.postClicked[_]){if((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.trim)((window.getSelection&&window.getSelection()||document.getSelection&&document.getSelection()||document.selection&&document.selection.createRange().text||"").toString()))return!1;o&&(cur.postClicked[_]=!0,setTimeout((function(){cur.postClicked[_]=!1}),2e3))}return i||!0},postClick:function(_,e,o){if((0,_web_stickers_Stickers_helpers__WEBPACK_IMPORTED_MODULE_72__.checkStopActionOnEventOnSticker)(e))return;if((0,_shared_short_video_utils__WEBPACK_IMPORTED_MODULE_70__.checkStopActionOnEventOnShortVideo)(e))return;o=o||{};const i=(_||"").match(/^(-?\d+)_(wall)?(\d+)$/),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post"+_);let l;const{target:a}=e;window?.searcher?.onPostClick?.(a);const n=(0,_web_feed_feed_common__WEBPACK_IMPORTED_MODULE_64__.getTrackCodeFromPost)(s);if(a&&"A"===a.tagName&&a.href&&(0,_shared_feed_feed_utils__WEBPACK_IMPORTED_MODULE_69__.checkIfInternalLink)(a.href)&&(0,_web_feed_feed_stats__WEBPACK_IMPORTED_MODULE_73__.checkIfLinkIsValid)(a)&&_shared_production_stats_click_feed_post_interaction__WEBPACK_IMPORTED_MODULE_68__.feedInteractionItemStatCollector.logEvent({track_code:n??void 0,ref:(0,_web_feed_feed_common__WEBPACK_IMPORTED_MODULE_64__.resolveRefFromCur)(),item:(0,_web_feed_feed_stats_utils__WEBPACK_IMPORTED_MODULE_74__.getFeedInteractionItemType)()},_shared_production_stats_types__WEBPACK_IMPORTED_MODULE_67__.EventItemType.INT_LINK_CLICK),l=!!o.skipCheck||Wall.checkPostClick(s,e),!l)return;if(!0!==l){if(!l.querySelector(".PostTextMore[data-open-post]")){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("wall_post_more",l,"a");if(_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)(_))return _.onclick(),void(i||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)(s,"wall_post_over"));const e=l.querySelector("button.PostTextMore");if(e)return e.click(),void e.remove()}}if(!i)return;if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(s,"suggest")||cur.onepost)return;const d=s&&(0,_shared_feed_adblock_protection_attributes_hider__WEBPACK_IMPORTED_MODULE_79__.getAdAttribute)(s,"ad"),E=s&&(0,_shared_feed_adblock_protection_attributes_hider__WEBPACK_IMPORTED_MODULE_79__.getAdAttribute)(s,"ad-block-uid"),c="/wall"+i[1]+"_"+i[3];if(_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.mobile&&e){const _={};d&&E&&(_.params={_post_ad_data:d,_post_ad_block_unique_id:E}),nav.go(c,null,_)}else(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.checkEvent)(e)?window.open(c,"_blank"):(d&&E&&(o.ads_params={post_ad_data:d,ad_block_unique_id:E}),o.trackCode=(0,_web_feed_feed_common__WEBPACK_IMPORTED_MODULE_64__.getTrackCodeFromPost)(s),o.postInteractionItem=_shared_production_stats_types__WEBPACK_IMPORTED_MODULE_67__.FeedInteractionItemType.WALL_ITEM,o.postId=s?.getAttribute("id"),Wall.hideEditPostReply(),Wall.postFull("wall"+i[1]+"_"+i[3],!1,o))},postClickStat:function(_){const e=(_=(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.normEvent)(_)).currentTarget,o=[];(0,_shared_feed_adblock_protection_attributes_hider__WEBPACK_IMPORTED_MODULE_79__.getAdAttribute)(e,"ad-view")&&(o.push(Wall.postsGetRaws(e)),Page.postsSeen(o));const i=_.target;let s=i.getAttribute("data-post-click-type");if(s||(s=i?.closest("a[data-post-click-type]")?.getAttribute("data-post-click-type")),!e)return;const l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("wall_post_text",_.target,e)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("wall_post_text_wrapper",_.target,e),a=e.querySelector('[data-testid="secondaryattachment"]'),n=a&&(a===_.target||a.contains(_.target));(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.inArray)(s,["post_owner_img","post_owner_link"])||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(i,"author")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(i,"post_image")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(i,"post_img")?Wall.triggerAdStat(e,"click_post_owner"):("A"==_.target.nodeName&&l||n||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("page_media_thumbed_link",_.target,e)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(_.target,"lnk")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("lnk",_.target,e))&&Wall.triggerAdStat(e,"click_post_link")},adBlockClickStat:function(_,e){const o=(_=(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.normEvent)(_)).currentTarget;if(!o)return;const i="._ads_block_data_w",s=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("post_adblock_protection_promo")?`${_shared_adblock_protection_locator__WEBPACK_IMPORTED_MODULE_89__.Locator.getInstance().lookupSelector(i)}, .post, ._post`:i,l=o.closest(s);if(!l)return;const a=[];(0,_shared_feed_adblock_protection_attributes_hider__WEBPACK_IMPORTED_MODULE_79__.getAdAttribute)(l,"ad-view")&&(a.push(Wall.postsGetRaws(l)),Page.postsSeen(a)),Wall.triggerAdStat(l,e)},getAdsEvents:function(){return _shared_lib_ls__WEBPACK_IMPORTED_MODULE_15__.multiAccountLs.get(Wall.LS_ADS_EVENTS)||{}},setAdsEvents:function(_){_shared_lib_ls__WEBPACK_IMPORTED_MODULE_15__.multiAccountLs.set(Wall.LS_ADS_EVENTS,_)},cleanAdsEvents:function(){const _=Wall.getAdsEvents(),e=(new Date).getTime()/1e3|0;let o=!1;(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.each)(_,(function(i,s){e-s>=3600&&(delete _[i],o=!0)})),o&&Wall.setAdsEvents(_)},triggerAdPostStat:function(_,e){Wall.triggerAdStat(_,e)},triggerAdStat:function(elIdOrEl,event){const el="string"==typeof elIdOrEl?Wall.domPost(elIdOrEl):elIdOrEl;[_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_84__.PixelNames.click,_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_84__.PixelNames.click_post_owner].includes(event)&&(0,_shared_pixels__WEBPACK_IMPORTED_MODULE_81__.logPixelEvent)(el,event);let pixels=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("post_adblock_protection_promo")?(0,_shared_feed_adblock_protection_attributes_hider__WEBPACK_IMPORTED_MODULE_79__.getAdAttribute)(el,`ad-stat-${event}`):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(el,"ad-stat-"+event);for(;pixels;){const _=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("post_adblock_protection_promo")?(0,_shared_feed_adblock_protection_attributes_hider__WEBPACK_IMPORTED_MODULE_79__.getAdAttribute)(el,"ad-block-uid"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(el,"ad-block-uid"),e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.inArray)(event,["load","impression","impression_long","video_start","video_play_3s","video_play_10s","video_play_25","video_play_50","video_play_75","video_play_95","video_play_100"]);if(e&&((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("post_adblock_protection_promo")?((0,_shared_feed_adblock_protection_attributes_hider__WEBPACK_IMPORTED_MODULE_79__.updateAdAttribute)(el,`ad-disabled-stat-${event}`,(0,_shared_feed_adblock_protection_attributes_hider__WEBPACK_IMPORTED_MODULE_79__.getAdAttribute)(el,`ad-stat-${event}`)),(0,_shared_feed_adblock_protection_attributes_hider__WEBPACK_IMPORTED_MODULE_79__.removeAdAttribute)(el,`ad-stat-${event}`)):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(el,"ad-disabled-stat-"+event,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(el,"ad-stat-"+event)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(el,"ad-stat-"+event,null))),_&&e)try{const e=(0,_web_lib_utils__WEBPACK_IMPORTED_MODULE_28__.hashCode)(""+event+_),o=Wall.getAdsEvents();if(o[e])break;const i=(new Date).getTime()/1e3|0;o[e]=i,Wall.setAdsEvents(o)}catch(_){try{(0,_shared_pixels__WEBPACK_IMPORTED_MODULE_81__.logPixelEvent)?.(el,_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_84__.PixelNames.error),console.log(_.message)}catch(_){}}pixels=pixels.split("$$$"),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.each)(pixels,(function(_,e){const o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.vkImage)();o.src=e,o.onerror=function(){(0,_shared_pixels__WEBPACK_IMPORTED_MODULE_81__.logPixelEvent)?.(el,_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_84__.PixelNames.error)}}));break}if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("ads_pixels_track_new_events_web_mvk"))(0,_shared_pixels__WEBPACK_IMPORTED_MODULE_81__.triggerAdHtmlEvent)(el,event);else{const statHtml=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("post_adblock_protection_promo")?(0,_shared_feed_adblock_protection_attributes_hider__WEBPACK_IMPORTED_MODULE_79__.getAdAttribute)(el,`ad-stat-html-${event}`):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(el,"ad-stat-html-"+event);if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("post_adblock_protection_promo")?(0,_shared_feed_adblock_protection_attributes_hider__WEBPACK_IMPORTED_MODULE_79__.removeAdAttribute)(el,`ad-stat-${event}`):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(el,"ad-stat-html-"+event,null),statHtml){const statElemWrap=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ce)("div",{innerHTML:statHtml});let elem;for(;elem=statElemWrap.firstChild;)if(el.appendChild(elem),"SCRIPT"===elem.tagName)try{eval(elem.innerHTML)}catch(_){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_26__.logEvalError)(_,elem.innerHTML)}}}},copyHistory:function(_,e,o,i){let s=(_=_||window.event).target||_.srcElement,l=8,a=!1,n=/published_a_quote/,d=!1;do{if(!s||(a=s.className.match(n))||s.onclick||s.onmousedown||(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.inArray)(s.tagName,["A","IMG"]))break}while(l--&&(s=s.parentNode));if(!a)return;return(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.trim)((window.getSelection&&window.getSelection()||document.getSelection&&document.getSelection()||document.selection&&document.selection.createRange().text||"").toString())?void 0:((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("feed_react_post")&&(d=(0,_web_feed_utils_isWkLayerOpened__WEBPACK_IMPORTED_MODULE_107__.isWkLayerOpened)()),ajax.post("al_wall.php",{act:"copy_history",post:o,offset:i,from:cur.module,is_wk_layer:d},{onDone:function(_){if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domPN)(e))return;if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)(e),!_)return;const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domPN)(e),"published_by_quote")?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domPN)(e):e;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domPN)(o).insertBefore((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.cf)(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domNS)(o)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isAncestor)(o,"im_rows")?IM.updateScroll(!0):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isAncestor)(o,"wl_post")&&WkView.wallUpdateReplies()}}),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.cancelEvent)(_))},postFull:function(_,e,o){if(_.match(/^wall-?\d+_\d+$/)&&!(o||{}).nolist&&(!cur.pgParams||!cur.pgParams.owners_only&&!cur.pgParams.q))switch(cur.wallType){case"all":case"full_all":_+="/all"}return(0,_web_lib_feature_entries_showWiki__WEBPACK_IMPORTED_MODULE_10__.showWiki)({w:_,reply:o?.reply},!1,e,o)},checkReplyClick:function(_,e){if(e=e||window.event,!_||!e)return!1;let o=e.target||e.srcElement,i=8,s=!1;do{if(!o||o==_||o.onclick||o.onmousedown||"A"==o.tagName&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(o,"_reply_lnk")||(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.inArray)(o.tagName,["IMG","TEXTAREA","EMBED","OBJECT"])&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(o,"emoji")||"wpe_cont"==o.id||o.dataset.preventReplyClick||(s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(o,"_reply_content")))break}while(i--&&(o=o.parentNode));if(!s)return!0;return!!(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.trim)((window.getSelection&&window.getSelection()||document.getSelection&&document.getSelection()||document.selection&&document.selection.createRange().text||"").toString())},replyClick:function(_,e,o,i){if((0,_web_stickers_Stickers_helpers__WEBPACK_IMPORTED_MODULE_72__.checkStopActionOnEventOnStickerPopupIcon)(o))return;if(o?.target.classList.contains(_web_Badges_constants__WEBPACK_IMPORTED_MODULE_55__.BADGE_COMMENT_SELECTOR))return;const s=_.split("_"),l=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)(s[0]),a=s[1].replace(/-?\d+$/,""),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post"+l+a+"_"+e);let d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post"+_);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(d,"closed_comments")||!cur.stickerClicked&&Wall.checkReplyClick(n,o))return;(o||{}).cancelBubble=!0;const E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("wall_reply_more",n,"a");if(E&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)(E))return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)(n,"reply_moreable"),void E.onclick();if(i){d=cur.wallLayer?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("wl_post"):d;const s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(d,"deep_active"),{packId:l,clickData:a}=cur.stickerClicked||{};let E=_;if(s){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("replies_wrap_deep",n);E=_?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(_,"post-id"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(n,"post-id")}const c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_field"+E);cur.stickerClicked=null,!l||c&&c.emojiInited||(cur.afterEmojiInit=cur.afterEmojiInit||{},cur.afterEmojiInit[E]=function(){Emoji.clickSticker(l,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_field"+E),o,a)}),Wall.replyTo(E,e,i,o),l&&c&&c.emojiInited&&Emoji.clickSticker(l,c,o,a)}},stickerClick:function(_,e,o,i){return o&&(o.cancelBubble=!0),window.Emoji?e?(Emoji.getStickerPack(_).then((s=>{if(Boolean(s?.[Emoji.PACK_FIELD_IS_ACTIVE])){const o=e.closest(".reply");o?.onclick&&(cur.stickerClicked={packId:_,clickData:i},o.onclick())}else Emoji.clickSticker(_,null,o,i)})),!1):(Emoji.clickSticker(_,null,o,i),!1):(window.stManager.add([window.jsc("web/emoji.js"),"notifier.css"],(function(){Wall.stickerClick(_,e,o,i)})),!1)},domPost:function(_){return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post"+_)},formatCount:function(_,e){return e=e||{},(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.formatCount)(_,e)},likeFullUpdate:function(_,e,o){const i=e.match(/^(wall|photo|video|note|topic|wall_reply|note_reply|photo_comment|video_comment|topic_comment|market_comment|)(-?\d+_)(\d+)/);Likes.update(i?(i[1]||"wall")+i[2]+i[3]:e,o)},likeUpdate:function(_,e,o,i,s,l,a){a||(i=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)(i)),!1===_&&cur.wallLayer===e&&(_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("wl_post_body"));const n=e.match(/(-?\d+)(_?)(photo|video|note|topic|wall_reply|note_reply|photo_comment|video_comment|topic_comment|market_comment|)(\d+)/),d=n[1]+"_"+n[4],E=_&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("_post_content",_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("wl_post",_))||wall.domPost(d),c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domByClass)(E,a?"_views_wrap":l?"_share_wrap":"_like_wrap"),p=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domByClass)(c,"_count");if(!p)return;if(!a&&!l){const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domByClass)(E,"_views_wrap"),s=o&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domByClass)(o,"_count");!s||!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(o,"_auto_update")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(s)&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(s)!=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(p)||wall.likeUpdate(_,e,0,this.formatCount(i),void 0,void 0,1)}const P=c.tt||{},u=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.clone)(P.opts||{}),b=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domByClass)(P.container,"_value"),O=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domByClass)(P.container,"_content"),D=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domByClass)(P.container,"_title");s&&D&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(D,s),P&&(P.likeInvalidated=!0),b&&(b.value=i),(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_21__.animateCount)(p,a?i:(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_23__.langNumeric)(i,"%s",!0),{str:"auto",noWrapWidth:!!a}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.toggleClass)(c,l?"my_share":"my_like",o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.toggleClass)(c,a?"no_views":l?"no_shares":"no_likes",!i),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.toggleClass)(O,"me_hidden",!o&&!a),i?P.el&&(!1===s?P.destroy&&P.destroy():(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)(P.container)||s||!1===s||tooltips.show(P.el,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)(u,{showdt:0}))):P.el&&P.hide();const M=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_23__.langNumeric)(i,"%s",!0);if(a){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("feedback_views",E);let e=0;e=i.match(/^\d+$/)?(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)(i):5,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(_,"<em>"+i+"</em> "+(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("global_X_post_views",e,!0))}else if(l){let _="";i>0&&(_="<em>"+M+"</em> "+(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("global_X_shared",i,!0)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("feedback_share",E),_)}else{let _="";i>0&&(_="<em>"+M+"</em> "+(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("global_like")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("feedback_like",E),_)}},likeShareUpdate:function(_,e,o,i,s){return Wall.likeUpdate(_,e,o,i,s,!0)},like:function(_,e){if(!vk.id||cur.viewAsBox)return;const o=wall.domPost(_),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domByClass)(o,"_like_wrap"),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domByClass)(i,"_icon"),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domByClass)(i,"_count"),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(s,"fw_like_icon")?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(s,"fw_my_like"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(i,"my_like"),n=_.match(/(-?\d+)(_?)(photo|video|note|topic|market|wall_reply|note_reply|photo_comment|video_comment|topic_comment|market_comment|)(\d+)/),d=(n[3]||"wall")+n[1]+"_"+n[4];let E=cur.module;cur.wallType&&(E="feed"==cur.wallType?"feed_"+("news"==cur.section&&cur.subsection?cur.subsection:cur.section):"top"==cur.wallType?"wall_top":"wall_"+(cur.onepost?"one":(cur.wallType||"").indexOf("full_")?"page":"full")),ajax.post("like.php",{act:"a_do_"+(a?"un":"")+"like",object:d,hash:e,wall:2,from:E},{onDone:Wall.likeFullUpdate.pbind(!1,_)});const c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(l);Wall.likeUpdate(!1,_,!a,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)(c)+(a?-1:1)),cur.onWallLike&&cur.onWallLike()},bookmark:function(_,e){(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.cancelEvent)(e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)(_,"bookmarked")},likeShare:function(_,e){if(!vk.id||cur.viewAsBox)return;const o=_.match(/(-?\d+)(_?)(photo|video|note|topic|market|wall_reply|note_reply|photo_comment|video_comment|topic_comment|market_comment|)(\d+)/),i=(o[3]||"wall")+o[1]+"_"+o[4],s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("like_share_"+i),l=(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isChecked)(s);let a=cur.wallType?"feed"==cur.wallType?"feed_"+cur.section:"wall_"+(cur.onepost?"one":(cur.wallType||"").indexOf("full_")?"page":"full"):cur.module;"top"==cur.wallType&&(a="wall_top"),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.checkbox)(s),ajax.post("like.php",{act:"a_do_"+(l?"un":"")+"publish",object:i,hash:e,wall:2,ref:a},{onDone:Wall.likeFullUpdate.pbind(!1,_)});const n=wall.domPost(_),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domByClass)(n,"_like_wrap"),E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domByClass)(d,"_icon"),c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domByClass)(n,"_count")),p=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(E,"fw_like_icon")?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(E,"fw_my_like"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(d,"my_like");Wall.likeUpdate(!1,_,!0,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)(c)+(p?0:1))},likeShareCustom:function(_,e){const o=_.match(/(-?\d+)(_?)(photo|video|note|topic|market|wall_reply|note_reply|photo_comment|video_comment|topic_comment|market_comment|)(\d+)/),i=(o[3]||"wall")+o[1]+"_"+o[4];(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_13__.showBox)("like.php",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)({act:"publish_box",object:i},e))},likeShareCheckLen:function(_,e,o){_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)(_),e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)(e),o=o||255;const i=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.trim)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(_)).replace(/\n\n\n+/g,"\n\n");if(_.lastLen===i.length)return;const s=_.lastLen=i.length,l=s-i.replace(/\n/g,"").length;s>o-50||l>4?(s>o?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(e,(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("text_exceeds_symbol_limit",s-o)):l>4?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(e,(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("global_recommended_lines",l-4)):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(e,(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("text_N_symbols_remain",o-s)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)(e)):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)(e)},showLikesPage:function(_,e,o){cur.likesBox.loadTabContent("like.php",{act:"a_get_members",object:_,published:e,offset:o,wall:1},e)},clearLikesCache:function(_,e){const o="^/like.php#"+(0,_shared_lib_convert__WEBPACK_IMPORTED_MODULE_24__.toQueryString)({act:"a_get_members",object:_,published:e,offset:12345,wall:1,tab:e,only_content:1}).replace("12345","\\d+")+"$",i=new RegExp(o,"i");for(const _ in ajaxCache)i.test(_)&&delete ajaxCache[_]},subscribeByButton:_web_wall_post_subscribe_action_post_subscribe_action__WEBPACK_IMPORTED_MODULE_4__.subscribeByButton,subscribeByAction:_web_wall_post_subscribe_action_post_subscribe_action__WEBPACK_IMPORTED_MODULE_4__.subscribeByAction,subscribeToAuthor:_web_wall_post_subscribe_action_post_subscribe_action__WEBPACK_IMPORTED_MODULE_4__.subscribeToAuthor,showPhoto:function(_,e,o,i,s){return!(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_13__.showBox)("al_photos.php",{act:"photo_box",to_id:_,photo:e,hash:o},{cache:1},!!i.href&&s)},domFC:function(_){for(_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domFC)(_);_&&_.id.match(/page_wall_count_/);)_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domNS)(_);return _},domPS:function(_){for(_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domPS)(_);_&&_.id.match(/page_wall_count_/);)_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domPS)(_);return _},initScrollChecking(_){(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.addEvent)(window,"scroll",Wall.scrollCheck),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.addEvent)(window,"resize",Wall.scrollCheck),(0,_shared_lib_nav_helpers__WEBPACK_IMPORTED_MODULE_108__.pushNavDestroy)((()=>{(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.removeEvent)(window,"scroll",Wall.scrollCheck),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.removeEvent)(window,"resize",Wall.scrollCheck)})),window.cur.wallAutoMore=_.automore,setTimeout((()=>{Wall.scrollCheck()}),200)},scrollCheck:function(_,e,o){const i=null==e?(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_20__.scrollGetY)():e;let s,l=0;const a=[],n=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;if(window.scrollAnimation)return!1;if(Wall.repliesSideUpdate(i),cur.wallPage){let _;if(_="suggested"==cur.wallTab?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("page_suggested_posts"):"top"==cur.wallTab?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("page_top_posts"):"donut"===cur.wallTab?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("page_donut_posts"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("page_wall_posts"),((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domPN)(cur.topRow)!=_||((cur.topRow||{}).id||"").match(/page_wall_count_/))&&(cur.topRow=Wall.domFC(_)),vk.id&&cur.topRow&&!cur.topRow.id.match(/page_wall_count_/)&&!((window.curNotifier||{}).idle_manager||{}).is_idle){const _=[];for(let e=Wall.domPS(cur.topRow);e;e=Wall.domPS(e))cur.topRow.offsetTop>i&&(cur.topRow=e),e.unseen||(e.unseen=!0,_.push(Wall.postsGetRaws(e)));Page.postsUnseen(_);for(let _=cur.topRow;_;_=s){window.LongView&&window.LongView.register(_,"Wall");const e=l||_.offsetTop;if(e>=i+n)break;s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domNS)(_),((s||{}).id||"").match(/page_wall_count_/)&&(s=null),l=s?s.offsetTop:e+_.offsetHeight,l<i&&s&&(cur.topRow=s);let o=_.bits||0;o>=3||(o|=(e>=i&&e<i+n?1:0)|(l>=i&&l<i+n?2:0))&&(_.bits=o,3==o&&a.push(Wall.postsGetRaws(_)))}window.LongView&&window.LongView.onScroll(i,n),Page.postsSeen(a)}}if(!cur.wallAutoMore||cur.wallLoading||cur.viewAsBox)return;const d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("wall_more_link");if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)(d))return;i+(window.lastWindowHeight||window.innerHeight)+1500>(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getXY)(d)[1]&&d.onclick()},postsGetRaws:function(_){const e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.indexOf)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domPN)(_).children,_);let o;const i={};if(!_)return i;i.module=cur.module,i.index=e;const s=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("post_adblock_protection_promo")?_shared_adblock_protection_locator__WEBPACK_IMPORTED_MODULE_89__.Locator.getInstance().lookupClassName("_ads_promoted_post"):"_ads_promoted_post",l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(_,s),a=(0,_shared_feed_adblock_protection_attributes_hider__WEBPACK_IMPORTED_MODULE_79__.getAdAttribute)(_,"ad-view");a&&(i["ad_"+a]=1,l&&(i.module+=s));const n=_.getAttribute("post_view_hash");if(n&&(i.hash=n),"block_"===_.id.substr(0,6)){i[_.id]=1,i.block=_.id.substr(6);let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.attr)(_,"data-contain");e&&(e=e.split(","),e.forEach((function(_){_=_.split(":"),i[_[0]]=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)(_[1])||1})))}else(o=_.id.match(/^post(-?\d+_\d+)$/))&&(i[o[1]]=1,(o=(_.getAttribute("data-copy")||"").match(/^(-?\d+_\d+)$/))&&(i[o[1]]=-1));return i},votingExtendParams:function(_,e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(e,"fixed")&&(_.is_fixed=1),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(e,"preview")&&(_.is_preview=1),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(e,"board")&&(_.is_board=1),vk.widget&&(_.is_widget=1,_.width=cur.widgetWidth,_.url=cur.url),cur.voteHash&&(_.vote_hash=cur.voteHash);const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(e,"id");o&&(_.voting_id=o);const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(e,"ref");i&&(_.ref=i);const s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(e,"hash");s&&(_.hash=s);const l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(e,"material");!l||_.is_board||_.is_widget||(_.material=l);const a=e?.getAttribute("data-track-code");return a&&(_.track_code=a),_},votingRevote:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("media_voting",_);if(e){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(e,"id");if((0,_web_page_wall_report_voting_utils__WEBPACK_IMPORTED_MODULE_91__.isVotingLocked)(_))return;const o=this.votingExtendParams({act:"revote"},e);ajax.post("al_voting.php",o,{onDone:this.votingUpdateFull.bind(this,_),showProgress:this.votingLock.bind(this,_),hideProgress:this.votingUnlock.bind(this,_)})}},votingLock:function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("_media_voting"+_).forEach((_=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(_,"disabled")&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(_,"queue")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)(_,"media_voting_locked")}))},votingUnlock:function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("_media_voting"+_).forEach((_=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)(_,"media_voting_locked")}))},votingUpdate:function(_,e){ajax.post("al_voting.php",{act:"get_layout",voting_id:_},{onDone:o=>{(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.isFunction)(e)&&!1===e(o)||(this.votingUpdateFull(_,o),this.votingUnlock(_))},onFail:()=>this.votingUnlock(_),showProgress:()=>this.votingLock(_)})},votingUpdateFull:function(_,e){if(_&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.isString)(e)){const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("_media_voting"+_);o.length&&(o.forEach((_=>{if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(_,"disabled")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(_,"queue"))if(""===e)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)(_);else{const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.cf)(e);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(_,"media_voting_can_vote")){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domFC)(o);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)(e,"media_voting_just_voted"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domReplaceEl)(_,o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClassDelayed)(e,"media_voting_just_voted")}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domReplaceEl)(_,o)}})),window.IMBRIDGE&&setTimeout(IMBRIDGE.syncHistory.bind(IMBRIDGE),0),vk.widget&&window.WPoll&&window.WPoll.resizeWidget())}},votingUpdatePartly:function(_,e){if(!_||!(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_34__.isObject)(e)||(0,_web_page_wall_report_voting_utils__WEBPACK_IMPORTED_MODULE_91__.isVotingLocked)(_))return;const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("_media_voting"+_);if(!o.length)return;const i=e.answers.reduce(((_,e)=>Math.max(_,e.rate)),0),s={};e.answers.forEach((_=>{_.isLeader=_.rate===i,s[_.id]=_})),o.some((o=>{if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(o,"disabled"))return;if(o.classList.contains("media_voting_voted")&&!e.votes)return this.votingUpdate(_),!0;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("media_voting_option_wrap",o).forEach((_=>{const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(_,"id"),i=s[o];if(_.tt&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.isFunction)(_.tt.destroy)&&_.tt.destroy(),!i)return;const l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("media_voting_option_bar",_),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("media_voting_option_percent",_),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("media_voting_option_count",_),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("media_voting_option_counter",_),E=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_23__.langNumeric)(i.votes,"%s",!0),c=new Array((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.cf)(E).textContent.split("").length+2).join("0");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domLC)(n),c),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domLC)(d),E),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(a,e.votes?i.rate:""),l.style.transform=`scaleX(${.01*i.rate})`,l.style.oTransform=`scaleX(${.01*i.rate})`,i.votes?n.classList.remove("media_voting_option_count_hidden"):(n.classList.add("media_voting_option_count_hidden"),_.classList.remove("media_voting_option_voted")),i.isLeader?_.classList.add("media_voting_option_leader"):_.classList.remove("media_voting_option_leader")}));const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("_media_voting_footer_voted_text",o);if(i){let _;_=e.votes?vk.widget?(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("voting_x_voted_short",e.votes,!0):(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("voting_x_voted",e.votes,!0):(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("voting_nobody_voted",e.votes,!0),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(i,_);const s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("media_voting_footer_voted_friend",o);s.length>e.votes&&s.forEach((_=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)(_)}))}})),window.IMBRIDGE&&window.IMBRIDGE.syncHistory(),vk.widget&&window.WPoll&&window.WPoll.resizeWidget()},votingUpdateByPostRaw:function(_){if(vk.id){_=_.split("_");const e=(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_34__.positive)(_[1]),o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)(_[0]),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("_post_media_voting"+o+"_"+e);if(i&&i.length){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("media_voting",i[0]);if(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(_,"id");this.votingUpdate(e)}}}},votingVote:function(_,e){const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(_,"id");if(!(0,_web_page_wall_report_voting_utils__WEBPACK_IMPORTED_MODULE_91__.isVotingLocked)(o)&&vk.id){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(_,"queue"))return this.votingUpdate(o,(_=>{if(_&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.isString)(_)){const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domFC)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.cf)(_));if(o&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(o,"queue")&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(o,"disabled"))return this.votingVote(o,e,!0),!1}}));if(e.length){const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domPN)(_),"wk_voting_box"),s=this.votingExtendParams({act:"vote",option_ids:e.join(",")},_);ajax.post("al_voting.php",s,{onDone:(_,e)=>{i?nav.reload():(vk.widget&&window.WPoll&&window.WPoll.updateShareMessage(e),this.votingUpdateFull(o,_))},showProgress:this.votingLock.bind(this,o),hideProgress:()=>{i||this.votingUnlock(o)}})}}else vk.widget&&Widgets.oauth()},votingButtonVote:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("media_voting",_);if(e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(e,"media_voting_multiple")){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("media_voting_option_selected",e),o=[];_.forEach((function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(_,"id");e&&o.push(e)})),this.votingVote(e,o)}},votingOptionVote:function(_,e){const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("media_voting",_);if(o){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(o,"media_voting_multiple")){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(o,"id");if((0,_web_page_wall_report_voting_utils__WEBPACK_IMPORTED_MODULE_91__.isVotingLocked)(e)||!vk.id)return void(vk.widget&&Widgets.oauth());(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.toggleClass)(_,"media_voting_option_selected");const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("media_voting_option_selected",o).length;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.toggleClass)(o,"media_voting_has_selected_options",i)}else{const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(_,"id");this.votingVote(o,[e])}(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.cancelEvent)(e)}},votingOptionVoteAttempt:function(_,e,o,i){const s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("media_voting",_);if(s){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(s,"ref");(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_19__.statlogsValueEvent)("voting_vote_attempt",_,o,i)}(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.cancelEvent)(e)},votingOptionTooltip:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("media_voting",_);if(e){const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(_,"id"),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(e,"owner-id"),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(e,"id"),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(e,"board");(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_12__.showTooltip)(_,{url:"al_voting.php",params:{act:"option_tt",option_id:o,owner_id:i,is_board:l,voting_id:s},slide:15,ajaxdt:100,showdt:400,hidedt:200,dir:"auto",shift:[0,10,10],typeClass:"voting_tt"})}},votingLayer:function(_,e){const o=!!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(_,"media_voting_option_wrap")&&_,i=o?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(o,"id"):0,s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(_,"media_voting")?_:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("media_voting",_);if(s){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(s,"id"),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(s,"owner-id"),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(s,"board"),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(s,"ref"),n={w:(l?"board_poll":"poll")+o+"_"+_};if(i&&(n.opt_id=i),vk.widget)window.open(location.origin+"/"+n.w,"poll");else{const _={queue:1,noloader:!!(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_17__.curBox)()};"story"===a&&(_.customRef="story"),(0,_web_lib_feature_entries_showWiki__WEBPACK_IMPORTED_MODULE_10__.showWiki)(n,!1,void 0,_)}(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.cancelEvent)(e)}},votingExport:function(_,e={}){const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("media_voting",_);if(o&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(o,"board")||e.id&&!1===e.isBoard){const _=this.votingExtendParams({act:"export_box",is_board:e.isBoard,voting_id:e.id},o);(vk.widget?window.showBox:_web_lib_message_box__WEBPACK_IMPORTED_MODULE_13__.showBox)("al_voting.php",_,{onDone:function(){(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_17__.curBox)().setOptions({width:500,needShadow:!1})}})}},votingOnMain:function(_,e){const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("media_voting",_);if(o){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(o,"id");if((0,_web_page_wall_report_voting_utils__WEBPACK_IMPORTED_MODULE_91__.isVotingLocked)(_))return;const i=this.votingExtendParams({act:"onmain",state:e?1:0},o);ajax.post("al_voting.php",i,{onDone:this.votingUpdateFull.bind(this,_),showProgress:this.votingLock.bind(this,_),hideProgress:this.votingUnlock.bind(this,_)})}},votingClosed:function(_,e){const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("media_voting",_);if(o){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(o,"id");if((0,_web_page_wall_report_voting_utils__WEBPACK_IMPORTED_MODULE_91__.isVotingLocked)(_))return;const i=this.votingExtendParams({act:"closed",state:e?1:0},o);ajax.post("al_voting.php",i,{onDone:this.votingUpdateFull.bind(this,_),showProgress:this.votingLock.bind(this,_),hideProgress:this.votingUnlock.bind(this,_)})}},votingNarrowAction:function(votingId,hash,action){let act,state;switch(action){case 101:act="closed",state=0;break;case 102:act="closed",state=1;break;case 103:act="onmain",state=0;break;case 104:act="onmain",state=1}act&&!cur.votingNarrowActionProgress&&ajax.post("al_voting.php",{act,voting_id:votingId,is_fixed:1,state,narrow:1,hash},{onDone:function(html,js){let votingModuleEl=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("group_voting");if(votingModuleEl&&(votingModuleEl=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domPN)(votingModuleEl),html?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domReplaceEl)(votingModuleEl,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.cf)(html)):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)(votingModuleEl)),js)try{eval(js)}catch(_){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_26__.logEvalError)(_,js)}},showProgress:function(){cur.votingNarrowActionProgress=!0},hideProgress:function(){cur.votingNarrowActionProgress=!1}})},showReportVotingForm:function(_,e={}){(0,_web_page_wall_report_voting_utils__WEBPACK_IMPORTED_MODULE_91__.showReportVotingForm)(_,e)},foTT:function(_,e,o){o&&o.oid&&(e=o.oid==vk.id?(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_my_friends_only"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("wpfo"+o.pid)),(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_12__.showTitle)(_,e)},update:function(){if(cur.wallLayer)return void WkView.wallUpdateReplies();const _="top"===cur.wallType,e="archive"===cur.wallType,o="donut"===cur.wallType;if("all"!==cur.wallType&&"own"!==cur.wallType&&!_&&!e&&!o||"all"!==cur.wallTab&&"own"!==cur.wallTab&&"top"!==cur.wallTab&&"archive"!==cur.wallTab&&"donut"!==cur.wallTab)return;const i=e?"all":_||o?"own":cur.wallType,s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("wall_more_link"),l=Wall.getPostsWrap(cur.wallType),a=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)(cur.deletedCnts[i]),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)(i,l).length-a;let d=!1;if((_||e||o)&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("no_posts",l))||_&&cur.wallTopFinished===cur.oid||e&&cur.wallArchiveFinished===cur.oid||o&&(cur.wallDonutFinished===cur.oid||Wall.cantAccessDonutPosts())))d=!0;else{let s;if(s=e?(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("page_wall_count_archive")):_?(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("page_wall_count_top")):o?(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("page_wall_count_donut")):"own"===i?(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("page_wall_count_own")):(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("page_wall_count_all")),"suggested"!==cur.wallTab){let _=s;_shared_ranges__WEBPACK_IMPORTED_MODULE_57__.Ranges.isGroupId(cur.oid)&&cur.options.fixed_post_id&&(_-=1),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("page_wall_posts_count",_?(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_23__.langNumeric)(_,cur.options.wall_counts):cur.options.wall_no)}let l=n;!_&&!e&&cur.options.fixed_post_id&&_shared_ranges__WEBPACK_IMPORTED_MODULE_57__.Ranges.isGroupId(cur.options.wall_oid)&&(l+=1),d=l>=s-a||0===l}d?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)(s):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)(s),s.onclick=Wall.showMore.pbind(n)),cur.wallTab==cur.wallType&&((0,_web_lib_market__WEBPACK_IMPORTED_MODULE_2__.shortCurrency)(),cur.gifAutoplayScrollHandler&&cur.gifAutoplayScrollHandler(),cur.videoAutoplayScrollHandler&&cur.videoAutoplayScrollHandler())},getAbsDate:function(_,e){e=e||window.cur;const o=new Date(_||Date.now());let i,s=o.getHours(),l=o.getMinutes(),a="";return e.wallTpl.time_system&&(a=e.wallTpl.time_system[s>11?1:0],s=s%12||12),i=s>9?s:"0"+s,l=l>9?l:"0"+l,e.wallTpl.date_format.replace("{am_pm}",a).replace("{hour}",s).replace("{num_hour}",i).replace("{minute}",l)},getNowRelTime:function(_){_=_||window.cur;const e=Date.now();return'<span class="rel_date rel_date_needs_update" time="'+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)(e/1e3-(_.tsDiff||0))+'" abs_time="'+Wall.getAbsDate(e,_)+'">'+(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("profile_status_word_secs_ago",1)+"</span>"},getNewPostHTML:function(_,e,o,i){const s=(i=i||window.cur).wallTpl.post;if(!s)return void console.error(new Error("Missing wall post template"));const l=[],a=_[2],[n]=a.split("_");let d="";const E=_[4].split("|");let c,p=Wall.getNowRelTime(i);const P="1"===_[8];P?d=i.wallTpl.reply_link||"":n!=vk.id&&(d=i.wallTpl.own_reply_link||"");let u=_[3].replace("mem_link","author").replace("memLink","author"),b=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.se)(u),O=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.clean)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.unclean)(b.innerText||b.textContent||""));-1!=_[6].indexOf('id="wpfo')&&(p+=`<span class="page_friends_only inl_bl dvd PostHeaderSubtitleDivider">${(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_post_privacy_friends")}</span>`);const D=(0,_web_Badges_helpers__WEBPACK_IMPORTED_MODULE_65__.updateNewPostHTMLForBadges)(l,i,_);i.wallTpl.custom_del&&(e>(_[9]==n?_shared_groups_constants__WEBPACK_IMPORTED_MODULE_51__.GroupAdminLevel.MODERATOR:_shared_groups_constants__WEBPACK_IMPORTED_MODULE_51__.GroupAdminLevel.USER)||n==vk.id||_[9]==vk.id||_[2].split("_")[0]!=_[4])&&l.push(i.wallTpl.custom_del),e>(_[9]==n?_shared_groups_constants__WEBPACK_IMPORTED_MODULE_51__.GroupAdminLevel.MODERATOR:_shared_groups_constants__WEBPACK_IMPORTED_MODULE_51__.GroupAdminLevel.USER)||n==vk.id||_[9]==vk.id?l.push(i.wallTpl.del):_[2].split("_")[0]!=_[4]&&l.push(i.wallTpl.spam);const M=e>_shared_groups_constants__WEBPACK_IMPORTED_MODULE_51__.GroupAdminLevel.MODERATOR&&_[9]==n||n==vk.id||_[9]==vk.id;M&&"rss"!==_[13]&&l.push(i.wallTpl.edit);let w=_[6];_[15]&&window.vk.pe.obscene_text_filter&&(w=_[15]),n!=vk.id&&_[9]!=vk.id||!w||(_[6]=_[6].replace("vk2017_snippet_show_layer_button","vk2017_snippet_show_layer_button_hidden"));const m=_shared_ranges__WEBPACK_IMPORTED_MODULE_57__.Ranges.isGroupId(n)&&_[9]==n&&e>_shared_groups_constants__WEBPACK_IMPORTED_MODULE_51__.GroupAdminLevel.MODERATOR,h=(0,_web_reactions_reactions_wall_reactions_wall__WEBPACK_IMPORTED_MODULE_31__.getReactionsButtonPostTemplate)(_,i);return c={oid:n,name:u,actions:l.length&&i.wallTpl?.post_actions?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.rs)(i.wallTpl.post_actions,{actions:l.join("")}):"",replies:"",reply_link:d,own_reply_link:i.wallTpl.own_reply_link,reply_box:P&&i.wallTpl.reply_box?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.rs)(i.wallTpl.reply_box,{actions:"",class:m?" reply_fakebox_with_official":""}):"",photo:E[0],link:_[5],text:w,date:p,post_id:_[2],post_class:"",poll_hash:i.wallTpl.poll_hash,date_postfix:"",user_image:"",post_url:"/wall"+a.replace("_wall_reply","_"),can_reply_as_group:m?1:"",owner_photo:m?E[1]||E[0]:"",owner_href:m?_[5]:"",owner_name:m?O:"",online_class:_shared_ranges__WEBPACK_IMPORTED_MODULE_57__.Ranges.isUserId(n)?" online":"",likes:Likes.makeTemplate(i.wallTpl.post_likes,{buttons_prepend:h?.template,like_class_name:h?.likeClassName,object_raw:_[2]}),class:"",...D},o&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)(c,o(c,_)),M&&i.wallTpl.author_data&&(c.date=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.rs)(i.wallTpl.author_data,{date:c.date,post_id:a})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.rs)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.rs)(s,c),c)},getNewReplyHTML:function(_,e,o,i){const s=i||window.cur;let l=s.wallTpl.reply,a=[];const n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_field"+_[2])||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_fakebox"+_[2])||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("fwr_text");let d="",E="",c="",p=_[10]||"";const P=(0,_web_reactions_reactions_wall_reactions_wall__WEBPACK_IMPORTED_MODULE_31__.getReactionsButtonReplyTemplate)(_,s);if(!l)return void console.error(new Error("Missing wall reply template"));if(e>_shared_groups_constants__WEBPACK_IMPORTED_MODULE_51__.GroupAdminLevel.USER||!_[2].indexOf(vk.id+"_")||_[4]==vk.id?a.push(s.wallTpl.del_reply):_[2].split("_")[0]!=_[4]&&a.push(s.wallTpl.spam_reply),(e>_shared_groups_constants__WEBPACK_IMPORTED_MODULE_51__.GroupAdminLevel.MODERATOR&&_[4]==(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)(_[2])||_[4]==vk.id)&&a.push(s.wallTpl.edit_reply),-1!=_[8].indexOf('class="wall_reply_more"')&&(d+="reply_moreable"),n){d+=" reply_replieable",E=s.wallTpl.reply_link_wrap;wall.getReplyNames()[_[4]]||wall.addReplyName(_[4],[_[11],_[12]])}d&&(c=" onclick=\"Wall.replyClick('%post_id%', %reply_msg_id%, event, %reply_uid%)\""),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.rs)(s.wallTpl.reply_actions,{actions:a.join("")});let u=_[8];_[15]&&window.vk.pe.obscene_text_filter&&(u=_[15]);const b=_[5].replace("mem_link","author"),O=_[7],D=_[4]||"false",M={name:b,photo:_[6],reply_image:(0,_shared_components_avatar_renderAvatarToString__WEBPACK_IMPORTED_MODULE_54__.renderAvatarToString)(_[6],_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_30__.REPLY_IMAGE_DEFAULT_SIZE,O,"reply_image",null,_[7],!1,void 0,b,_[_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_30__.EVENT_REPLY_FIELD_IS_NFT_INDEX]),link:O,text:u,classname:d,actions:a,attr:c,date:Wall.getNowRelTime(s),to_link:p,answer_link:E,post_id:_[2],reply_id:_[3],like_id:_[3].replace("_","_wall_reply"),reply_msg_id:_[3].split("_")[1],reply_uid:D,object_full:(0,_web_likes_helpers__WEBPACK_IMPORTED_MODULE_109__.likeReplyObjectId)(_[3]),likes:Likes.makeTemplate(s.wallTpl.reply_likes,{buttons_prepend:P?.template,like_class_name:P?.likeClassName,object_raw:_[2]}),is_author_suffix:_[_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_30__.EVENT_REPLY_FIELD_IS_POST_AUTHOR_INDEX]?s.wallTpl.reply_is_author_suffix:""};return o&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)(M,o(M)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.rs)(l,M)},updatePostImages:function(_){return _.replace(/<img[^>]+>/g,(function(_){return _.match(/class=/)?_.replace("src=","data-src=").replace('class="','class="__need_img '):_}))},loadPostImages:function(_){(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("__need_img",_,"img"),(function(){const _=this.getAttribute("data-src");_&&(this.src=_,this.removeAttribute("data-src")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)(this,"__need_img")}))},openNewComments:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("replies"+_),o=e.nextSibling;let i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("wr_header",e,"a"),s=0,l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("reply",e,"div").length,a=l,n=o.newCnt;Wall.loadPostImages(e),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.each)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.clone)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("new_reply",e,"div")),(function(){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)(this,"new_reply"),(0,_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_37__.highlightUpdatedReply)(this),s++,100==s)return!1})),i&&(a=s+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)(i.getAttribute("offs").split("/")[1])),l+=-n+s,(a>3||l<a)&&(i||e.insertBefore(i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ce)("a",{className:"wr_header"}),e.firstChild),Wall.updateRepliesHeader(_,i,l,a)),cur.wallMyOpened[_]=1,o&&"replies_open"==o.className&&(n>100?(o.innerHTML=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("news_x_new_replies_more",Math.min(100,n-s)),o.newCnt-=s):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)(o)),Wall.repliesSideSetup(_)},langWordNumeric:function(_,e,o){return(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_23__.langWordNumeric)(_,e,o)},updateTimes:function(_){let e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)(Date.now()/1e3);const o=[];e-=cur.tsDiff,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("rel_date_needs_update",_||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("page_wall_posts"),"span"),(function(_,i){if(!i)return;const s=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)(i.getAttribute("time")),l=e-s;let a=(0,_web_lib_date__WEBPACK_IMPORTED_MODULE_42__.getFormattedDiffTimeText)(l,"",(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("feed_redesign_header_2023_enabled")&&i.closest(".PostHeader--redesignV3"));a||(a=i.getAttribute("abs_time"),o.push(i)),i.innerHTML=a})),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.each)(o,(function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)(this,"rel_date_needs_update")}))},updateRepliesHeader:function(_,e,o,i){if(cur.onepost)return;let s,l,a=e.href,n=3,d=0;if(!a&&(l=_.match(/^(-?\d+)_(photo|video|note|topic|video|)(\d+)$/))){const _=l[2]||"wall";switch(a="/"+_+l[1]+"_"+l[3],_){case"topic":a+="?offset=last&scroll=1";break;case"wall":a+="?offset=last&f=replies"}e.href=a}i>o?o<100?(s=i>100?(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_show_n_last_replies",100):(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_show_all_n_replies",i),n=!1):s=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_hide_replies"):(s=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_hide_replies"),d=1),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.toggleClass)(e,"wrh_all",d),e.innerHTML=s,e.onclick=Wall.showReplies.pbind(_,n,!1),e.setAttribute("offs",o+"/"+i)},processQueueEvent(_){if((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_34__.isObject)(_)&&_.entity_type&&"voting"===_.entity_type)this.votingUpdatePartly(_.data.id,_.data)},updated:function(_,e,o){const i=_?window.wkcur:window.cur;if(!(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_34__.isArray)(i.wallQueues)||!(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_34__.isArray)(o.events)||!o.events.length)return;const s=i.wallQueues.filter((_=>_.key===e)).pop();if(!s)return;if(o.failed)return void(i.wallQueues=!1);s.ts=o.ts;const l=_?wkLayerWrap.scrollTop:(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_20__.scrollGetY)();let a=l;const n=!(i.wallType||"").indexOf("full"),d=i.onepost,E=!!_,c=_;n&&(nav.objLoc.q||nav.objLoc.search||nav.objLoc.day)||((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.each)(o.events,(function(){if((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_34__.isObject)(this))return Wall.processQueueEvent(this);const e=this.split("<!>"),o=e[0];let s=e[1];const l=e[2];let p=0,P=0,u=_&&window.cur.wallLayer==l&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("wl_post");if(u&&"del_reply"!=s||(u=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post"+l),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isAncestor)(u,_?wkLayerWrap:pageNode)||(u=null)),o==i.options.qversion){switch((Wall.isArchiveWall()?"archive_post"===s:"reveal_post"===s)&&(s="res_post"),(Wall.isArchiveWall()?"reveal_post"===s:"archive_post"===s)&&(s="del_post"),s){case"new_post":{if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("posting_web_react_form")&&!(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("feed_fix_render_new_post"))break;if(u)break;if(n&&i.pgStart>0){i.pgOffset++;break}if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("feed_fix_render_new_post")||i.oid==vk.id&&vk.id==e[9]&&window.curNotifier&&curNotifier.idle_manager.is_idle&&Wall.clearInput(),"own"!==i.wallType&&"all"!==i.wallType&&!Wall.hasPosts("own"))break;if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("feed_fix_render_new_post")){if(document.getElementById(`post${l}`))break;const{ownerId:_,itemId:e}=(0,_vkontakte_internal_shared__WEBPACK_IMPORTED_MODULE_110__.splitRawId)(l);(0,_web_feed_utils_renderNewPostInFeed__WEBPACK_IMPORTED_MODULE_8__.renderNewPostInFeed)(e,_,_shared_ranges__WEBPACK_IMPORTED_MODULE_57__.Ranges.isGroupId(i.options.wall_oid));break}const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("page_wall_posts");let o=_.lastChild;const s=!!n&&FullWall.addTetaTet,a=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)(e[e.length-1]),d=void 0!==i.options.is_admin?i.options.is_admin:_shared_ranges__WEBPACK_IMPORTED_MODULE_57__.Ranges.isGroupId(i.options.wall_oid)?8&a?_shared_groups_constants__WEBPACK_IMPORTED_MODULE_51__.GroupAdminLevel.EDITOR:2&a?_shared_groups_constants__WEBPACK_IMPORTED_MODULE_51__.GroupAdminLevel.MODERATOR:_shared_groups_constants__WEBPACK_IMPORTED_MODULE_51__.GroupAdminLevel.USER:_shared_groups_constants__WEBPACK_IMPORTED_MODULE_51__.GroupAdminLevel.USER,E=Wall.getNewPostHTML(e,d,s,i);if(!E)break;const b=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.se)(E);let O=_.firstChild;if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post"+l))break;for(o&&o!=b?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)(o):o=!1,n?o||i.pgOffset++:((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("page_wall_count_all",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("page_wall_count_all"))+1),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)(b,"all"),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)(e[10])&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("page_wall_count_own",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("page_wall_count_own"))+1),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)(b,"own"))),0==e[8]&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)(b,"closed_comments"),i.deepRepliesActive&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)(b,"deep_active");O&&("INPUT"==O.tagName||1!=O.nodeType||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(O,"post_fixed"));)O=O.nextSibling;_.insertBefore(b,O),Wall.votingUpdateByPostRaw(l),(0,_web_stories_narrative_utils__WEBPACK_IMPORTED_MODULE_45__.updateNarrativeSnippetsFromQueueByPost)(b),(0,_web_articles_article_utils__WEBPACK_IMPORTED_MODULE_46__.updateArticleSnippetsFromQueueByPost)(b),p=b.offsetHeight+15,P=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getXY)(b,c)[1],(0,_web_wall_post_update_view_utils__WEBPACK_IMPORTED_MODULE_5__.highlightUpdatedPost)(b),(0,_web_lib_accessibility__WEBPACK_IMPORTED_MODULE_25__.updateAriaElements)(),Wall.updateMentionsIndex(),_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_0__.AudioUtils.updateQueueReceivedPost(b);break}case"edit_post":{if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("posting_web_react_form"))break;const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("wpt"+l);if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)(u)||!_)break;let o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("wall_post_more",_);o&&(o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domNS)(o))),p=-_.offsetHeight,P=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getXY)(_,c)[1];let s=e[3];e[6]&&window.vk.pe.obscene_text_filter&&(s=e[6]);let a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.rs)(s,{poll_hash:i.wallTpl.poll_hash});const n=i.videoInlinePlayer&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isAncestor)(window._videoLastInlined[0],_),d=n&&"playing"==i.videoInlinePlayer.getState();if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(_,a),n){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("page_post_sized_thumbs",_);1==(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domChildren)(e).length&&(e.innerHTML="",e.appendChild(window._videoLastInlined[1]),e.appendChild(window._videoLastInlined[0]),d&&setTimeout((function(){i.videoInlinePlayer.play()}),0))}o&&(o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("wall_post_more",_),o&&o.onclick()),Wall.votingUpdateByPostRaw(l),(0,_web_stories_narrative_utils__WEBPACK_IMPORTED_MODULE_45__.updateNarrativeSnippetsFromQueueByPost)(_),(0,_web_articles_article_utils__WEBPACK_IMPORTED_MODULE_46__.updateArticleSnippetsFromQueueByPost)(_),p+=_.offsetHeight,(0,_web_wall_post_update_view_utils__WEBPACK_IMPORTED_MODULE_5__.highlightUpdatedPostContent)(_),Wall.updatePostAuthorData(l);break}case"edit_reply":{const _=e[3],o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("wpt"+_);if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("post"+_)||!o)break;let i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("wall_reply_more",o);i&&(i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domNS)(i)));let s=e[4];e[5]&&window.vk.pe.obscene_text_filter&&(s=e[5]),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(o,s),p=-o.offsetHeight,P=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getXY)(o,c)[1],i&&(i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("wall_reply_more",o),i&&i.onclick()),p+=o.offsetHeight,(0,_web_stories_narrative_utils__WEBPACK_IMPORTED_MODULE_45__.updateNarrativeSnippetsFromQueueByPost)(o),(0,_web_articles_article_utils__WEBPACK_IMPORTED_MODULE_46__.updateArticleSnippetsFromQueueByPost)(o),(0,_web_stickers_utils__WEBPACK_IMPORTED_MODULE_50__.updateStickersFromQueue)(o),(0,_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_37__.highlightUpdatedReplyContent)(o);break}case"post_parsed_link":{if(!u)break;const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("wall_postlink_preview_btn_disabled",u);if(!_)break;const o=e[3];if("1"===o)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)(_,"wall_postlink_preview_btn_disabled"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)(_,"button_disabled");else if("0"===o)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)(_);else if(o){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ce)("a",{href:o,className:"flat_button",innerHTML:(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_preview_link")});(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domReplaceEl)(_,e)}break}case"del_post":u&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)(u)&&!i.wallMyDeleted[l]&&!d&&(p-=u.offsetHeight+15,P=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getXY)(u,c)[1],(0,_web_lib_revertLastInlineVideo__WEBPACK_IMPORTED_MODULE_22__.revertLastInlineVideo)(u),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)(u,"unshown"),n||E||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("page_wall_count_all",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("page_wall_count_all"))-1),e[3]&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("page_wall_count_own",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("page_wall_count_own"))-1),Wall.isArchiveWall()&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("page_wall_count_archive",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("page_wall_count_archive"))-1)));break;case"res_post":u&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)(u)&&((i.wallRnd==e[4]||Wall.isArchiveWall())&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)(u,"unshown"),n?i.pgOffset++:((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("page_wall_count_all",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("page_wall_count_all"))+1),e[3]&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("page_wall_count_own",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("page_wall_count_own"))+1),Wall.isArchiveWall()&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("page_wall_count_archive",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("page_wall_count_archive"))+1)));break;case"new_reply":{if(!u||i.wallMyReplied[l]||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post"+e[3])||d&&i.pgOffset<i.pgCount||E&&(i.reverse?i.offset:i.offset+i.loaded<i.count))break;if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(E?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("wl_post"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post"+l),"deep_active")){const _=wall.addNewReply(e);p+=_[0],P=_[1];break}const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("replies"+l),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("replies_wrap"+l),a=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)(e[e.length-1]),n=void 0!==i.options.is_admin?i.options.is_admin:_shared_ranges__WEBPACK_IMPORTED_MODULE_57__.Ranges.isGroupId(i.options.wall_oid)?8&a?_shared_groups_constants__WEBPACK_IMPORTED_MODULE_51__.GroupAdminLevel.EDITOR:2&a?_shared_groups_constants__WEBPACK_IMPORTED_MODULE_51__.GroupAdminLevel.MODERATOR:_shared_groups_constants__WEBPACK_IMPORTED_MODULE_51__.GroupAdminLevel.USER:_shared_groups_constants__WEBPACK_IMPORTED_MODULE_51__.GroupAdminLevel.USER,b=Wall.getNewReplyHTML(e,n,!1,i);if(!b)break;const O=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.se)(b),D=E?o.offsetHeight:u.offsetHeight;let M,w=!1;if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)(o)&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)(s)&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("reply_link"+l)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domClosest)("wall_fixed",s)){M=o.nextSibling;let _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("new_reply",o,"div").length+1;if(E||d||i.wallMyOpened[l]){if(!d){M&&"replies_open"==M.className&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)(M),w=!0;let _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("wr_header",o,"a");const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("reply",o,"div").length+1;let i=e;_&&(i=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)(_.getAttribute("offs").split("/")[1])+1),(i>5||e<i)&&(_||o.insertBefore(_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ce)("a",{className:"wr_header"}),o.firstChild),Wall.updateRepliesHeader(l,_,e,i))}}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)(O,"new_reply"),M&&"replies_open"==M.className||(M=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ce)("div",{className:"replies_open",onclick:Wall.openNewComments.pbind(l),role:"button",tabIndex:0}),o.parentNode.insertBefore(M,o.nextSibling)),M.innerHTML=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_x_new_replies_more",Math.min(100,_)),M.newCnt=_}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)("reply_link"+l),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)(s,o),w=!0;_&&i.reverse&&o.firstChild?o.insertBefore(O,o.firstChild):o.appendChild(O),w&&(0,_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_37__.highlightUpdatedReply)(O),E?(i.count++,i.loaded++,WkView.wallUpdateReplies(),p=o.offsetHeight-D,P=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getXY)(O,c)[1]):(d&&(FullWall.repliesSummary(e[13]),i.pgOffset++,i.pgCount++,FullWall.repliesSummary(i.pgCount),Pagination.pageReady(!1),FullWall.onePostOnScroll(!1,!1,!0)),p=u.offsetHeight-D,P=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getXY)(w?O:M)[1],Wall.repliesSideSetup(l)),(0,_web_stories_narrative_utils__WEBPACK_IMPORTED_MODULE_45__.updateNarrativeSnippetsFromQueueByPost)(O),(0,_web_articles_article_utils__WEBPACK_IMPORTED_MODULE_46__.updateArticleSnippetsFromQueueByPost)(O),(0,_web_stickers_utils__WEBPACK_IMPORTED_MODULE_50__.updateStickersFromQueue)(O),Wall.updateMentionsIndex(),Likes.update("wall"+l,{comment_num:e[13]});break}case"del_reply":{if(i.wallMyDeleted[l]||!u)break;const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("wl_post",u)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("post",u);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(_,"deep_active")){const _=wall.removeDeepReply(e);p+=_[0],P=_[1];break}if(p-=u.offsetHeight,P=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getXY)(u,c)[1],(0,_web_lib_revertLastInlineVideo__WEBPACK_IMPORTED_MODULE_22__.revertLastInlineVideo)(u),i.layerpost)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)(u),i.count--,i.loaded--;else{d&&(i.pgOffset--,i.pgCount--,FullWall.repliesSummary(i.pgCount));const _=u.parentNode.id.match(/replies(-?\d+_\d+)/);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)(u),_&&Wall.repliesSideSetup(_[1])}break}case"view_post":Wall.likeUpdate(!1,l,0,Wall.formatCount((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)(e[3])),void 0,void 0,1);break;case"like_post":case"like_reply":{if(!u)break;const _="like_reply"==s?"wall_reply"+l:l,o=u&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domByClass)(u,"_like_wrap"),i=u&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domByClass)(u,"_share_wrap"),a=(0,_web_reactions_reactions_wall_reactions_wall__WEBPACK_IMPORTED_MODULE_31__.likeDataReactionsFields)(e);wall.likeFullUpdate(o,_,{isQueueUpdate:!0,like_my:o&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(o,"my_like"),like_num:e[3],like_title:!1,share_my:i&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(i,"my_share"),share_num:e[4],share_title:!1,...a});break}case"upd_ci":{let _=e[2],o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("current_info"),s=o||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("page_current_info");const l=(0,_web_profile_profile_utils__WEBPACK_IMPORTED_MODULE_53__.isVKCOMProfileRedesignedEnabled)()&&"profile"===window.cur.module;if(!s&&!l)break;switch(e[3]){case"audio":{if(l){let o;return e[4]&&"string"==typeof e[4]&&(o=e[4].split(",")?.[1]),void window.Profile?.updateBroadcastAudioStatus(_,o)}const a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("current_audio_cnt_wrap");a&&a.tt&&a.tt.hide();const n=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)(e[5]||""),d=n?"":" hidden";let E="";o||(E+=" onmouseover=\"showTooltip(this, {forcetoup: true, text: '"+i.options.ciAudioTip+"', black: 1, shift: [14, 5, 5]})\" onclick=\"Page.playCurrent(this, '"+e[4]+"')\""),_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.rs)(i.options.ciAudioTpl,{text:_,attrs:E,count:n,cnt_class:d}),wall.updateOwnerStatus(_,s,e,o);break}case"app":{const l=e[6]?"[12, 5, 5]":"[15, 5, 5]",a=e[6]?" current_app_icon":"";let n=o?' onclick="cur.ciApp = '+e[4]+'"':" onmouseover=\"showTooltip(this, {forcetoup: true, text: '"+i.options.ciAppTip+"', black: 1, shift: "+l+'})" href="'+e[5]+'?ref=14" onclick="return showApp(event, '+e[4]+', 1, 14, cur.oid)"';e[6]&&(n+=" style=\"background-image: url('"+e[6]+"'); background-size: 16px 16px;\""),_='<a class="current_app'+a+'"'+n+">"+_+"</a>",wall.updateOwnerStatus(_,s,e,o);break}default:if(l)return void window.Profile?.resetActiveBroadcastAudioStatus();window.stManager.add([window.jsc("web/emoji.js")],(function(){_=_?'<span class="current_text">'+Emoji.emojiToHTML(_,!0)+"</span>":_,wall.updateOwnerStatus(_,s,e,o)}))}break}case"upd_ci_cnt":{const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("current_info"),o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)(e[2]),i=_||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("page_current_info"),s=i&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("current_audio_cnt_wrap",i);s&&(s.tt&&s.tt.destroy(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.toggleClass)(s,"hidden",0==o),(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_21__.animateCount)(document.querySelector(".current_audio_cnt"),(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_23__.langNumeric)(o,"%s",!0),{str:"auto"}));break}case"cover_updated":{const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("_page_cover");if(_&&e[2]){const o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.vkImage)(),i=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.isRetina)()?e[3]:e[2];o.src=i,o.onload=function(){_.style.backgroundImage="url('"+i+"')",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)(o)}}break}}p&&(_?P<0:a+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getSize)("page_header_cont")[1]>P)&&(a+=p)}})),a!=l&&l>100&&!i.onepost&&(_?wkLayerWrap.scrollTop=a:(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_20__.scrollToY)(a,0,!1,!0)),Wall.update())},updateOwnerStatus:function(_,e,o,i){if(i){_='<span class="'+(_?"my_current_info":"no_current_info")+'">'+(_||(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("change_current_info"))+"</span>",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(e.parentNode.nextSibling,_),!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("currinfo_editor")&&_shared_ranges__WEBPACK_IMPORTED_MODULE_57__.Ranges.isUserId(cur.oid)&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.toggle)("currinfo_audio","app"!=o[3]),o[2]&&"app"!=o[3]&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.checkbox)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("currinfo_audio"),Boolean(o[2])),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.toggle)("currinfo_app","app"==o[3]),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)("currinfo_app","on"))}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(e,_)},updateMentionsIndex:function(_){if(clearTimeout(cur.wallUpdateMentionsIndexTO),!_)return void(cur.wallUpdateMentionsIndexTO=setTimeout(wall.updateMentionsIndex.pbind(!0),300));const e={},o=[],i=new RegExp(`^(https?://(${_shared_lib_site__WEBPACK_IMPORTED_MODULE_3__.VK_HOST_REGEX_GROUP_UNSAFE.source}|${(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.escapeRE)(location.host)}))?/?`);let s=[];(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("author",document.body,"a"),(function(){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(this),s=this.href.replace(i,"");if(void 0!==e[s])return;const l=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)(this.getAttribute("data-from-id"));l&&l!=vk.id&&(e[s]=o.length,o.push([l,_,"@"+s,"/images/camera_c.gif"]))})),s=s.concat(Array.from(document.querySelectorAll("a.post_image, a._post_image")),Array.from(document.querySelectorAll("a.reply_image, a._reply_image"))),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.each)(s,(function(){const _=this.href.replace(i,""),s=e[_];if(void 0===s)return;const l=(0,_web_wall_wall_post_elem_utils__WEBPACK_IMPORTED_MODULE_111__.replyUserImageImg)(this);l&&(o[s][3]=l.getAttribute("src"),delete e[_])})),cur.wallMentions=o},initUpdates:function(_,e=!1){if(_&&_.length&&window.Notifier){const o=e?window.wkcur:window.cur,i=()=>{o.wallQueues&&o.wallQueues.forEach((_=>{Notifier.addKey(_,((_,o)=>{Wall.updated(e,_,o)}))}))};if(!o.wallQueues){const _=setInterval(i,1e4);e?o._hide.push((()=>clearInterval(_))):o.destroy.push((()=>clearInterval(_)))}o.wallQueues=_,i()}},initWallOptions:function(_){(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)(cur,{wallCheckComments:_.check_comments,wallType:_.wall_type,wallTpl:_.wall_tpl,wallMyDeleted:{},isGridOnly:_.posting_is_grid_only,isCarouselOnly:_.posting_is_carousel_only,tsDiff:_.wall_tpl&&_.wall_tpl.abs_timestamp?900*Math.round((Date.now()/1e3-_.wall_tpl.abs_timestamp)/900):0,wallMyOpened:{},wallMyReplied:{},wallMentions:[],wallMyRepliesCnt:0,wallUploadOpts:_.upload,wallUploadVideoOpts:_.upload_video,hasGroupAudioAccess:_.hasGroupAudioAccess}),_.wall_tpl&&_.wall_tpl.lang&&(cur.lang=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)(cur.lang||{},_.wall_tpl.lang)),window.Notifier&&Notifier.addRecvClbk("wall_reply_multiline","wall",(function(_){Wall.onReplySubmitChanged(_.value,1)}),!0)},onPostLoaded:function(_,e){_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)(_),Wall.onAdBlockLoaded(_,e),e&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(_,"_post")&&(_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("_post",_)),_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(_,"_post")&&cur.onPostLoaded&&cur.onPostLoaded(_)},onAdBlockLoaded:function(_,e){let o;const i=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("post_adblock_protection_promo")?_shared_adblock_protection_locator__WEBPACK_IMPORTED_MODULE_89__.Locator.getInstance().lookupSelector(_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_84__.AD_POST_CLASS_SELECTOR):_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_84__.AD_POST_CLASS_SELECTOR;if(o=_?.closest?.(i),!o){const e=_?.querySelectorAll(_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_84__.AD_POST_CLASS_SELECTOR);e&&e.length&&1===e.length&&(o=e[0])}o&&((0,_shared_pixels__WEBPACK_IMPORTED_MODULE_81__.logPixelEvent)?.(o,_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_84__.PixelNames.render),(0,_shared_pixels__WEBPACK_IMPORTED_MODULE_81__.logPixelEvent)?.(o,_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_84__.PixelNames.viewability_measurable),Wall.triggerAdStat(o,"load"))},init:function(_){Wall.initEmoji(),Wall.initWallOptions(_),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)(cur,{wallInited:!0,postField:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post_field"),sendPostBtn:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("send_post"),wallSearch:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("wall_search"),wallPage:document.getElementById("profile_redesigned")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("profile")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("group")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("public"),wallPageNarrow:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("narrow_column"),wallUploadOpts:_.upload||!1,wallOnClearInput:[],deletedCnts:{own:0,all:0,archive:0},posterFeatureTooltip:_.poster_feature_tooltip,posterFeatureTooltipHash:_.poster_feature_tooltip_hash,postCopyrightFeatureTooltip:_.post_copyright_feature_tooltip,postCopyrightFeatureTooltipHash:_.post_copyright_feature_tooltip_hash,isUrlsRecognitionDisabled:_.is_urls_recognition_disabled}),Wall.postponedPosts=_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_66__.PostponedPosts.new();const e=Wall.initPostponedSort();cur.destroy.push((function(_){(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_18__.removeSearchPositionTracker)(_web_lib_stats__WEBPACK_IMPORTED_MODULE_18__.serviceWallUsers),(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_18__.removeSearchPositionTracker)(_web_lib_stats__WEBPACK_IMPORTED_MODULE_18__.serviceWallGroups),(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_18__.removeSearchPositionTracker)(_web_lib_stats__WEBPACK_IMPORTED_MODULE_18__.serviceNews),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.cleanElems)(_.postField),Wall.postponedPosts?.cleanUpOnNavigation(),uiTabs.hideSort(),e&&e()}));const o=_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.removeEvent.pbind(document,"click",Wall.hideEditPostReply);cur._back?(cur._back.hide.push(o),cur._back.show.push(o),cur._back.show.push(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.addEvent.pbind(document,"click",Wall.hideEditPostReply))):cur.destroy.push(o),cur.wallTab=cur.wallType,Wall.update(),Wall.initUpdates(_.add_queues),_.wall_tpl&&(cur.timeUpdateInt=setInterval((function(){Wall.updateTimes(_.wallCont)}),1e4),(0,_shared_lib_nav_helpers__WEBPACK_IMPORTED_MODULE_108__.pushNavDestroy)((()=>{clearInterval(cur.timeUpdateInt)}))),(0,_shared_posting_analytics_utils__WEBPACK_IMPORTED_MODULE_86__.isPostingPerfStatsEnabled)()&&!vk.widget&&(0,_web_lib_nav_helpers__WEBPACK_IMPORTED_MODULE_112__.subscribeNavLocationChange)((()=>{_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.postingTimelineLogger.logScreenClose()})),Wall.initScrollChecking(_);let i,s,l=!1;if(cur.options?.no_draft||(l=_.draft||cur.oid!=vk.id&&Wall.getOwnerDraft(cur.oid)),Wall.initPostEditable(l),cur.wallSearch&&(0,_web_lib_input_utils__WEBPACK_IMPORTED_MODULE_27__.placeholderInit)(cur.wallSearch),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.removeEvent)(document,"click",Wall.hideEditPostReply),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.addEvent)(document,"click",Wall.hideEditPostReply),_.poster_options&&Wall.initPosterEditor(_.poster_options),cur.options.max_post_full_length&&Wall.initPostWarningField(),_.media_types){let a=4;_.media_types.find((_=>"article"===_?.[0]))&&(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("inline_attaches_icons")&&a++;const n=(0,_vkontakte_vkjs__WEBPACK_IMPORTED_MODULE_6__.debounce)((_=>{(cur.isCarouselOnly&&_.getIsCarouselAllowed()||!_.getIsGridAllowed())&&cur.wallAddMedia.getAttachView()===_web_attachments_view_selector_constants__WEBPACK_IMPORTED_MODULE_63__.ATTACHMENT_PRIMARY_MODE.grid&&(cur.wallAddMedia.setAttachView(_web_attachments_view_selector_constants__WEBPACK_IMPORTED_MODULE_63__.ATTACHMENT_PRIMARY_MODE.carousel),_.setAttachViewControlValue(_web_attachments_view_selector_constants__WEBPACK_IMPORTED_MODULE_63__.ATTACHMENT_PRIMARY_MODE.carousel))}),0),d=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)({onAddMediaChange:(_,e,o)=>{if(cur.postCopyrightFeatureTT&&cur.postCopyrightFeatureTT.hide(),Wall.hidePosterFeatureTooltip(),Wall.postChanged(10,_),["poll","postpone",_web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_32__.MEDIA_SELECTOR_PRODUCT,_web_donut__WEBPACK_IMPORTED_MODULE_29__.MEDIA_TYPE_DONUT_DURATION].includes(_)||wall.focusOnEnd(),cur.oid!=vk.id&&Wall.saveOwnerDraftMedia(cur.oid,_,e,o),["postpone","video"].includes(_)){const i=cur.wallAddMedia?.getMedias?.()||[],s=Number(cur.wallAddMedia?.postponeDate);if("postpone"===_){(0,_web_page_wall_utils__WEBPACK_IMPORTED_MODULE_49__.showPostponePostWithVideoInfo)("media_info",e,i);const _=document.querySelector(".addpost_button");_&&_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_48__.FlatButton.setLabel(_,(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("profile_wall_postpone_btn"))}else(0,_web_page_wall_utils__WEBPACK_IMPORTED_MODULE_49__.showPostponePostWithVideoInfo)("media_info",s,[...i,[_,e,o]])}setTimeout(Wall.checkPosterAvailability)},onChangedSize:()=>{setTimeout((()=>{const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("submit_post_box"),e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("VideoRestriction",_);(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.each)(e,((_,e)=>{const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getSize)(e)[1],i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getSize)(e)[0];(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.toggleClass)(e,"VideoRestriction--onlyIcon",i<200),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.toggleClass)(e,"VideoRestriction--small",i>=200&&i<300&&i>o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.toggleClass)(e,"VideoRestriction--medium",i>=300&&i<400)}))}))},onMediaChange:(..._)=>{const e=Number(_.slice(-1));if(e){const _=cur.wallAddMedia?.getMedias?.()||[];(0,_web_page_wall_utils__WEBPACK_IMPORTED_MODULE_49__.showPostponePostWithVideoInfo)("media_info",e,_)}Wall.postChanged()},onMediaAdd:()=>{n(d),cur.wallAddMedia.checkAttachViewFromOnePhoto?.(),s&&cur.wallAddMedia.checkNeedShowCarouselRatioHint?.(s.showHintTooltip)},onMediaRemove:_=>{const e=_.removedTypes?.includes("postpone"),o=_.removedTypes?.includes("video");if(e||o){const _=cur.wallAddMedia?.getMedias?.()||[],o=e?null:Number(cur.wallAddMedia?.postponeDate);(0,_web_page_wall_utils__WEBPACK_IMPORTED_MODULE_49__.showPostponePostWithVideoInfo)("media_info",o,_)}},onMediaUploadStarted:()=>{Wall.postChanged()},onIndexChanged:(_,e)=>{window.cur.addPostData=(0,_shared_attachments_utils_sharedUtils__WEBPACK_IMPORTED_MODULE_60__.moveThumbsInData)(_,e,window.cur.addPostData)},onDelete:_=>{window.cur.addPostData=(0,_shared_attachments_utils_sharedUtils__WEBPACK_IMPORTED_MODULE_60__.deleteThumbInData)(_,window.cur.addPostData)},onDataDelete:({type:_,id:e,isReset:o})=>{const i=d.getIsCarouselAllowed();window.cur.addPostData=window.cur.addPostData?.filter((([o,i])=>!(_===o&&e===i))),o||!i||cur.wallAddMedia.getAttachView()!==_web_attachments_view_selector_constants__WEBPACK_IMPORTED_MODULE_63__.ATTACHMENT_PRIMARY_MODE.carousel||d.getIsCarouselAllowed()||(cur.wallAddMedia.setAttachView(_web_attachments_view_selector_constants__WEBPACK_IMPORTED_MODULE_63__.ATTACHMENT_PRIMARY_MODE.grid),d.setAttachViewControlValue(_web_attachments_view_selector_constants__WEBPACK_IMPORTED_MODULE_63__.ATTACHMENT_PRIMARY_MODE.grid)),o||n(d),cur.wallAddMedia.checkAttachViewForOnePhoto?.(),cur.wallAddMedia.checkIsOnlyNotPhotosInCarousel?.()},editable:1,from:"ads"===cur.module?"ads":"post",sortable:1,poster:cur.poster,maxShown:a,hideAfterCount:5,initialAttachView:(0,_web_attachments_view_selector_utils__WEBPACK_IMPORTED_MODULE_59__.getAttachmentsPrimaryModeDefaultValue)(cur)},_.media_opts||{});d.getIsCarouselAllowed=({skipClipsCheck:_=!1}={})=>!cur.isGridOnly&&(0,_web_posting_carousel_posting_carousel__WEBPACK_IMPORTED_MODULE_61__.isCarouselAllowed)(window.cur.addPostData,{skipClipsCheck:_}),d.getIsGridAllowed=()=>(0,_web_posting_carousel_posting_carousel__WEBPACK_IMPORTED_MODULE_61__.isGridAllowed)(window.cur.addPostData,cur.isCarouselOnly),d.setAttachViewControlValue=_=>{i?.setOption(_)},d.isFirstRatioNotEquelAllRatioThumbs=()=>(0,_web_posting_carousel_components_utils__WEBPACK_IMPORTED_MODULE_83__.isFirstRatioNotEquelAllRatioThumbs)((0,_shared_attachments_utils_sharedUtils__WEBPACK_IMPORTED_MODULE_60__.getThumbsMediaItems)(window.cur.addPostData)),d.savePreviousRatioCropsAndGetCropsForNewRatio=(_,e,o)=>{const i=(0,_shared_attachments_utils_sharedUtils__WEBPACK_IMPORTED_MODULE_60__.getThumbsMediaItems)(window.cur.addPostData),s={};i.forEach((_=>{if(!_||!_[2])return;const i=_[2];i&&(s[_[1]]=i.crop_data,o[e]&&o[e][_[1]]?i.crop_data=o[e][_[1]]:delete i.crop_data)})),_&&(o[_]=s)},"supp"!==cur.wallType&&(d.getThumbsCount=()=>(0,_web_posting_carousel_posting_carousel__WEBPACK_IMPORTED_MODULE_61__.getThumbsCount)(window.cur.addPostData),d.isOnlyNotPhotoThumbData=()=>(0,_shared_attachments_utils_sharedUtils__WEBPACK_IMPORTED_MODULE_60__.isOnlyNotPhotoThumbData)(window.cur.addPostData),d.isNotExistDraftThumbs=Array.isArray(l?.[1])?0===(0,_web_posting_carousel_posting_carousel__WEBPACK_IMPORTED_MODULE_61__.getThumbsCount)(l?.[1]):void 0),cur.wallAddMedia=null,(0,_shared_video_isStandaloneOrVideoPage__WEBPACK_IMPORTED_MODULE_101__.isVideoPageOpen)()&&(cur.wallAddMedia=new window.MediaSelector((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("page_add_media"),"media_preview",_.media_types,d)),cur.wallAddMedia=new window.MediaSelector((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("page_add_media"),"media_preview",_.media_types,d);const{wallAddMedia:E}=cur;if(cur.wallAddMedia.menu){E.emitter.on(E.eventTypes.choosenMedia,(_=>{switch(_?.[0]){case _web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_32__.MEDIA_SELECTOR_PHOTO:_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.postingTimelineLogger.logStartAttaching({pickerType:_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.POSTING_PICKER_TYPES.PHOTO_VK}),(0,_shared_posting_analytics_utils__WEBPACK_IMPORTED_MODULE_86__.sendPostingEvent)(_shared_posting_analytics_types__WEBPACK_IMPORTED_MODULE_87__.POSTING_STATS_NAMES.ATTACH_PHOTO),_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.postingTimelineLogger.logFinishAttaching();break;case _web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_32__.MEDIA_SELECTOR_ALBUM:(0,_shared_posting_analytics_utils__WEBPACK_IMPORTED_MODULE_86__.sendPostingEvent)(_shared_posting_analytics_types__WEBPACK_IMPORTED_MODULE_87__.POSTING_STATS_NAMES.ATTACH_ALBUM),_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.postingTimelineLogger.logFinishAttaching();break;case _web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_32__.MEDIA_SELECTOR_VIDEO:(0,_shared_posting_analytics_utils__WEBPACK_IMPORTED_MODULE_86__.sendPostingEvent)(_shared_posting_analytics_types__WEBPACK_IMPORTED_MODULE_87__.POSTING_STATS_NAMES.ATTACH_VIDEO),_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.postingTimelineLogger.logFinishAttaching();break;case _web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_32__.MEDIA_SELECTOR_AUDIO:(0,_shared_posting_analytics_utils__WEBPACK_IMPORTED_MODULE_86__.sendPostingEvent)(_shared_posting_analytics_types__WEBPACK_IMPORTED_MODULE_87__.POSTING_STATS_NAMES.ATTACH_MUSIC),_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.postingTimelineLogger.logStartAttaching({pickerType:_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.POSTING_PICKER_TYPES.MUSIC}),_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.postingTimelineLogger.logFinishAttaching();break;case _web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_32__.MEDIA_SELECTOR_MAP:_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.postingTimelineLogger.logStartAttaching({pickerType:_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.POSTING_PICKER_TYPES.PLACE}),_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.postingTimelineLogger.logFinishAttaching()}window.cur.addPostData=window.cur.addPostData??[],window.cur.addPostData=(0,_shared_attachments_utils_sharedUtils__WEBPACK_IMPORTED_MODULE_60__.addThumbsInData)(_,window.cur.addPostData)})),E.emitter.on(E.eventTypes.mediaItemClick,(_=>{switch(_?.type){case _web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_32__.MEDIA_SELECTOR_PHOTO:(0,_shared_posting_analytics_utils__WEBPACK_IMPORTED_MODULE_86__.sendPostingEvent)(_shared_posting_analytics_types__WEBPACK_IMPORTED_MODULE_87__.POSTING_STATS_NAMES.OPEN_MY_PHOTO),_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.postingTimelineLogger.logPickerOpening({pickerType:_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.POSTING_PICKER_TYPES.PHOTO});break;case _web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_32__.MEDIA_SELECTOR_VIDEO:(0,_shared_posting_analytics_utils__WEBPACK_IMPORTED_MODULE_86__.sendPostingEvent)(_shared_posting_analytics_types__WEBPACK_IMPORTED_MODULE_87__.POSTING_STATS_NAMES.OPEN_MY_VIDEO),_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.postingTimelineLogger.logPickerOpening({pickerType:_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.POSTING_PICKER_TYPES.VIDEO});break;case _web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_32__.MEDIA_SELECTOR_DOC:(0,_shared_posting_analytics_utils__WEBPACK_IMPORTED_MODULE_86__.sendPostingEvent)(_shared_posting_analytics_types__WEBPACK_IMPORTED_MODULE_87__.POSTING_STATS_NAMES.ADD_FILE),_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.postingTimelineLogger.logPickerOpening({pickerType:_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.POSTING_PICKER_TYPES.DOCUMENT});break;case _web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_32__.MEDIA_SELECTOR_POLL:(0,_shared_posting_analytics_utils__WEBPACK_IMPORTED_MODULE_86__.sendPostingEvent)(_shared_posting_analytics_types__WEBPACK_IMPORTED_MODULE_87__.POSTING_STATS_NAMES.ADD_SURVEY),_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.postingTimelineLogger.logPickerOpening({pickerType:_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.POSTING_PICKER_TYPES.POLL}),_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.postingTimelineLogger.logPickerReady(),_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.postingTimelineLogger.logStartAttaching({pickerType:_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.POSTING_PICKER_TYPES.POLL}),_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.postingTimelineLogger.logFinishAttaching();break;case _web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_32__.MEDIA_SELECTOR_MAP:(0,_shared_posting_analytics_utils__WEBPACK_IMPORTED_MODULE_86__.sendPostingEvent)(_shared_posting_analytics_types__WEBPACK_IMPORTED_MODULE_87__.POSTING_STATS_NAMES.ADD_MAP),_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.postingTimelineLogger.logPickerOpening({pickerType:_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.POSTING_PICKER_TYPES.PLACE});break;case _web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_32__.MEDIA_SELECTOR_ARTICLE:(0,_shared_posting_analytics_utils__WEBPACK_IMPORTED_MODULE_86__.sendPostingEvent)(_shared_posting_analytics_types__WEBPACK_IMPORTED_MODULE_87__.POSTING_STATS_NAMES.ADD_ARTICLE),_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.postingTimelineLogger.logPickerOpening({pickerType:_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.POSTING_PICKER_TYPES.ARTICLE});break;case _web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_32__.MEDIA_SELECTOR_SHORT_VIDEO:(0,_shared_posting_analytics_utils__WEBPACK_IMPORTED_MODULE_86__.sendPostingEvent)(_shared_posting_analytics_types__WEBPACK_IMPORTED_MODULE_87__.POSTING_STATS_NAMES.ADD_CLIP),_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.postingTimelineLogger.logPickerOpening({pickerType:_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.POSTING_PICKER_TYPES.VIDEO});break;case _web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_32__.MEDIA_SELECTOR_MARKET:(0,_shared_posting_analytics_utils__WEBPACK_IMPORTED_MODULE_86__.sendPostingEvent)(_shared_posting_analytics_types__WEBPACK_IMPORTED_MODULE_87__.POSTING_STATS_NAMES.ADD_PRODUCT),_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.postingTimelineLogger.logPickerOpening({pickerType:_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.POSTING_PICKER_TYPES.MARKET});break;case _web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_32__.MEDIA_SELECTOR_AUDIO:(0,_shared_posting_analytics_utils__WEBPACK_IMPORTED_MODULE_86__.sendPostingEvent)(_shared_posting_analytics_types__WEBPACK_IMPORTED_MODULE_87__.POSTING_STATS_NAMES.OPEN_MUSIC),_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.postingTimelineLogger.logPickerOpening({pickerType:_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.POSTING_PICKER_TYPES.MUSIC})}})),E.emitter.on(E.eventTypes.closePickerModal,(_=>{switch(_?.type){case _web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_32__.MEDIA_SELECTOR_PHOTO:(0,_shared_posting_analytics_utils__WEBPACK_IMPORTED_MODULE_86__.sendPostingEvent)(_shared_posting_analytics_types__WEBPACK_IMPORTED_MODULE_87__.POSTING_STATS_NAMES.CLOSE_ADD_PHOTO);break;case _web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_32__.MEDIA_SELECTOR_VIDEO:(0,_shared_posting_analytics_utils__WEBPACK_IMPORTED_MODULE_86__.sendPostingEvent)(_shared_posting_analytics_types__WEBPACK_IMPORTED_MODULE_87__.POSTING_STATS_NAMES.CLOSE_ADD_VIDEO)}})),E.emitter.on(E.eventTypes.pickerModalDone,(_=>{switch(_?.type){case _web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_32__.MEDIA_SELECTOR_PHOTO:_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.postingTimelineLogger.logPickerReady({pickerType:_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.POSTING_PICKER_TYPES.PHOTO});break;case _web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_32__.MEDIA_SELECTOR_VIDEO:_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.postingTimelineLogger.logPickerReady({pickerType:_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.POSTING_PICKER_TYPES.VIDEO});break;case _web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_32__.MEDIA_SELECTOR_DOC:_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.postingTimelineLogger.logPickerReady({pickerType:_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.POSTING_PICKER_TYPES.DOCUMENT});break;case _web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_32__.MEDIA_SELECTOR_POLL:_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.postingTimelineLogger.logPickerReady({pickerType:_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.POSTING_PICKER_TYPES.POLL});break;case _web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_32__.MEDIA_SELECTOR_MAP:_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.postingTimelineLogger.logPickerReady({pickerType:_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.POSTING_PICKER_TYPES.PLACE});break;case _web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_32__.MEDIA_SELECTOR_ARTICLE:_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.postingTimelineLogger.logPickerReady({pickerType:_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.POSTING_PICKER_TYPES.ARTICLE});break;case _web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_32__.MEDIA_SELECTOR_SHORT_VIDEO:_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.postingTimelineLogger.logPickerReady({pickerType:_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.POSTING_PICKER_TYPES.VIDEO});break;case _web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_32__.MEDIA_SELECTOR_MARKET:_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.postingTimelineLogger.logPickerReady({pickerType:_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.POSTING_PICKER_TYPES.MARKET});break;case _web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_32__.MEDIA_SELECTOR_AUDIO:_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.postingTimelineLogger.logPickerReady({pickerType:_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.POSTING_PICKER_TYPES.MUSIC})}})),E.emitter.on(E.eventTypes.pickerModalFail,(_=>{_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.postingTimelineLogger.logError({message:_?.error?JSON.stringify(_?.error):void 0})}));let c=()=>{},p=()=>{};E.emitter.on(E.eventTypes.viewChanged,(()=>{c(),Wall.drawMedia({skipPoll:!0,skipPostpone:!0,skipCopyright:!0})})),E.emitter.on(E.eventTypes.thumbUpdated,(_=>{c(),Wall.onThumbUpdate(_)})),p=(0,_web_posting_carousel_components_utils__WEBPACK_IMPORTED_MODULE_83__.isCarouselCropEnabled)()?_=>{c=renderReactCarousel({thumbs:(0,_shared_attachments_utils_sharedUtils__WEBPACK_IMPORTED_MODULE_60__.getThumbsMediaItems)(window.cur.addPostData),onDelete:_=>{const[e,o]=(0,_shared_attachments_utils_sharedUtils__WEBPACK_IMPORTED_MODULE_60__.getThumbByIndex)(_,window.cur.addPostData)??[];e&&o&&E.unchooseMediaByTypeAndId(e,o)},ratio:E.getCarouselRatio(),changeRatio:(_,e)=>{E.setCarouselRatio(_,e),s?.setOption(_)}},_),E.emitViewDraw()}:(0,_vkontakte_vkjs__WEBPACK_IMPORTED_MODULE_6__.debounce)((async _=>{c();const{renderCarouselPromise:e,abort:o}=(0,_web_posting_carousel_posting_carousel__WEBPACK_IMPORTED_MODULE_61__.renderCarousel)({attachments:(0,_web_posting_carousel_posting_carousel__WEBPACK_IMPORTED_MODULE_61__.mediaDataToAttachments)(window.cur.addPostData),oid:window.cur.oid,photoClickHandlers:(0,_web_posting_carousel_posting_carousel__WEBPACK_IMPORTED_MODULE_61__.mediaDataToClickHandlers)(window.cur.addPostData),onDelete:_=>{const[e,o]=(0,_shared_attachments_utils_sharedUtils__WEBPACK_IMPORTED_MODULE_60__.getThumbByIndex)(_,window.cur.addPostData)??[];e&&o&&E.unchooseMediaByTypeAndId(e,o)}},_);c=o,await e,E.emitViewDraw()}),0),E.emitter.on(E.eventTypes.carouselRedrawNeeded,(_=>{p(_)})),window.cur.destroy.push((()=>{c()}));const P=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domByClass)(cur.wallAddMedia.menu.menuNode,"_type_podcast"),u=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("official");P&&u&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domClosest)("_submit_post_box",u),"from-oid")!=cur.postTo&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)(P)}}if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("attachments_primary_mode_web_feature")){const b=cur.wallAddMedia&&cur.wallAddMedia.id||"";i=(0,_web_attachments_view_selector_init_view_ui_selector__WEBPACK_IMPORTED_MODULE_58__.initAttachmentsViewSelector)({linkId:String(b),postActionsEl:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post_actions_btns"),addMedia:cur.wallAddMedia,isCarouselOnly:cur.isCarouselOnly,isGridOnly:cur.isGridOnly}),i&&(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_34__.isArray)(window.cur.wallOnClearInput)&&window.cur.wallOnClearInput.push(i.onClear)}if((0,_web_posting_carousel_components_utils__WEBPACK_IMPORTED_MODULE_83__.isCarouselCropEnabled)()){const O=cur.wallAddMedia&&cur.wallAddMedia.id||"";s=(0,_web_posting_carousel_components_CarouselRatioSelector_initCarouselRatioSelector__WEBPACK_IMPORTED_MODULE_82__.initCarouselRatioSelector)({linkId:String(O),postActionsEl:document.getElementById("post_actions_btns"),addMedia:cur.wallAddMedia}),s&&(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_34__.isArray)(window.cur.wallOnClearInput)&&window.cur.wallOnClearInput.push(s.onClear)}if(Wall.initPostVisibilitySelector(cur.wallAddMedia),(0,_web_discover_category_post_topic__WEBPACK_IMPORTED_MODULE_33__.isPostTopicSettingEnabled)(window.cur)){const D=cur.wallAddMedia&&cur.wallAddMedia.id||"",M=(0,_web_discover_category_post_topic__WEBPACK_IMPORTED_MODULE_33__.initPostTopicCreatingSelector)(String(D),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post_actions_btns"),(_=>-1!==_));M&&(window.cur.destroy.push(M.onDestroy),(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_34__.isArray)(window.cur.wallOnClearInput)&&window.cur.wallOnClearInput.push(M.clearSelection))}if(cur.withUpload=window.WallUpload&&!_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.safari_mobile&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.inArray)(cur.wallType,["all","own","feed","full_all","ads_promoted_stealth"])&&Wall.withMentions&&cur.wallUploadOpts,cur.withUpload&&WallUpload.checkDragDrop()){let w=!1,m=!1;const h=function(_){if(!1!==w&&(clearTimeout(w),w=!1),cur.uploadInited)return C(),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.cancelEvent)(_);switch(_.type){case"drop":m=!1,delete cur.wallUploadFromDrag,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("post_upload_dropbox");break;case"dragleave":w=setTimeout((function(){m=!1,delete cur.wallUploadFromDrag,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("post_upload_dropbox")}),100);break;case"dragover":case"dragenter":m||(m=!_.target||"IMG"!=_.target.tagName&&"A"!=_.target.tagName?2:1,2==m&&setTimeout(WallUpload.initCallback,0)),2==m&&(cur.wallUploadFromDrag=1)}return(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.cancelEvent)(_)};function C(){(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.removeEvent)(document,"dragover dragenter drop dragleave",h)}(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.addEvent)(document,"dragover dragenter drop dragleave",h),cur.destroy.push(C)}if(Wall.updateMentionsIndex(),(0,_web_wall_wall_post_render__WEBPACK_IMPORTED_MODULE_39__.wallPostRenderInit)(),nav.objLoc.new_post){Wall.showEditPost();const g=nav.objLoc.post_privacy;"friends_only"===g?Wall.togglePostVisibilityAccess((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("friends_only"),_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_30__.VISIBILITY_ACCESS_OPTIONS.ONLY_FRIENDS,"",!0):"best_friends_only"===g&&Wall.togglePostVisibilityAccess((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("best_friends_only"),_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_30__.VISIBILITY_ACCESS_OPTIONS.ONLY_BEST_FRIENDS,"",!0),delete nav.objLoc.new_post,delete nav.objLoc.post_privacy,nav.setLoc(nav.objLoc)}},initPosterEditor:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.se)('<div class="page_block"></div>'),o=Wall.getMainPostBlock();"feed"===cur.module&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)(e,"feed_post_field_wrap");const i=function(){return!1},s=function(){Wall.closeFancyTooltipsInPost(),Wall.openPosterEditor(),cur.poster.sendStatsInfo("open")},l={onPreOpen:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domInsertAfter)(e,o)},onPostOpen:function(){const _=cur.poster.getTextInputEl();Wall.restoreCaretPositionForPoster(_)},onPreHide:function(){Wall.saveCaretPositionForPoster(cur.poster.getTextInputEl()),Wall.closeFancyTooltipsInPost();const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("submit_post_error"),e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("submit_post_box"),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post_actions_btns"),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("submit_post");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domInsertBefore)(o,i),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)(_)&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domInsertAfter)(_,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domFC)(e))},onPostHide:function(){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post_settings_btn"),i=cur.options.suggesting&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("check_sign");_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domInsertBefore)(_,cur.openPosterBtn),i&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domInsertBefore)(i,cur.openPosterBtn),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)(o);let s=cur.poster.getTextAsHtml();s&&s.match(Emoji.emojiRegex)&&(s=s.replace(Emoji.emojiRegex,Emoji.emojiReplace)),cur.postField.innerHTML=s,Wall.restoreCaretPositionForPoster(cur.postField),setTimeout((function(){Composer.updateArticleConvertSuggest((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.data)(cur.postField,"composer"))})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)(e)},onPreUploaderOpen:function(){const _=cur.poster.getTextInputEl();Wall.saveCaretPositionForPoster(_)},onPostUploaderClose:function(){const _=cur.poster.getTextInputEl();Wall.restoreCaretPositionForPoster(_)},onOverTextLimit:function(){Wall.disablePoster(!0),cur.poster.closeEditor(),cur.poster.sendStatsInfo("auto_disable"),cur.poster.state.toggled=!0},onChangeData:Wall.postChanged,onSend:function(_){Wall.sendPost({skipLocked:!0,posterSendParams:_})},onDestroy:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)(e)},getPostOwnerId:function(){return+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("submit_post_box"),"from-oid")},width:Wall.getMainPostBlock()?.clientWidth,containerClasses:"poster_wall-creating",placeholder:cur.postField?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.attr)(cur.postField,"placeholder"):"",appendToElem:e};cur.openPosterBtn=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("page_poster_btn"),cur.poster=new Poster(_.poster_config,l),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.addEvent)(cur.openPosterBtn,"click",s),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.addEvent)(cur.openPosterBtn,"mousedown",i),(0,_shared_lib_nav_helpers__WEBPACK_IMPORTED_MODULE_108__.pushNavDestroy)((()=>{(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.removeEvent)(cur.openPosterBtn,"click",s),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.removeEvent)(cur.openPosterBtn,"mousedown",i)}))},openPosterEditor:function(_){if(cur.viewAsBox)return cur.viewAsBox();if(!cur.poster||cur.poster.state.disabled||cur.poster.state.opened)return;_=_||{},cur.posterFeatureTT&&cur.posterFeatureTT.hide();const e=Wall.getMainPostBlock(),o=_.bkgId,i=window.browser.windows7||window.browser.windowsVista||window.browser.windowsXp;Wall.saveCaretPositionForPoster(cur.postField);let s=_.text||cur.postField.innerHTML;if(s=s.replace(/\n/g,"<br/>"),s=s.replace(/<img[^>]*>/g,(function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ce)("div",{innerHTML:_}).firstChild,o=Emoji.getCode(e);return o?i?" ":Emoji.codeToChr(o):_})),!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)(e))return cur.poster.setBkg(o,!0),void cur.poster.setText(s);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)(e);const l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post_settings_btn"),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("submit_post_error"),n=cur.options.suggesting&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("check_sign"),d=cur.poster.getPostOptionsWrapperEl();if(l&&d.appendChild(l),n&&d.appendChild(n),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)(a)){const _=cur.poster.getErrorWrapperElement();_.innerHTML="",_.appendChild(a)}const E=cur.poster.getBtnsWrapper(),c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post_actions_btns");c&&(E.firstChild?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domInsertBefore)(c,E.firstChild):E.appendChild(c),c.children.length||E.children.length>1?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)(E):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)(E)),cur.poster.openEditor(),cur.poster.setBkg(o,!0),cur.poster.setText(s)},checkPosterAvailability:function(){if(!cur.poster)return;const _=cur.wallAddMedia?cur.wallAddMedia.getMedias():[],e=cur.poster.isTextFieldValid(cur.postField),o=Wall.checkAttachesForPoster(_),i=e&&o;!i!==cur.poster.state.disabled&&Wall.disablePoster(!i),i&&cur.poster.state.toggled&&(Wall.openPosterEditor(),cur.poster.sendStatsInfo("auto_enable"),cur.poster.state.toggled=!1)},checkAttachesForPoster(_){if(!(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_34__.isArray)(_))return!1;if(!_.length)return!0;let e=0;return _.some((_=>{if((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_34__.isArray)(_)){const[o]=_;["copyright","postpone",_web_donut__WEBPACK_IMPORTED_MODULE_29__.MEDIA_TYPE_DONUT_DURATION].includes(o)||++e}})),0===e},disablePoster:function(_){cur.poster&&(void 0===_&&(_=!0),cur.poster.state.disabled=_,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.toggleClass)(cur.openPosterBtn,"_disable",_))},isPosterEditorOpen:function(){return cur.poster&&cur.poster.isOpen()},saveCaretPositionForPoster:function(_){if(document.activeElement!==_)return;const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ce)("span"),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ce)("span");e.classList.add("poster__marker","poster__marker_start"),o.classList.add("poster__marker","poster__marker_end");let i=getSelection().getRangeAt(0);i=i.cloneRange(),i.insertNode(e),i.collapse(!1),i.insertNode(o)},restoreCaretPositionForPoster:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("poster__marker_start",_),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("poster__marker_end",_);if(!e||!o)return void wall.focusOnEnd(_);const i=document.createRange();i.setStartBefore(e),i.setEndBefore(o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)(e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)(o);const s=window.getSelection();s.removeAllRanges(),s.addRange(i)},getMainPostBlock:function(){let _=cur.mainPostBlock;return _||(_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domPN)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("submit_post_box")),cur.mainPostBlock=_),_},changeAuthorInPoster:function(_){cur.poster&&_&&cur.poster.changeBkgAuthor({authorName:_.authorName,authorUrl:_.authorUrl})},closeFancyTooltipsInPost:function(){const _=cur.wallAddMedia.lnkId;cur["postPostponeTT"+_]&&cur["postPostponeTT"+_].hide(),cur["post_action_btn"+_]&&cur["post_action_btn"+_].hide(),(0,_web_discover_category_post_topic__WEBPACK_IMPORTED_MODULE_33__.topicUISelectorHide)(_)},switchOwner:function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.toggleClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("_ui_toggler",_),"on"),uiSearch.showProgress("wall_search"),cur.options.params.owners_only=cur.options.params.owners_only?null:1,nav.change({owners_only:cur.options.params.owners_only,offset:null})},fakeReplyAsGroupOver:function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("reply_fakebox_with_official",_)&&wall.replyAsGroupOver(_)},fakeReplyAsGroupCheck:function(_,e,o){if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("fix_anonymous_reply")&&!window.vk.id)return;return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("reply_fakebox_with_official",_)?(window.tooltips&&window.tooltips.hide(_),Wall.showEditReply(e,null,!1,!1,!0,(function(){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_as_group"+e);_&&(_.focus(),_.click())})),o&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.cancelEvent)(o)):void 0},setReplyAsGroup:function(_,e){if(!_)return!1;if(_.hasAttribute("data-reinit-ads-needs-confirmation")&&window.AdsEdit&&!e.reinitConfirmed&&AdsEdit.reinitCreatingPostFormNeeded())return AdsEdit.reinitCreatingPostFormConfirm(wall.setReplyAsGroup.pbind(_,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)({},e||{},{reinitConfirmed:!0}))),!1;let o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domClosest)("_submit_post_box",_),i=o&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("signed"),s=o&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("close_comments"),l=o&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("mute_notifications"),a=o&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("official"),n=o&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("mark_as_ads"),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.data)(_,"tt"),E=e.from||(e.fromGroup?cur.oid:vk.id),c=E==vk.id?wall.replyAsProfileData():window.replyAsData&&window.replyAsData[E]||wall.replyAsGroupDomData(_);c||(c=[]);const[p,P,u,b,,O]=c;if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(o,"from-oid")==E||p!=E)return!1;const D=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("submit_post_box"),M=!o&&cur.poster&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domClosest)("poster",_),w=o===D;M&&(o=D,i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("signed"),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("mark_as_ads"),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("close_comments"),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("mute_notifications"),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("official")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(o,"from-oid",E),wall.replyAsAnimate(o,u,P,O),cur.poster&&(w||M)&&Wall.changeAuthorInPoster({authorName:b,authorUrl:u}),d&&d.rows&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.each)(d.rows,(function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.toggleClass)(this,"active",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(this,"from-oid")==E)})),i&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.disable)(i,_shared_ranges__WEBPACK_IMPORTED_MODULE_57__.Ranges.isUserId(E)),n&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.disable)(n,_shared_ranges__WEBPACK_IMPORTED_MODULE_57__.Ranges.isUserId(E)),s&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.disable)(s,_shared_ranges__WEBPACK_IMPORTED_MODULE_57__.Ranges.isUserId(E)),l&&((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isChecked)(n)?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)(l,"on"),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.disable)(l,1)):(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.disable)(l,_shared_ranges__WEBPACK_IMPORTED_MODULE_57__.Ranges.isUserId(E))),a&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.checkbox)(a,E!==vk.id),_.setAttribute("aria-label",_shared_ranges__WEBPACK_IMPORTED_MODULE_57__.Ranges.isGroupId(E)?(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_reply_as_group"):(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_reply_as_user")),_.hasAttribute("data-replace-owner-name")&&(_.innerHTML=b,"A"===_.tagName&&(_.href=u)),_.hasAttribute("data-replace-post-to")&&(cur.postTo=p),_.hasAttribute("data-replace-oid")&&(cur.oid=p),_.hasAttribute("data-reinit-ads-post-editor")&&window.AdsEdit&&(e.withoutRedraw?AdsEdit.reinitCreatingPostFormBoundWithoutRedraw():AdsEdit.reinitCreatingPostFormBound()),"official"==_.id&&Wall.postChanged(!0);const m=cur.wallAddMedia&&cur.wallAddMedia.menu&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domByClass)(cur.wallAddMedia.menu.menuNode,"_type_podcast");if(m){let _=cur.postTo==E;(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.each)(cur.wallAddMedia.getMedias()||[],(function(e,o){if("podcast"===o[0])return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.toggleClass)(o[2],"attach_disabled",!_),_=!1,!1})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.toggle)(m,_)}return _.id&&Wall.hideCheckTimer(_.id.replace("reply_as_group",""),"editing"),cur.wallAddMedia&&cur.wallAddMedia.donutUpdateVisibility&&cur.wallAddMedia.donutUpdateVisibility(o),!1},replyAsAnimate:function(_,e,o,i){const s=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("avatar_component_refactor_web"),l=_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("_post_field_author",_),a=l&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("_post_field_image",l),n=_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("_post_field_official",_),d=n&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("_post_field_image",n),E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(_,"author_secondary"),c=E?0:1,p=a?.[c]?.offsetWidth,P=d?.[c]?.offsetWidth;if(l&&a&&a[c])if(l.href=e,s){const _=(0,_web_page_wall_utils__WEBPACK_IMPORTED_MODULE_49__.getPostAvatarString)(o,"post_field_user_image",p,!1,E?void 0:"post_field_image_secondary");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domReplaceEl)(a[c],_)}else a[c].src=o;if(d&&d[c])if(s){const _=(0,_web_page_wall_utils__WEBPACK_IMPORTED_MODULE_49__.getPostAvatarString)(o,"post_field_choose_image",P,!1,E?void 0:"post_field_choose_secondary");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domReplaceEl)(d[c],_)}else d[c].src=o;(0,_shared_utils_reflow__WEBPACK_IMPORTED_MODULE_113__.reflow)(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.toggleClass)(_,"author_secondary")},replyAsGroupOver:function(_){if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(_,"checkbox_official")&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(_,"reply_fakebox_wrap_image")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(_,"disabled"))return!1;const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("_submit_post_box",_),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("deep_active",_);let i;if(i=o&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("replies_wrap_deep",_)?[7,8,8]:o?[2,8,8]:[9,8,8],(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_12__.showTooltip)(_,{text:function(){return _shared_ranges__WEBPACK_IMPORTED_MODULE_57__.Ranges.isGroupId((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(e,"from-oid")||vk.id)?(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("global_on_behalf_group"):(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("global_on_behalf_me")},black:1,shift:i,noZIndex:!0}),!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(_,"reply_fakebox_wrap_image")&&(wall.isWallReply(_)||wall.isAdsCreatingPost(_))){let e="/al_groups.php",o="get_editor_clubs";wall.isAdsCreatingPost(_)&&(e="/ads_edit.php",o="a_get_promoted_post_stealth_groups"),ajax.post(e,{act:o},{cache:1})}},replyAsGroupFocus:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.data)(_,"tt");e&&e.isShown()||wall.replyAsGroupOver(_)},replyAsGroup:function(_,e,o){if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(_,"checkbox_official")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(_,"disabled"))return o&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.cancelEvent)(o);if(!((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(_,"can_reply_as_any_group")>0)&&wall.isWallReply(_))return wall.replyAsGroupTT(_,e,[]),o&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.cancelEvent)(o);if(!wall.isWallReply(_)&&!wall.isAdsCreatingPost(_)||cur.replyAsLoaded)wall.showReplyAsGroupTooltip(_,e);else{let o="/al_groups.php",i="get_editor_clubs";wall.isAdsCreatingPost(_)&&(o="/ads_edit.php",i="a_get_promoted_post_stealth_groups"),ajax.post(o,{act:i},{cache:1,onDone:function(o){cur.replyAsLoaded=o,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)(_)&&wall.showReplyAsGroupTooltip(_,e)}})}return o&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.cancelEvent)(o)},showReplyAsGroupTooltip(_,e){const o=!!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("can_reply_only_verified",_),i=(cur.replyAsLoaded||[]).filter((_=>!o||_[0]>0||_[4]||_[6]));wall.replyAsGroupTT(_,e,i)},replyAsGroupDomData:function(_){let e,o,i,s,l,a;if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("replies_wrap_deep",_)){const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("post",_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("wl_post",_),"post-id");i&&(e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_box"+i)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_fakebox"+i),o=i.split("_")[0])}else e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("_submit_post_box",_),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(e,"oid");return e&&(i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(e,"owner-photo"),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(e,"owner-href"),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(e,"owner-name"),a=(0,_web_wall_reply_utils__WEBPACK_IMPORTED_MODULE_38__.replyBoxOwnerIsNftFromAttr)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(e,"owner-is-nft"))),o&&i&&s&&l&&[o,i,s,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.clean)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.unclean)(l)),null,a]||cur.wallTpl&&cur.wallTpl.ownerData||!1},isWallReply:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("_submit_post_box",_);return e&&e.id.match(/reply_box(-?\d+)_(\d+)/)},isAdsCreatingPost:function(_){return!!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("ads_edit_ad_submit_post_header",_)},replyAsProfileData:function(){return window.cur&&cur.wallTpl&&cur.wallTpl.profileData||window.wkcur&&wkcur.wallTpl&&wkcur.wallTpl.profileData||window.mvcur&&mvcur.wallTpl&&mvcur.wallTpl.profileData},replyAsGroupList:function(_,e){const o=_.hasAttribute("data-disallow-profile")?[]:[wall.replyAsProfileData()],i=wall.replyAsGroupDomData(_);return i&&o.push(i),(wall.isWallReply(_)||wall.isAdsCreatingPost(_))&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.each)(window.replyAsList,(function(){this[0]!=e&&o.push(this)})),o},replyAsGroupTT:function(_,e,o){__webpack_require__._dG("replyAsList",o||[]),__webpack_require__._dG("replyAsData",{}),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.each)(window.replyAsList,(function(){window.replyAsData[this[0]]=this}));let i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.data)(_,"tt"),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("_submit_post_box",_),l=s&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(s,"from-oid");if(!wall.replyAsProfileData())return!1;if(!i){const o=wall.replyAsGroupList(_,e);let s="";_.hasAttribute("data-enable-search")&&(s+='<div class="post_from_tt_row_search_wrap"><input class="clear_fix post_from_tt_row post_from_tt_row_search" value="" placeholder="'+(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("global_search")+'" /><div class="post_from_tt_row_search_progress"></div></div>');const a=function(_,e,o,i,s){return'<a id="_post_from_tt_row_oid_'+e+'" class="clear_fix post_from_tt_row _post_from_tt_row_searchable'+_+'" data-from-oid="'+e+'" href="'+o+'"><img class="post_from_tt_image" src="'+i+'" aria-label="'+s+'">'+s+"</a>"};(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.each)(o,(function(){const _=l==this[0]?" active":"";s+=a(_,this[0],this[2],this[1],this[3])}));const n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("deep_active",_);i=new ElementTooltip(_,{content:'<div class="post_from_tt_choose _post_scroll_wrap">'+s+"</div>",appendToParent:!0,autoHide:!0,customShow:!0,defaultSide:"bottom",offset:function(){return wall.isAdsCreatingPost(_)?[_.offsetWidth/2+8.5,-2]:n?[1,-5]:[-10,-5]},onFirstTimeShow:function(e){const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("post_from_tt_row",e);(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.each)(o,(function(e,o){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(o,"post_from_tt_row_search")||(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.addEvent)(o,"click",wall.setReplyAsGroup.pbind(_,{from:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(this,"from-oid")}))}));const s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("post_from_tt_row_search",e);if(s){let o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("_post_from_tt_row_searchable",e);const l=_.getAttribute("data-search-url"),n={};(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.addEvent)(s,"keyup valueChanged",(function(){const d=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.trim)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(s)).toLowerCase();if(l&&d){_.searchRequestTimeout&&(clearTimeout(_.searchRequestTimeout),delete _.searchRequestTimeout);const s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("post_from_tt_row_search_progress",e);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("pr",s)||(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.showProgress)(s),_.searchRequestTimeout=setTimeout((function(){n[d]?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.hideProgress)(s):ajax.plainpost(l,{str:d},(function(l){n[d]=!0,l=JSON.parse(l),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.each)(l,(function(){if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("_post_from_tt_row_oid_"+this[0])){const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.se)(a("",this[0],this[2],this[1],this[3]));(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("ui_scroll_content",e).appendChild(o),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.addEvent)(o,"click",wall.setReplyAsGroup.pbind(_,{from:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(o,"from-oid")})),window.replyAsData[this[0]]||(window.replyAsData[this[0]]=this)}})),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("_post_from_tt_row_searchable",e),setTimeout((function(){i.scroll.update(),i.updatePosition()}),0),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.hideProgress)(s)}),(function(){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.hideProgress)(s)}))}),500)}(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.each)(o,(function(_,e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.toggle)(e,""===d||-1!==e.innerText.toLowerCase().indexOf(d))}))}))}this.rows=o,this.scroll=new uiScroll((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("_post_scroll_wrap",e)),setTimeout((function(){i.scroll.update(),i.updatePosition()}),0)},onShow:function(_){setTimeout((function(){if(!i.scroll)return;const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("active",_),o=e?e.offsetTop-(i.scroll.data.viewportHeight-(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getSize)(e)[1])/2:0;i.scroll.scrollTop(o);const s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("post_from_tt_row_search",_);s&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.elfocus)(s)}),0)},onHide:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("post_from_tt_row_search",_);e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(e,"")}}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.data)(_,"tt",i)}e&&i.isShown()&&!_.hasAttribute("data-disallow-profile")&&wall.setReplyAsGroup(_,{from:l==vk.id?e:vk.id}),_.tt&&_.tt.hide&&_.tt.hide(),i.isShown()||i.show()},reportPost:function(_,e,o){window.stManager.add([window.jsc("web/privacy.js"),"privacy.css"],(function(){return Privacy.show(_,e,"report_"+o)}))},parsePostId:_web_wall_wall_utils__WEBPACK_IMPORTED_MODULE_40__.parseObjectPostId,likeIt:function(_,e,o,i){if((0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.stopEvent)(i),!vk.id)return!1;if(cur.viewAsBox)return cur.viewAsBox(),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.cancelEvent)(i);const s=wall.parsePostId(e),l=s.type,a=s.id,n=_&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("_post_content",_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("wl_post",_))||wall.domPost(a),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domByClass)(n,"_like_wrap"),E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domByClass)(d,"_count"),c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(d,"my_like");let p;p=e==cur.wallLayer?"wkview":cur.wallType?"feed"==cur.wallType?"news"==cur.section?"feed_"+(cur.subsection?cur.subsection:cur.section):"recommended"==cur.section?"feed_recommended"+("recent"!=cur.subsection?"_"+cur.subsection:""):"friends"==cur.section||"groups"==cur.section||"videos"==cur.section||"photos"==cur.section?"feed_"+cur.section+(cur.subsection?"_"+cur.subsection:""):"feed_"+cur.section:"top"==cur.wallType?"wall_top":"wall_"+(cur.onepost?"one":(cur.wallType||"").indexOf("full_")?"page":"full"):cur.module,ajax.post("like.php",{act:c?"a_do_unlike":"a_do_like",object:l+a,hash:o,wall:2,from:p,ref:p},{onDone:Wall.likeFullUpdate.pbind(_,e),onFail:function(){return!0}});const P=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.stripHTML)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(E)).replace(/(\s|,)/g,"");return Wall.likeUpdate(_,e,!c,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)(P)+(c?-1:1)),"wall"==l&&window.cur.onLike&&window.cur.onLike(_,l,e,c),cur.onWallLike&&cur.onWallLike(),"wall"==l&&Wall.triggerAdStat(a,"like_post"),!1},likesShow:function(_,e,o){if(_.postDontShowLikes)return;o=o||{};const i=wall.parsePostId(e),s=i.type,l=i.id,a=s+l,n=_&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("_post_content",_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("wl_post",_))||wall.domPost(l),d=o.views?"_views_wrap":o.share?"_share_wrap":"_like_wrap",E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domByClass)(n,d),c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(_,"_feedback_info_item")?_:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domByClass)(E,"_icon"),p=n&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domByClass)(n,"_share_wrap");if(!c||cur.viewAsBox)return;let P=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getXY)(E)[0],u=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getXY)(c)[0],b=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getSize)(c,!0)[0],O=u+b/2-P-41;const D=o.views?{views:1}:o.share?{published:1}:{};if(o.listId&&(D.list=o.listId),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(c,"_feedback_info_item")){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByTag1)("em",c);O=-40,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(c,"feedback_share")&&(O+=7),O+=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getSize)(_)[0]/2}const M=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(c,"_feedback_info_item")?c:c.parentNode;(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_12__.showTooltip)(M,{url:"/like.php",params:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)({act:"a_get_stats",object:a,has_share:p?1:""},D),slide:15,shift:[-O,o.views?2:"wall_reply"==s?-3:7],ajaxdt:100,showdt:400,hidedt:200,dir:"auto",checkLeft:!0,reverseOffset:80,noZIndex:!0,tip:{over:function(){Wall.likesShow(_,e,o)}},onShowStart:function(){const e=M.tt.container;setTimeout((function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.setStyle)(e,{left:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.floatval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getStyle)(e,"left"))+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getXY)(c)[0]-u})}),10),(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_19__.statlogsValueEvent)("likes_show",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(_,"shown"))},typeClass:"like_tt",className:o.cl||""})},likesShowList:function(_,e,o){o=o||{};const i=wall.parsePostId(e),s=i.type,l=i.id,a=s+l,n=_&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("_post_content",_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("wl_post",_))||wall.domPost(l),d=o.share?"_share_wrap":"_like_wrap",E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domByClass)(n,d);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domByClass)(E,"_icon")&&!cur.viewAsBox&&(0,_web_lib_feature_entries_showWiki__WEBPACK_IMPORTED_MODULE_10__.showWiki)({w:(o.views?"views":o.share?"shares":"likes")+"/"+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.clean)(a)},!1,!1,{queue:1})},sharesShow:function(_,e,o){Wall.likesShow(_,e,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)(o,{share:1}))},sharesShowList:function(_,e,o){Wall.likesShowList(_,e,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)(o,{share:1}))},viewsShowList:function(_,e,o){Wall.likesShowList(_,e,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)(o,{views:1}))},viewsUpdate:function(_,e){const o=wall.parsePostId(e),i={act:"a_get_stats",object:o.type+o.id,views:1};ajax.post("/like.php",i,{cache:1,onDone:function(o,s){Wall.likeUpdate(!1,e,!1,o,void 0,void 0,1);const l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ce)("div",{innerHTML:s});_.setAttribute("title",l.innerText||l.textContent),setTimeout(ajax.invalidate.pbind("/like.php",i),3e3)}})},sharesOpen:function(_,e,o){if(cur.viewAsBox)return cur.viewAsBox(),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.cancelEvent)(_);if(!vk.id)return!1;(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.stopEvent)(_);const i=wall.parsePostId(e),s=i.type,l=i.id,a=s+l;return(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_13__.showBox)("/like.php",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)({act:"publish_box",object:a},o)),"wall"==s&&Wall.triggerAdStat(l,"share_post"),!1},customCur:function(){return window.wkcur&&wkcur.shown?wkcur:window.mvcur&&mvcur.mvShown?mvcur:window.pvcur&&cur.pvShown?pvcur:cur},processPostReplyActions:function(_){},updatePostAuthorData:function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("_post_author_data_"+_).forEach((function(_){_.post_author_data_update=!0}))},triggerAccessibleSelectEvent:function(_){"Space"!==_.code&&"Enter"!==_.code||(_.preventDefault(),_.target.click())},closeComments:function(_,e,o,i,s){const l=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(_,"closed"))?0:1;if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("feed_post_menu_stats")){const e=_ instanceof HTMLElement?(0,_web_feed_feed_common__WEBPACK_IMPORTED_MODULE_64__.getTrackCodeFromPost)(_):null;l?_shared_feed_stats_click_three_dots__WEBPACK_IMPORTED_MODULE_85__.FeedPostMenuStats.closeComments(e,(0,_web_feed_feed_common__WEBPACK_IMPORTED_MODULE_64__.resolveRefFromCur)()):_shared_feed_stats_click_three_dots__WEBPACK_IMPORTED_MODULE_85__.FeedPostMenuStats.openComments(e,(0,_web_feed_feed_common__WEBPACK_IMPORTED_MODULE_64__.resolveRefFromCur)())}ajax.post("al_wall.php",{act:"close_comments",owner_id:e,post_id:o,close:l,hash:i},{onDone:function(){if(s)s(l);else{const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("post",_);Wall.onCloseComments(l,e)}}})},onCloseComments:function(_,e,o){if(!e||!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(e,"post")||vk.widget)return;const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("comment",e),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("reply_box_inner_wrap",e),l=cur.pgParams&&cur.pgParams.archive||"wall_archive"===cur.module,a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(e,"Post--with_closed_comments_donut"),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(e,"postponed");if(!(o||a||n||i&&s)){const o=e.id.replace("post","").split("_");return void ajax.post("al_wall.php",{act:"comment_box",owner_id:o[0],post_id:o[1]},{onDone:function(o,i){if(!l){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("comment",e),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("reply_box_inner_wrap",e);if(!_&&o){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("PostButtonReactionsContainer",e).after((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.se)(o))}if(!s&&i){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("replies_list",e);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domInsertAfter)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.se)(i),_)}}Wall.onCloseComments(_,e,!0)}})}l||a||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.toggleClass)(e,"closed_comments",_);const d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("action_closing_comments",e);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(d,"closed",_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(d,_?(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_open_comments"):(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_closing_comments"))},showPostEditedTime:function(_){const e=(cur.lang||{}).wall_changed;if(!e)return;const o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(_,"time")),i=60*((new Date).getTimezoneOffset()+180);o&&(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_12__.showTooltip)(_,{text:e.replace("{time}",(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_23__.getDateText)(o,i)),black:1,shift:[0,4]})},showPostAuthorData:function(_,e){const o=_.className.match(/_post_author_data_(-?\d+_\d+)/)[1]||"",i=e?e.target:window.event.srcElement;!o||i!=_&&i.onmouseover||(_.post_author_data_update&&(delete _.post_author_data_update,_.post_author_data_tt&&(_.post_author_data_tt.destroy(),_.post_author_data_tt=!1)),_.post_author_data_tt||ajax.post("al_page.php",{act:"post_author_data_tt",raw:o},{onDone:function(e){const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("post_link",_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domFC)(_);if(!e||!i)return void(_.post_author_data_tt=!0);const s={content:e,arrowSize:"mini",cls:"post_author_data",defaultSide:"bottom",align:"left",id:"author_tt_"+o},l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("_im_mess_stack",_);l?s.appendTo=l:s.appendToParent=!0,vk.widget&&(s.offset=[0,-2],s.forceSide="bottom"),_.post_author_data_tt=new ElementTooltip(i,s),_.post_author_data_tt.show()}}))},createPostTooltip:_web_page_wall_post_tooltip__WEBPACK_IMPORTED_MODULE_35__.createPostTooltip,hidePostCopyrightFeatureTooltip:function(){cur.postCopyrightFeatureTooltip&&cur.postCopyrightFeatureTooltipHash&&(cur.postCopyrightFeatureTooltip=!1,cur.postCopyrightFeatureTT.hide(),setTimeout((()=>{cur.postCopyrightFeatureTT.destroy()}),ElementTooltip.FADE_SPEED),ajax.post("al_index.php",{act:"hide_feature_tt",hash:cur.postCopyrightFeatureTooltipHash,type:"post_copyright"}))},showPostCopyrightFeatureTooltip:function(){if(!cur.postCopyrightFeatureTooltip||cur.postCopyrightFeatureTT)return;const _=setTimeout((()=>{const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post_settings_btn");_&&cur.postCopyrightFeatureTooltip&&(cur.postCopyrightFeatureTT=new ElementTooltip(_,{content:`<div class="feature_tooltip__close" onclick="Wall.hidePostCopyrightFeatureTooltip();"></div>${(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_post_copyright_feature_text")}`,cls:"feature_intro_tt feature_info_tooltip",forceSide:"bottom",autoShow:!1,noOverflow:!1,noHideOnClick:!0,appendToParent:!0,offset:[-6.5,-8],onShow:()=>{ajax.post("al_index.php",{act:"show_feature_tt",hash:cur.postCopyrightFeatureTooltipHash,type:"post_copyright"})},onWindowClick:()=>{cur.postCopyrightFeatureTT&&(cur.postCopyrightFeatureTT.hide(),cur.postField.blur())}}),cur.postCopyrightFeatureTT.show())}),800);cur.destroy.push((()=>clearTimeout(_)))},showPostOnlineBookingTooltip:function(_){if(!_)return;const e=_.querySelector(".ms_items_more_wrap");if(e&&e.hasAttribute("data-disable-show-online-booking-tooltip"))return;let o;var i;i=()=>{const i=_.querySelector(".ms_items_more_wrap");if(!i)return;const s=()=>{o&&(o.hide(),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.removeEvent)(e,"mouseover",s))};(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.addEvent)(e,"mouseover",s),o=new ElementTooltip(i,{content:(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("intro_hint_description_online_booking_attach_add_web"),cls:"eltt_fancy poster_feature_tt",defaultSide:"left",autoShow:!1,appendToParent:!0,onHide:()=>(e&&e.setAttribute("data-disable-show-online-booking-tooltip","true"),(0,_vkontakte_internal_shared__WEBPACK_IMPORTED_MODULE_114__.ensureAccountHelpHintsService)().hideHelpHint(_vkontakte_internal_shared__WEBPACK_IMPORTED_MODULE_115__.AvailableHelpHints.ACCOUNT_HINT_POSTING_EDITOR_ONLINE_BOOKING),o&&o.destroy(),void(o=null))}),o.show()},(0,_vkontakte_internal_shared__WEBPACK_IMPORTED_MODULE_114__.ensureAccountHelpHintsService)().canShow(_vkontakte_internal_shared__WEBPACK_IMPORTED_MODULE_115__.AvailableHelpHints.ACCOUNT_HINT_POSTING_EDITOR_ONLINE_BOOKING)&&i()},hidePosterFeatureTooltip:function(){cur.posterFeatureTooltip=!1,cur.posterFeatureTT&&cur.posterFeatureTooltipHash&&(cur.posterFeatureTT.destroy(),cur.posterFeatureTT=null,ajax.post("al_index.php",{act:"hide_feature_tt",hash:cur.posterFeatureTooltipHash,type:"poster_new_year"}))},showPosterFeatureTooltip:function(){if(!cur.posterFeatureTooltip)return;const _=setTimeout((function(){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domQuery1)(".poster__open-btn",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("page_poster_btn"));if(!_||!cur.posterFeatureTooltip)return;const e='<div class="poster_feature_tt__layout" onclick="cur.posterFeatureTT.hide(); cancelEvent(event);"><div class="poster_feature_tt__close"></div><div class="poster_feature_tt__info">'+(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_new_posters_new_year")+"</div>";cur.posterFeatureTT=new ElementTooltip(_,{content:e,forceSide:"bottom",cls:"eltt_fancy poster_feature_tt",autoShow:!1,noOverflow:!1,align:"left",centerShift:-28,noHideOnClick:!0,appendToParent:!0,offset:[0,-8],onHide:Wall.hidePosterFeatureTooltip,onWindowClick:function(){cur.posterFeatureTT.hide(),cur.postField.blur()}}),cur.posterFeatureTT.show(),cur.poster&&cur.poster.sendStatsInfo("new_bkg_tooltip_show")}),800);(0,_shared_lib_nav_helpers__WEBPACK_IMPORTED_MODULE_108__.pushNavDestroy)((()=>{clearTimeout(_)}))},replyEditPhoto:function(_,e,o){if(!(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("fix_anonymous_reply")||window.vk.id)return Wall.showEditReply(e,null,!1,!1,!1,(function(){const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_more_attaches"+e);if(o){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("ms_item_photo",o);tooltips.hide(_),e&&e.click()}})),o&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.cancelEvent)(o)},replyMoreAttachShow:function(_,e,o){if(!(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("fix_anonymous_reply")||window.vk.id)return Wall.showEditReply(e,null,!1,!1,!0,(function(){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("ms_items_more_wrap",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_more_attaches"+e));_&&(_.focus(),_.click())})),o&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.cancelEvent)(o)},replyFakeEmojiOver:function(_){(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("fix_anonymous_reply")&&!window.vk.id||wall.initEditReply(_,!1,!0,(function(){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_smile"+_);if(e){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("emoji_smile",e);_.onmouseenter?.()}}))},hideDeepReplies:function(_){let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post"+_);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(e,"reply")&&(e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("post",e),_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(e,"post-id"));const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(e,"replies-offset")||0,i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(e,"replies-limit")||3,s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("replies"+_),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.rs)(cur.wallTpl.reply_deep_next,{post_id:_,reply_id:_,offset:o,count:i,text:"",class:" replies_next_main",post_author_suffix:""}));s.innerHTML="",s.appendChild(l),(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_20__.scrollToY)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getXY)(s)[1]-100,0,null,!0),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(l,"collapse",!0),l.click(),cur.wallMyOpened[_]=0},addNewReply:function(_){const e=_[2],o=(_[10]||"").match(/wall.showReply\([^-)0-9]*(-?[_0-9]+)[^-)0-9]*(-?[_0-9]+)[^-)0-9]*\)/),i=o&&o[2]||"",s=i&&i!==e,l=cur.wallLayer&&cur.wallLayer===e,a=l?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("replies"+e):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post"+e),n=a.offsetHeight;let d,E=0,c=0;d=s?wall._addDeepReply(_,i):wall._addRootReply(_);const p=l?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("wl_post"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post"+e);return wall.incReplyCounter(p,1,_[13]),l?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("wl_replies_wrap",p)),cur.count++,cur.loaded++):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("replies_wrap"+e),Wall.repliesSideSetup(e)),Wall.updateMentionsIndex(),d&&((0,_web_stories_narrative_utils__WEBPACK_IMPORTED_MODULE_45__.updateNarrativeSnippetsFromQueueByPost)(d),(0,_web_articles_article_utils__WEBPACK_IMPORTED_MODULE_46__.updateArticleSnippetsFromQueueByPost)(d),(0,_web_stickers_utils__WEBPACK_IMPORTED_MODULE_50__.updateStickersFromQueue)(d),E=a.offsetHeight-n,c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getXY)(d,l)[1]),[E,c]},_addDeepReply:function(_,e){const o=_[2],i=_[10]||"",s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.se)(i);let l=s&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(s,"root-id")||e,a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post"+l);const n=a&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("replies_wrap_deep",a),d=cur.wallLayer&&cur.wallLayer===o?wkcur:cur;let E;if(n&&(l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(n,"post-id"),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post"+l)),!a)return null;let c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("replies"+l);if(!c){wall.addDeepRepliesBlock(l);const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_fakebox"+l)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_box"+l);_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)(_),c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("replies"+l),E=c}if(!c)return null;if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("reply",c).length){const _=wall._addNewReplyShowMore(o,l,c,"replies_next_deep");E=E||_}else{let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("replies_short_deep"+l);const i=wall.isDescRepliesOrder(o);if(e){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("replies_short_text_count",e),o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(_).replace(/[^0-9]/g,""))||0;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(_,(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("global_replied_to_reply_count",o+1))}else{e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.rs)(d.wallTpl.reply_deep_short,{post_id:o,reply_id:l,reply_msg_id:l.split("_")[1],img_src:_[6]||"",name:_[5]||"",count:(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("global_replied_to_reply_count",1)}));const s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domFC)(c);if(s)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domInsertBefore)(e,s),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(s,"replies_next_deep")&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.toggleClass)(s,"replies_prev",i);else{c.appendChild(e);const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.rs)(d.wallTpl.reply_deep_next,{post_id:o,reply_id:l,offset:0,count:1,text:(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_next_n_replies",1),class:" replies_next_deep"+(i?" replies_prev":""),post_author_suffix:""}));c.appendChild(_)}}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)(n,"replies_deep_has_short"),E=e}return wall.updateCollapseDeepReplies(l),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)(n,"replies_deep_empty_list"),E},_addRootReply:function(_){const e=_[2],o=cur.wallLayer&&cur.wallLayer===e,i=o?wkcur:cur,s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("replies"+e),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domChildren)(s).length,a="full"===i.wallType,n=!l||l<3&&(o||a),d=wall.isDescRepliesOrder(e);if(n){const e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.intval)(_[_.length-1]),o=void 0!==i.options.is_admin?i.options.is_admin:_shared_ranges__WEBPACK_IMPORTED_MODULE_57__.Ranges.isGroupId(i.options.wall_oid)?8&e?_shared_groups_constants__WEBPACK_IMPORTED_MODULE_51__.GroupAdminLevel.EDITOR:2&e?_shared_groups_constants__WEBPACK_IMPORTED_MODULE_51__.GroupAdminLevel.MODERATOR:_shared_groups_constants__WEBPACK_IMPORTED_MODULE_51__.GroupAdminLevel.USER:_shared_groups_constants__WEBPACK_IMPORTED_MODULE_51__.GroupAdminLevel.USER,l=Wall.getNewReplyHTML(_,o,!1,i);if(!l)throw new Error("Failed to add root reply");const a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.se)(l);return(0,_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_37__.highlightUpdatedReply)(a),d&&s.firstChild?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domInsertBefore)(a,s.firstChild):s.appendChild(a),a}return wall._addNewReplyShowMore(e,e,s,"replies_next_main",d)},_addNewReplyShowMore:function(_,e,o,i,s){const l=cur.wallLayer&&cur.wallLayer===_?wkcur:cur,a=l.options.replies_page_count||20,n=s?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domFC)(o):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domLC)(o);let d,E;if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(n,"replies_next"))return d=+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(n,"count")||0,d<a?(d++,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(n,"count",d),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(n,s?(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_prev_n_replies",d):(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_next_n_replies",d))):s&&(E=+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(n,"offset")||0,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(n,"offset",E+1)),n;{if(s)E=0;else{const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)(i,o),e=_[_.length-1],s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domChildren)(o);if(e){const _=+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(e,"count")||a,o=+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(e,"offset")||0;let i=s.indexOf(e);i=(i>=0?i:0)+1;E=o+_+s.slice(i).filter((function(_){return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(_,"reply")})).length}else E=s.filter((function(_){return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(_,"reply")})).length}const n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.rs)(l.wallTpl.reply_deep_next,{post_id:_,reply_id:e,offset:E,count:1,text:s?(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_prev_n_replies",1):(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_next_n_replies",1),class:" "+(s?" replies_prev":"")+(i?" "+i:""),post_author_suffix:""}));return s?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domInsertBefore)(n,o.firstChild):o.appendChild(n),(0,_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_37__.loadRepliesLinkShow)(n),n}},removeDeepReply:function(_){const e=_[2],o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post"+e);let i=0,s=0;if(cur.wallMyDeleted[e]||!o)return[i,s];s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getXY)(o,cur.layerpost)[1],(0,_web_lib_revertLastInlineVideo__WEBPACK_IMPORTED_MODULE_22__.revertLastInlineVideo)(o);const l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("wl_post",o)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("post",o),a=l?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(l,"post-id"):"",n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("replies_wrap_deep",o);if(n)i=-o.offsetHeight,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)(o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getSize)(n)[1]&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)(n,"replies_deep_empty_list"),wall.updateCollapseDeepReplies(e);else{if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("replies_wrap_deep"+e)){const _=cur.wallLayer&&cur.wallLayer===a?wkcur:cur,s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("reply_date",o),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("reply_link_wrap",o);let n="";const d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.attr)(o,"onclick");d&&(n+=' onclick="'+d+'"');const E=e.split("_")[0],c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.rs)(_shared_ranges__WEBPACK_IMPORTED_MODULE_57__.Ranges.isGroupId(E)?_.wallTpl.reply_deleted_group:_.wallTpl.reply_deleted_user,{reply_id:e,date:s?s.innerHTML:"",answer:l?l.outerHTML:"",class:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(o,"reply_replieable")?" reply_replieable":"",attr:n})),p=o.offsetHeight;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domReplaceEl)(o,c),i=c.offsetHeight-p}else i=-o.offsetHeight,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)(o)}return cur.layerpost&&(cur.count--,cur.loaded--),l&&(wall.repliesSideSetup(a),wall.incReplyCounter(l,-1)),[i,s]},addDeepRepliesBlock:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post"+_);if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(e,"reply"))return;const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("wl_post",e)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("post",e);if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(o,"deep_active"))return;const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(o,"post-id");let s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("replies_wrap_deep"+_);const l=(cur.wallLayer?wkcur:cur).wallTpl;s||(s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.rs)(l.reply_deep,{post_id:i,reply_id:_,reply_msg_id:_.split("_")[1],text:"",offset:0,class:" replies_next_deep"})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domInsertAfter)(s,e));const a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_fakebox"+_),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_box"+_);if(!a&&!n){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_fakebox"+i)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("reply_box"+i),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("checkbox_official",e)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.gpeByClass)("reply_fakebox_with_official",e),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.rs)(l.reply_box,{post_id:_,owner_name:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.clean)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(e,"owner-name")||""),owner_photo:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(e,"owner-photo")||"",owner_href:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(e,"owner-href")||"",owner_is_nft:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(e,"owner-is-nft")||"",can_reply_as_group:o||"",class:o?" reply_fakebox_with_official":""}));s.appendChild(a),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)(s,"replies_deep_has_field")}},addReplyName:function(_,e){const o={};o[_]=e,wall.addReplyNames(o)},addReplyNames:function(_){const e=cur.wallLayer?wkcur:cur;e.options||(e.options={}),e.options.reply_names=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.extend)({},e.options.reply_names,_)},getReplyNames:function(){return(cur.wallLayer?wkcur:cur).options.reply_names||{}},getReplyName:function(_){if(cur.pvShown&&cur.pvReplyNames)return cur.pvReplyNames[_]||[];if(window.mvcur&&mvcur.mvShown&&!mvcur.minimized)return mvcur.mvReplyNames[_]||[];if((0,_shared_video_isStandaloneOrVideoPage__WEBPACK_IMPORTED_MODULE_101__.isVideoPageOpen)()||(0,_shared_video_isFakeVideoStandalone__WEBPACK_IMPORTED_MODULE_100__.isFakeVideoStandalone)())return window.cur.videoPageReplyNames[_]||[];return wall.getReplyNames()[_]||[]},showReorderRepliesTooltip:function(_,e){const o=cur.wallLayer&&cur.wallLayer===e?wkcur:cur;if(!o["postRepliesReorderTT"+e]&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.data)(_,"ett")){const i=_.closest(".post_replies_reorder_wrap");let s;s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(_,"hide-smart")||!1?o.wallTpl.replies_reorder_tooltip:o.wallTpl.replies_reorder_tooltip_with_smart;const l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.rs)(s||"",{postId:e})),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("radiobtn",l),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(_,"order")||"asc",d="post_replies_reorder"+e;radioBtns[d]={val:n,els:a},a.some((function(_){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(_,"order")===n)return(0,_web_page_wall_post_tooltip__WEBPACK_IMPORTED_MODULE_35__.updatePostTooltipActionRadioBtn)(_,!0,d),!0}));const E=new ElementTooltip(_,{appendTo:i?.parentNode,forceSide:"bottom",autoShow:!1,cls:"eltt_fancy eltt_fancy_actions",noOverflow:!1,centerShift:0,offset:[-10,0],content:l,align:"left"});o["postRepliesReorderTT"+e]=E,(0,_shared_lib_nav_helpers__WEBPACK_IMPORTED_MODULE_108__.pushNavDestroy)((()=>{E&&E.destroy()})),E.show()}},reorderReplies:function(_,e,o){const i=cur.wallLayer&&cur.wallLayer===e?wkcur:cur;o=o||"asc",(0,_web_page_wall_post_tooltip__WEBPACK_IMPORTED_MODULE_35__.updatePostTooltipActionRadioBtn)(_,o,"post_replies_reorder"+e);const s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post_replies_reorder"+e),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(_,"label")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(_),a=s?.querySelector(".post_replies_reorder");if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(a,l),s&&(s.setAttribute("aria-label",l),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(s,"order",o)),i["postRepliesReorderTT"+e]&&i["postRepliesReorderTT"+e].hide(),(0,_web_feed_feed_stats__WEBPACK_IMPORTED_MODULE_73__.isFeedRepliesStatsEnabled)()){let _=0,i=0;if(e&&"string"==typeof e){const o=e.split("_");_=o[0],i=o[1]}const s=document.getElementById("post"+e),l=(0,_web_feed_utils_miscellaneous__WEBPACK_IMPORTED_MODULE_78__.postsGetRaws)(s?.parentElement);_shared_production_stats_click_feed_comments_sort_tab_click__WEBPACK_IMPORTED_MODULE_77__.feedCommentsSortTabClickCollector.logEvent({event:(0,_web_feed_feed_stats__WEBPACK_IMPORTED_MODULE_73__.getCommentsSortEvent)(o),wall_item_id:{owner_id:_,id:i},ref:(0,_web_feed_feed_common__WEBPACK_IMPORTED_MODULE_64__.resolveRefFromCur)(),position:l.index??0},{type:_shared_production_stats_types__WEBPACK_IMPORTED_MODULE_67__.EventItemType.POST})}wall.moreReplies(e,0,0,{deep:!0,clear:!0,order:o,onDone:function(_,o,i){const s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("replies"+e);if(i.count>i.offset+i.num){const _=cur.wallLayer&&cur.wallLayer===e?wkcur:cur,o=_.options.replies_page_count||20,l=Math.min(o,i.count-i.offset-i.num),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.rs)(_.wallTpl.reply_deep_next,{post_id:e,reply_id:e,offset:i.offset+i.num,count:l,text:(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_next_n_replies",l),class:" replies_next_main",post_author_suffix:i.author_avatar_suffix}));s.appendChild(a)}i.top_reply_ids&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(s,"top-ids",i.top_reply_ids.join(",")),cur.wallMyOpened=cur.wallMyOpened||{},cur.wallMyOpened[e]=1,wall.repliesSideSetup(e)}})},getRepliesOrder:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("post_replies_reorder"+_);return(e?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(e,"order"):"")||"asc"},isDescRepliesOrder:function(_,e){return"desc"===(e=e||wall.getRepliesOrder(_))},postEventChangeStatus:function(_,e,o,i){const s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domData)(_,"context"),l=()=>document.querySelectorAll(".post_event_action_btn"+e);return window.stManager.add([window.jsc("web/groups.js")],(()=>{Groups.enter(_,e,o,s,((_,o,i)=>{const a=s.split("_"),n=!a[1],d=a[0]+"_"+(n?"decline":""),E=n?(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("events_snippet_will_participate_active"):(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("events_snippet_cant_participate_active");i=i||{},l().forEach((_=>{_.dataset.context=d,_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_48__.FlatButton.setAppearance(_,_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_48__.FlatButtonAppearance.SECONDARY),_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_48__.FlatButton.setLabel(_,E)})),i.members&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("page_media_event"+e).forEach((_=>{const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("page_media_event_members",_);e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(e,i.members)}))}),{showProgress:()=>{l().forEach((_=>{_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_48__.FlatButton.lock(_)}))},hideProgress:()=>{l().forEach((_=>{_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_48__.FlatButton.unlock(_)}))}})})),i&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.cancelEvent)(i)},showEventFriends:function(_,e){(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_12__.showTooltip)(_,{url:"/al_groups.php",params:{act:"a_event_friends_tt",owner_id:e},ajaxdt:100,showdt:400,hidedt:200,dir:"auto",noZIndex:!0,typeClass:"like_tt"})},updateRepliesOnScroll:function(){cur.wallLayer?WkView.wallUpdateRepliesOnScroll():"full"===cur.wallType&&FullWall.onePostOnScroll()},updateConvertedClassifiedPost:function({postId:_,ownerId:e}){ajax.post("al_wall.php",{act:"s_one",post_id:_,owner_id:e,render_context:"wall",only_post:!0},{onDone:o=>{const i=Wall.domPost(`${e}_${_}`);if(i&&o){const _=document.createElement("div");_.innerHTML=o,i.querySelector(".post_info").innerHTML=_.querySelector(".post_info").innerHTML}}})},sendFakeNewsMark:function(_,e,o,i,s){const l="data-mark-exists",a={post_id:o,owner_id:i,mark:1===parseInt(_.getAttribute(l))?0:1,hash:s},n={onDone(e,o){(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_17__.showDoneBox)(e),_.innerHTML=o,_.setAttribute(l,a.mark)},onFail:_=>(0,_web_lib_utils__WEBPACK_IMPORTED_MODULE_28__.showErrorBox)(_),showProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockActionsMenuItem)(_),hideProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockActionsMenuItem)(_)};ajax.post(e,a,n)},sendToObsceneCheck:function(_,e,o,i,s){const l={post_id:o,owner_id:i,hash:s},a={onDone(_){(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_17__.showDoneBox)(_)},onFail:_=>(0,_web_lib_utils__WEBPACK_IMPORTED_MODULE_28__.showErrorBox)(_),showProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockActionsMenuItem)(_),hideProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockActionsMenuItem)(_)};ajax.post(e,l,a)},openMarkAsAdsOrdMiniApp:function(_){const e='[name="ord_pred_id"]',o='[name="erid"]',i=(_,e,o)=>{_&&(o?_.classList.contains(e)||(_.classList.add(e),_.classList.add("on")):_.classList.contains(e)&&(_.classList.remove(e),_.classList.remove("on")))},s=(()=>{const i=_.querySelector(e),s=_.querySelector(o),l=_.classList.contains("on"),a=i&&i.value;return{is_ad:l,erid:s&&s.value,ord_pred_id:a}})();(0,_web_ord_utils__WEBPACK_IMPORTED_MODULE_62__.handleOrdMiniappOpen)(s,(s=>(s=>{const l=s.is_ad,a=_.closest(".PostSettings"),n=a&&a.querySelector("#post_icon_gear_settings"),d=_.querySelector(e),E=_.querySelector(o);i(n,"PostOption__iconWrapperApplied",l),i(_,"PostOption__withMarkAdsOrdMiniApp",l),d&&(d.value=s.ord_pred_id),E&&(E.value=s.erid)})(s)),{isSnackbar:!0,edit:!1})},toggleDowngradeState:function(_,e,o,i,s){const l="data-downgraded",a={post_id:o,owner_id:i,set:1===parseInt(_.getAttribute(l))?0:1,hash:s},n={onDone(e,o){(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_17__.showDoneBox)(e),_.innerHTML=o,_.setAttribute(l,a.set)},onFail:_=>(0,_web_lib_utils__WEBPACK_IMPORTED_MODULE_28__.showErrorBox)(_),showProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockActionsMenuItem)(_),hideProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockActionsMenuItem)(_)};ajax.post(e,a,n)},initPostWarningField(){if(window.cur.postWarningField)return;window.cur.postWarningField=document.createElement("span"),window.cur.postWarningField.classList.add("post_field_warning");const _=window.cur.postField?.parentElement;_&&_.appendChild(window.cur.postWarningField)},showPostGeoBanBox(_,e){(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_13__.showBox)("groups_wall_posts_geoban.php",{act:"manage_geoban_box",gid:_,post_id:e})},initPostGeoBan(_,e,o){this.geoBlockCountryElement=document.getElementById("post_geoban_country"),this.geoBlockCountries=e.values,this.geoBlockCommentField=document.getElementById("post_geoban_comment"),this.geoBlockComments=e.comments,this.geoBlockDoAction=o=>{ajax.post("groups_wall_posts_geoban.php",{act:"a_set_post_geoban",status:o,comment:this.geoBlockCommentField.value,country:this.geoBlockCountry.val(),post_id:_,hash:e.hash},{onDone:()=>{window.nav.reload()},onFail:_=>(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_13__.showFastBox)("Ошибка",_)})},this.geoBlockBanAction=()=>{this.geoBlockDoAction(1)},this.geoBlockUnbanAction=()=>{this.geoBlockDoAction(0)},this.geoBlockCountryChange=()=>{const _=this.geoBlockCountry.val();this.geoBlockComments[_]?(this.geoBlockCommentField.value=this.geoBlockComments[_],this.geoBlockCommentField.disabled=!0,o.setButtons("Разблокировать",this.geoBlockUnbanAction)):(this.geoBlockCommentField.value="",this.geoBlockCommentField.disabled=!1,o.setButtons("Заблокировать",this.geoBlockBanAction))},this.geoBlockCountry=new Dropdown(this.geoBlockCountryElement,this.geoBlockCountries,{big:1,selectedItems:[],onChange:this.geoBlockCountryChange}),this.geoBlockCountryChange(),(0,_web_lib_layout_utils__WEBPACK_IMPORTED_MODULE_52__.autosizeSetup)("post_geoban_comment",{minHeight:60})},getLastReplies(_,e=4){const o=wall.isDescRepliesOrder(_),i=wall.getRepliesOrder(_),s="smart"===i,l=cur?.wallLayer===_?wkcur:cur;const a={clear:!0,deep:s,rev:o?1:0,order:i};wall.moreReplies(_,null,e,{...a,onDone:function(e,i,a){const n=document.querySelector(`#replies${_}`);if(!n)return;if(a.count>a.offset+a.num){const e=l.options.replies_page_count||20,i=Math.min(e,a.count-a.offset-a.num),d=o||s,E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.rs)(l.wallTpl.reply_deep_next,{post_id:_,reply_id:_,offset:a.offset+a.num,count:i,text:d?(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_next_n_replies",i):(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("wall_prev_n_replies",i),class:d?" replies_next replies_next_main":" replies_prev",post_author_suffix:""}));d?n.appendChild(E):n.insertBefore(E,n.firstChild)}const d=n.parentNode;d&&e&&(d.style.display=""),a.top_reply_ids&&(n.dataset.topIds=a.top_reply_ids.join(",")),cur.wallMyOpened=cur.wallMyOpened||{},cur.wallMyOpened[_]=1,wall.repliesSideSetup(_)}})},initHashtagComposer(_,e,o){const i=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_47__.partConfigEnabled)("posting_hashtags_web");if(!i)return;const s=(_,e)=>{if(""===_||"isLoading"===window.cur.hashtags)return[];if(!window.cur.hashtags)return window.cur.hashtags="isLoading",(0,_vkontakte_internal_api_client__WEBPACK_IMPORTED_MODULE_116__.api)("wall.getSuggestedHashtags",{}).then((o=>{window.cur.hashtags=o.hashtags,e(s(_,e))})),[];const o=[(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_16__.escapeRE)(_),(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.parseLatin)(_),(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_23__.parseCyr)(_)].filter((_=>_)),i=new RegExp("(?![^&;]+;)(?!<[^<>]*)((\\(*)("+o.join("|")+"))(?![^<>]*>)(?![^&;]+;)","gi");return window.cur.hashtags.filter((_=>_.match(i))).map((_=>"#"+_))};Wall.initComposer(_,{...e,lang:{introText:(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("profile_hashtag_start_typing"),noResult:(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_7__.getLang)("profile_hashtag_not_found")},hashtagEnable:i,wddOpts:{customNeedEmpty:!0,custom:s}},o)},deinitHashtagComposer(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.data)(_,"composer_hashtag");e&&Composer.destroy(e)},postingTimelineLogger:_shared_posting_analytics_posting_timeline__WEBPACK_IMPORTED_MODULE_92__.postingTimelineLogger};vk.widget||(0,_shared_posting_analytics_utils__WEBPACK_IMPORTED_MODULE_86__.isPostingStatsEnabled)()&&((0,_shared_evbus__WEBPACK_IMPORTED_MODULE_88__.tq)().setInteractiveHandler("Posting/upload_file",(()=>{(0,_shared_posting_analytics_utils__WEBPACK_IMPORTED_MODULE_86__.sendPostingEvent)(_shared_posting_analytics_types__WEBPACK_IMPORTED_MODULE_87__.POSTING_STATS_NAMES.UPLOAD_FILE)})),(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_88__.tq)().setInteractiveHandler("Posting/upload_video",(()=>{(0,_shared_posting_analytics_utils__WEBPACK_IMPORTED_MODULE_86__.sendPostingEvent)(_shared_posting_analytics_types__WEBPACK_IMPORTED_MODULE_87__.POSTING_STATS_NAMES.UPLOAD_VIDEO)})),(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_88__.tq)().setInteractiveHandler("Posting/upload_photo",(()=>{(0,_shared_posting_analytics_utils__WEBPACK_IMPORTED_MODULE_86__.sendPostingEvent)(_shared_posting_analytics_types__WEBPACK_IMPORTED_MODULE_87__.POSTING_STATS_NAMES.UPLOAD_PHOTO)})),(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_88__.tq)().setInteractiveHandler("Posting/albums_load_more",(()=>{(0,_shared_posting_analytics_utils__WEBPACK_IMPORTED_MODULE_86__.sendPostingEvent)(_shared_posting_analytics_types__WEBPACK_IMPORTED_MODULE_87__.POSTING_STATS_NAMES.SHOW_ALBUM)})));const __WEBPACK_DEFAULT_EXPORT__=Wall},290788:(_,e,o)=>{o.d(e,{Handler:()=>O});var i=o(914421),s=o(520637),l=o(234430),a=o(52905),n=o(105330),d=o(898848),E=o(314309),c=o(695368),p=o(540462),P=o(670053),u=o(534100),b=o(816980);class O{get successDescriptor(){return`${this.params.originalHandlerName||this.params.handlerName}Result`}get errorDescriptor(){return`${this.params.originalHandlerName||this.params.handlerName}Failed`}get previousCallsCount(){return this.app?.context?.getHandlerCallsCount(this.params.handlerName)-1||0}shouldLogStat(){return!(0,p.partConfigEnabled)("mini_apps_log_overridden_handlers")}shouldLogCallArgumentsInStat(){return(0,p.partConfigEnabled)("mini_apps_send_stat_arguments_bridge_events")&&Array.isArray(this.app?.bridgeMethodsToBeLogged)&&this.app.bridgeMethodsToBeLogged.includes(this.params.handlerName)}getEventHash(_=!1){const e=`${this.getEventName(_)}_hash`;return(0,P.getCurrentApp)()?.options[e]}getEventName(_=!1){const e=`${this.params.handlerName}${_?"Preload":""}`;return a.VK_CONNECT_EVENTS[e]}sendNetworkError(){this.errorHandler({code:a.ERROR_CODES.UNKNOWN,error_type:a.ERROR_TYPES.CLIENT,reason:a.ERROR_REASONS.UNKNOWN_ERROR})}sendConnectionLostError(){this.errorHandler({code:a.ERROR_CODES.CONNECTION_LOST,error_type:a.ERROR_TYPES.CLIENT,reason:a.ERROR_REASONS.CONNECTION_LOST})}sendUserDeniedError(){this.errorHandler({code:a.ERROR_CODES.USER_DENIED,error_type:a.ERROR_TYPES.CLIENT,reason:a.ERROR_REASONS.USER_DENIED})}handleApiError(_){const e=_?.error,o=e?.error_msg,i=e?.error_code;if(i)switch(i){case c.API_ERROR_ACCESS:this.errorHandler({code:a.ERROR_CODES.ACCESS_DENIED,error_type:a.ERROR_TYPES.CLIENT,reason:o});break;case c.API_ERROR_PARAM:this.errorHandler({code:a.ERROR_CODES.INVALID_PARAMS,error_type:a.ERROR_TYPES.CLIENT,reason:o});break;default:this.errorHandler({code:a.ERROR_CODES.CUSTOM,error_type:a.ERROR_TYPES.CLIENT,reason:o||a.ERROR_REASONS.UNKNOWN_ERROR})}else this.errorHandler({code:a.ERROR_CODES.CONNECTION_LOST,error_type:a.ERROR_TYPES.CLIENT,reason:o||a.ERROR_REASONS.UNKNOWN_ERROR})}sendCustomError(_){this.errorHandler({code:a.ERROR_CODES.CUSTOM,reason:_||a.ERROR_REASONS.UNKNOWN_ERROR})}checkParams(_,e){for(let o=0;o<e.length;o++){const{param:i,type:s,isRequired:l,extraChecks:n}=e[o];if(!_.hasOwnProperty(i)&&l)return this.errorHandler({code:a.ERROR_CODES.MISSING_PARAM,reason:`Missing required param "${i}"`}),!1;if(_.hasOwnProperty(i)&&typeof _[i]!==s)return this.errorHandler({code:a.ERROR_CODES.INVALID_PARAMS,reason:`Param "${i}" should be ${s}`},this.callback),!1;if(_.hasOwnProperty(i)&&n&&n.length>0)for(let e=0;e<n.length;e++)if(!n[e].check(_[i]))return this.errorHandler({code:a.ERROR_CODES.INVALID_PARAMS,reason:n[e].error(i)},this.callback),!1}return!0}actionHandler(_){return this.callApi?window.ajax.post("apps.php",{act:"handle_vk_connect_event",hash:this.getEventHash(),event:this.getEventName(),app_id:this.app.appId,..._},{onDone:e=>{this.handleResponse(e,_,this.checkResponse)},onFail:_=>(this.errorHandler(_),!0)}):{}}checkResponse(_){1===_||0===_?this.successHandler(Boolean(_)):this.successHandler(_)}scopeStringToArray(_){return _?_.replace(/ /g,"").split(","):[]}denyUIAction(_){this.errorHandler({error_type:"client_error",code:a.ERROR_CODES.USER_DENIED},null),this.modal&&i.default.pop(this.modal)}allowUIAction(_){this.actionHandler(_),this.modal&&i.default.pop(this.modal)}createDenyUIAction(_){this.params.modal.cancelAction=void 0!==_?()=>this.denyUIAction(_):this.denyUIAction}createAllowUIAction(_){this.params.modal.allowAction=void 0!==_?()=>this.allowUIAction(_):this.allowUIAction}launchUI(_){this.createDenyUIAction(),this.createAllowUIAction(),this.modal=new l.UIAction({...this.params.modal,..._}),i.default.push(this.modal)}_enhanceBtnsWithActions(){this.params.modal.buttons?.forEach((_=>{"deny"===_.type?_.action=this.params.modal.cancelAction:_.action=this.params.modal.allowAction}))}setData(_,e,o=null){o&&(this.callback=o),_.request_id&&(this.params.request_id=_.request_id),this.params.modal||(this.params.modal={}),_.containerId&&(this.params.modal.containerId=_.containerId),_.pic&&(this.params.modal.pic=_.pic),this.app=e,this.shouldLogCallArgumentsInStat()&&(this.callArguments=_)}showBridgeModal(_,e){return(0,b.isSpaLaunch)()&&_.showModal?_.showModal(e):(0,u.showBridgeModalBox)(e)}handleResponse(_,e,o,i){try{const i=JSON.parse(_);i.hasOwnProperty("error")?this.errorHandler(i.error):o(i,e)}catch(_){i?i(_):this.errorHandler(_)}}handler(_,e,o){if(this.setData(_,e),this.callback=o,this.isWebOnly&&(0,n.isMvk)()||this.isMobileWebOnly&&!(0,n.isMvk)())return this.errorHandler({code:a.ERROR_CODES.UNSUPPORTED_PLATFORM,error_type:a.ERROR_TYPES.CLIENT,reason:a.ERROR_REASONS.UNSUPPORTED_PLATFORM});this.useUI?this.launchUI(_):this.useUI||this.actionHandler(_)}getAppWebviewUrl(){const _=(0,P.getCurrentApp)();return _?.url||_?.frame?.src||""}cleanCallArguments(_){const e=["request_id","handlerName","method","modal","containerId","pic"];for(const o of e)delete _[o];return _}getSerializedCallArguments(){if(!this.shouldLogCallArgumentsInStat()||!this.callArguments)return null;const _=this.cleanCallArguments({...this.callArguments});let e=JSON.stringify(_);return e.length>a.BRIDGE_STAT_CALL_ARGUMENTS_MAX_LENGTH&&(e=null),e}isPassedParameters(_){return(0,d.isObject)(_)}successHandler(_,e){if("function"==typeof e&&e(),this.isPassedParameters(_)||(_={result:_}),this.params.request_id&&(_.request_id=this.params.request_id),this.callback?.({type:this.successDescriptor,data:_},this.params.handlerName),(0,n.isMvk)()&&(0,P.getCurrentApp)()?.frame?.focus(),this.shouldLogStat()){const _=this.getSerializedCallArguments();E.bridgeEventItemStat.logEvent(this.getAppWebviewUrl(),this.app.appId,{event_type:this.params.handlerName,is_success:!0,..._?{call_arguments:_}:{}},void 0,this.app.vkApp.sessionUuid)}}errorHandler(_,e,o){"string"==typeof _&&(_={reason:_}),this.params.request_id&&_&&(_.request_id=this.params.request_id);const i=new s.default(this.errorDescriptor,_,o),l=i.selectErrorType();if("function"==typeof e&&e(l),this.callback?.(l),(0,n.isMvk)()&&(0,P.getCurrentApp)()?.frame?.focus(),this.shouldLogStat()){const _=this.getSerializedCallArguments();E.bridgeEventItemStat.logEvent(this.getAppWebviewUrl(),this.app.appId,{event_type:this.params.handlerName,is_success:!1,..._?{call_arguments:_}:{}},{error_type:i.type||a.ERROR_TYPES.CLIENT,error_code:i.data.code||a.ERROR_CODES.UNKNOWN},this.app.vkApp.sessionUuid,i.getReadableMessage())}}constructor(_={}){this.params={handlerName:"handler",method:"method",modal:{},..._},this.callApi=!0,this.useUI=!1,this.callback=null,this.modal=null,this.isWebOnly=!1,this.isMobileWebOnly=!1,this.callArguments=null,this.actionHandler=this.actionHandler.bind(this),this.errorHandler=this.errorHandler.bind(this),this.successHandler=this.successHandler.bind(this),this.denyUIAction=this.denyUIAction.bind(this),this.allowUIAction=this.allowUIAction.bind(this),this.checkResponse=this.checkResponse.bind(this),this.getSerializedCallArguments=this.getSerializedCallArguments.bind(this),window.cur.vkAppSuccessHandler=this.successHandler,window.cur.vkAppErrorHandler=this.errorHandler}}},310338:(_,e,o)=>{o.d(e,{VKWebAppCustomMessage:()=>i.VKWebAppCustomMessage,getStore:()=>s.getStore});var i=o(265658),s=o(837207)},837207:(_,e,o)=>{o.d(e,{getStore:()=>a});var i=o(558137),s=o(32489);function l(){return{onOrdData:(0,s.createDomain)("APPS_CONNECT/VKWebAppCustomMessage").createEvent()}}function a(){return(0,i.makeSharedState)("static/js/modules/shared/apps_connect/handlers/VKWebAppCustomMessage/store.ts",l,{version:0})()}},914421:(_,e,o)=>{o.d(e,{default:()=>s});var i=o(558137);const s=new class{initCallback(){o._dG("cur",window.cur||{}),window.cur.clearVKMiniAppsLayerPopups=this.clearLayerPopups.bind(this)}get vkMiniAppsStack(){return(0,i.makeSharedState)("MiniAppsModalsStack",(()=>[]),{version:0})()}get modalCount(){return this.vkMiniAppsStack.length}push(_){_.init(),0===this.modalCount&&_.show(),this.vkMiniAppsStack.push(_)}clearLayerPopups(){if(this.modalCount>0){const _=this.vkMiniAppsStack.filter((_=>"appNode"in _&&!_.appNode.id.includes("container_layer")));this.vkMiniAppsStack.splice(0,this.modalCount),this.vkMiniAppsStack.push(..._)}}pop(_){const e=this.vkMiniAppsStack.indexOf(_);-1!==e&&(this.vkMiniAppsStack.splice(e,1),this.checkForNext())}shift(){this.vkMiniAppsStack.shift(),this.checkForNext()}checkForNext(){this.modalCount>0&&this.vkMiniAppsStack[0].show()}constructor(){this.initCallback()}}},643401:(_,e,o)=>{o.d(e,{MvkModalRoot:()=>l});var i=o(474848),s=o(220208);const l=_=>(0,i.jsx)(s.SplitLayout,{modal:_.children})},729477:(_,e,o)=>{o.d(e,{ModalRoot:()=>b,WebModalRoot:()=>u});var i=o(474848),s=o(296540),l=o(700272),a=o(234430),n=o(142278),d=o(351118),E=o(19999),c=o(575753),p=o(898848),P=o(581197);const u=_=>(0,i.jsx)(s.Suspense,{fallback:(0,i.jsx)(l.Spinner,{size:"regular"}),children:_.children});class b extends a.UIAction{updatesCoordinates(){if(this.modal&&this.modalContainer){const _=window.innerHeight||document.documentElement.clientHeight||this.modal.offsetHeight,e=c.browser.mobile?(0,p.intval)(window.scrollY):0,o=(0,P.getSize)(this.modalContainer);this.modalContainer.style.marginTop=Math.max(10,e+(_-o[1])/3)+"px"}}destroy(){this.reactInitiator.unmount(),this.props?.containerId||this.modal?.parentElement?.remove(),super.destroy()}addScroll(){this.updatesCoordinates()}createContainer(){const _="message-box-root-"+(0,d.getRandomString)(6),e=document.createElement("div");return e.id=_,document.body.appendChild(e),e}createModalLayer(){const _=document.createElement("div"),e=document.createElement("div");return _.classList.add(E.default.layerOuter),e.classList.add(E.default.layerIn),_.append(e),[_,e]}renderModal(){if(!this.ModalComponent)return;[this.modal,this.modalContainer]=this.createModalLayer();(document.querySelector(`#${this.props?.containerId}`)||this.createContainer()).append(this.modal),this.reactInitiator=(0,n.createReactInitiator)(this.ModalComponent,this.modalContainer),this.reactInitiator.render({...this.modalProps,updateCoordinates:this.updatesCoordinates.bind(this)}),this.applyRenderOptions()}applyRenderOptions(){if(!this.modal)return;const{horizontalPadding:_,verticalPadding:e,width:o,maxWidth:i,fixed:s,zIndex:l}=this.props;this.modal&&s&&this.modal.classList.add(E.default.outerFixed),_&&this.modal.style.setProperty("--modal-horizontal-padding",_),e&&this.modal.style.setProperty("--modal-vertical-padding",e),o&&this.modal.style.setProperty("--modal-width",o),i&&this.modal.style.setProperty("--modal-max-width",i),l&&this.modal.style.setProperty("--modal-z-index",l)}constructor(_,e,o){super(_,null),this.ModalComponent=e,this.modalProps=o,this.renderModal()}}},50175:(_,e,o)=>{o.d(e,{useModalData:()=>i.useModalData,useModalProps:()=>s.useModalProps});var i=o(845991),s=o(494517)},845991:(_,e,o)=>{o.d(e,{useModalData:()=>a});var i=o(293721),s=o(695066),l=o(540462);const a=()=>(0,i.useStore)((0,l.partConfigEnabled)("mini_apps_sdk_together_several_modals")?(0,s.ensureBridgeModalsService)().$modalData:(0,s.ensureBridgeModalsService)().$modalDataOld)},494517:(_,e,o)=>{o.d(e,{useModalProps:()=>a});var i=o(296540),s=o(845991),l=o(540462);const a=(_,e)=>{const o=(0,s.useModalData)(),a=o[e];return(0,i.useMemo)((()=>({..._,...(0,l.partConfigEnabled)("mini_apps_sdk_together_several_modals")?{data:a?.data,actions:a?.actions}:{data:o}})),[a?.data,o])}},534100:(_,e,o)=>{o.d(e,{LazyModalComponent:()=>O,ensureBridgeModalsService:()=>E.ensureBridgeModalsService,registerModalRenderer:()=>b,showBridgeModalBox:()=>D,showModalBox:()=>w,useModalData:()=>u.useModalData,useModalProps:()=>u.useModalProps});var i=o(474848),s=o(865708),l=o(302032),a=o(105330),n=o(142278),d=o(914421),E=o(695066),c=o(643401),p=o(729477),P=o(898848),u=o(50175);const b=_=>{const{setRenderFunction:e,resetModalData:o}=(0,E.ensureBridgeModalsService)();e(((e,i)=>{const s=(0,n.createReactInitiator)(_),l={unmount:()=>{s.unmount(),o(i)},modalId:i};s.render({modalParams:e,modalOptions:l})}))},O=({modalParams:_,loader:e,modalOptions:o,loading:s})=>{const{type:a}=_,n=(0,l.lazyModule)({loader:e(a),name:a});return(0,i.jsx)(n,{loading:s,modalParams:_,modalOptions:o})};function D(_){const e=(0,E.ensureBridgeModalsService)(),{showModal:o,updateModalData:i}=e,s=`${_.type}${(0,P.srand)()}`;return i({data:_.data??{},actions:_.actions??{},modalId:s,force:!0}),o({modalParams:_,modalId:s}),_=>i({data:_?.data??{},modalId:s})}const M=_=>e=>{const o=(0,a.isMvk)()?c.MvkModalRoot:p.WebModalRoot;return(0,i.jsx)(s.AppRootProvider,{children:(0,i.jsx)(o,{onClose:e.onClose,children:(0,i.jsx)(_,{...e})})})};function w(_,e,o){const i=M(_),s=(0,a.isMvk)()?function(_){return(0,n.createReactInitiator)(_)}(i):function(_,e={}){return{render(o){this.modalRoot=new p.ModalRoot(e,_,o),d.default.push(this.modalRoot)},unmount(){d.default.pop(this.modalRoot),this.modalRoot.destroy()}}}(i,o);return new Promise(((_,o)=>{s.render({...e||{},onClose:()=>{e?.onClose?.(),s.unmount(),_(null)},onDone:o=>{e?.onDone?.(o),s.unmount(),_(o)},onError:_=>{e?.onError?.(_),s.unmount(),o(_)}})}))}},572560:(_,e,o)=>{o.d(e,{domain:()=>i});const i=(0,o(32489).createDomain)("MINI_APPS/BRIDGE_MODAL")},695066:(_,e,o)=>{o.d(e,{ensureBridgeModalsService:()=>n});var i=o(558137),s=o(572560),l=o(32489),a=o(540462);const n=(0,i.makeSharedState)("global/bridgeModals",(()=>(({domain:_})=>{const e=_.createStore({}),o=_.createStore({}),i=_.createStore(null,{name:"renderFunction"}),s=_.createEvent("updateModalData"),n=_.createEvent("resetModalData"),d=_.createEvent("setRenderFunction"),E=_.createEvent("showModal"),c=_.createEffect({name:"showModalFx",handler:({modalParams:_,renderFunction:e,modalId:o})=>{e?.(_,o)}});return(0,l.sample)({clock:s,source:e,fn:(_,{data:e,force:o,actions:i={},modalId:s})=>{const l=_[s],a=o||!l?{data:e,actions:i}:{data:{...l?.data,...e},actions:l?.actions};return{..._,[s]:a}},target:e,filter:()=>(0,a.partConfigEnabled)("mini_apps_sdk_together_several_modals")}),(0,l.sample)({clock:s,source:o,fn:(_,{data:e,force:o})=>o?e:{..._,...e},target:o,filter:()=>!(0,a.partConfigEnabled)("mini_apps_sdk_together_several_modals")}),(0,l.sample)({clock:d,target:i}),(0,l.sample)({clock:E,source:i,fn:(_,{modalParams:e,modalId:o})=>({modalParams:e,renderFunction:_,modalId:o}),target:c}),(0,l.sample)({clock:n,source:e,fn:(_,e)=>{const o={..._};return delete o[e],o},target:e,filter:()=>(0,a.partConfigEnabled)("mini_apps_sdk_together_several_modals")}),(0,l.sample)({clock:n,source:o,fn:()=>({}),target:o,filter:()=>!(0,a.partConfigEnabled)("mini_apps_sdk_together_several_modals")}),{$modalData:e,$modalDataOld:o,$renderFunction:i,updateModalData:s,resetModalData:n,setRenderFunction:d,showModal:E}})({domain:s.domain})),{version:1})},592423:(_,e,o)=>{o.d(e,{CaptchaType:()=>d,createCaptchaPopupService:()=>E});var i=o(32489),s=o(293721),l=o(418562),a=o(311606),n=o(621745),d=function(_){return _[_.IMAGE=0]="IMAGE",_[_.AUDIO=1]="AUDIO",_}({});const E=()=>{const _=(0,s.createGate)(),e=(0,i.createEvent)(),o=(0,i.createEvent)(),d=(0,i.createEvent)(),E=(0,i.createEvent)(),c=(0,i.createEvent)(),p=(0,i.createEvent)(),P=(0,i.createEvent)(),u=(0,i.createEvent)(),b=(0,i.createEvent)(),O=(0,i.createEvent)(),D=(0,i.createEvent)();(0,i.forward)({from:_.close,to:D});const M=(0,i.createStore)("");M.on(_.open,((_,{captchaImage:e})=>e));const w=(0,i.createStore)("");w.on(_.open,((_,{captchaTrack:e})=>e));const m=(0,i.createStore)("");m.on(_.open,((_,{deviceId:e})=>e));const h=(0,i.createStore)(null);h.on(_.open,(()=>"CAPTCHA_MODAL_ACTIVE")),h.on(O,(()=>null));const C=(0,i.createStore)(null);C.on(_.open,((_,e)=>e.platform));const g=(0,i.createStore)("");g.reset(_.close),g.on(_.open,((_,{sid:e})=>e));const T=(0,i.createStore)("");T.reset(_.close),T.on([P,u],(()=>(0,l.default)()));const A=(0,i.createStore)(0);A.on(p,(_=>_+1)),A.reset(_.close);const I=(0,i.createStore)("");I.reset(_.close),I.on(e,((_,e)=>e));const R=(0,i.createStore)(!0);R.reset([_.close,p,P]),R.on(E,(()=>!0)),R.on(P,(()=>!0)),R.on(c,(()=>!1)),R.on(b,(()=>!1));const L=(0,i.createStore)(0);L.on(p,(_=>0===_?1:0));const B=(0,i.createStore)(!1);B.reset(_.close),B.on(o,(()=>!0)),B.on(d,(()=>!1));const W=(0,i.createStore)(!1);W.reset([_.close,p,P,u]),W.on(b,(()=>!0));const U=(0,i.createStore)("");U.reset([_.close,P]);const f=(0,i.createStore)(0);f.reset([_.close,D]),f.on([P,p],(()=>5));const{tick:K,isRunning:v}=(0,a.interval)({timeout:1e3,start:(0,i.merge)([P,p]),stop:D});f.on(K,(_=>_-1));const y=(0,i.createStore)(!1);y.reset(_.close);const k=(0,i.createStore)(!1);k.reset(_.close);const S=(0,i.createStore)(!0);S.reset(_.close),S.on(e,((_,e)=>""===e.trim()));const x=(0,i.createStore)(!0);return x.reset(_.close),x.on(p,(()=>!1)),(0,i.sample)({source:f,filter:_=>0===_,target:D}),(0,i.sample)({source:{isAudioPlaying:B,refreshCountdownRunning:v},fn:({isAudioPlaying:_,refreshCountdownRunning:e})=>_||e,target:[y,k]}),(0,i.sample)({clock:[_.open,u,p],source:{sid:g,hash:T,type:L,swapCount:A,platform:C,captchaImage:M,captchaTrack:w,deviceId:m,isFirst:x},fn:_=>(0,n.getCaptchaLink)(_),target:U}),(0,i.sample)({clock:P,source:{sid:g,hash:T,type:L,swapCount:A,platform:C,captchaImage:M,captchaTrack:w,deviceId:m},fn:_=>(0,n.getCaptchaLink)({..._,isRefresh:!0}),target:U}),{Gate:_,answerChanged:e,audioPlaying:o,audioPaused:d,captchaLoadingStarts:E,captchaLoadingEnds:c,captchaTypeToggled:p,captchaRefreshed:P,captchaReloaded:u,captchaLoadingErrorSet:b,closeCaptcha:O,$answer:I,$captchaLoading:R,$captchaType:L,$isAudioPlaying:B,$hasLoadCaptchaError:W,$captchaSrc:U,$refreshCountdown:f,$isRefreshButtonDisabled:y,$isCaptchaTypeToggleDisabled:k,$isSubmitButtonDisabled:S,$isCaptchaModalActive:h}}},972980:(_,e,o)=>{o.d(e,{CaptchaType:()=>i.CaptchaType,Platform:()=>s.Platform,createCaptchaPopupService:()=>i.createCaptchaPopupService});var i=o(592423),s=o(621745)},621745:(_,e,o)=>{o.d(e,{Platform:()=>l,getCaptchaLink:()=>a});var i=o(592423),s=o(586138),l=function(_){return _[_.VK_WEB=0]="VK_WEB",_[_.VK_M_WEB=1]="VK_M_WEB",_}({});const a=({sid:_,hash:e,type:o,isRefresh:l,swapCount:a,platform:n,isFirst:d,captchaImage:E,captchaTrack:c,deviceId:p})=>{const P=e?`&v=${e}`:"",u=l?"&refresh=1":"",b=!l&&a>0?"&swap_type=1":"",O=d?"&first=1":"";let D;switch(n){case 0:default:D=s.VK_WEB_APP_ID;break;case 1:D=s.VK_MVK_APP_ID}switch(o){case i.CaptchaType.IMAGE:{let e="";if(E){const _=new URLSearchParams(E);e=_.has("device_id")?_.has("device_id")&&_.get("device_id")?`${E}&s=1&width=400&resized=1`:`${E.replace("device_id=",`device_id=${p}`)}&s=1&width=400&resized=1`:`${E}&resized=1&width=400&app_id=${D}&device_id=${p}`}else e=`/captcha.php?sid=${_}&s=1&resized=1&width=400&app_id=${D}&device_id=${p}`;return`${e}${P}${u}${b}${O}`}case i.CaptchaType.AUDIO:{let e="";if(c){const _=new URLSearchParams(c);e=_.has("device_id")?_.has("device_id")&&_.get("device_id")?`${c}`:`${c.replace("device_id=",`device_id=${p}`)}`:`${c}&app_id=${D}&device_id=${p}`}else e=`/sound_captcha.php?act=get&captcha_sid=${_}&app_id=${D}&device_id=${p}`;return`${e}${P}${u}${b}${O}`}default:return""}}},267757:(_,e,o)=>{o.d(e,{BestFriendsEventType:()=>l,sendBestFriendsAnalytic:()=>a});var i=o(636576),s=o(540462),l=function(_){return _.addFriendsFromChat="add_friends_from_chat",_.clear="clear",_.moreChats="more_chats",_.selectFriendFromSearch="select_friend_from_search",_.selectChatFromSearch="select_chat_from_search",_.saveBestFriendsList="save_best_friends_list",_.updatePopupSave="update_popup_save",_.updatePopupCancel="update_popup_cancel",_.createPostFromPopupBest="create_post_from_popup_best",_.createPostFromPopupFriends="create_post_from_popup_friends",_.clickToLockFriends="click_to_lock_friends",_.clickToLockBestFriends="click_to_lock_best_friends",_.editBestFriendsFromPopup="edit_best_friends_from_popup",_.editBestFriends="edit_best_friends",_.selectBestFriends="select_best_friends",_.clickToBestFriendsEntrypoint="click_to_best_friends_entrypoint",_}({});function a(_,e){const o={event_type:_,nav_screen:e||window.cur.module};(0,s.partConfigEnabled)("best_friends_analytics_log")&&console.log(o),(0,i.statlogsValueEvent)("best_friends_product_analytic",o)}},857606:(_,e,o)=>{function i(_,e=!0){return`${e?"data-":""}ad-stat-${_}`}o.d(e,{getStatAttrName:()=>i})},248199:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{SENSITIVITY_TRIGGER_EVENT_PLAYBACK_PROGRESS:()=>SENSITIVITY_TRIGGER_EVENT_PLAYBACK_PROGRESS,logPixelEvent:()=>logPixelEventUntyped,sendPixelEvent:()=>sendPixelEvent,throttleLogPixelReachedValueEvent:()=>throttleLogPixelReachedValueEvent,triggerAdHtmlEvent:()=>triggerAdHtmlEvent});var _shared_lib_ls__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(469004),_shared_lib_common__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(898848),_shared_utils_numberHashCode__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(586227),_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(396482),_shared_lib_js_logger__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(298077),_shared_user_user_env__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(540462),_shared_feed_feed_utils__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(54998),_attributes__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(857606),_shared_pixels_utils__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(349438),_shared_feed_adblock_protection_attributes_hider__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(374339),_shared_lib_throttle__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(150585);const SENSITIVITY_TRIGGER_EVENT_PLAYBACK_PROGRESS=.01,SENSITIVITY_TRIGGER_EVENT_REACHED_SECONDS=.3,THROTTLE_TRIGGER_EVENT_SECOND=250,LS_ADS_EVENTS="ads.events",uniqueEvents=[_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_2__.PixelNames.render,_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_2__.PixelNames.viewability_measurable,_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_2__.PixelNames.viewability_unmeasurable,_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_2__.PixelNames.viewin,_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_2__.PixelNames.error],isUniqueEvent=_=>uniqueEvents.includes(_),triggerAdHtmlEvent=(el,event)=>{if(!el)return null;const statHtml=(0,_shared_feed_adblock_protection_attributes_hider__WEBPACK_IMPORTED_MODULE_7__.getAdAttribute)(el,`ad-stat-html-${event}`);if((0,_shared_feed_adblock_protection_attributes_hider__WEBPACK_IMPORTED_MODULE_7__.removeAdAttribute)(el,`ad-stat-html-${event}`),statHtml){const statElemWrap=document.createElement("div");let elem;for(statElemWrap.setAttribute("innerHTML",statHtml);elem=statElemWrap.firstChild;)if(el.appendChild(elem),"SCRIPT"===elem.tagName)try{eval(elem.innerHTML)}catch(_){(0,_shared_lib_js_logger__WEBPACK_IMPORTED_MODULE_3__.logEvalError)(_,elem.innerHTML)}}};function parsePixels(_,e){try{const e=JSON.parse(_);if(Array.isArray(e))return{pixels:e}}catch(o){if(!/^https?:\/\//.test(_))return{isInvalid:!0,pixels:[]};return{pixels:_.split("$$$").map((_=>({type:e,url:_})))}}return{pixels:[]}}const filterPixelReachedEvents=(_,e,o)=>{const i=o?.duration,s="number"==typeof o?.value&&o?.value>=0?o?.value+SENSITIVITY_TRIGGER_EVENT_REACHED_SECONDS:i&&"number"==typeof o?.pvalue&&o?.pvalue>=0?o?.pvalue*i:0,l="number"==typeof o?.pvalue&&o?.pvalue>=0?o?.pvalue+SENSITIVITY_TRIGGER_EVENT_PLAYBACK_PROGRESS:i&&s?100*s/i:0;if(s||l){const{pixelsFilter:o,pixelsRemainingFilter:i}=e.reduce(((_,e)=>(e?.pvalue&&"number"==typeof e?.pvalue&&l&&e?.pvalue<=l||e?.value&&"number"==typeof e?.value&&s&&e?.value<=s?_.pixelsFilter.push(e):_.pixelsRemainingFilter.push(e),_)),{pixelsFilter:[],pixelsRemainingFilter:[]}),a=(0,_shared_feed_adblock_protection_attributes_hider__WEBPACK_IMPORTED_MODULE_7__.getAdAttribute)(_,`ad-stat-disabled-${_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_2__.PixelNames.playhead_reached_value}`);try{if(o.length>0){(0,_shared_feed_adblock_protection_attributes_hider__WEBPACK_IMPORTED_MODULE_7__.updateAdAttribute)(_,`ad-stat-${_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_2__.PixelNames.playhead_reached_value}`,JSON.stringify(i));const e=a?JSON.parse(a):[];Array.isArray(e)&&Array.isArray(o)&&(0,_shared_feed_adblock_protection_attributes_hider__WEBPACK_IMPORTED_MODULE_7__.updateAdAttribute)(_,`ad-stat-disabled-${_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_2__.PixelNames.playhead_reached_value}`,JSON.stringify([...e,...o]))}}catch(_){console.log(`throw Pixel event error: ${_.message}`)}return o}return[]},logPixelEvent=(_,e,o)=>{if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_4__.partConfigEnabled)("ads_pixels_track_new_events_web_mvk")&&(0,_shared_feed_feed_utils__WEBPACK_IMPORTED_MODULE_5__.isOnFeedPage)())try{const i=(0,_shared_feed_feed_utils__WEBPACK_IMPORTED_MODULE_5__.getNearestPost)(_)??_;if(!(i instanceof HTMLElement))return;const s=(0,_attributes__WEBPACK_IMPORTED_MODULE_8__.getStatAttrName)(e,!1),l=(0,_shared_feed_adblock_protection_attributes_hider__WEBPACK_IMPORTED_MODULE_7__.getAdAttribute)(i,s),a=(0,_shared_feed_adblock_protection_attributes_hider__WEBPACK_IMPORTED_MODULE_7__.getAdAttribute)(i,"ad-block-uid");if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_4__.partConfigEnabled)("feed_ads_pixel_tracked_console_log")&&(0,_shared_pixels_utils__WEBPACK_IMPORTED_MODULE_6__.logIfAdPostPixelFired)(i,e),!l)return;let{isInvalid:n,pixels:d}=parsePixels(l,e);if(n&&console.log("throw Pixel parse error"),isUniqueEvent(e)&&d.length&&((0,_shared_feed_adblock_protection_attributes_hider__WEBPACK_IMPORTED_MODULE_7__.updateAdAttribute)(i,`ad-disabled-stat-${e}`,l),(0,_shared_feed_adblock_protection_attributes_hider__WEBPACK_IMPORTED_MODULE_7__.removeAdAttribute)(i,s)),a&&isUniqueEvent(e)&&d.length)try{const _=(0,_shared_utils_numberHashCode__WEBPACK_IMPORTED_MODULE_9__.numberHashCode)(`${e}${a}`),o=_shared_lib_ls__WEBPACK_IMPORTED_MODULE_0__.multiAccountLs.get(LS_ADS_EVENTS)||{};if(!o[_]){const e=(new Date).getTime()/1e3|0;o[_]=e,_shared_lib_ls__WEBPACK_IMPORTED_MODULE_0__.multiAccountLs.set(LS_ADS_EVENTS,o)}}catch(_){console.log(`throw Pixel event error: ${_.message}`)}e===_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_2__.PixelNames.playhead_reached_value&&(d=filterPixelReachedEvents(i,d,o)),d.forEach((_=>{sendPixelEvent({pixel:_})})),triggerAdHtmlEvent(i,e)}catch(_){console.log(`throw Pixel event error: ${_.message}`)}},throttleLogPixelReachedValueEvent=(0,_shared_lib_throttle__WEBPACK_IMPORTED_MODULE_10__.throttle)(((_,e)=>{logPixelEvent(_,_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_2__.PixelNames.playhead_reached_value,e)}),THROTTLE_TRIGGER_EVENT_SECOND);function sendPixelEvent({pixel:_,adEl:e}){if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_4__.partConfigEnabled)("feed_ads_pixel_tracked_console_log")&&(0,_shared_pixels_utils__WEBPACK_IMPORTED_MODULE_6__.logPixelSent)(_.type,_,e),_.url){(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_1__.vkImage)().src=_.url}}const logPixelEventUntyped=(_,...e)=>{if(_ instanceof HTMLElement)return logPixelEvent(_,...e)}},349438:(_,e,o)=>{o.d(e,{logIfAdPostPixelFired:()=>c,logPixelSent:()=>E});var i=o(396482),s=o(540462),l=o(374339),a=o(962724);const n=(_,e,o,i)=>{console.debug(`[ads pixels log][debug] Pixel "${_}" is touched${e?` with text "${e}"`:""}`,o,i)},d=(_,e,o)=>{n(_,"Pixel rich conditions and fired to track",e,o)},E=(_,e,o)=>{n(_,"Pixel sent",e,o)},c=(_,e,o)=>{if(o)return void d(e,void 0,_);const n=(0,s.partConfigEnabled)("post_adblock_protection_promo")?a.Locator.getInstance().lookupSelector(i.AD_POST_CLASS_SELECTOR):i.AD_POST_CLASS_SELECTOR;(_.classList.contains(n.replaceAll(".",""))||(0,l.hasAdElementAttributes)(_))&&d(e,void 0,_)}},400160:(_,e,o)=>{o.d(e,{ArticleTtsActionType:()=>s,articleTtsActionStatController:()=>l});var i=o(314309),s=function(_){return _.START="start",_.PAUSE="pause",_.CONTINUE="continue",_.SEEK="seek",_.CLOSE="close",_.P10="10p",_.P25="25p",_.P50="50p",_.P75="75p",_.P95="95p",_.P99="99p",_.P100="100p",_}({});const l=new class{logEvent(_,e){const o={type:"type_marusia_reading_item",type_marusia_reading_item:_};this.actionStatCollector.logEvent(o,e)}constructor(){this.productStatCollector=new i.ProductionStatCollector,this.actionStatCollector=new i.ActionStatCollector(this.productStatCollector)}}},160971:(_,e,o)=>{o.d(e,{feedCommentsSortTabClickCollector:()=>l});var i=o(317216),s=o(314309);const l=new class{logEvent(_,e){const o={...this.productionStatCollector.getBaseEvent(_.ref),type:i.ClickProductionStatEventTypes.TYPE_FEED_COMMENTS_SORT_TAB_CLICK,[i.ClickProductionStatEventTypes.TYPE_FEED_COMMENTS_SORT_TAB_CLICK]:_};this.clickStatCollector.logEvent(o,e)}constructor(){this.productionStatCollector=new s.ProductionStatCollector,this.clickStatCollector=new s.ClickStatCollector(this.productionStatCollector)}}},652547:(_,e,o)=>{o.d(e,{CLIP_MAX_LIMIT:()=>D,CLIP_MIN_LIMIT:()=>O,checkStopActionOnEventOnShortVideo:()=>u,formatNumberTranslation:()=>b,getThumb:()=>p,getUrlToOwnerFeedShortVideo:()=>M,isLockedVideo:()=>P});var i=o(351118),s=o(908671),l=o(501397),a=o(866467),n=o(105330),d=(o(615650),o(188546)),E=o(540462),c=o(468073);function p(_,e,o){const s=o&&(0,i.isRetina)()?2:1,a=((0,i.isNumber)(e)?e:e.width||0)*s,n=((0,i.isNumber)(e)?0:e.height||0)*s;if((0,E.partConfigEnabled)("disable_common_covers_of_videos")){if(!_?.length)return;const e=(0,d.findBaseImage)(_);if(e)return(0,d.getBaseImageUrl)(e.url,a,n);(0,l.logError)(new Error(`Unexpectedly no base picture. ${_[0].url}`))}const c=_.filter((_=>!_.with_padding));return(0,i.getPhotoSize)(c.length?c:_,a,n)?.url}function P(_,e){return Boolean(e?.userIsAdmin)&&Boolean(_.privacyView&&!function(_){return function(_,e){return!_.category||!e.length||e.includes(_.category)}(_,["all","any"])&&0===(_?.excludedCategory?.length||0)&&0===(_?.lists?.allowed?.length||0)&&0===(_?.lists?.excluded?.length||0)&&0===(_?.owners?.allowed?.length||0)&&0===(_?.owners?.excluded?.length||0)}(_.privacyView))}const u=_=>{const e=_?.target,o=new RegExp(`^https?:\\/\\/${n.VK_HOST_REGEX_UNSAFE.source}\\/clip(-?\\d+_\\d+)$`);return!!e?.href&&o.test(e.href)};function b(_,e){return`${(0,s.formatCount)(_)} ${(0,a.langNumeric)(_>=1e3?1e3:_,e)}`}const O=1,D=60;function M(_,e,o){let i=o;return i||(i=c.Ranges.isGroupId(_)?`club${c.Ranges.convertOwnerIdToGroupId(_)}`:`id${_}`),`/clips/${i}/feed/clip${_}_${e}`}},565703:(_,e,o)=>{o.d(e,{STICKERS_CONFDATA_KEY:()=>s,isNewStickerPicker:()=>l,isPromoVmojiCounterEnabled:()=>n,isUGCStickersEnabled:()=>a});var i=o(540462),s=function(_){return _.UGC="stickers.ugc",_.PROMO_VMOJI_COUNTER="vmoji.promo.avatar_suggestion.promo_counter",_.NEW_STICKER_PICKER="new_sticker_picker",_}({});function l(){return(0,i.partConfigEnabled)("new_sticker_picker")}function a(){return(0,i.partConfigEnabled)("stickers.ugc")}function n(){return(0,i.partConfigEnabled)("vmoji.promo.avatar_suggestion.promo_counter")}},33732:(_,e,o)=>{o.d(e,{POPUP_STICKER_CLASS:()=>l,POPUP_STICKER_ICON_CLASS:()=>a,POPUP_STICKER_ICON_CLASS_ANIMATED:()=>n,POPUP_STICKER_ICON_CLASS_ROTATED:()=>d,POPUP_STICKER_WRAPPER_CLASS:()=>i,POPUP_STICKER_WRAPPER_CLASS_ANIMATION_IS_PLAYING:()=>s,STICKER_CLASS:()=>E,StickersSettingsApiMethods:()=>c});const i="popupStickerWrapper",s="popupStickerWrapperAnimationIsPlaying",l="popupSticker",a="popupStickerIcon",n="popupStickerIconAnimated",d="popupStickerIconRotated",E="stickerImageWrapper",c={getSettings:"stickers.getSettings",setPopupSettings:"stickers.setPopupSettings"}},586227:(_,e,o)=>{function i(_){let e=0;if(0===_.length)return e;for(let o=0,i=_.length;o<i;o++){e=(e<<5)-e+_.charCodeAt(o),e|=0}return e}o.d(e,{numberHashCode:()=>i})},38462:(_,e,o)=>{function i(_){try{_.offsetWidth,_.offsetHeight}catch(_){}}o.d(e,{reflow:()=>i})},395846:(_,e,o)=>{o.d(e,{ACCESS_DENIED_CODE:()=>D,CLIP_UPLOAD_MAX_FILE_SIZE_IN_GB:()=>E,SHORT_VIDEO_UPLOAD_EXTS:()=>s,SHORT_VIDEO_UPLOAD_INPUT_ACCEPT:()=>a,VIDEO_DEFAULT_THUMB_ID:()=>O,VIDEO_UPLOAD_CHUNK_MAX_RETRY_NUMBER:()=>P,VIDEO_UPLOAD_CHUNK_SIZE:()=>c,VIDEO_UPLOAD_EXTS:()=>l,VIDEO_UPLOAD_FILE_THREAD_NUMBER:()=>p,VIDEO_UPLOAD_INPUT_ACCEPT:()=>n,VIDEO_UPLOAD_MAX_FILE_SIZE_IN_GB:()=>d,VIDEO_UPLOAD_SUBTITLES_DISABLED:()=>u,VIDEO_UPLOAD_SUBTITLES_USER_LANG:()=>b});const i=_=>["video/*",..._.map((_=>`.${_}`))].join(","),s="avi mp4 3gp mpeg mov flv f4v wmv mkv webm vob rm rmvb m4v mpg ogv ts m2ts mts mxf".split(" "),l=[...s,"torrent"],a=i(s),n=i(l),d=5,E=8,c=4194304,p=4,P=10,u=-1,b=-2,O="0_0",D=15},615650:(_,e,o)=>{o.d(e,{ErrorCodes:()=>c,checkFileType:()=>E,getUploadErrorInfo:()=>P,getUploadErrorText:()=>p,getVideoMetadata:()=>n,getVideoSize:()=>d,sendVideoMetadataStatsBeforeUpload:()=>u});var i=o(866467),s=o(395846),l=o(314309),a=o(317216);function n(_){return new Promise((e=>{try{const o=document.createElement("video");o.preload="metadata",o.onloadedmetadata=()=>{const _=o.duration||0,i=o.videoWidth,s=o.videoHeight;e({duration:_,width:i,height:s})},o.onerror=()=>e(null),o.src=window.URL.createObjectURL(_)}catch(_){e(null)}}))}function d(_){return _.size}function E(_,e){const o=(_.name.split(".").pop()||"").toLowerCase(),i=(e||s.VIDEO_UPLOAD_EXTS).includes(o);return!!(_.type&&_.type.match(/^video/i)||i)}var c=function(_){return _[_.SHORT_VIDEO_TOO_SHORT=100]="SHORT_VIDEO_TOO_SHORT",_[_.SHORT_VIDEO_TOO_LONG=101]="SHORT_VIDEO_TOO_LONG",_[_.INCORRECT_PUBLISH_DATE=-1]="INCORRECT_PUBLISH_DATE",_[_.LIMIT_POSTPONE_POSTS=-2]="LIMIT_POSTPONE_POSTS",_[_.LIMIT_POSTPONE_POSTS_PER_DAY=-3]="LIMIT_POSTPONE_POSTS_PER_DAY",_[_.SAME_POSTPONE_POST_DATE=-4]="SAME_POSTPONE_POST_DATE",_[_.LIMIT_POSTS_PER_DAY=-5]="LIMIT_POSTS_PER_DAY",_[_.SHORT_VIDEO_CONVERT=20]="SHORT_VIDEO_CONVERT",_[_.CLAIMED_NOT_UPLOADED=15]="CLAIMED_NOT_UPLOADED",_}({});function p(_,e){switch(_){case 100:return(0,i.getLang)("video_upload_encode_error_too_short_1s");case 101:return(0,i.getLang)("video_upload_encode_error_too_long");case 20:return(0,i.getLang)("video_upload_error_uploading");case-1:return(0,i.getLang)("video_upload_error_incorrect_publish_date");case-2:return(0,i.getLang)("video_upload_error_limit_postpone_posts");case-3:return(0,i.getLang)("video_upload_error_day_limit_postpone_posts");case-4:return(0,i.getLang)("video_upload_error_same_publish_date");case-5:return(0,i.getLang)("video_upload_error_day_limit_posts");default:return e||(0,i.getLang)("global_unknown_error")}}function P(_){switch(_){case-2:return(0,i.getLang)("video_upload_error_info_limit_postpone_posts");case-3:return(0,i.getLang)("video_upload_error_info_day_limit_postpone_posts");case-4:return(0,i.getLang)("video_upload_error_info_same_publish_date")}}const u=async(_,e,o)=>{const i=await n(_);i?.duration&&i?.width&&l.videoUploadStatsCollector.logEvent({event_type:a.VideoUploadActionEventTypes.DECODE_VIDEO_METAINFO,video_owner_id:e,video_id:o,decode_metainfo:JSON.stringify({width:i.width,height:i.height,video_duration:i.duration,format:(_.name.split(".").pop()||"").toLowerCase()})})}},787476:(_,e,o)=>{o.d(e,{generateLatinizedName:()=>p,isPublishNameCorrect:()=>d,updateArticleSnippetsFromQueueByPost:()=>n});var i=o(298077),s=o(898848),l=o(540462);o(6204),o(983567),o(801746),o(792112),o(908166),o(358172),o(392358),o(449299),o(866467);const a="article_snippet";function n(_){if(!window.vk.id)return;if(!(0,l.partConfigEnabled)("update_private_snippets_by_queue"))return;const e=Array.from(_.querySelectorAll(`.${a}`));if(!e.length)return;const o=[];e.forEach((_=>{if(!window.vk.id||!_.dataset.needUpdate)return;const e=_.dataset.articleRawId;e&&o.push({article_raw_id:e,post_raw_id:_.dataset.postId,is_mini_snippet:(0,s.intval)(_.dataset.isMiniSnippet)})})),o.length&&window.ajax.post("al_articles.php",{act:"get_snippets",article_snippets:JSON.stringify(o)},{onDone:_=>{e.forEach((e=>{e.dataset.articleRawId&&_[e.dataset.articleRawId]&&(e.outerHTML=_[e.dataset.articleRawId])}))},onFail:()=>((0,i.logError)(new Error("Fail: updateArticleSnippetsFromQueueByPost")),!0)})}function d(_){return!!/^[a-z0-9\-]+$/.test(_)&&(!_.includes("--")&&(!_.startsWith("-")&&!_.endsWith("-")&&!(_.length>60)))}const E=[{to:"a",from:"[ÀÁÂÃÄÅÆĀĂĄẠẢẤẦẨẪẬẮẰẲẴẶ]"},{to:"c",from:"[ÇĆĈČ]"},{to:"d",from:"[ÐĎĐÞ]"},{to:"e",from:"[ÈÉÊËĒĔĖĘĚẸẺẼẾỀỂỄỆ]"},{to:"g",from:"[ĜĞĢǴ]"},{to:"h",from:"[ĤḦ]"},{to:"i",from:"[ÌÍÎÏĨĪĮİỈỊ]"},{to:"j",from:"[Ĵ]"},{to:"ij",from:"[Ĳ]"},{to:"k",from:"[Ķ]"},{to:"l",from:"[ĹĻĽŁ]"},{to:"m",from:"[Ḿ]"},{to:"n",from:"[ÑŃŅŇ]"},{to:"o",from:"[ÒÓÔÕÖØŌŎŐỌỎỐỒỔỖỘỚỜỞỠỢǪǬƠ]"},{to:"oe",from:"[Œ]"},{to:"p",from:"[ṕ]"},{to:"r",from:"[ŔŖŘ]"},{to:"s",from:"[ßŚŜŞŠ]"},{to:"t",from:"[ŢŤ]"},{to:"u",from:"[ÙÚÛÜŨŪŬŮŰŲỤỦỨỪỬỮỰƯ]"},{to:"w",from:"[ẂŴẀẄ]"},{to:"x",from:"[ẍ]"},{to:"y",from:"[ÝŶŸỲỴỶỸ]"},{to:"z",from:"[ŹŻŽ]"}],c={1072:"a",1073:"b",1074:"v",1075:"g",1076:"d",1077:"e",1105:"e",1078:"zh",1079:"z",1080:"i",1081:"i",1082:"k",1083:"l",1084:"m",1085:"n",1086:"o",1087:"p",1088:"r",1089:"s",1090:"t",1091:"u",1092:"f",1093:"h",1094:"c",1095:"ch",1096:"sh",1097:"sch",1099:"y",1101:"e",1102:"u",1103:"ya"};function p(_,e){_=_.toLowerCase();let o="",i=!1;const s="-qwertyuiopasdfghjklzxcvbnm0123456789".split("");E.forEach((e=>{_=_.replace(new RegExp(e.from,"gi"),e.to)}));for(let e=0;e<_.length;e++)if(/\s/.test(_[e]))i||(o+="-",i=!0);else if(s.includes(_[e]))o+=_[e],i=!1;else{let s=c[_.charCodeAt(e)];s&&(o+=s,i=!1)}return o=o.substr(0,e),o=o.replace(/-*$/,"").replace(/^-*/,"").replace(/-+/g,"-"),o}},303279:(_,e,o)=>{o.d(e,{handleCaptcha:()=>d});var i=o(657472),s=o(540462),l=o(265668),a=o(270959),n=o(345601);const d=_=>new Promise((async(e,o)=>{const d=_.redirect_uri;if(d)try{const o=await(0,l.showCaptchaSDK)(d);return void e({captcha_key:"",captcha_sid:_.captcha_sid,is_sound_captcha:0,success_token:o})}catch(_){if(_===i.CaptchaSDKEvents.CLOSE||_===i.CaptchaSDKEvents.OPENED)return void o()}if((0,s.partConfigEnabled)("vkcom_audio_captcha_enabled"))(0,n.showCaptchaPopup)({sid:_.captcha_sid,isRefreshEnabled:_.is_refresh_enabled,isSoundCaptchaAvailable:_.is_sound_captcha_available,captcha_track:_.captcha_track,captcha_img:_.captcha_img,onSubmit:(o,i)=>{e({captcha_sid:_.captcha_sid,captcha_key:o,is_sound_captcha:i})},onClose:()=>{o()}});else{let i=null;const l=(0,s.partConfigEnabled)("vkcom_captcha_resized")?`${_.captcha_img}&resized=1&width=400`:_.captcha_img,n=_?.is_refresh_enabled||!1,d={imgSrc:l,onSubmit:(_,o)=>{e({captcha_sid:_,captcha_key:o,is_sound_captcha:0}),i&&i.hide()},onHide:()=>{o()}};i=(0,a.showCaptchaBox)(_.captcha_sid,!1,null,d,n)}}))},345601:(_,e,o)=>{o.d(e,{showCaptchaPopup:()=>i.showCaptchaPopup});var i=o(630988)},236087:(_,e,o)=>{o.d(e,{CaptchaType:()=>i.CaptchaType,Platform:()=>i.Platform,captchaPopupService:()=>s});var i=o(972980);const s=(0,i.createCaptchaPopupService)()},630988:(_,e,o)=>{o.d(e,{showCaptchaPopup:()=>a});var i=o(474848),s=o(211413),l=o(98341);function a(_){(0,s.showMessageBoxModal)((e=>(0,i.jsx)(l.CaptchaPopup,{...e,..._,onClose:()=>{_.onClose&&_.onClose(),e.onClose()},onSubmit:(o,i)=>{_.onSubmit&&(_.onSubmit(o,i),e.onClose())}})),{width:300,onDestroy:()=>{_.onClose&&_.onClose()}})}},681735:(_,e,o)=>{o.d(e,{CaptchaAnswerField:()=>c});var i=o(474848),s=o(296540),l=o(44544),a=o(220208),n=o(236087),d=o(866467),E=o(293721);const c=(0,s.forwardRef)((({disabled:_,captchaType:e},o)=>{const c=(0,s.useRef)(null),p=(0,s.useRef)(null),P=(0,E.useStore)(n.captchaPopupService.$answer),u=(0,E.useEvent)(n.captchaPopupService.answerChanged);return(0,s.useImperativeHandle)(o,(()=>({inputFieldRef:c,inputLabelRef:p}))),(0,i.jsx)(l.FormItem,{mode:"vertical",noPadding:!0,top:e===n.CaptchaType.AUDIO?(0,i.jsx)("div",{tabIndex:0,ref:p,children:(0,d.getLang)("vkconnect_auth_audio_captcha_title")}):"",children:(0,i.jsx)(a.Input,{getRef:c,tabIndex:0,value:P,placeholder:e===n.CaptchaType.IMAGE?(0,d.getLang)("vkconnect_auth_label_captcha"):(0,d.getLang)("vkconnect_auth_label_captcha_audio_new_ux"),disabled:_,onChange:_=>u(_.target.value)})})}))},766969:(_,e,o)=>{o.d(e,{CaptchaAnswerField:()=>i.CaptchaAnswerField});var i=o(681735)},200831:(_,e,o)=>{o.d(e,{CaptchaError:()=>E});var i=o(474848),s=o(866467),l=o(293721),a=o(236087),n=o(220208),d=o(279734);const E=(0,o(296540).forwardRef)((({captchaType:_},e)=>{const o=(0,l.useEvent)(a.captchaPopupService.captchaReloaded);return(0,i.jsxs)(n.Footer,{children:[(0,i.jsx)(i.Fragment,{children:_===a.CaptchaType.IMAGE?(0,s.getLang)("vkconnect_auth_captcha_loading_error_caption"):(0,s.getLang)("vkconnect_auth_audio_captcha_loading_error_caption")}),(0,i.jsx)(d.Link,{onClick:o,getRootRef:e,role:"button","aria-label":_===a.CaptchaType.IMAGE?(0,s.getLang)("vkconnect_auth_captcha_image_loading_error_retry_aria_label"):(0,s.getLang)("vkconnect_auth_captcha_sound_loading_error_retry_aria_label"),children:(0,s.getLang)("vkconnect_auth_captcha_loading_error_refresh_text")})]})}))},165317:(_,e,o)=>{o.d(e,{CaptchaError:()=>i.CaptchaError});var i=o(200831)},932829:(_,e,o)=>{o.d(e,{CaptchaInfoButton:()=>E});var i=o(474848),s=o(296540),l=o(684797),a=o(454154),n=o(723723),d=o(866467);const E=(0,s.forwardRef)((({onClick:_},e)=>(0,i.jsx)(a.Button,{getRootRef:e,tabIndex:0,appearance:"neutral",mode:"tertiary",size:"m",before:(0,i.jsx)(l.Icon24InfoCircleOutline,{className:(0,n.getColorClass)("color_icon_secondary")}),"aria-label":(0,d.getLang)("vkconnect_auth_audio_captcha_info_text"),onClick:_})))},438105:(_,e,o)=>{o.d(e,{CaptchaInfoButton:()=>i.CaptchaInfoButton});var i=o(932829)},132015:(_,e,o)=>{o.d(e,{CaptchaPopup:()=>R});var i=o(474848),s=o(296540),l=o(293721),a=o(694244),n=o(220208),d=o(63614),E=o(303800),c=o(293116),p=o(700272),P=o(194528),u=o(175400),b=o(454154),O=o(866467),D=o(540462),M=o(836410),w=o(165317),m=o(740557),h=o(318029),C=o(766969),g=o(246407),T=o(438105),A=o(24343),I=o(236087);const R=({sid:_,isRefreshEnabled:e,isSoundCaptchaAvailable:o,captcha_track:R,captcha_img:L,onSubmit:B,onClose:W})=>{(0,l.useGate)(I.captchaPopupService.Gate,{sid:_,platform:I.Platform.VK_WEB,captchaTrack:R,captchaImage:L,deviceId:(0,g.getDeviceId)(I.Platform.VK_WEB)});const U=(0,D.partConfigEnabled)("vkcom_captcha_new_ux"),f=(0,l.useEvent)(I.captchaPopupService.captchaLoadingEnds),K=(0,l.useStore)(I.captchaPopupService.$hasLoadCaptchaError),v=(0,l.useStore)(I.captchaPopupService.$captchaLoading),y=(0,l.useEvent)(I.captchaPopupService.captchaLoadingErrorSet),k=(0,l.useStore)(I.captchaPopupService.$captchaType),S=(0,l.useStore)(I.captchaPopupService.$answer),x=(0,l.useStore)(I.captchaPopupService.$captchaSrc),N=(0,l.useStore)(I.captchaPopupService.$isSubmitButtonDisabled),F=(0,l.useStore)(I.captchaPopupService.$isCaptchaTypeToggleDisabled),j=(0,l.useEvent)(I.captchaPopupService.captchaTypeToggled),H=(0,l.useStore)(I.captchaPopupService.$isRefreshButtonDisabled),V=(0,l.useEvent)(I.captchaPopupService.captchaRefreshed),G=(0,l.useStore)(I.captchaPopupService.$refreshCountdown),q=(0,s.useRef)(null),$=(0,s.useRef)(null),Y=(0,s.useRef)(null),z=(0,s.useRef)(null),X=(0,s.useRef)(null),Q=(0,s.useRef)(null),Z=(0,s.useRef)(null),J=(0,s.useRef)(null),__=k===I.CaptchaType.AUDIO,[e_,t_]=(0,s.useState)(!1),o_=(0,l.useStore)(I.captchaPopupService.$isAudioPlaying),i_=_=>{_.preventDefault(),B&&B(S,Number(__))},s_=(0,s.useCallback)((_=>{const e=J.current||Z.current||$.current,i=Y.current,s=z.current,l=X.current,a=q?.current?.inputFieldRef.current,n=q?.current?.inputLabelRef.current,d=Q.current,{activeElement:E}=document,c=[e,i,s,l,a,n,d].includes(E)?E:e;if("Space"===_.code&&[i,s,l,d,e].some((_=>c===_))){_.preventDefault();c.click()}function p(){__&&!s?.disabled?s?.focus():P()}function P(){l?.disabled?u():l?.focus()}function u(){__&&n?n?.focus():b()}function b(){a?.disabled?O():a?.focus()}function O(){U||!d?.disabled?d?.focus():D()}function D(){e?.focus()}if(o&&"Tab"===_.key&&!_.shiftKey&&c)switch(_.preventDefault(),c){case e:U||!i?.disabled?i?.focus():p();break;case i:p();break;case s:P();break;case l:u();break;case n:b();break;case a:O();break;case d:D()}function M(){a?.disabled?w():a?.focus()}function w(){__?n?.focus():m()}function m(){l?.disabled?h():l?.focus()}function h(){__?s?.focus():C()}function C(){U||!i?.disabled?i?.focus():g()}function g(){e?.focus()}if(o&&"Tab"===_.key&&_.shiftKey&&c)switch(_.preventDefault(),c){case e:U||!d?.disabled?d?.focus():M();break;case d:M();break;case a:w();break;case n:m();break;case l:h();break;case s:C();break;case i:g()}}),[o,U,__]);(0,s.useEffect)((()=>(document.removeEventListener("keydown",s_),document.addEventListener("keydown",s_),()=>{document.removeEventListener("keydown",s_)})),[s_]),(0,s.useEffect)((()=>{if(__){const _=_=>{_.ctrlKey&&!o_&&J?.current?.click()};return document.addEventListener("keydown",_),()=>{document.removeEventListener("keydown",_)}}}),[__,o_]),(0,s.useEffect)((()=>{const _=$.current;!v&&k===I.CaptchaType.IMAGE&&_&&(_.tabIndex=0,_.ariaLabel=(0,O.getLang)("vkconnect_auth_captcha_image_aria_label"),_.focus()),v||k!==I.CaptchaType.AUDIO||J.current?.focus()}),[v,k]),(0,s.useEffect)((()=>{const _=Z.current;K&&_&&_.focus()}),[K]);return(0,i.jsxs)(a.ModalBox,{children:[(0,i.jsx)(n.ModalDismissButton,{onClick:W}),(0,i.jsx)(d.ModalBody,{insetLevel:1,children:(0,i.jsxs)(E.Div,{mode:"vertical",spacing:4,paddingTop:8,paddingBottom:8,children:[(0,i.jsxs)(c.Image,{getRef:$,alt:(0,O.getLang)("vkconnect_auth_captcha_image_aria_label"),src:k===I.CaptchaType.IMAGE?x:"",onLoad:f,onError:y,widthSize:268,heightSize:102,children:[v&&(0,i.jsx)(p.Spinner,{}),!v&&K&&(0,i.jsx)(w.CaptchaError,{ref:Z,captchaType:k}),!K&&__&&(0,i.jsx)(M.SoundCaptcha,{ref:J,src:x,disabled:!U&&o_})]}),(0,i.jsx)(P.Spacing,{size:6}),(0,i.jsxs)(u.ButtonGroup,{mode:"horizontal",stretched:!0,gap:"s",style:{justifyContent:"space-between"},children:[e&&(0,i.jsx)(m.CaptchaRefreshButton,{ref:Y,newCaptchaUX:U,disabled:!U&&(H||__&&(v||K)),countdownValue:G,captchaType:k,onRefresh:()=>{V(),U&&q?.current?.inputFieldRef.current?.focus()}}),(__||o)&&(0,i.jsxs)(u.ButtonGroup,{mode:"horizontal",gap:"s",children:[__&&(0,i.jsx)(T.CaptchaInfoButton,{ref:z,onClick:()=>{t_((_=>!_))}}),o&&(0,i.jsx)(h.CaptchaTypeButton,{ref:X,disabled:!U&&F,captchaType:k,onToggle:()=>{j(),U&&q?.current?.inputFieldRef.current?.focus()}})]})]}),__&&e_&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(P.Spacing,{size:8}),(0,i.jsx)(A.InfoBanner,{})]}),(0,i.jsx)(P.Spacing,{size:16}),(0,i.jsxs)("form",{onSubmit:i_,children:[(0,i.jsx)(C.CaptchaAnswerField,{ref:q,disabled:__&&(v||K),captchaType:k}),(0,i.jsx)(P.Spacing,{size:12}),(0,i.jsx)(u.ButtonGroup,{mode:"vertical",align:"center",stretched:!0,children:(0,i.jsx)(b.Button,{getRootRef:Q,size:"l",stretched:!0,disabled:!U&&(N||__&&(v||K)),onClick:i_,tabIndex:0,children:(0,O.getLang)("vkconnect_auth_captcha_submit_button")})})]})]})})]})}},98341:(_,e,o)=>{o.d(e,{CaptchaPopup:()=>i.CaptchaPopup});var i=o(132015)},740557:(_,e,o)=>{o.d(e,{CaptchaRefreshButton:()=>c});var i=o(474848),s=o(296540),l=o(399440),a=o(454154),n=o(723723),d=o(236087),E=o(866467);const c=(0,s.forwardRef)((({newCaptchaUX:_,disabled:e,countdownValue:o,captchaType:s,onRefresh:c},p)=>(0,i.jsx)(a.Button,{getRootRef:p,disabled:e,size:"m",appearance:"neutral",mode:"tertiary",before:(0,i.jsx)(l.Icon24Refresh,{className:(0,n.getColorClass)("color_icon_secondary")}),"aria-label":s===d.CaptchaType.IMAGE?(0,E.getLang)("vkconnect_auth_captcha_refresh_button_aria_label"):(0,E.getLang)("vkconnect_auth_captcha_refresh_audio_button_aria_label_new_ux"),tabIndex:0,onClick:c,children:_||!o?(0,E.getLang)("vkconnect_refresh_captcha"):(0,E.langReplace)((0,E.getLang)("vkconnect_refresh_captcha_via"),{time:String(o)})})))},298161:(_,e,o)=>{o.d(e,{CaptchaTypeButton:()=>p});var i=o(474848),s=o(296540),l=o(236087),a=o(784298),n=o(655733),d=o(454154),E=o(723723),c=o(866467);const p=(0,s.forwardRef)((({disabled:_,captchaType:e,onToggle:o},s)=>(0,i.jsx)(d.Button,{getRootRef:s,disabled:_,size:"m",appearance:"neutral",mode:"tertiary",before:e===l.CaptchaType.IMAGE?(0,i.jsx)(a.Icon24Headphones,{className:(0,E.getColorClass)("color_icon_secondary")}):(0,i.jsx)(n.Icon24TextOutline,{className:(0,E.getColorClass)("color_icon_secondary")}),onClick:o,"aria-label":e===l.CaptchaType.IMAGE?(0,c.getLang)("vkconnect_auth_captcha_enable_audio_aria_label"):(0,c.getLang)("vkconnect_auth_captcha_enable_image_aria_label"),tabIndex:0})))},318029:(_,e,o)=>{o.d(e,{CaptchaTypeButton:()=>i.CaptchaTypeButton});var i=o(298161)},772243:(_,e,o)=>{o.d(e,{InfoBanner:()=>n});var i=o(474848),s=o(327626),l=o(866467),a=o(428937);const n=()=>(0,i.jsx)(s.Banner,{noPadding:!0,size:"s",subheader:(0,l.getLang)("vkconnect_auth_audio_captcha_info_text"),mode:"image",imageTheme:"light",background:(0,i.jsx)("div",{className:a.default.background})})},24343:(_,e,o)=>{o.d(e,{InfoBanner:()=>i.InfoBanner});var i=o(772243)},104413:(_,e,o)=>{o.d(e,{SoundCaptcha:()=>u});var i=o(474848),s=o(296540),l=o(589066),a=o(384081),n=o(723723),d=o(271036),E=o(866467),c=o(366176),p=o(293721),P=o(236087);const u=(0,s.forwardRef)((({src:_,disabled:e},o)=>{const u=(0,s.useRef)(null),b=(0,p.useEvent)(P.captchaPopupService.audioPlaying),O=(0,p.useEvent)(P.captchaPopupService.audioPaused),D=(0,p.useEvent)(P.captchaPopupService.captchaLoadingErrorSet),M=(0,p.useEvent)(P.captchaPopupService.captchaLoadingStarts),w=(0,p.useEvent)(P.captchaPopupService.captchaLoadingEnds),m=(0,p.useStore)(P.captchaPopupService.$isAudioPlaying),h=(0,p.useStore)(P.captchaPopupService.$captchaLoading);return(0,s.useEffect)((()=>{const e=u.current;_&&e&&e.load()}),[_]),(0,i.jsxs)(i.Fragment,{children:[_&&(0,i.jsx)("audio",{ref:u,preload:"none",src:_,onLoadStart:M,onCanPlay:w,onPlay:b,onPause:O,onError:D}),!h&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l.IconIllustrationSoundWaveLeft36h,{className:(0,n.getColorClass)(m?"color_icon_accent_themed":"color_icon_tertiary")}),(0,i.jsx)(d.IconButton,{getRootRef:o,size:52,disabled:e,"aria-label":(0,E.getLang)("vkconnect_auth_captcha_play_audio_button_aria_label_new_ux"),className:(0,n.getColorClass)("color_text_accent_themed"),tabIndex:0,onClick:()=>{const _=u.current;_?.readyState||_?.load(),_?.play().catch((()=>{D()}))},children:(0,i.jsx)(c.Icon40PlayCircle,{})}),(0,i.jsx)(a.IconIllustrationSoundWaveRight36h,{className:(0,n.getColorClass)(m?"color_icon_accent_themed":"color_icon_tertiary")})]})]})}))},836410:(_,e,o)=>{o.d(e,{SoundCaptcha:()=>i.SoundCaptcha});var i=o(104413)},246407:(_,e,o)=>{o.d(e,{getDeviceId:()=>n});var i=o(553608),s=o(418562),l=o(236087);const a="vk_web_captcha_device_id",n=_=>{let e;switch(_){case l.Platform.VK_WEB:e=a;break;case l.Platform.VK_M_WEB:e="vk_m_web_captcha_device_id";break;default:e=a}let o=i.vkLocalStorage.getItem(e);return o||(o=(0,s.default)(),i.vkLocalStorage.setItem(e,o)),o}},622048:(_,e,o)=>{o.d(e,{TOOLTIP_SUCCESS_EVENT:()=>s,TooltipEventService:()=>l});var i=o(734990);const s="group_tooltip_success_event",l={onUploadAvatar:()=>{window.dispatchEvent(new CustomEvent(s,{detail:i.OnboardingTooltipIds.Avatar}))},onUploadCover:()=>{window.dispatchEvent(new CustomEvent(s,{detail:i.OnboardingTooltipIds.Cover}))},onAddPost:()=>{window.dispatchEvent(new CustomEvent(s,{detail:i.OnboardingTooltipIds.Post}))},onAddMarketItem:()=>{window.dispatchEvent(new CustomEvent(s,{detail:i.OnboardingTooltipIds.MarketItem}))},onAddServiceItem:()=>{window.dispatchEvent(new CustomEvent(s,{detail:i.OnboardingTooltipIds.ServiceItem}))}}},734990:(_,e,o)=>{o.d(e,{OnboardingTooltipIds:()=>i});var i=function(_){return _.Avatar="business_groups_web:avatar",_.Cover="business_groups_web:cover",_.ActionButton="business_groups_web:action_button",_.MarketItem="business_groups_web:add_item",_.ServiceItem="business_groups_web:add_service",_.Post="business_groups_web:make_post",_.Dov="business_groups_web:fill_dov",_.Trigger="business_groups_web:ui_trigger",_}({})},292985:(_,e,o)=>{o.d(e,{sendExpandStats:()=>n});var i=o(153663),s=o(317216),l=o(666994),a=o(870465);function n(_){if(!_)return;const e=(0,i.getTrackCodeFromPost)(_);l.feedInteractionItemStatCollector.logEvent({track_code:e??void 0,ref:(0,i.resolveRefFromCur)(),item:(0,a.getFeedInteractionItemType)()},s.EventItemType.EXPAND)}},377330:(_,e,o)=>{o.d(e,{renderNewPostInFeed:()=>n});var i=o(581197),s=o(390199),l=o(538522),a=o(540462);function n(_,e,o){let n="feed";return["wall","profile","groups","wall_donut","public"].includes(window.cur?.module)&&(n="wall"),new Promise(((d,E)=>{window.ajax.post("al_wall.php",{act:"s_one",post_id:_,owner_id:e,render_context:n,only_post:!0},{onDone:(n,c)=>{if(document.getElementById(`post${(0,l.joinRawId)({ownerId:e,itemId:_})}`))return E();if(!n)return E();const p=(0,i.createElementFromHTML)(n);if(!p)return E();let P;if(o||"own"===window.cur.wallTab?p.classList.add("all","own"):p.classList.add("all"),p.classList.contains("postponed")){if("postponed"===window.cur.wallTab&&(P=document.getElementById("page_postponed_posts"),P)){const _=Number(p.querySelector(".rel_date")?.dataset?.date),e=P.children?Array.from(P.children).find((e=>Number(e.querySelector(".rel_date")?.dataset?.date)>_)):null,o=document.querySelector("#postponed_show_more");e?(e.before(p),window.Wall?.postponedPosts?.updateOffset(1)):_?o||(P.appendChild(p),window.Wall?.postponedPosts?.updateOffset(1)):(P.insertAdjacentElement("afterbegin",p),window.Wall?.postponedPosts?.updateOffset(1))}return window.Wall?.updateTabVisibility("page_wall_postponed",!0),window.Wall?.postponeUpdateCount((window.wall?.postponedPosts?.postsSize||window.cur.postponedPostsCount||0)+1),d()}if(p.classList.contains("suggest")){const _=c&&c.was_deleted;if("suggested"===window.cur.wallTab&&(P=document.getElementById("page_suggested_posts"),P&&!_&&P.insertAdjacentElement("afterbegin",p)),!_){window.Wall?.updateTabVisibility("page_wall_suggest",!0);const _=Number(document.querySelector(".page_wall_suggested_cnt")?.innerHTML||0)+1;window.Wall?.updateTabCounter("page_wall_suggested_cnt",_)}return d()}if(p.classList.contains("donut"))return"donut"===window.cur.wallTab&&(P=document.getElementById("page_donut_posts"),P&&P.insertAdjacentElement("afterbegin",p)),window.Wall?.updateTabVisibility("page_wall_donut",!0),d();if(P=(0,a.partConfigEnabled)("feed_fix_render_new_post")?document.getElementById("page_wall_posts")||document.getElementById("feed_rows"):document.getElementById("page_wall_posts"),!P)return E();let u=P.firstChild;for(;u&&("INPUT"==u.tagName||1!=u.nodeType||u.classList.contains("post_fixed"));)u=u.nextSibling;if(!u)return E();let b=["all","own"];(0,a.partConfigEnabled)("feed_fix_render_new_post")&&b.push("feed"),(window.cur.wallTab&&b.includes(window.cur.wallTab)||(0,a.partConfigEnabled)("feed_fix_render_new_post")&&window.cur.wallTab&&["suggested","postponed"].includes(window.cur.wallTab))&&P.insertBefore(p,u),(0,s.highlightUpdatedPost)(p),d()}})}))}},60411:(_,e,o)=>{o.d(e,{handleOrdMiniappOpen:()=>E});var i=o(494565),s=o(52905),l=o(866467),a=o(310338),n=o(432465),d=o(545537);const E=(_,e,o,E)=>{const c=E?{..._,service:E}:_,p=c?(0,i.objectToQuerystring)(c,"#"):"",P=(0,a.getStore)().onOrdData.watch((i=>{o?.isSnackbar&&(i?.is_ad&&!_?.is_ad?(0,n.showSnackbar)({text:(0,l.getLang)("global_ads_wall_post_ord_mark_as_ads_added"),timeout:3e3,type:"ok28"}):!i?.is_ad&&_?.is_ad&&(0,n.showSnackbar)({text:(0,l.getLang)("global_ads_wall_post_ord_mark_as_ads_removed"),timeout:3e3,type:"loudspeaker28"})),e(i,o?.ref),P()}));o=o||{};const u={...o,options:{...o.options||{}}},{onDestroy:b,onLoaded:O}=u.options;u.options.asBox?u.options.onDestroy=(..._)=>{b?.(..._),P()}:u.options.onLoaded=(..._)=>{O?.(..._),(0,d.addWkViewHideQueue)((()=>P()))},window.showWiki?.({w:`app${s.ORD_APP_ID}${p}`},u?.edit,u?.ev,u?.options)}},345235:(_,e,o)=>{o.d(e,{highlightModule:()=>c});var i=o(402096),s=o(137771),l=o(672277),a=o(754866),n=o(342018);let d,E;function c(_){const e=document.getElementById(_.module);if(!e||!e.classList.contains("module"))return;window.cur.__narrowBarForceNotFixed=!0;const o=_.speed?_.speed:300;(0,l.scrollToY)((0,a.getXY)(e)[1]-100,o);const c=()=>{d&&(d.hideTT(),(0,l.enableBodyScroll)(),delete window.cur.__narrowBarForceNotFixed,(0,s.updateNarrow)(),_.onClose&&_.onClose())};d=new i.default(e,_.text,{highlight:!0,width:250,offset:[0,-17],side:"bottom",withCloseButton:!0,onBGClick:c,onCloseButtonClick:c}),d.show(),(0,l.disableBodyScroll)(),_.autoCancelDelay&&(E=setTimeout((()=>{c(),E=null}),_.autoCancelDelay),(0,n.pushNavDestroy)((()=>{E&&clearTimeout(E)})))}},51839:(_,e,o)=>{o.d(e,{PostponedPosts:()=>b,isPostponedPostsActResult:()=>M,isPostponedPostsParallelLoadingEnabled:()=>O,isPostponedPostsUpdateEnabled:()=>D});var i=o(761520),s=o(540462),l=o(342018),a=o(150585),n=o(866467),d=o(898848),E=o(278693),c=o(772127),p=o(867888);function P(_){return new Promise(((e,o)=>{i.ajax.post("al_wall.php",{act:"get_postponed",..._},{onDone:_=>{e(_)},onFail:_=>{o(_)},local:1})}))}function u(_){const e=document.querySelector("#page_postponed_posts");e&&e.insertAdjacentHTML("beforeend",_)}class b{setLock(_){this.lock=_,this.lock?this.showMoreButton.lock():this.showMoreButton.unlock()}static new(){return new b}getPostsSize(){return this.postsSize}updateOffset(_){this.offset=this.offset+_}isLocked(){return this.lock}updateState(_){Object.assign(this,_)}toggleSort(){this.sort="sort_desc"===this.sort?"sort_asc":"sort_desc"}canStartInitialLoading(){const _=document.querySelector("#page_postponed_posts");return 0===this.offset||""===_?.innerHTML.trim()}areAllPostsLoaded(){return this.offset>=this.postsSize}getNextPosts(){this.setLock(!0),P({offset:this.offset,owner_id:this.ownerId,sort:this.sort}).then((_=>{u(_.rendered_posts),this.offset=this.offset+this.limit,this.restoreLoadingState()})).catch((()=>{this.restoreLoadingState()}))}initPaginationAndShowMoreButton(){this.areAllPostsLoaded()||(this.showMoreButton.renderInWallModule(),O()||this.paginate())}paginationHandler(){const{scrollTop:_,scrollHeight:e,clientHeight:o}=document.documentElement;_+o>=(this.offset<2*this.limit?0:e/2)&&!this.areAllPostsLoaded()&&!this.lock&&this.getNextPosts()}destroyPagination(){window.removeEventListener("scroll",this.throttledPaginationHandler)}paginate(){return window.addEventListener("scroll",this.throttledPaginationHandler,{passive:!0}),(0,l.pushNavDestroy)(this.destroyPagination.bind(this)),this.destroyPagination}removePost(){this.postsSize-=1,this.offset-=1}restorePost(){this.postsSize+=1,this.offset+=1}cleanUp(){this.destroyPagination(),this.showMoreButton.remove()}cleanUpOnNavigation(){this.cleanUp(),this.makeInitialState()}makeInitialState(){this.offset=0,this.postsSize=0,this.lock=!1,this.ownerId=0,this.limit=0,this.sort="sort_asc"}restoreLoadingState(){this.setLock(!1),this.areAllPostsLoaded()&&(this.showMoreButton.remove(),this.destroyPagination())}chunkedPostponedPostRequests(_=0){const e=this.postsSize||1;return(0,p.rangeWithStep)(this.limit,e,_).map((_=>P({offset:_,owner_id:window.cur.oid??0,sort:this.sort})))}loadInParallel(_,{onLoaded:e,onError:o},i){this.setLock(!0),(0,c.trackStartWithMarkName)(c.POSTPONED_POSTS_PARALLEL_LOADING_MARK);const s=this.chunkedPostponedPostRequests(_);Promise.all(s).then((_=>{const o=(0,c.trackEndWithMarkName)(c.POSTPONED_POSTS_PARALLEL_LOADING_MARK),s=_.map((_=>_.rendered_posts)).reduce(((_,e)=>_+e),""),l=_?.[0]?.count,a=_?.[0]?.limit;(0,c.saveLoadingStats)(c.POSTPONED_STATS_KEY,o.duration,{type:"parallel",action:i?"after_posting":"just_loading",offset:this.offset,limit:a,postsSize:l,userId:window.cur.oid??0,hasError:!1}),this.offset=l,this.limit=a,this.postsSize=l,this.restoreLoadingState();e({count:l,limit:a,rendered_posts:s})})).catch((_=>{this.restoreLoadingState();const e=(0,c.trackEndWithMarkName)(c.POSTPONED_POSTS_PARALLEL_LOADING_MARK),s=(0,c.getErrorMessage)(_);(0,c.saveLoadingStats)(c.POSTPONED_STATS_KEY,e.duration,{type:"parallel",action:i?"after_posting":"just_loading",offset:this.offset,limit:this.limit,postsSize:this.postsSize,userId:window.cur.oid??0,hasError:!1,errorMessage:s}),o?.(_)}))}loadInitialForPagination({onLoaded:_,onError:e}){this.setLock(!0),P({offset:0,owner_id:window.cur.oid??0,sort:this.sort}).then((e=>{_(e),this.postsSize=e.count,this.offset=e.limit,this.ownerId=window.cur.oid??0,this.limit=e.limit,this.initPaginationAndShowMoreButton(),this.restoreLoadingState()})).catch((_=>{e?.(_),this.restoreLoadingState()}))}loadOnTabReturn(){this.initPaginationAndShowMoreButton()}loadAfterPosting(_){this.postsSize=_.count,this.limit=_.limit,this.offset=_.limit,this.ownerId=window.cur.oid??0,this.cleanUp(),this.initPaginationAndShowMoreButton()}loadAllAfterPosting(_){this.cleanUp(),this.areAllPostsLoaded()||(this.initPaginationAndShowMoreButton(),this.loadInParallel(_.starts_from??0,{onLoaded:_=>{u(_.rendered_posts)}},!0))}constructor(){this.throttledPaginationHandler=(0,a.throttle)(this.paginationHandler.bind(this),500).bind(this),this.offset=0,this.postsSize=0,this.lock=!1,this.ownerId=0,this.limit=0,this.sort="sort_asc",this.showMoreButton=E.ShowMoreButton.new((0,n.getLang)("wall_post_text_show_more"),{onClick:this.getNextPosts.bind(this)}),this.destroyPagination=this.destroyPagination.bind(this)}}function O(){return(0,s.partConfigEnabled)("wall_postponed_posts_parallel_loading_web")}function D(){return(0,s.partConfigEnabled)("wall_postponed_posts_update_enabled_web")}function M(_){return!!_&&(!("string"==typeof _||!(0,d.isObject)(_))&&"rendered_posts"in _)}},772127:(_,e,o)=>{o.d(e,{POSTPONED_POSTS_PARALLEL_LOADING_MARK:()=>l,POSTPONED_STATS_KEY:()=>s,getErrorMessage:()=>a,saveLoadingStats:()=>n,trackEndWithMarkName:()=>E,trackStartWithMarkName:()=>d});o(636576);var i=o(101272);const s="wall_postponed_posts_stats",l="postponed_posts_parallel_loading_mark";function a(_){return _?"string"==typeof _?_:_ instanceof Error&&_.message?_.message:"Unknown error":"Unknown error"}function n(_,e,o){(0,i.saveStatlogEvents)({name:_,value:e,keys:[o]})}function d(_){window.cur.postponedPostsPerformanceMarks||(window.cur.postponedPostsPerformanceMarks={}),window.cur.postponedPostsPerformanceMarks[_]=performance.now()}function E(_){return window.cur.postponedPostsPerformanceMarks&&window.cur.postponedPostsPerformanceMarks[_]?{duration:performance.now()-+window.cur.postponedPostsPerformanceMarks[_]}:{duration:-1}}},278693:(_,e,o)=>{o.d(e,{ShowMoreButton:()=>s});var i=o(952661);class s{static new(_,e){return new s(_,e)}putInContainer(){this.container=document.createElement("div"),this.container.style.display="flex",this.container.style.justifyContent="center",this.container.style.marginBottom="16px",this.container.append(this.button)}lock(){i.FlatButton.lock(this.button)}unlock(){i.FlatButton.unlock(this.button)}remove(){this.container?.remove()}renderInWallModule(){this.container||this.putInContainer();const _=document.querySelector(".wall_module");_?.append(this.container)}constructor(_,{onClick:e}){this.button=i.FlatButton.render({children:_,appearance:i.FlatButtonAppearance.SECONDARY,size:i.FlatButtonSize.M}),this.onClick=e,this.button.addEventListener("click",this.onClick),this.button.id="postponed_show_more"}}},867888:(_,e,o)=>{function i(_,e,o=0){return Array.from(Array(Math.ceil((e-o)/_)).keys()).map((e=>e*_+o))}o.d(e,{rangeWithStep:()=>i})},468479:(_,e,o)=>{o.d(e,{ignoreAdsItem:()=>n});var i=o(374339),s=o(115939),l=o(892848),a=o(540462);const n=(_,e,o,n,d="",E=0,c="")=>{let p=`post${_}`;(0,a.partConfigEnabled)("post_adblock_protection_promo")&&(p=s.AdBlockPostMasker.getInstance().getMaskedPostId(p));const P=document.querySelector(`#${p}`),u=(0,i.getAdAttribute)(P,"ad"),b=P.querySelector(".ui_actions_menu_wrap");return b&&window.uiActionsMenu.toggle(b,!1),(0,l.revertLastInlineVideo)(P),new Promise(((i,s)=>{window.ajax.post("/al_feed.php",{act:"a_ignore_item",post_raw:_,track_code:c,feed_raw:e,hash:o,uids:d,ad_data:u,no_html:1,reason_id:E},{onDone:function(){P.style.display="none",i()},onFail:s})}))}},763879:(_,e,o)=>{o.d(e,{isAdPostMarkingAsSpam:()=>a});var i=o(374339),s=o(115939),l=o(540462);const a=_=>{let e=`post${_}`;(0,l.partConfigEnabled)("post_adblock_protection_promo")&&(e=s.AdBlockPostMasker.getInstance().getMaskedPostId(e));const o=document.querySelector(`#${e}`);return!!o&&(0,i.getAdAttribute)(o,"ad")}},497719:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{markAdAsSpam:()=>markAdAsSpam});var _shared_feed_adblock_protection_attributes_hider__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(374339),_shared_feed_adblock_protection_post_masker__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(115939),_web_lib_ui__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(683234),_web_lib_revertLastInlineVideo__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(892848),_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(237625),_shared_user_user_env__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(540462);const markAdAsSpam=(el,post,hash,inline)=>{let postElementId=`post${post}`;(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_5__.partConfigEnabled)("post_adblock_protection_promo")&&(postElementId=_shared_feed_adblock_protection_post_masker__WEBPACK_IMPORTED_MODULE_1__.AdBlockPostMasker.getInstance().getMaskedPostId(postElementId));const adDataPost=document.querySelector(`#${postElementId}`),adData=(0,_shared_feed_adblock_protection_attributes_hider__WEBPACK_IMPORTED_MODULE_0__.getAdAttribute)(adDataPost,"ad");if(!el)return;window.ajax.post("al_wall.php",{act:"spam",post,ad_data:adData,hash,from:inline?"inline":""},{onDone:function(msg,js,js2){if("string"!=typeof js&&js2&&(js=js2),inline){const _=document.createElement("div");_.innerHTML=msg,el.parentNode?.replaceChild(_,el)}else{const postSelector=`#${postElementId}`,r=el.closest(postSelector)||document.querySelector(postSelector),t=r?.querySelector("._post_content")||r?.querySelector(".feedback_row_t");(0,_web_lib_revertLastInlineVideo__WEBPACK_IMPORTED_MODULE_3__.revertLastInlineVideo)(r);const pd=document.querySelector(`#post_del${post}`);if(pd)pd.innerHTML=msg,pd.style.display="block";else{const _=document.createElement("div");_.innerHTML=msg,_.id=`post_del${post}`,r?.appendChild(_)}if(t.style.display="none",js)try{eval(js)}catch(_){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_4__.logEvalError)(_,js)}adData&&window.Wall._setAdReportHandler(post,adData,hash)}},showProgress:function(){if(el&&el.classList.contains("ui_actions_menu_item"))(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_2__.lockActionsMenuItem)(el);else if(inline){const _=document.createElement("span");_.classList.add("progress_inline"),el.style.display="none";const e=el.nextSibling||el?.parentNode?.appendChild(_);if(!e)return;e.style.display="block"}},hideProgress:function(){el&&el.classList.contains("ui_actions_menu_item")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_2__.unlockActionsMenuItem)(el):inline&&(el.style.display="block",el.nextSibling?.remove())},stat:[window.jsc("web/privacy.js"),"privacy.css"]});const btn=document.querySelector(`#delete_post${post}`);btn&&btn.tt&&btn.tt.el&&btn.tt.destroy()}},763270:(_,e,o)=>{o.d(e,{markAsSpam:()=>u});var i=o(497719),s=o(763879),l=o(415033),a=o(317216),n=o(237625),d=o(866467),E=o(153663),c=o(540462),p=o(666994),P=o(870465);const u=(_,e,o,u,b)=>{if((0,s.isAdPostMarkingAsSpam)(e))return void(0,i.markAdAsSpam)(o,e,u,b);const[O,D]=e.split("_");window.Feed?.viewStats?.onReport(o);const M=(0,E.getTrackCodeFromPost)(o),w=(0,E.resolveRefFromCur)();M&&"wall"===_&&(0,c.partConfigEnabled)("feed_content_events_report_web")&&p.feedInteractionItemStatCollector.logEvent({track_code:M??void 0,ref:w,item:(0,P.getFeedInteractionItemType)()},a.EventItemType.REPORT),(0,l.showReportForm)(_,Number(O),Number(D),(()=>{const _=document.querySelector(`#post${O}_${D}`);null!==_?_.innerHTML=`<div class="dld">${(0,d.getLang)("global_report_sent")}</div>`:(0,n.debugLog)("unable to find wall item")}),void 0,void 0,void 0,void 0,M||void 0)}},488737:(_,e,o)=>{o.d(e,{showIgnoreItemReasons:()=>O});var i=o(374339),s=o(115939),l=o(892848),a=o(248199),n=o(396482),d=o(952661),E=o(153663),c=o(683234),p=o(468479),P=o(540462),u=o(549906),b=o(754866);const O=(_,e,o,O,D,M="",w="",m)=>{let h=`post${e}`;(0,P.partConfigEnabled)("post_adblock_protection_promo")&&(h=s.AdBlockPostMasker.getInstance().getMaskedPostId(h));let C=document.querySelector(`#${h}`);if(!C)return;m&&window.cur.feedEntriesHTML&&(window.cur.feedEntriesHTML[e]=(0,b.val)(C));const g=(0,i.getAdAttribute)(C,"ad");(0,l.revertLastInlineVideo)(C),(0,a.logPixelEvent)(C,n.PixelNames.closed_by_user),window.ajax.post("/al_wall.php",{act:"get_ignore_reasons",post_raw:e,feed_raw:o,caption_type:D,uids:M,hash:O,ad_data:g,mode:w},{onDone:function(_,i){C.innerHTML=_;const s="ad_hide_"+e,l=document.querySelector(`#${s}_send`);if(i&&m&&((0,b.val)(C,_),(0,u.evalWithLogging)(i)),!l)return;const a=document.querySelector(`#${s}`);if(!a)return;const n=[...a.querySelectorAll(".radiobtn")],c=a.querySelector(".radiobtn.on");window.radioBtns[s]={val:c?.dataset?.value||1,els:n},l.addEventListener("click",(()=>{d.FlatButton.lock(l);const _=window.radioBtns[s].val,i="feed"===w?window.Feed?.ignoreItem:p.ignoreAdsItem,a=(0,E.getTrackCodeFromPost)(C);if(!i)return;const n=i(e,o,O,D,M,_,a);n&&n.then((()=>{window.Wall.triggerAdStat(C,"hide"),delete window.radioBtns[s]})).catch((()=>d.FlatButton.unlock(l)))}))},showProgress:function(){_&&_.classList.contains("ui_actions_menu_item")&&(0,c.lockActionsMenuItem)(_)},hideProgress:function(){_&&_.classList.contains("ui_actions_menu_item")&&(0,c.unlockActionsMenuItem)(_)}})}},164043:(_,e,o)=>{o.d(e,{isVotingLocked:()=>d,showReportVotingForm:()=>E});var i=o(683234),s=o(754866),l=o(237625),a=o(866467),n=o(65759);const d=_=>{const e=(0,s.geByClass)("_media_voting"+_);let o=!1;return e.forEach((_=>{(0,s.hasClass)(_,"media_voting_locked")&&(o=!0)})),o},E=(_,e)=>{if((0,i.actionsMenuItemLocked)(_))return;let o,E,c;const p=void 0!==e.id;if(p)o=e.id,E=e.isBoard;else{if(c=(0,s.gpeByClass)("media_voting",_),null===c&&(0,l.debugLog)("Unable to show report voting form because there is no .media_voting element"),o=(0,s.domData)(c,"id"),d(o))return;E=(0,s.domData)(c,"board")}const P=E?"board_poll":"poll";(0,n.showReportForm)(P,0,o,(()=>{if(!p&&null!==c){const _=c.querySelector("._report_voting_button");if(null==_)return void(0,l.debugLog)("Unable to disable report voting button, because it cannot be found");_.innerHTML=(0,a.getLang)("global_report_sent"),_.onclick=null}}))}},554311:(_,e,o)=>{o.d(e,{getNavigableTabs:()=>s,showHiddenNavigableTabs:()=>l});var i=o(754866);const s=_=>{const e=[],o=document.querySelector("#wall_tabs");return o?Array.from(o.querySelectorAll(".ui_tab")).filter((e=>{const o=e.parentNode;return null!==o&&o!==_&&!(0,i.hasClass)(o,"unshown")&&!(0,i.matchesSelector)(o,'[data-ui-tab="no_posts"]')})):e},l=()=>{const _=document.querySelector("#wall_tabs"),e=_?.querySelector(".page_wall_no_posts");e?.remove(),(0,i.removeClass)(document.querySelector("#wall_tabs"),"page_tabs_hidden")}},163790:(_,e,o)=>{o.d(e,{getReactionsButtonPostTemplate:()=>u,getReactionsButtonReplyTemplate:()=>b,likeDataReactionsFields:()=>M});var i=o(540462),s=o(754866),l=o(865556),a=o(66663),n=o(369296),d=o(888065),E=o(673006);const c=(_,e,o)=>{const i=(_=>{try{const e=JSON.parse(_);if(null!==e&&"object"!=typeof e)return;return e}catch(_){return}})(_)?.set_id,l="string"==typeof i?i:void 0;if(!e||!l)return;const d=(0,a.getReactionSet)(l);return d?{likeClassName:"like_btn--hidden PostBottomAction--hidden",template:(0,s.rs)(e,{reactions_button_title:(0,n.getDefaultReactionTitle)(d)||"",reactions_set_id:l,badges_object_type:E.BadgesObjectType.WALL,badges_object_owner_id:o?.objectOwnerId||0,badges_object_id:o?.objectId||0,badges_ref:E.BadgesEventRef.POST_BTN})}:void 0},p=(_,e)=>e.length>_,P=_=>{const e=_[2],[o,i]=e.split("_");return{objectOwnerId:Number(o),objectId:Number(i)}},u=(_,e)=>{const o=P(_),i=e?.wallTpl?.post_likes_reactions,s=p(14,_)?_[14]:void 0;if("string"==typeof s)return c(s,i,o)},b=(_,e)=>{const o=P(_),s=e?.wallTpl?.reply_likes_reactions;if(!(0,i.partConfigEnabled)("reactions_enabled_post_replies"))return;const l=p(14,_)?_[14]:void 0;return"string"==typeof l?c(l,s,o):void 0},O=_=>{let e=JSON.parse(_);if(null===e||"object"==typeof e||Array.isArray(e)){if(Array.isArray(e)){e=(0,d.reactionCountsBrandWrap)((o=e,Object.assign({},o)))}var o;return e}},D=_=>{const e=p(5,_)?_[5]:void 0;if("string"!=typeof e)return;const o=(_=>{const e=_.indexOf(";"),o=_.substr(0,e),i=_.substr(e+1);if("1"===o)return O(i)})(e);return o?{counts:o}:void 0},M=_=>{const e=D(_);return{[l.REACTIONS_COUNTS_RESPONSE_FIELD]:e?.counts}}},65759:(_,e,o)=>{o.d(e,{ReportReasonIds:()=>p,afterCommentReportSubmit:()=>P,showReportForm:()=>d.showReportForm});var i=o(237625),s=o(866467),l=o(168066),a=o(864448),n=o(303279),d=o(415033),E=o(416368);(0,l.initApi)();const c=window.vk;(0,a.setLoginConfig)({onCaptcha:n.handleCaptcha,domain:c?.apiConfigDomains?.loginDomain}),(0,a.setApiConfig)({onCaptcha:n.handleCaptcha,domain:c?.apiConfigDomains?.apiDomain,challenge:E.processFetchChallenge});var p=function(_){return _[_.NotOriginalContent=28]="NotOriginalContent",_}({});function P(_,e,o){const l=function(_,e,o){switch(_){case"photo":return`#post${e}photo_${o}`;case"video":return`#post${e}video_${o}mv`;case"market":return`#post${e}market_${o}`}}(_,e,o);if("photo"===_){const _=document.querySelector(`${l} .dld`);null!==_&&(_.outerHTML="")}const a=document.querySelector(`${l} .reply_wrap`);null!==a?(a.style.display="none",a.outerHTML+=`<div class="dld">${(0,s.getLang)("global_report_sent")}</div>`):(0,i.debugLog)(`Unable to hide report button for ${_} comment`)}},415033:(_,e,o)=>{o.d(e,{showReportForm:()=>E});var i=o(474848),s=o(725669),l=o(211413),a=o(540462),n=o(319756),d=o(792242);function E(_,e,E,c,p,P,u,b,O,D){if((0,a.partConfigEnabled)("reports_miniapp")){const a=(0,s.asyncComponent)((()=>Promise.all([o.e(91498),o.e(89631),o.e(91303),o.e(58459),o.e("langs/web/MiniApp")]).then(o.bind(o,288355))),(({MiniApp:_})=>_));(0,l.showMessageBoxModalSuspense)((o=>(0,i.jsx)(a,{onSubmit:c,query:{from:u,adData:b,trackCode:O,type:_,sourceOwnerId:e,sourceId:E},disabledNavOnClose:D,...o})),{onDestroy:p})}else if("user"===_&&(0,a.partConfigEnabled)("content_reports_new_profile_form")){const _=(0,s.asyncComponent)((()=>Promise.all([o.e(91498),o.e(89631),o.e(66434),o.e("langs/web/ReportsProfileModal")]).then(o.bind(o,863927))),(({ReportsProfileModal:_})=>_)),a=_=>{window.location.assign(_)};(0,l.showMessageBoxModalSuspense)((o=>(0,i.jsx)(n.DIRootWebProvider,{children:(0,i.jsx)(_,{userId:e,onRedirect:a,onSilentModalShow:d.showSilentModeFormBox,...o})})),{onDestroy:p})}else{const a=(0,s.asyncComponent)((()=>Promise.all([o.e(91498),o.e(89631),o.e(99595),o.e("langs/web/ReportForm")]).then(o.bind(o,716729))),(({ReportForm:_})=>_));(0,l.showMessageBoxModalSuspense)((o=>(0,i.jsx)(a,{...o,trackCode:O||void 0,reportSource:_,reportSourceOwnerId:e,reportSourceId:E,onSubmit:c,messengerAdditionalData:P,from:u,adData:b})),{onDestroy:p})}}},996849:(_,e,o)=>{o.d(e,{checkStopActionOnEventOnSticker:()=>p,checkStopActionOnEventOnStickerPopupIcon:()=>c,previewSticker:()=>a,showPackByClickOnSticker:()=>n,wrapSticker:()=>E});var i=o(614098),s=o(565703),l=o(33732);const a=(_,e,o)=>window.Emoji.previewSticker(_,!1,{sticker_referrer:o??"message",randomPackAttemptId:e}),n=(_,e)=>{(0,s.isNewStickerPicker)()?window.StickerPickerViewer?.api.getPack({productId:_}).then((o=>{Boolean(o?.product?.active)?window.StickerPickerViewer?.showPack(_,e):a(_)})).catch((()=>{a(_)})):window.Emoji.getStickerPack(_).then((o=>{Boolean(o&&o[window.Emoji.PACK_FIELD_IS_ACTIVE])?window.Emoji.showPackInKeyboard(_,e):a(_)}))},d=_=>`stickerSize${_}`,E=({stickerHtml:_,stickerWrapperClass:e="",icon:o,iconClass:s,size:l,iconTqAttrs:a})=>{const n=o?`<div class="${i.STICKER_ICON_CLASS} ${s}" ${a}>${o}</div>`:"";return`\n  <div class="${[i.STICKER_ROW_CLASS,e,d(l)].join(" ")}">\n    ${_}\n    ${n}\n  </div>\n`},c=_=>{const e=_?.target;return!!e?.closest("."+l.POPUP_STICKER_ICON_CLASS)},p=_=>{const e=_?.target;return!!e?.closest("."+i.STICKER_ROW_CLASS)||(!!e?.closest("."+l.POPUP_STICKER_WRAPPER_CLASS)||!!c(_))}},118628:(_,e,o)=>{o.d(e,{UPDATE_NARRATIVE_BLOCK_EVENT_NAME:()=>P,highlightNarrativeBlock:()=>D,prepareStoriesForPublishing:()=>b,updateNarrativeBlock:()=>O,updateNarrativeSnippetsFromQueueByPost:()=>M});var i=o(754866),s=o(246429),l=o(345235),a=o(866467),n=o(898848),d=o(298077),E=o(540462),c=o(810068),p=o(901089);const P="update_narrative_block",u="NarrativeSnippet";function b(_){return _.map((_=>_.id)).join(",")}function O(_=!1){const e=(0,n.intval)(window.cur.oid);if(!c.Ranges.isUserId(e)||"profile"!==window.cur.module)if(window.cur.narrativeBlock){const _=document.getElementById(`narratives_module${e}_wrapper`);if(_)window.ajax.post("al_stories.php",{act:"get_narrative_block",owner_id:e},{onDone:e=>{const o=(0,n.intval)(window.cur.oid);if(e)(0,i.domReplaceEl)(_,e),window.cur.narrativeBlock&&window.cur.narrativeBlock.destroy(),window.NarrativeBlock&&(window.cur.narrativeBlock=new window.NarrativeBlock);else{const e=_.parentElement;e?.children.length&&e?.children.length>1?_.remove():e?.remove(),window.cur.narrativeBlock&&window.cur.narrativeBlock.destroy(),delete window.cur.narrativeBlock}(0,p.removeStoryList)(`narratives${o}`)}});else if(window.cur.narrativeBlock.gallery){const _=document.querySelector('#group_tabs_content .group-tab-content[data-tab="narratives"]');_&&window.ajax.post("al_stories.php",{act:"get_narratives_tab",owner_id:e},{onDone:e=>{_.innerHTML=e}})}}else _&&function(_){window.boxQueue.hideAll();const e=document.querySelector("#box_layer_wrap"),o=document.querySelector("#box_loader");window.nav.reload({onDone:()=>{_&&_()},showProgress:()=>{(0,i.show)(e),(0,i.show)(o),(0,s.refreshBoxLoaderCoords)()},hideProgress:()=>{(0,i.hide)(e),(0,i.hide)(o)}})}((()=>{window.cur.needNarrativeOnboard=!0}))}function D(_){if(!_)return;const e=`narratives_module${window.vk.id}`;(0,l.highlightModule)({module:e,text:(0,a.getLang)("stories_narrative_block_onboarding_text"),onClose:()=>{delete window.cur.needNarrativeOnboard,window.ajax.post("al_index.php",{act:"hide_feature_tt",hash:_,type:"profile_narrative"})},autoCancelDelay:1e4,speed:600})}function M(_){if(!window.vk.id)return;if(!(0,E.partConfigEnabled)("update_private_snippets_by_queue"))return;const e=Array.from(_.querySelectorAll(`.${u}`));if(!e.length)return;const o=[];e.forEach((_=>{if(!window.vk.id||!_.dataset.needUpdate)return;const e=_.dataset.narrativeRawId;e&&o.push({narrative_raw_id:e,from:_.dataset.from})})),o.length&&window.ajax.post("al_stories.php",{act:"get_narrative_snippets",narrative_snippets:JSON.stringify(o)},{onDone:_=>{e.forEach((e=>{e.dataset.narrativeRawId&&_[e.dataset.narrativeRawId]&&(e.outerHTML=_[e.dataset.narrativeRawId])}))},onFail:()=>((0,d.logError)(new Error("Fail: updateNarrativeSnippetFromQueueByPost")),!0)})}},429748:(_,e,o)=>{o.d(e,{scrollOutsideFixedReplyArea:()=>l});var i=o(754866),s=o(330447);const l=(_,e)=>{if(!(_ instanceof HTMLElement&&e instanceof HTMLElement))return;const o="fixed"===(0,i.getStyle)(e,"position"),l=void 0!==window.cur.wallLayer;if(!o){if(l)return;const _=e.closest(".replies_wrap");return void(_&&(_=>{const e=(0,i.clientHeight)();if(_.getBoundingClientRect().bottom>e){const o=(0,i.getXY)(_)[1]+(0,i.getH)(_)-e;(0,s.setActiveAreaScroll)(o)}})(_))}const a=_.getBoundingClientRect(),n=20-(e.getBoundingClientRect().top-a.bottom);n>0&&(0,s.scrollActiveAreaToYDelta)(n)}},348320:(_,e,o)=>{o.d(e,{postSubscribeHandlerInit:()=>w,subscribeByAction:()=>O,subscribeByButton:()=>D,subscribeToAuthor:()=>b});var i=o(683234),s=o(593159),l=o(754866),a=o(270959),n=o(761520),d=o(866467),E=o(349835),c=o(903401),p=o(810068),P=o(869071);const u="_subscribed";function b(_,e,o,i,s){const l={onFail:_=>{setTimeout((0,a.showFastBox)((0,d.getLang)("global_error"),_).hide,3e3)},...i};s=s||{},p.Ranges.isUserId(e)?n.ajax.post("al_friends.php",{act:_?"remove":"add",mid:e,hash:o,from:"post_subscribe_button",...s},l):n.ajax.post("al_groups.php",{act:_?"list_leave":"list_enter",gid:-e,hash:o,...s},l)}function O(_,e,o,n){if((0,i.actionsMenuItemLocked)(_))return;const E=(0,s.intval)((0,l.domData)(_,"value"))?1:0;let c={showProgress:()=>(0,i.lockActionsMenuItem)(_),hideProgress:()=>(0,i.unlockActionsMenuItem)(_)};const P={};p.Ranges.isUserId(e)&&n?P.from=n:p.Ranges.isGroupId(e)&&(c={...c,onDone:(i,s,n)=>{if(s){const _=(0,a.showFastBox)((0,d.getLang)("global_warning"),s,(0,d.getLang)("group_leave_group"),(()=>{_.hide(),b(E,e,o,c,{confirm:1})}),(0,d.getLang)("global_cancel"));return!0}(0,l.val)(_,i),_.setAttribute("data-value",String(1-E)),n&&((0,l.re)((0,l.domNS)(_)),(0,l.re)(_))}}),b(E,e,o,c,P)}function D(_,e,o,{query:s}={}){const l=_.querySelector(".post_header_subscribe_button_loader"),a="post_header_subscribe_button_icons_only_loading";let n=_.classList.contains(u);const d=(0,E.isWkLayerWallPostOpen)();b(n,e,o,{onDone:()=>{d?_.classList.toggle(u,!n):(0,c.emitEvent)(c.WallDataEvents.post_subscribe_update,{groupId:-e,isSubscribed:!n}),!n&&p.Ranges.isGroupId(e)&&(0,P.trackTmrGroupsJoin)()},showProgress:()=>{_.classList.toggle(a,!0),(0,i.showProgress)(l)},hideProgress:()=>{_.classList.toggle(a,!1),(0,i.hideProgress)(l)}},s)}const M=_=>{const{isSubscribed:e,groupId:o}=_,i=document.querySelector(`[id^="post-${o}"]`),s=i?.querySelector(".post_header_subscribe_button");s&&s.classList.toggle(u,e)},w=()=>(0,c.registerUniqueListener)("wall-post-subscribe",c.WallDataEvents.post_subscribe_update,M)},390199:(_,e,o)=>{o.d(e,{highlightUpdatedPost:()=>s,highlightUpdatedPostContent:()=>l});var i=o(581197);const s=_=>{(0,i.triggerAnimationClass)(_,"post_highlight_updated",3e3)},l=_=>{(0,i.triggerAnimationClass)(_,"post_highlight_updated_content",3e3)}},996531:(_,e,o)=>{o.d(e,{floatingButtonCollapseAllRepliesHide:()=>l,floatingButtonCollapseAllRepliesShow:()=>a,highlightUpdatedReply:()=>E,highlightUpdatedReplyContent:()=>c,loadRepliesLinkIsVisible:()=>d,loadRepliesLinkShow:()=>n});var i=o(581197),s=o(754866);const l=_=>{_ instanceof HTMLElement&&_.classList.contains("replies_side")&&_.classList.add("replies_side_hidden")},a=_=>{_ instanceof HTMLElement&&_.classList.contains("replies_side")&&_.classList.remove("replies_side_hidden")},n=_=>{_ instanceof HTMLElement&&_.classList.contains("replies_next")&&_.classList.add("replies_next_shown")},d=_=>!!(_ instanceof HTMLElement&&_.classList.contains("replies_next"))&&(_.classList.contains("replies_next_shown")||(0,s.isVisible)(_)),E=_=>{(0,i.triggerAnimationClass)(_,"reply_highlight_updated",3e3)},c=_=>{(0,i.triggerAnimationClass)(_,"reply_highlight_updated_content",3e3)}},174623:(_,e,o)=>{o.d(e,{wallPostRenderInit:()=>l});var i=o(913054),s=o(348320);const l=()=>{(0,i.postRenderReactionsInit)(),(0,s.postSubscribeHandlerInit)(),(0,i.postWkViewReactionsListener)()}},330447:(_,e,o)=>{o.d(e,{scrollActiveAreaToYDelta:()=>l,setActiveAreaScroll:()=>s});var i=o(672277);const s=_=>{window.cur.wallLayer?window.wkLayerWrap&&(window.wkLayerWrap.scrollTop=_):(0,i.scrollToY)(_,0,!1,!0)},l=_=>{s((window.cur.wallLayer?window.wkLayerWrap?.scrollTop??0:(0,i.scrollGetY)())+_)}},254961:(_,e,o)=>{o.d(e,{buildOwnerDraftKey:()=>s,parseObjectPostId:()=>i});o(553608);const i=_=>{const e=_.match(/(-?\d+)(_?)(photo|video|note|topic|market|wall_reply|note_reply|photo_comment|video_comment|topic_comment|market_comment|)(\d+)/);if(e)return{type:e[3]||"wall",id:e[1]+"_"+e[4]}},s=_=>"wall_draft"+window.vk.id+"_"+_},889438:(_,e,o)=>{o.d(e,{getMessengerSharedState:()=>i.getMessengerSharedState});var i=o(408223)},408223:(_,e,o)=>{o.d(e,{getMessengerSharedState:()=>s});var i=o(720357);const s=(0,o(558137).makeSharedState)("vkcom-messenger::web",(()=>({externalEvents:new i.ExternalEvents})),{version:0})},879168:(_,e,o)=>{o.d(e,{Atom:()=>i});class i{set(_,{notify:e=!0}={}){e&&this.base.notify(this.key)}getKey(){return`${this.base.options.storeName}-${this.key}`}constructor({key:_,base:e}){this.key=_,this.base=e}}},98184:(_,e,o)=>{o.d(e,{Store:()=>i});class i{subscribe(_,e){const o=this.getListeners(e);return o.add(_),()=>{o.delete(_)}}notify(_,e){this.getListeners(e).forEach((e=>{e(_)}))}refresh(){try{localStorage.setItem(this.key,""),localStorage.removeItem(this.key)}catch{}}destroy(){this.listeners.clear(),this.syncListeners.clear(),i.instances.delete(this.key)}get key(){const{dbName:_,storeName:e,version:o}=this.options;return`${_}-v${o}-${e}`}getListeners(_){return _?this.syncListeners:this.listeners}constructor(_){this.listeners=new Set,this.syncListeners=new Set,this.options=_,i.instances.set(this.key,this)}}i.instances=new Map,window.addEventListener("storage",(({key:_,newValue:e})=>{if(!_||null===e)return;const o=i.instances.get(_);o?.notify()}))},100596:(_,e,o)=>{o.d(e,{SyncAtom:()=>l,SyncAtomType:()=>s});var i=o(879168),s=function(_){return _.OBJECT="object",_.STRING="string",_.NUMBER="number",_.BOOLEAN="boolean",_.STRING_NUMBER="string_number",_}({});class l extends i.Atom{get(){const _=this.getKey();try{let e=localStorage.getItem(_);if(!e)return null;switch(this.type){case"object":try{e=JSON.parse(e)}catch{return null}break;case"number":e=Number(e)||0;break;case"string_number":e=Number(e)||e;break;case"boolean":e=Boolean(Number(e))}return e}catch(e){return console.log(`${_}: Ошибка чтения данных из хранилища`),console.log(e),this.cache||null}}set(_,e){const o=this.getKey();let i;switch(this.type){case"object":i=JSON.stringify(_);break;case"boolean":i=String(Number(_));break;default:i=String(_)}try{localStorage.setItem(o,i)}catch(e){console.log(`${o}: Не удалось записать данные в хранилище`),console.log(e),this.cache=_}super.set(_,e)}delete(){const _=this.getKey();try{delete this.cache,localStorage.removeItem(_)}catch(e){console.log(`${_}: Ошибка удаления ключа из хранилища`),console.log(e)}}getKey(){return`${this.base.key}-${this.key}`}constructor(_){super(_);const{base:e,type:o}=_;this.base=e,this.type=o}}},724361:(_,e,o)=>{o.d(e,{createSyncStore:()=>a});var i=o(98184),s=o(100596);class l extends i.Store{createAtom(_,e){return new s.SyncAtom({key:_,type:e,base:this})}constructor(_){super(_)}}function a(_){return new l(_)}},302032:(_,e,o)=>{o.d(e,{lazyModule:()=>d});var i=o(474848),s=o(296540);function l(_){console.error(_)}const a=()=>(0,i.jsx)("h2",{children:"Loading..."}),n=()=>(0,i.jsx)("h2",{children:"Cannot load module..."});function d({loader:_,name:e}){const o=({loading:o=(0,i.jsx)(a,{}),loadingError:d=(0,i.jsx)(n,{}),...c})=>{const[p,P]=(0,s.useState)(!1),u=(0,s.useMemo)((()=>(0,s.lazy)((()=>_().then((_=>({default:_})),(_=>(l(_),P(!0),{default:()=>null})))))),[_]);return(0,i.jsx)(E,{fallback:d,moduleName:e,children:p?d:(0,i.jsx)(s.Suspense,{fallback:o,children:(0,i.jsx)(u,{...c})})})};return o.displayName=`lazyModule(${e})`,o.preload=_,o}class E extends s.Component{componentDidCatch(_){l(_),this.setState({hasError:!0})}render(){const{fallback:_,children:e}=this.props,{hasError:o}=this.state;return o?_:e}constructor(..._){super(..._),this.state={hasError:!1}}}},523901:(_,e,o)=>{o.d(e,{PackContext:()=>E});var i=o(434518),s=o(763812),l=(0,s._)("_options"),a=(0,s._)("_pack"),n=(0,s._)("_product"),d=(0,s._)("_stockItem");class E{get rawData(){return(0,i._)(this,a)[a]||(0,i._)(this,d)[d]||(0,i._)(this,n)[n]}get isPack(){return Boolean((0,i._)(this,a)[a])}get isProduct(){return Boolean((0,i._)(this,n)[n])}get isStockItem(){return Boolean((0,i._)(this,d)[d])}get isStoreItem(){return this.isProduct||this.isStockItem}get stockItem(){return(0,i._)(this,d)[d]}get id(){const _=(0,i._)(this,l)[l]?.redefine?.id;if(void 0!==_)return _;const e=(0,i._)(this,n)[n]?.id;return void 0!==e?e:(0,i._)(this,a)[a]?.id}setHint(_){return(0,i._)(this,l)[l]?((0,i._)(this,l)[l].hint=_,this):this}get hintId(){return(0,i._)(this,l)[l]?.hint?.id}get hintWidth(){return(0,i._)(this,l)[l]?.hint?.width}get index(){return(0,i._)(this,l)[l]?.index}get referrer(){return(0,i._)(this,l)[l]?.referrer}get tooltip(){return(0,i._)(this,l)[l]?.tooltip}get title(){return(0,i._)(this,l)[l]?.redefine?.title||(0,i._)(this,n)[n]?.title||""}get stickers(){return(0,i._)(this,l)[l]?.redefine?.stickers||(0,i._)(this,a)[a]?.stickers||(0,i._)(this,n)[n]?.stickers}get baseId(){return(0,i._)(this,n)[n]?.base_id}get isStyle(){return void 0!==this.baseId}get hasStyles(){return Boolean(this.styleIds?.length)}get styleIds(){return(0,i._)(this,n)[n]?.style_ids}get canGift(){return Boolean((0,i._)(this,d)[d]?.can_gift)}get vmojiAvatar(){return(0,i._)(this,n)[n]?.vmoji_avatar}get isVmoji(){return Boolean(this.vmojiAvatar||(0,i._)(this,n)[n]?.is_vmoji)}get isPopup(){return(0,i._)(this,n)[n]?.is_popup}get isNew(){return(0,i._)(this,n)[n]?.is_new}get previews(){return(0,i._)(this,n)[n]?.previews}constructor({pack:_,...e}){Object.defineProperty(this,l,{writable:!0,value:void 0}),Object.defineProperty(this,a,{writable:!0,value:void 0}),Object.defineProperty(this,n,{writable:!0,value:void 0}),Object.defineProperty(this,d,{writable:!0,value:void 0}),(0,i._)(this,l)[l]=e,_&&("product"in _?((0,i._)(this,d)[d]=_,(0,i._)(this,n)[n]=_.product):"id"in _&&"type"in _?(0,i._)(this,n)[n]=_:(0,i._)(this,a)[a]=_)}}},348385:(_,e,o)=>{o.d(e,{$api:()=>d,APIGate:()=>E,changeAPIOptions:()=>n});var i=o(32489),s=o(293721),l=o(175325),a=o(990490);const n=l.stickersEmojiKeyboard.createEvent(),d=l.stickersEmojiKeyboard.createStore(new a.API({})).on(n,((_,{api:e})=>e)),E=(0,s.createGate)();(0,i.forward)({from:E.state,to:n})},175325:(_,e,o)=>{o.d(e,{stickersEmojiKeyboard:()=>i});const i=(0,o(32489).createDomain)()},720112:(_,e,o)=>{o.d(e,{$favoriteStickers:()=>l,setFavoriteStickers:()=>s});var i=o(175325);const s=i.stickersEmojiKeyboard.createEvent(),l=i.stickersEmojiKeyboard.createStore(null).on(s,((_,e)=>e))},460543:(_,e,o)=>{o.d(e,{$hasAvatar:()=>l,setHasAvatar:()=>s});var i=o(175325);const s=i.stickersEmojiKeyboard.createEvent(),l=i.stickersEmojiKeyboard.createStore(null).on(s,((_,e)=>e))},939659:(_,e,o)=>{o.d(e,{$packs:()=>b,ServicePackKey:()=>u});var i=o(32489),s=o(270634),l=o(969102),a=o(853262),n=o(460543),d=o(432726),E=o(649179),c=o(409875),p=o(720112),P=o(523901),u=function(_){return _[_.FAVORITE=-1]="FAVORITE",_[_.RECENT=-2]="RECENT",_[_.VMOJI=-3]="VMOJI",_[_.UGC=-4]="UGC",_[_.PHOTO_EDITOR=-5]="PHOTO_EDITOR",_}({});const b=(0,i.combine)(l.$ugcInfo,a.$ugcPacks,d.$stockItems,E.$recentStickers,c.$photoEditorStickers,p.$favoriteStickers,n.$hasAvatar,((_,e,o,i,l,a,n)=>{const d=new Map;let E=[];const c=new Map;let p=0;if(!o||!i||!a||s.$context.getState()===s.CONTEXT.PHOTO_EDITOR&&!l)return{};l?.length&&(d.set(-5,new P.PackContext({index:p,referrer:"keyboard",redefine:{id:-5,stickers:l}})),E.push(-5),p++),a.length&&(d.set(-1,new P.PackContext({index:p,referrer:"favourite",redefine:{id:-1,title:"stickers_picker_favorite",stickers:a}})),E.push(-1),p++),i.length&&(d.set(-2,new P.PackContext({index:p,referrer:"recent",redefine:{id:-2,title:"stickers_picker_recently_used",stickers:i}})),E.push(-2),p++);-1!==o?.findIndex((({product:{vmoji_avatar:_}})=>void 0!==_))||n||(d.set(-3,new P.PackContext({index:p,referrer:"keyboard",redefine:{id:-3,title:"stickers_picker_vmoji"}})),E.push(-3),p++);const u=e?.[0],b=_?.can_edit,O=u?.stickers?.length,D=_?.show_keyboard_onboarding&&b;if(!_?.is_keyboard_hidden&&(O||D)){const _=new P.PackContext({pack:u,index:p,referrer:"keyboard",tooltip:{header:"stickers_picker_ugc_tooltip_title",text:"stickers_picker_ugc_tooltip_description"},redefine:{id:-4,title:"stickers_picker_ugc"}});b&&_.setHint({id:"stickers:ugc_keyboard_onboarding_tooltip",width:176}),d.set(-4,_),E.push(-4),p++}return o.forEach((_=>{const{product:{id:e,vmoji_avatar:o}}=_;if(d.set(e,new P.PackContext({index:p,referrer:"keyboard",pack:_})),o){let _=c.get(o.id);_||(_=E.push([])-1,c.set(o.id,_));const i=E[_];Array.isArray(i)&&i.push(e)}else E.push(e);p++})),{packs:d,packsGroups:E}}))},432726:(_,e,o)=>{o.d(e,{$stockItems:()=>l,setStockItems:()=>s});var i=o(175325);const s=i.stickersEmojiKeyboard.createEvent(),l=i.stickersEmojiKeyboard.createStore(null).on(s,((_,e)=>e))},409875:(_,e,o)=>{o.d(e,{$photoEditorStickers:()=>l,setPhotoEditorStickers:()=>s});var i=o(175325);const s=i.stickersEmojiKeyboard.createEvent(),l=i.stickersEmojiKeyboard.createStore(null).on(s,((_,e)=>e))},649179:(_,e,o)=>{o.d(e,{$recentStickers:()=>l,setRecentStickers:()=>s});var i=o(175325);const s=i.stickersEmojiKeyboard.createEvent(),l=i.stickersEmojiKeyboard.createStore(null).on(s,((_,e)=>e))},969102:(_,e,o)=>{o.d(e,{$ugcInfo:()=>c,reloadUGCInfo:()=>d,setUGCInfo:()=>n});var i=o(32489),s=o(348385),l=o(175325),a=o(579924);const n=l.stickersEmojiKeyboard.createEvent(),d=l.stickersEmojiKeyboard.createEvent(),E=l.stickersEmojiKeyboard.createEffect((_=>_.cache.ugcInfo.get().catch((()=>null)))),c=l.stickersEmojiKeyboard.createStore(null).on(n,((_,e)=>e)).on(E.doneData,((_,e)=>e)).on(a.submitUGCReportFx.doneData,(()=>null));(0,i.sample)({clock:d,source:s.$api,target:E})},853262:(_,e,o)=>{o.d(e,{$ugcPacks:()=>a,setUGCPacks:()=>l});var i=o(175325),s=o(579924);const l=i.stickersEmojiKeyboard.createEvent(),a=i.stickersEmojiKeyboard.createStore(null).on(l,((_,e)=>e)).on(s.submitUGCReportFx.doneData,(()=>null))},579924:(_,e,o)=>{o.d(e,{submitUGCReport:()=>a,submitUGCReportFx:()=>n});var i=o(32489),s=o(348385),l=o(175325);const a=l.stickersEmojiKeyboard.createEvent(),n=l.stickersEmojiKeyboard.createEffect((_=>{_.cache.clearUGC()}));(0,i.sample)({clock:a,source:s.$api,target:n})},528079:(_,e,o)=>{o.d(e,{$userEnv:()=>l,setUserEnv:()=>s});var i=o(175325);const s=i.stickersEmojiKeyboard.createEvent(),l=i.stickersEmojiKeyboard.createStore({}).on(s,((_,e)=>e))},19999:(_,e,o)=>{o.d(e,{default:()=>i});const i={layerOuter:"WebModalRoot__layerOuter--O6HAQ",outerFixed:"WebModalRoot__outerFixed--ildg7",layerIn:"WebModalRoot__layerIn--VH0kc"}},428937:(_,e,o)=>{o.d(e,{default:()=>i});const i={background:"InfoBanner__background--4zHoK"}},358172:(_,e,o)=>{_.exports=o.p+"icons/d4181af8b45ee623.png"},589066:(_,e,o)=>{o.d(e,{IconIllustrationSoundWaveLeft36h:()=>l});var i=o(474848),s=(o(296540),o(506447));const l=_=>(0,i.jsx)(s.SvgIconRootV2,{viewBox:"0 0 72 36",width:72,height:36,vkuiIconId:"illustration_sound_wave_left_36h",vkuiAttrs:{fill:"currentColor"},vkuiProps:_,children:(0,i.jsx)("path",{d:"M59.693 5.25a1.25 1.25 0 0 0-2.5 0v25.788a1.25 1.25 0 1 0 2.5 0zm-8.595 6.446a1.25 1.25 0 0 0-2.5 0V24.59a1.25 1.25 0 0 0 2.5 0zm15.942-1.25c.69 0 1.25.56 1.25 1.25V24.59a1.25 1.25 0 0 1-2.5 0V11.696c0-.69.56-1.25 1.25-1.25M42.5 14.275a1.25 1.25 0 0 0-2.5 0v7.737a1.25 1.25 0 0 0 2.5 0zM23.693 5.25a1.25 1.25 0 0 0-2.5 0v25.788a1.25 1.25 0 1 0 2.5 0zm-8.595 6.446a1.25 1.25 0 0 0-2.5 0V24.59a1.25 1.25 0 0 0 2.5 0zm15.942-1.25c.69 0 1.25.56 1.25 1.25V24.59a1.25 1.25 0 0 1-2.5 0V11.696c0-.69.56-1.25 1.25-1.25M6.5 14.275a1.25 1.25 0 0 0-2.5 0v7.737a1.25 1.25 0 0 0 2.5 0z"})})},384081:(_,e,o)=>{o.d(e,{IconIllustrationSoundWaveRight36h:()=>l});var i=o(474848),s=(o(296540),o(506447));const l=_=>(0,i.jsx)(s.SvgIconRootV2,{viewBox:"0 0 72 36",width:72,height:36,vkuiIconId:"illustration_sound_wave_right_36h",vkuiAttrs:{fill:"currentColor"},vkuiProps:_,children:(0,i.jsx)("path",{d:"M12.307 5.25a1.25 1.25 0 0 1 2.5 0v25.788a1.25 1.25 0 1 1-2.5 0zm8.595 6.446a1.25 1.25 0 0 1 2.5 0V24.59a1.25 1.25 0 0 1-2.5 0zM4.96 10.446c-.69 0-1.25.56-1.25 1.25V24.59a1.25 1.25 0 0 0 2.5 0V11.696c0-.69-.56-1.25-1.25-1.25m24.54 3.829a1.25 1.25 0 0 1 2.5 0v7.737a1.25 1.25 0 0 1-2.5 0zM48.307 5.25a1.25 1.25 0 0 1 2.5 0v25.788a1.25 1.25 0 1 1-2.5 0zm8.595 6.446a1.25 1.25 0 0 1 2.5 0V24.59a1.25 1.25 0 0 1-2.5 0zm-15.942-1.25c-.69 0-1.25.56-1.25 1.25V24.59a1.25 1.25 0 0 0 2.5 0V11.696c0-.69-.56-1.25-1.25-1.25m24.54 3.829a1.25 1.25 0 0 1 2.5 0v7.737a1.25 1.25 0 0 1-2.5 0z"})})},784298:(_,e,o)=>{o.d(e,{Icon24Headphones:()=>l});var i=o(474848),s=(o(296540),o(506447));const l=_=>(0,i.jsx)(s.SvgIconRootV2,{viewBox:"0 0 24 24",width:24,height:24,vkuiIconId:"headphones_24",vkuiAttrs:{fill:"currentColor"},vkuiProps:_,children:(0,i.jsx)("path",{d:"M12 2.25a9 9 0 0 0-9 9V18a3 3 0 0 0 3 3h1.5A1.5 1.5 0 0 0 9 19.5v-5A1.5 1.5 0 0 0 7.5 13H5v-1.75c0-3.87 3.13-7 7-7s7 3.13 7 7V13h-2.5a1.5 1.5 0 0 0-1.5 1.5v5a1.5 1.5 0 0 0 1.5 1.5H18a3 3 0 0 0 3-3v-6.75a9 9 0 0 0-9-9"})})},399440:(_,e,o)=>{o.d(e,{Icon24Refresh:()=>l});var i=o(474848),s=(o(296540),o(506447));const l=_=>(0,i.jsx)(s.SvgIconRootV2,{viewBox:"0 0 24 24",width:24,height:24,vkuiIconId:"refresh_24",vkuiAttrs:{fill:"currentColor"},vkuiProps:_,children:(0,i.jsx)("path",{d:"M12 9.096a.4.4 0 0 0 .67.296l4.287-3.899a.667.667 0 0 0 0-.987L12.67.609a.4.4 0 0 0-.67.295V4a8 8 0 1 0 8 8 1 1 0 1 0-2 0 6 6 0 1 1-6-6z"})})},366176:(_,e,o)=>{o.d(e,{Icon40PlayCircle:()=>l});var i=o(474848),s=(o(296540),o(506447));const l=_=>(0,i.jsx)(s.SvgIconRootV2,{viewBox:"0 0 40 40",width:40,height:40,vkuiIconId:"play_circle_40",vkuiAttrs:{fill:"currentColor"},vkuiProps:_,children:(0,i.jsx)("path",{fillRule:"evenodd",d:"M40 20c0 11.046-8.954 20-20 20S0 31.046 0 20 8.954 0 20 0s20 8.954 20 20m-14.329 1.077a1.25 1.25 0 0 0 0-2.154l-8.787-5.175A1.25 1.25 0 0 0 15 14.826v10.348a1.25 1.25 0 0 0 1.884 1.078z",clipRule:"evenodd"})})}}])}if("undefined"!=typeof window&&window.partConfigEnabled?.("static_loading_execute_errors"))try{sourceFn(),window.stManager?.done?.("dist/web/chunks/534f92fc.db369ab0.js")}catch(_){throw window.stManager?.fail?.("dist/web/chunks/534f92fc.db369ab0.js",_),_}else sourceFn(),"undefined"!=typeof window&&window.stManager?.done?.("dist/web/chunks/534f92fc.db369ab0.js");